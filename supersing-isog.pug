title Supersingular isogeny graphs and Quaternion Algebras

introduction#sec-supersing-isog-intro
    p
        | These are notes for BUNTES Fall 2018, the topic is
        | Supersingular isogeny graphs and Quaternion Algebras.

    p
        | Outline:
        ol
            li
                | Background, isogeny graphs, applications.
            li
                | Supersingular isogeny graph cryptography (candidate for post-quantum cryptography).
            li
                | Introduction to Quaternion algebras.
            li
                | The Deuring correspondence:
                me \left\{ \text{maximal orders }\ints \subseteq B_{p,\infty}\right\}/\sim \leftrightarrow \left\{ j \text{ s.s. }\in \FF_{p^2}\right\}/\Gal{\FF_{p^2}}{\FF_p}
                |.
    p
        | References:
        ol
            li
                | Sutherland, Andrew. "Isogeny volcanoes." The Open Book Series 1, no. 1 (2013): 507-530. #[url(href="https://msp.org/obs/2013/1-1/obs-v1-n1-p25-s.pdf")/].


section#sec-supersing-isog-graphs
    title Isogeny graphs: background and motivation (Maria Ines)

    subsection#subsec-supersing-isog-background
        title Background

        p
            | Let #[m k = \FF_q], #[m \characteristic (k) = p \ne 2,3].

        definition#def-supersing-isog-ec
            title Elliptic curves
            statement: p
                | An #[term elliptic curve] #[m E/k] is a smooth projective curve of genus 1 together with a point #[m \infty \in E(k)].

        p
            | We can always write such a curve using a Weierstrass equation
            me E\colon y^2=  x^3  + ax  +b,\,a,b    \in k
            | #[m E] is really the projective closure of this affine equation.

        definition#def-supersing-isog-j-inv
            title #[m j]-invariants
            statement
                p
                    | The #[m j]-invariant of an elliptic curve #[m E] is
                    me j(E) = j(a,b) = 1728 \frac{4a^3}{4a^3 + 27b^2}
                    | doesn't depend on the choice of Weierstrass equation.

        fact
            statement: p
                ol
                    li
                        | #[m E,E'] are isomorphic over #[m \overline k \iff j(E)  = j(E')].
                    li
                        | There is a 1-1 correspondence
                        me k \leftrightarrow \overline k \text{-isomorphism classes of EC's }/k
                        |.

        definition#def-supersing-isog-isog
            title Isogenies
            statement: p
                | Let #[m E,E'/k] be elliptic curves.
                | An #[term isogeny], #[m \phi \colon E\to E'] is a non-constant morphism of pointed curves.
                | The degree #[m \deg \phi ] is the degree as a morphism.
                | #[m E,E'] are said to be #[m n]-isogenous if there exists #[m \phi\colon E\to E'] of degree #[m n].
                | #[m j,j'\in k] are #[m n]-isogenous if the corresponding elliptic curves are.

        fact: statement: p
            ol
                li
                    | If #[m p \nmid n = \deg \phi] then the kernel of #[m \phi] has size #[m n] (#[m \phi] is separable).
                li
                    | every finite subgoup of #[m E(\overline k )] is the kernel of a separable isogeny from #[m E], unique up to isomorphism.
                li
                    | Every #[m n]-isogeny #[m \phi\colon E \to E'] has  a dual isogeny #[m \hat \phi \colon E' \to E] such that
                    me \phi\circ \hat\phi = \hat\phi \circ \phi = \lb n \rb
                    | , the multiplication-by-#[m n ] map.

                li
                    | The #[m n]-torsion subgroup
                    me E\lb n \rb = \left\{ P \in E(\overline k) : nP = \infty\right\}
                    | is isomorphic to #[m (\ZZ/n)^2] if #[m p\nmid n].

        lemma
            statement: p
                | Let #[m E/k] be an elliptic curve with #[m j(E) \not\in\{0,1728\}] and let #[m l\ne p] be prime, up to isomorphism the number of #[m l]-isogenies from #[m E] defined over #[m k] is 0,1,2 or #[m l+1].
            proof: p
                | In Maria's notes.
                // TODO

        paragraphs
            title The modular equation

            p
                | Let #[m j(\tau)] be the modular #[m j]-function.
                | For each prime #[m l] the minimal polynomial #[m \phi_l] of #[m j(l\tau)] over #[m \CC (j(\tau))] is the modular polynomial
                me \phi_l \in \ZZ[j(\tau)][y] \simeq \ZZ[x,y]
                | .

            fact
                statement: p
                    ol
                        li
                            | #[m \phi_l] is symmetric in #[m x,y] and has a degree #[m l+1] in both variables.
                        li
                            | The modular equation
                            me \phi_l (x,y) = 0
                            | is a canonical model for
                            me Y_0(l) = \Gamma_0(l) \backslash \HH
                            | it parameterises pairs of elliptic curves related by an #[m l]-isogeny.
                            | This moduli interpretation is still valid when we use any field #[m F] with #[m \characteristic(F) \ne l].
                        li
                            | Let #[m m_l(j,j') = \ord_{t = j'} \phi_l(j,t)], whenever #[m j,j' \ne 0,1728],
                            me  m_l(j,j') = m_l(j',j)
                            |.



        paragraphs
            title The endomorphism ring

            definition#def-supersing-isog-endo
                title Endomorphisms of elliptic curves
                statement: p
                    | An #[term endomorphism] of an elliptic curve #[m E] is either the zero map or an isogeny from #[m E] to itself.
                    | They form a ring #[m \End(E)].

            p
                | For #[m n \in ZZ] we ahve #[m \lb n \rb \in \End(E)] so #[m \ZZ \subseteq \End(E)] over a finite field #[m k], #[m \End(E)] is always larger than #[m \ZZ].
                | It is either an order in an imaginary quadratic field, in which case we say #[m E] is ordinary.
                | Or an order in an quaternion algebra, in which case we say #[m E] is supersingular.
                | We say #[m E] has complex multiplication by #[m \ints].

            proposition
                statement: p
                    | Let #[m E/k = \FF_{p^n}] be an elliptic curve, TFAE
                    ol
                        li
                            | #[m E] is supersingular.
                        li
                            | #[m E\lb p\rb] is trivial.
                        li
                            | The map #[m \lb p\rb \colon E\to E] is purely inseparable and #[m j(E) \in \FF_{p^2}].

            note
                p
                    | If #[m E,E'] are isogenous elliptic curves then #[m \End(E) \otimes_\ZZ \QQ \simeq \End(E')\otimes_\ZZ \QQ].

                    | So supersingularity is preserved by isogenies.

        paragraphs
            title Isogeny graphs of elliptic curves

            p.
                Let #[m k = \FF_q] with #[m \characteristic(k) = p] and #[m l \ne p ] be prime.

            definition#def-supersing-isog-graph
                title Isogeny graphs
                statement: p.
                    The #[m l]-isogeny graph #[m G_l(k)] is the directed graph with vertex set #[m k] and edges #[m (j,j')] present with multiplicity
                    #[me m_j(l,l') = \ord_{t=j} \phi_l(j,t)]
                    vertices are #[m \overline k] isomorphism classes of  elliptic curves #[m /k],
                    edges are isomorphism classes of #[m l]-isogenies defined over #[m k].

            p
                | Since #[m m_l(j,j') =  m(j',j)] whenever #[m j,j' \ne  0,1728] the subgraph of #[m G_l(k)] supported on #[m k\smallsetminus \{0,1728\}] can be thought of as undirected.
                | By the last note #[m G_l(k)] consists of ordinary and supersingular components.

        paragraphs
            title Supersingular isogney graphs

            p
                | Since every supersingular #[m j]-invariant lives in #[m \FF_{p^2}] if #[m E] is supersingular all roots of #[m \phi_l(j(E), y)] live in #[m \FF_{p^2}].
                | every vertex in a supersingular component has out-degree #[m l+1].
            p
                | Moreover by a result of Kohel #[m G_l(\FF_{p^2})] has only one supersingular component.
            p
                | By the above if #[m p \equiv 1 \pmod {12}] then the supersingular component of #[m G_l(\FF_{p^2})] is an undirected #[m (l+1)]-regular graph with around #[m p/12] vertices.

            theorem
                title Pizer
                statement: p.
                    The supersingular component of #[m G_l(\FF_{p^2})] is a Ramanujan graph.

            definition#def-supersing-isog-ramanujan
                title Ramanujan graphs
                statement: p
                    | A #[m d]-regular graph is a #[term Ramanujan graph] if #[m \lambda_2 \le \sqrt{d+1}] where #[m \lambda_2] is the second largest eigenvalue of its adjaceny matrix.


        paragraphs
            title Ordinary isogney graphs

            p
                | Let #[m E/\FF_q] be an ordinary elliptic curve, then #[m \End(E) \simeq \ints] is an order in an imaginary quadratic field #[m K] with #[m \ZZ\lb \pi \rb \subseteq \ints \subseteq \ints_K] where #[m \pi] is Frobenius and
                me K = \QQ(\sqrt{(\trace \pi)^2 - 4q})
                | by Tate, isogenous elliptic curves have the same #[m \trace \pi].


            p
                | We can separate the vertices in the component #[m V] of #[m G_l(k)] containing #[m j(E)] into levels #[m V_0, \ldots, V_d] so that #[m j(E') \in V_i] if #[m i = v_l(\lb \ints_K : \ints'\rb)].
                | We'll see that #[m \bigcup_{i=0}^d V_i] is connected.

            p
                | Let #[m \phi\colon E\to E'] be an #[m l]-isogeny between two elliptic curves with CM by #[m \ints = \ZZ+\tau\ZZ], #[m \ints ' = \ZZ+\tau'\ZZ].
                | Then #[m \hat\phi \tau' \phi \in \End(E) \implies l\tau ' \in \ints].
                | Similarly #[m l\tau \in \ints'].
                | There are 3 cases
                ol
                    li
                        | #[m \ints = \ints'] (#[m \phi] is horizontal).
                    li
                        | #[m \lb\ints : \ints' \rb = l] (#[m \phi] is descending).
                    li
                        | #[m \lb\ints' : \ints \rb = l] (#[m \phi] is ascending).
                | In the last two cases we say #[m \phi] is critical.

        paragraphs
            title Horizontal isogenies

            p
                | #[m E/k] with CM by #[m \ints \subseteq K] imaginary quadratic.
                | Let #[m \ideal a] be an invertible ideal.
                me E\lb \ideal a \rb = \{ P \in E(\overline k) : \alpha (P)  = 0\, \forall \alpha \in \ideal a\}
                | this is a finite group so it is the kernel of a separable isogeny #[m \phi_{\ideal a }].

                | If #[m p \nmid N(\ideal a)] then #[m \deg(\phi_{\ideal a}) = N(\ideal a)] with #[m \ideal a] invertible implying #[m \phi_{\ideal a} ] is horizontal.

            p
                | Each horizontal #[m l]-isogeny #[m \phi] arises from some invertible ideal #[m \ideal a] of norm #[m l].
            p
                | If #[m l | \lb \ints_K : \ints \rb ] no such ideals exist, otherwise the number of invertible ideals of norm #[m l] is
                me 1+ \left(\frac {\disc(K)}{l}\right) = \begin{cases}0\amp\text{ if }l \text{ inert }\\ 1\amp\text{ if }l \text{ ramified }\\ 2\amp\text{ if }l \text{ splits}\end{cases}

        paragraphs
            title Vertical isogenies

            p
                | Let #[m \ints] be an order in an imaginary quadratic field #[m K ] of discriminant #[m D \lt -4] and let #[m \ints' = \ZZ+l\ints].

            lemma
                statement: p
                    | Let #[m E' / k]  be an elliptic curve with CM by #[m \ints '] then there is a  unique ascending #[m l]-isogeny #[m E'\to E] with #[m E/k] an elliptic curve with CM by #[m \ints].

            definition
                statement: p
                    | An #[m l]-volcano #[m V] is a connected undirected graph whose vertices are partitioned into levels #[m V_0, \ldots, V_d].
                    ol
                        li
                            | The subgraph #[m V_0] is regular of degree #[m \le 2].
                        li
                            | For each #[m i \gt 0] each vertex in #[m V_i] has exactly one neighbour in level #[m V_{i-1}], and this accounts for all edges outside of #[m V_0].
                        li
                            | For #[m  i \lt d] each vertex has degree #[m l+1].
                    | The number #[m d] is the depth.

            figure
                caption A #[m 3]-volcano
                image: latex-image.
                    <![CDATA[
                    \begin{tikzpicture}
                    \definecolor{cv0}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv0}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv0}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv1}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv1}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv1}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv2}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv2}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv2}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv3}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv3}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv3}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv4}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv4}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv4}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv5}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv5}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv5}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv6}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv6}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv6}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv7}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv7}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv7}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv8}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv8}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv8}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv9}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv9}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv9}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv10}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv10}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv10}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv11}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv11}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv11}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv12}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv12}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv12}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv13}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv13}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv13}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv14}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv14}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv14}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv15}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv15}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv15}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv16}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv16}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv16}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv17}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv17}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv17}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv18}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv18}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv18}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv19}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv19}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv19}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv20}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv20}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv20}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv21}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv21}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv21}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv22}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv22}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv22}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv23}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv23}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv23}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv24}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv24}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv24}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv25}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv25}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv25}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv26}{rgb}{0.0,0.0,0.0}
                    \definecolor{cfv26}{rgb}{1.0,1.0,1.0}
                    \definecolor{clv26}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv0v1}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv0v2}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv0v9}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv0v18}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv1v3}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv1v4}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv1v5}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv2v6}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv2v7}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv2v8}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv9v10}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv9v11}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv9v18}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv10v12}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv10v13}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv10v14}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv11v15}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv11v16}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv11v17}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv18v19}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv18v20}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv19v21}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv19v22}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv19v23}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv20v24}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv20v25}{rgb}{0.0,0.0,0.0}
                    \definecolor{cv20v26}{rgb}{0.0,0.0,0.0}
                    %
                    \Vertex[style={minimum size=1.0cm,draw=cv0,fill=cfv0,text=clv0,shape=circle},LabelOut=false,L=\hbox{$0$},x=2.0163cm,y=2.0254cm]{v0}
                    \Vertex[style={minimum size=1.0cm,draw=cv1,fill=cfv1,text=clv1,shape=circle},LabelOut=false,L=\hbox{$1$},x=1.203cm,y=0.8898cm]{v1}
                    \Vertex[style={minimum size=1.0cm,draw=cv2,fill=cfv2,text=clv2,shape=circle},LabelOut=false,L=\hbox{$2$},x=0.7768cm,y=2.2131cm]{v2}
                    \Vertex[style={minimum size=1.0cm,draw=cv3,fill=cfv3,text=clv3,shape=circle},LabelOut=false,L=\hbox{$3$},x=1.0954cm,y=0.0cm]{v3}
                    \Vertex[style={minimum size=1.0cm,draw=cv4,fill=cfv4,text=clv4,shape=circle},LabelOut=false,L=\hbox{$4$},x=0.8216cm,y=0.3343cm]{v4}
                    \Vertex[style={minimum size=1.0cm,draw=cv5,fill=cfv5,text=clv5,shape=circle},LabelOut=false,L=\hbox{$5$},x=0.4512cm,y=0.4732cm]{v5}
                    \Vertex[style={minimum size=1.0cm,draw=cv6,fill=cfv6,text=clv6,shape=circle},LabelOut=false,L=\hbox{$6$},x=0.1621cm,y=1.8553cm]{v6}
                    \Vertex[style={minimum size=1.0cm,draw=cv7,fill=cfv7,text=clv7,shape=circle},LabelOut=false,L=\hbox{$7$},x=0.3018cm,y=2.7372cm]{v7}
                    \Vertex[style={minimum size=1.0cm,draw=cv8,fill=cfv8,text=clv8,shape=circle},LabelOut=false,L=\hbox{$8$},x=0.0cm,y=2.3107cm]{v8}
                    \Vertex[style={minimum size=1.0cm,draw=cv9,fill=cfv9,text=clv9,shape=circle},LabelOut=false,L=\hbox{$9$},x=2.8719cm,y=3.0805cm]{v9}
                    \Vertex[style={minimum size=1.0cm,draw=cv10,fill=cfv10,text=clv10,shape=circle},LabelOut=false,L=\hbox{$10$},x=2.3761cm,y=4.0591cm]{v10}
                    \Vertex[style={minimum size=1.0cm,draw=cv11,fill=cfv11,text=clv11,shape=circle},LabelOut=false,L=\hbox{$11$},x=3.7123cm,y=4.2098cm]{v11}
                    \Vertex[style={minimum size=1.0cm,draw=cv12,fill=cfv12,text=clv12,shape=circle},LabelOut=false,L=\hbox{$12$},x=1.7658cm,y=4.2209cm]{v12}
                    \Vertex[style={minimum size=1.0cm,draw=cv13,fill=cfv13,text=clv13,shape=circle},LabelOut=false,L=\hbox{$13$},x=2.4794cm,y=4.7695cm]{v13}
                    \Vertex[style={minimum size=1.0cm,draw=cv14,fill=cfv14,text=clv14,shape=circle},LabelOut=false,L=\hbox{$14$},x=1.987cm,y=4.7202cm]{v14}
                    \Vertex[style={minimum size=1.0cm,draw=cv15,fill=cfv15,text=clv15,shape=circle},LabelOut=false,L=\hbox{$15$},x=4.4167cm,y=4.5571cm]{v15}
                    \Vertex[style={minimum size=1.0cm,draw=cv16,fill=cfv16,text=clv16,shape=circle},LabelOut=false,L=\hbox{$16$},x=4.1369cm,y=4.9378cm]{v16}
                    \Vertex[style={minimum size=1.0cm,draw=cv17,fill=cfv17,text=clv17,shape=circle},LabelOut=false,L=\hbox{$17$},x=3.7145cm,y=5.0cm]{v17}
                    \Vertex[style={minimum size=1.0cm,draw=cv18,fill=cfv18,text=clv18,shape=circle},LabelOut=false,L=\hbox{$18$},x=3.272cm,y=2.0393cm]{v18}
                    \Vertex[style={minimum size=1.0cm,draw=cv19,fill=cfv19,text=clv19,shape=circle},LabelOut=false,L=\hbox{$19$},x=4.2945cm,y=2.4624cm]{v19}
                    \Vertex[style={minimum size=1.0cm,draw=cv20,fill=cfv20,text=clv20,shape=circle},LabelOut=false,L=\hbox{$20$},x=3.9454cm,y=0.8813cm]{v20}
                    \Vertex[style={minimum size=1.0cm,draw=cv21,fill=cfv21,text=clv21,shape=circle},LabelOut=false,L=\hbox{$21$},x=4.7397cm,y=3.0333cm]{v21}
                    \Vertex[style={minimum size=1.0cm,draw=cv22,fill=cfv22,text=clv22,shape=circle},LabelOut=false,L=\hbox{$22$},x=5.0cm,y=2.6024cm]{v22}
                    \Vertex[style={minimum size=1.0cm,draw=cv23,fill=cfv23,text=clv23,shape=circle},LabelOut=false,L=\hbox{$23$},x=4.9265cm,y=2.1023cm]{v23}
                    \Vertex[style={minimum size=1.0cm,draw=cv24,fill=cfv24,text=clv24,shape=circle},LabelOut=false,L=\hbox{$24$},x=3.8508cm,y=0.1215cm]{v24}
                    \Vertex[style={minimum size=1.0cm,draw=cv25,fill=cfv25,text=clv25,shape=circle},LabelOut=false,L=\hbox{$25$},x=4.3552cm,y=0.2074cm]{v25}
                    \Vertex[style={minimum size=1.0cm,draw=cv26,fill=cfv26,text=clv26,shape=circle},LabelOut=false,L=\hbox{$26$},x=4.6084cm,y=0.613cm]{v26}
                    %
                    \Edge[lw=0.1cm,style={color=cv0v1,},](v0)(v1)
                    \Edge[lw=0.1cm,style={color=cv0v2,},](v0)(v2)
                    \Edge[lw=0.1cm,style={color=cv0v9,},](v0)(v9)
                    \Edge[lw=0.1cm,style={color=cv0v18,},](v0)(v18)
                    \Edge[lw=0.1cm,style={color=cv1v3,},](v1)(v3)
                    \Edge[lw=0.1cm,style={color=cv1v4,},](v1)(v4)
                    \Edge[lw=0.1cm,style={color=cv1v5,},](v1)(v5)
                    \Edge[lw=0.1cm,style={color=cv2v6,},](v2)(v6)
                    \Edge[lw=0.1cm,style={color=cv2v7,},](v2)(v7)
                    \Edge[lw=0.1cm,style={color=cv2v8,},](v2)(v8)
                    \Edge[lw=0.1cm,style={color=cv9v10,},](v9)(v10)
                    \Edge[lw=0.1cm,style={color=cv9v11,},](v9)(v11)
                    \Edge[lw=0.1cm,style={color=cv9v18,},](v9)(v18)
                    \Edge[lw=0.1cm,style={color=cv10v12,},](v10)(v12)
                    \Edge[lw=0.1cm,style={color=cv10v13,},](v10)(v13)
                    \Edge[lw=0.1cm,style={color=cv10v14,},](v10)(v14)
                    \Edge[lw=0.1cm,style={color=cv11v15,},](v11)(v15)
                    \Edge[lw=0.1cm,style={color=cv11v16,},](v11)(v16)
                    \Edge[lw=0.1cm,style={color=cv11v17,},](v11)(v17)
                    \Edge[lw=0.1cm,style={color=cv18v19,},](v18)(v19)
                    \Edge[lw=0.1cm,style={color=cv18v20,},](v18)(v20)
                    \Edge[lw=0.1cm,style={color=cv19v21,},](v19)(v21)
                    \Edge[lw=0.1cm,style={color=cv19v22,},](v19)(v22)
                    \Edge[lw=0.1cm,style={color=cv19v23,},](v19)(v23)
                    \Edge[lw=0.1cm,style={color=cv20v24,},](v20)(v24)
                    \Edge[lw=0.1cm,style={color=cv20v25,},](v20)(v25)
                    \Edge[lw=0.1cm,style={color=cv20v26,},](v20)(v26)
                    %
                    \end{tikzpicture}
                    ]]>

            p
                | The Sage code used to make this picture was:

            sage: input.
                N = 3 # number of flows
                p = 3
                d = 2
                G = graphs.BalancedTree(p,d) # a (p+1)-regular tree of depth d
                G.delete_edge(G.edges()[0])
                F = G.subgraph(G.connected_component_containing_vertex(0)) # A single 'flow'
                H = N*F
                H.add_cycle([len(F.vertices())*i for i in range(N)])
                show(H)
                #latex(H) # for the code

            theorem
                title Kohel
                statement: p
                    | Let #[m V] be an ordinary component of #[m G_l(\FF_q)] that doesn't contain #[m 0] or #[m 1728] then #[m V] is an #[m  l]-volcano s.t.
                    ol
                        li
                            | All vertices in #[m V_i] have the same endomorphism ring #[m \ints_i].
                        li
                            | The subgraph on #[m V_0] has degree
                            me 1+ \left(\frac {\disc(K)}{l}\right)
                            | where #[m K = \Frac(\ints_0)]
                        li
                            | If
                            me \left(\frac {\disc(K)}{l}\right) \ge 0
                            | then #[m \#V_0] is the order #[m \lb l \rb] in #[m \Cl (\ints_0)] else #[m \#V_0 = 1].
                        li
                            | The depth of #[m V] is #[m d = v_l (\lb \ints_K : \ZZ\lb\pi \rb\rb)] where #[m \pi] is the Frobenius morphism on any #[m E] with #[m j(E) \in V].
                        li
                            | #[m l \nmid \lb \ints_K : \ints_0 \rb], #[m \lb \ints_i : \ints_{i+1}\rb = l] for #[m 0\le i \lt d].

        paragraphs
            title Application: Identifying supersingular elliptic curves

            algorithm
                title Sutherland
                statement
                    p
                        | Input: Elliptic curve #[m E/k], #[m \characteristic k = p].
                    p
                        | Output: Ordinary or supersingular.

                    p
                        ol
                            li
                                | If #[m j(E) \not \in \FF_{p^2}] then ordinary.
                            li
                                | If #[m  p  =2,3] return supersingular if #[m j(E) = 0] or ordinary otherwise.
                            li
                                | Find 3 roots of #[m \phi_2(j(E), 4)] over #[m \FF_{p^2}] if not possible return ordinary.
                            li
                                | Walk 3 paths in parallel for up to #[m \lceil \log_2 p \rceil + 1 ] steps.
                                | If any of these paths get to #[m V_d], return ordinary.
                            li
                                | Otherwise supersingular.
