%**************************************%
%*    Generated from PreTeXt source   *%
%*                                    *%
%*      https://pretextbook.org       *%
%*                                    *%
%**************************************%
\documentclass[oneside,10pt,]{book}
%% Custom Preamble Entries, early (use latex.preamble.early)
%% Default LaTeX packages
%%   1.  always employed (or nearly so) for some purpose, or
%%   2.  a stylewriter may assume their presence
\usepackage{geometry}
%% Some aspects of the preamble are conditional,
%% the LaTeX engine is one such determinant
\usepackage{ifthen}
%% etoolbox has a variety of modern conveniences
\usepackage{etoolbox}
\usepackage{ifxetex,ifluatex}
%% Raster graphics inclusion
\usepackage{graphicx}
%% Color support, xcolor package
%% Always loaded, for: add/delete text, author tools
%% Here, since tcolorbox loads tikz, and tikz loads xcolor
\PassOptionsToPackage{usenames,dvipsnames,svgnames,table}{xcolor}
\usepackage{xcolor}
%% begin: defined colors, via xcolor package, for styling
%% end: defined colors, via xcolor package, for styling
%% Colored boxes, and much more, though mostly styling
%% skins library provides "enhanced" skin, employing tikzpicture
%% boxes may be configured as "breakable" or "unbreakable"
%% "raster" controls grids of boxes, aka side-by-side
\usepackage{tcolorbox}
\tcbuselibrary{skins}
\tcbuselibrary{breakable}
\tcbuselibrary{raster}
%% We load some "stock" tcolorbox styles that we use a lot
%% Placement here is provisional, there will be some color work also
%% First, black on white, no border, transparent, but no assumption about titles
\tcbset{ bwminimalstyle/.style={size=minimal, boxrule=-0.3pt, frame empty,
colback=white, colbacktitle=white, coltitle=black, opacityfill=0.0} }
%% Second, bold title, run-in to text/paragraph/heading
%% Space afterwards will be controlled by environment,
%% dependent of constructions of the tcb title
\tcbset{ runintitlestyle/.style={fonttitle=\normalfont\bfseries, attach title to upper} }
%% Spacing prior to each exercise, anywhere
\tcbset{ exercisespacingstyle/.style={before skip={1.5ex plus 0.5ex}} }
%% Spacing prior to each block
\tcbset{ blockspacingstyle/.style={before skip={2.0ex plus 0.5ex}} }
%% xparse allows the construction of more robust commands,
%% this is a necessity for isolating styling and behavior
%% The tcolorbox library of the same name loads the base library
\tcbuselibrary{xparse}
%% Hyperref should be here, but likes to be loaded late
%%
%% Inline math delimiters, \(, \), need to be robust
%% 2016-01-31:  latexrelease.sty  supersedes  fixltx2e.sty
%% If  latexrelease.sty  exists, bugfix is in kernel
%% If not, bugfix is in  fixltx2e.sty
%% See:  https://tug.org/TUGboat/tb36-3/tb114ltnews22.pdf
%% and read "Fewer fragile commands" in distribution's  latexchanges.pdf
\IfFileExists{latexrelease.sty}{}{\usepackage{fixltx2e}}
%% Text height identically 9 inches, text width varies on point size
%% See Bringhurst 2.1.1 on measure for recommendations
%% 75 characters per line (count spaces, punctuation) is target
%% which is the upper limit of Bringhurst's recommendations
\geometry{letterpaper,total={340pt,9.0in}}
%% Custom Page Layout Adjustments (use latex.geometry)
%% This LaTeX file may be compiled with pdflatex, xelatex, or lualatex executables
%% LuaTeX is not explicitly supported, but we do accept additions from knowledgeable users
%% The conditional below provides  pdflatex  specific configuration last
%% The following provides engine-specific capabilities
%% Generally, xelatex is necessary for non-Western fonts
\ifthenelse{\boolean{xetex} \or \boolean{luatex}}{%
%% begin: xelatex and lualatex-specific configuration
\ifxetex\usepackage{xltxtra}\fi
%% realscripts is the only part of xltxtra relevant to lualatex 
\ifluatex\usepackage{realscripts}\fi
%% fontspec package provides extensive control of system fonts,
%% meaning *.otf (OpenType), and apparently *.ttf (TrueType)
%% that live *outside* your TeX/MF tree, and are controlled by your *system*
%% (it is possible that a TeX distribution will place fonts in a system location)
\usepackage{fontspec}
%% We use Latin Modern (lmodern) as the default font
%% So we check that it is available as a system font
\IfFontExistsTF{Latin Modern Roman}{}{\GenericError{}{The font "Latin Modern Roman" requested by PreTeXt output is not available as a system font}{Consult the PreTeXt Guide for help with LaTeX fonts.}{}}
%% We then define various font family commands using a vanilla version,
%% with the intention of letting a style override these choices
%% \setmainfont can be re-issued, and \renewfontfamily can redefine others
\setmainfont{Latin Modern Roman}[SmallCapsFont={Latin Modern Roman Caps}, SlantedFont={Latin Modern Roman Slanted}]
\newfontfamily{\divisionfont}{Latin Modern Roman}
\newfontfamily{\contentsfont}{Latin Modern Roman}
\newfontfamily{\pagefont}{Latin Modern Roman}[SlantedFont={Latin Modern Roman Slanted}]
\newfontfamily{\tabularfont}{Latin Modern Roman}[SmallCapsFont={Latin Modern Roman Caps}]
%% begin: font information supplied by "font-xelatex-style" template
%% end: font information supplied by "font-xelatex-style" template
%% 
%% Extensive support for other languages
\usepackage{polyglossia}
%% Set main/default language based on pretext/@xml:lang value
%% document language code is "en-US", US English
%% usmax variant has extra hypenation
\setmainlanguage[variant=usmax]{english}
%% Enable secondary languages based on discovery of @xml:lang values
%% Enable fonts/scripts based on discovery of @xml:lang values
%% Western languages should be ably covered by Latin Modern Roman
%% end: xelatex and lualatex-specific configuration
}{%
%% begin: pdflatex-specific configuration
\usepackage[utf8]{inputenc}
%% PreTeXt will create a UTF-8 encoded file
%% begin: font setup and configuration for use with pdflatex
%% Portions of a document, are, or may, be affected by font-changing commands
%% These are more robust when using  xelatex  but may be employed with  pdflatex
%% The following definitons are meant to be re-defined in a style with \renewcommand
\newcommand{\divisionfont}{\relax}
\newcommand{\contentsfont}{\relax}
\newcommand{\pagefont}{\relax}
\newcommand{\tabularfont}{\relax}
%% begin: font information supplied by "font-pdflatex-style" template
\usepackage{lmodern}
\usepackage[T1]{fontenc}
%% begin: font information supplied by "font-pdflatex-style" template
%% end: font setup and configuration for use with pdflatex
%% end: pdflatex-specific configuration
}
%% Monospace font: Inconsolata (zi4)
%% Sponsored by TUG: http://levien.com/type/myfonts/inconsolata.html
%% Loaded for documents with intentional objects requiring monospace
%% See package documentation for excellent instructions
%% One caveat, seem to need full file name to locate OTF files
%% Loads the "upquote" package as needed, so we don't have to
%% Upright quotes might come from the  textcomp  package, which we also use
%% We employ the shapely \ell to match Google Font version
%% pdflatex: "varqu" option produces best upright quotes
%% xelatex,lualatex: add StylisticSet 1 for shapely \ell
%% xelatex,lualatex: add StylisticSet 2 for plain zero
%% xelatex,lualatex: we add StylisticSet 3 for upright quotes
%% 
\ifthenelse{\boolean{xetex} \or \boolean{luatex}}{%
%% begin: xelatex and lualatex-specific monospace font
\usepackage{zi4}
\setmonofont[BoldFont=Inconsolatazi4-Bold.otf,StylisticSet={1,3}]{Inconsolatazi4-Regular.otf}
%% end: xelatex and lualatex-specific monospace font
}{%
%% begin: pdflatex-specific monospace font
%% "varqu" option provides textcomp \textquotedbl glyph
%% "varl"  option provides shapely "ell"
\usepackage[varqu,varl]{zi4}
%% end: pdflatex-specific monospace font
}
%% Symbols, align environment, commutative diagrams, bracket-matrix
\usepackage{amsmath}
\usepackage{amscd}
\usepackage{amssymb}
%% allow page breaks within display mathematics anywhere
%% level 4 is maximally permissive
%% this is exactly the opposite of AMSmath package philosophy
%% there are per-display, and per-equation options to control this
%% split, aligned, gathered, and alignedat are not affected
\allowdisplaybreaks[4]
%% allow more columns to a matrix
%% can make this even bigger by overriding with  latex.preamble.late  processing option
\setcounter{MaxMatrixCols}{30}
%%
%%
%% Division Titles, and Page Headers/Footers
%% titlesec package, loading "titleps" package cooperatively
%% See code comments about the necessity and purpose of "explicit" option.
%% The "newparttoc" option causes a consistent entry for parts in the ToC 
%% file, but it is only effective if there is a \titleformat for \part.
%% "pagestyles" loads the  titleps  package cooperatively.
\usepackage[explicit, newparttoc, pagestyles]{titlesec}
%% The companion titletoc package for the ToC.
\usepackage{titletoc}
%% Fixes a bug with transition from chapters to appendices in a "book"
%% See generating XSL code for more details about necessity
\newtitlemark{\chaptertitlename}
%% begin: customizations of page styles via the modal "titleps-style" template
%% Designed to use commands from the LaTeX "titleps" package
%% Plain pages should have the same font for page numbers
\renewpagestyle{plain}{%
\setfoot{}{\pagefont\thepage}{}%
}%
%% Single pages as in default LaTeX
\renewpagestyle{headings}{%
\sethead{\pagefont\slshape\MakeUppercase{\ifthechapter{\chaptertitlename\space\thechapter.\space}{}\chaptertitle}}{}{\pagefont\thepage}%
}%
\pagestyle{headings}
%% end: customizations of page styles via the modal "titleps-style" template
%%
%% Create globally-available macros to be provided for style writers
%% These are redefined for each occurence of each division
\newcommand{\divisionnameptx}{\relax}%
\newcommand{\titleptx}{\relax}%
\newcommand{\subtitleptx}{\relax}%
\newcommand{\shortitleptx}{\relax}%
\newcommand{\authorsptx}{\relax}%
\newcommand{\epigraphptx}{\relax}%
%% Create environments for possible occurences of each division
%% Environment for a PTX "chapter" at the level of a LaTeX "chapter"
\NewDocumentEnvironment{chapterptx}{mmmmmm}
{%
\renewcommand{\divisionnameptx}{Chapter}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\chapter[{#3}]{#1}%
\label{#6}%
}{}%
%% Environment for a PTX "section" at the level of a LaTeX "section"
\NewDocumentEnvironment{sectionptx}{mmmmmm}
{%
\renewcommand{\divisionnameptx}{Section}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\section[{#3}]{#1}%
\label{#6}%
}{}%
%% Environment for a PTX "subsection" at the level of a LaTeX "subsection"
\NewDocumentEnvironment{subsectionptx}{mmmmmm}
{%
\renewcommand{\divisionnameptx}{Subsection}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\subsection[{#3}]{#1}%
\label{#6}%
}{}%
%% Environment for a PTX "subsubsection" at the level of a LaTeX "subsubsection"
\NewDocumentEnvironment{subsubsectionptx}{mmmmmm}
{%
\renewcommand{\divisionnameptx}{Subsubsection}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\subsubsection[{#3}]{#1}%
\label{#6}%
}{}%
%% Environment for a PTX "references" at the level of a LaTeX "chapter"
\NewDocumentEnvironment{references-chapter}{mmmmmm}
{%
\renewcommand{\divisionnameptx}{References}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\chapter[{#3}]{#1}%
\label{#6}%
}{}%
%% Environment for a PTX "references" at the level of a LaTeX "chapter"
\NewDocumentEnvironment{references-chapter-numberless}{mmmmmm}
{%
\renewcommand{\divisionnameptx}{References}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\chapter*{#1}%
\addcontentsline{toc}{chapter}{#3}
\label{#6}%
}{}%
%%
%% Styles for six traditional LaTeX divisions
\titleformat{\part}[display]
{\divisionfont\Huge\bfseries\centering}{\divisionnameptx\space\thepart}{30pt}{\Huge#1}
[{\Large\centering\authorsptx}]
\titleformat{\chapter}[display]
{\divisionfont\huge\bfseries}{\divisionnameptx\space\thechapter}{20pt}{\Huge#1}
[{\Large\authorsptx}]
\titleformat{name=\chapter,numberless}[display]
{\divisionfont\huge\bfseries}{}{0pt}{#1}
[{\Large\authorsptx}]
\titlespacing*{\chapter}{0pt}{50pt}{40pt}
\titleformat{\section}[hang]
{\divisionfont\Large\bfseries}{\thesection}{1ex}{#1}
[{\large\authorsptx}]
\titleformat{name=\section,numberless}[block]
{\divisionfont\Large\bfseries}{}{0pt}{#1}
[{\large\authorsptx}]
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titleformat{\subsection}[hang]
{\divisionfont\large\bfseries}{\thesubsection}{1ex}{#1}
[{\normalsize\authorsptx}]
\titleformat{name=\subsection,numberless}[block]
{\divisionfont\large\bfseries}{}{0pt}{#1}
[{\normalsize\authorsptx}]
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titleformat{\subsubsection}[hang]
{\divisionfont\normalsize\bfseries}{\thesubsubsection}{1em}{#1}
[{\small\authorsptx}]
\titleformat{name=\subsubsection,numberless}[block]
{\divisionfont\normalsize\bfseries}{}{0pt}{#1}
[{\normalsize\authorsptx}]
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titleformat{\paragraph}[hang]
{\divisionfont\normalsize\bfseries}{\theparagraph}{1em}{#1}
[{\small\authorsptx}]
\titleformat{name=\paragraph,numberless}[block]
{\divisionfont\normalsize\bfseries}{}{0pt}{#1}
[{\normalsize\authorsptx}]
\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{1.5em}
%%
%% Styles for five traditional LaTeX divisions
\titlecontents{part}%
[0pt]{\contentsmargin{0em}\addvspace{1pc}\contentsfont\bfseries}%
{\Large\thecontentslabel\enspace}{\Large}%
{}%
[\addvspace{.5pc}]%
\titlecontents{chapter}%
[0pt]{\contentsmargin{0em}\addvspace{1pc}\contentsfont\bfseries}%
{\large\thecontentslabel\enspace}{\large}%
{\hfill\bfseries\thecontentspage}%
[\addvspace{.5pc}]%
\dottedcontents{section}[3.8em]{\contentsfont}{2.3em}{1pc}%
\dottedcontents{subsection}[6.1em]{\contentsfont}{3.2em}{1pc}%
\dottedcontents{subsubsection}[9.3em]{\contentsfont}{4.3em}{1pc}%
%%
%% Begin: Semantic Macros
%% To preserve meaning in a LaTeX file
%%
%% \mono macro for content of "c", "cd", "tag", etc elements
%% Also used automatically in other constructions
%% Simply an alias for \texttt
%% Always defined, even if there is no need, or if a specific tt font is not loaded
\newcommand{\mono}[1]{\texttt{#1}}
%%
%% Following semantic macros are only defined here if their
%% use is required only in this specific document
%%
%% Used for inline definitions of terms
\newcommand{\terminology}[1]{\textbf{#1}}
%% End: Semantic Macros
%% Division Numbering: Chapters, Sections, Subsections, etc
%% Division numbers may be turned off at some level ("depth")
%% A section *always* has depth 1, contrary to us counting from the document root
%% The latex default is 3.  If a larger number is present here, then
%% removing this command may make some cross-references ambiguous
%% The precursor variable $numbering-maxlevel is checked for consistency in the common XSL file
\setcounter{secnumdepth}{3}
%%
%% AMS "proof" environment is no longer used, but we leave previously
%% implemented \qedhere in place, should the LaTeX be recycled
\newcommand{\qedhere}{\relax}
%%
%% A faux tcolorbox whose only purpose is to provide common numbering
%% facilities for most blocks (possibly not projects, 2D displays)
%% Controlled by  numbering.theorems.level  processing parameter
\newtcolorbox[auto counter, number within=section]{block}{}
%%
%% This document is set to number PROJECT-LIKE on a separate numbering scheme
%% So, a faux tcolorbox whose only purpose is to provide this numbering
%% Controlled by  numbering.projects.level  processing parameter
\newtcolorbox[auto counter, number within=section]{project-distinct}{}
%% A faux tcolorbox whose only purpose is to provide common numbering
%% facilities for 2D displays which are subnumbered as part of a "sidebyside"
\newtcolorbox[auto counter, number within=tcb@cnt@block, number freestyle={\noexpand\thetcb@cnt@block(\noexpand\alph{\tcbcounter})}]{subdisplay}{}
%%
%% tcolorbox, with styles, for THEOREM-LIKE
%%
%% theorem: fairly simple numbered block/structure
\tcbset{ theoremstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{theorem}[3]{title={{Theorem~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, phantomlabel={#3}, breakable, parbox=false, after={\par}, fontupper=\itshape, theoremstyle, }
%% proposition: fairly simple numbered block/structure
\tcbset{ propositionstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{proposition}[3]{title={{Proposition~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, phantomlabel={#3}, breakable, parbox=false, after={\par}, fontupper=\itshape, propositionstyle, }
%% corollary: fairly simple numbered block/structure
\tcbset{ corollarystyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{corollary}[3]{title={{Corollary~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, phantomlabel={#3}, breakable, parbox=false, after={\par}, fontupper=\itshape, corollarystyle, }
%% lemma: fairly simple numbered block/structure
\tcbset{ lemmastyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{lemma}[3]{title={{Lemma~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, phantomlabel={#3}, breakable, parbox=false, after={\par}, fontupper=\itshape, lemmastyle, }
%% fact: fairly simple numbered block/structure
\tcbset{ factstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{fact}[3]{title={{Fact~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, phantomlabel={#3}, breakable, parbox=false, after={\par}, fontupper=\itshape, factstyle, }
%% claim: fairly simple numbered block/structure
\tcbset{ claimstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{claim}[3]{title={{Claim~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, phantomlabel={#3}, breakable, parbox=false, after={\par}, fontupper=\itshape, claimstyle, }
%% algorithm: fairly simple numbered block/structure
\tcbset{ algorithmstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{algorithm}[3]{title={{Algorithm~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, phantomlabel={#3}, breakable, parbox=false, after={\par}, fontupper=\itshape, algorithmstyle, }
%%
%% tcolorbox, with styles, for AXIOM-LIKE
%%
%% conjecture: fairly simple numbered block/structure
\tcbset{ conjecturestyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{conjecture}[3]{title={{Conjecture~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, phantomlabel={#3}, breakable, parbox=false, after={\par}, fontupper=\itshape, conjecturestyle, }
%%
%% tcolorbox, with styles, for DEFINITION-LIKE
%%
%% definition: fairly simple numbered block/structure
\tcbset{ definitionstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, after upper={\space\space\hspace*{\stretch{1}}\(\lozenge\)}, } }
\newtcolorbox[use counter from=block]{definition}[2]{title={{Definition~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, phantomlabel={#2}, breakable, parbox=false, after={\par}, definitionstyle, }
%%
%% tcolorbox, with styles, for REMARK-LIKE
%%
%% note: fairly simple numbered block/structure
\tcbset{ notestyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{note}[2]{title={{Note~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, phantomlabel={#2}, breakable, parbox=false, after={\par}, notestyle, }
%% remark: fairly simple numbered block/structure
\tcbset{ remarkstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{remark}[2]{title={{Remark~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, phantomlabel={#2}, breakable, parbox=false, after={\par}, remarkstyle, }
%% observation: fairly simple numbered block/structure
\tcbset{ observationstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{observation}[2]{title={{Observation~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, phantomlabel={#2}, breakable, parbox=false, after={\par}, observationstyle, }
%%
%% tcolorbox, with styles, for EXAMPLE-LIKE
%%
%% example: fairly simple numbered block/structure
\tcbset{ examplestyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, after upper={\space\space\hspace*{\stretch{1}}\(\square\)}, } }
\newtcolorbox[use counter from=block]{example}[2]{title={{Example~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, phantomlabel={#2}, breakable, parbox=false, after={\par}, examplestyle, }
%% question: fairly simple numbered block/structure
\tcbset{ questionstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, after upper={\space\space\hspace*{\stretch{1}}\(\square\)}, } }
\newtcolorbox[use counter from=block]{question}[2]{title={{Question~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, phantomlabel={#2}, breakable, parbox=false, after={\par}, questionstyle, }
%% problem: fairly simple numbered block/structure
\tcbset{ problemstyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, after upper={\space\space\hspace*{\stretch{1}}\(\square\)}, } }
\newtcolorbox[use counter from=block]{problem}[2]{title={{Problem~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, phantomlabel={#2}, breakable, parbox=false, after={\par}, problemstyle, }
%%
%% tcolorbox, with styles, for inline exercises
%%
%% inlineexercise: fairly simple numbered block/structure
\tcbset{ inlineexercisestyle/.style={bwminimalstyle, runintitlestyle, blockspacingstyle, after title={\space}, } }
\newtcolorbox[use counter from=block]{inlineexercise}[2]{title={{Exercise~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, phantomlabel={#2}, breakable, parbox=false, after={\par}, inlineexercisestyle, }
%%
%% tcolorbox, with styles, for FIGURE-LIKE
%%
%% figureptx: 2-D display structure
\tcbset{ figureptxstyle/.style={bwminimalstyle, middle=1ex, blockspacingstyle, } }
\newtcolorbox[use counter from=block]{figureptx}[3]{lower separated=false, before lower={{\textbf{Figure~\thetcbcounter}\space#1}}, phantomlabel={#2}, unbreakable, parbox=false, figureptxstyle, }
%% tableptx: 2-D display structure
\tcbset{ tableptxstyle/.style={bwminimalstyle, middle=1ex, blockspacingstyle, coltitle=black, bottomtitle=2ex, titlerule=-0.3pt} }
\newtcolorbox[use counter from=block]{tableptx}[3]{title={{\textbf{Table~\thetcbcounter}\space#1}}, phantomlabel={#2}, unbreakable, parbox=false, tableptxstyle, }
%%
%% xparse environments for introductions and conclusions of divisions
%%
%% introduction: in a structured division
\NewDocumentEnvironment{introduction}{m}
{\notblank{#1}{\noindent\textbf{#1}\space}{}}{\par\medskip}
%%
%% tcolorbox, with styles, for miscellaneous environments
%%
%% proof: title is a replacement
\tcbset{ proofstyle/.style={bwminimalstyle, fonttitle=\normalfont\itshape, attach title to upper, after title={\space}, after upper={\space\space\hspace*{\stretch{1}}\(\blacksquare\)},
} }
\newtcolorbox{proofptx}[2]{title={\notblank{#1}{#1}{Proof.}}, phantom={\hypertarget{#2}{}}, breakable, parbox=false, after={\par}, proofstyle }
\NewDocumentEnvironment{case}{mmm}
{\par\medskip\noindent\notblank{#1}{#1\space{}}{}\textit{\notblank{#2}{#2\space{}}{}\notblank{#1#2}{}{Case.\space{}}}\hypertarget{#3}{}}{}
%% paragraphs: the terminal, pseudo-division
%% We use the lowest LaTeX traditional division
\titleformat{\subparagraph}[runin]{\normalfont\normalsize\bfseries}{\thesubparagraph}{1em}{#1}
\titlespacing*{\subparagraph}{0pt}{3.25ex plus 1ex minus .2ex}{1em}
\NewDocumentEnvironment{paragraphs}{mm}
{\subparagraph*{#1}\hypertarget{#2}{}}{}
%% Localize LaTeX supplied names (possibly none)
\renewcommand*{\chaptername}{Chapter}
%% Equation Numbering
%% Controlled by  numbering.equations.level  processing parameter
%% No adjustment here implies document-wide numbering
\numberwithin{equation}{section}
%% "tcolorbox" environment for a single image, occupying entire \linewidth
%% arguments are left-margin, width, right-margin, as multiples of
%% \linewidth, and are guaranteed to be positive and sum to 1.0
\tcbset{ imagestyle/.style={bwminimalstyle} }
\NewTColorBox{image}{mmm}{imagestyle,left skip=#1\linewidth,width=#2\linewidth}
%% For improved tables
\usepackage{array}
%% Some extra height on each row is desirable, especially with horizontal rules
%% Increment determined experimentally
\setlength{\extrarowheight}{0.2ex}
%% Define variable thickness horizontal rules, full and partial
%% Thicknesses are 0.03, 0.05, 0.08 in the  booktabs  package
\newcommand{\hrulethin}  {\noalign{\hrule height 0.04em}}
\newcommand{\hrulemedium}{\noalign{\hrule height 0.07em}}
\newcommand{\hrulethick} {\noalign{\hrule height 0.11em}}
%% We preserve a copy of the \setlength package before other
%% packages (extpfeil) get a chance to load packages that redefine it
\let\oldsetlength\setlength
\newlength{\Oldarrayrulewidth}
\newcommand{\crulethin}[1]%
{\noalign{\global\oldsetlength{\Oldarrayrulewidth}{\arrayrulewidth}}%
\noalign{\global\oldsetlength{\arrayrulewidth}{0.04em}}\cline{#1}%
\noalign{\global\oldsetlength{\arrayrulewidth}{\Oldarrayrulewidth}}}%
\newcommand{\crulemedium}[1]%
{\noalign{\global\oldsetlength{\Oldarrayrulewidth}{\arrayrulewidth}}%
\noalign{\global\oldsetlength{\arrayrulewidth}{0.07em}}\cline{#1}%
\noalign{\global\oldsetlength{\arrayrulewidth}{\Oldarrayrulewidth}}}
\newcommand{\crulethick}[1]%
{\noalign{\global\oldsetlength{\Oldarrayrulewidth}{\arrayrulewidth}}%
\noalign{\global\oldsetlength{\arrayrulewidth}{0.11em}}\cline{#1}%
\noalign{\global\oldsetlength{\arrayrulewidth}{\Oldarrayrulewidth}}}
%% Single letter column specifiers defined via array package
\newcolumntype{A}{!{\vrule width 0.04em}}
\newcolumntype{B}{!{\vrule width 0.07em}}
\newcolumntype{C}{!{\vrule width 0.11em}}
%% Program listing support: for listings, programs, consoles, and Sage code
\ifthenelse{\boolean{xetex} \or \boolean{luatex}}%
  {\tcbuselibrary{listings}}%
  {\tcbuselibrary{listingsutf8}}%
%% We define the listings font style to be the default "ttfamily"
%% To fix hyphens/dashes rendered in PDF as fancy minus signs by listing
%% http://tex.stackexchange.com/questions/33185/listings-package-changes-hyphens-to-minus-signs
\makeatletter
\lst@CCPutMacro\lst@ProcessOther {"2D}{\lst@ttfamily{-{}}{-{}}}
\@empty\z@\@empty
\makeatother
%% We define a null language, free of any formatting or style
%% for use when a language is not supported, or pseudo-code, or consoles
%% Not necessary for Sage code, so in limited cases included unnecessarily
\lstdefinelanguage{none}{identifierstyle=,commentstyle=,stringstyle=,keywordstyle=}
\ifthenelse{\boolean{xetex}}{}{%
%% begin: pdflatex-specific listings configuration
%% translate U+0080 - U+00F0 to their textmode LaTeX equivalents
%% Data originally from https://www.w3.org/Math/characters/unicode.xml, 2016-07-23
%% Lines marked in XSL with "$" were converted from mathmode to textmode
\lstset{extendedchars=true}
\lstset{literate={ }{{~}}{1}{¡}{{\textexclamdown }}{1}{¢}{{\textcent }}{1}{£}{{\textsterling }}{1}{¤}{{\textcurrency }}{1}{¥}{{\textyen }}{1}{¦}{{\textbrokenbar }}{1}{§}{{\textsection }}{1}{¨}{{\textasciidieresis }}{1}{©}{{\textcopyright }}{1}{ª}{{\textordfeminine }}{1}{«}{{\guillemotleft }}{1}{¬}{{\textlnot }}{1}{­}{{\-}}{1}{®}{{\textregistered }}{1}{¯}{{\textasciimacron }}{1}{°}{{\textdegree }}{1}{±}{{\textpm }}{1}{²}{{\texttwosuperior }}{1}{³}{{\textthreesuperior }}{1}{´}{{\textasciiacute }}{1}{µ}{{\textmu }}{1}{¶}{{\textparagraph }}{1}{·}{{\textperiodcentered }}{1}{¸}{{\c{}}}{1}{¹}{{\textonesuperior }}{1}{º}{{\textordmasculine }}{1}{»}{{\guillemotright }}{1}{¼}{{\textonequarter }}{1}{½}{{\textonehalf }}{1}{¾}{{\textthreequarters }}{1}{¿}{{\textquestiondown }}{1}{À}{{\`{A}}}{1}{Á}{{\'{A}}}{1}{Â}{{\^{A}}}{1}{Ã}{{\~{A}}}{1}{Ä}{{\"{A}}}{1}{Å}{{\AA }}{1}{Æ}{{\AE }}{1}{Ç}{{\c{C}}}{1}{È}{{\`{E}}}{1}{É}{{\'{E}}}{1}{Ê}{{\^{E}}}{1}{Ë}{{\"{E}}}{1}{Ì}{{\`{I}}}{1}{Í}{{\'{I}}}{1}{Î}{{\^{I}}}{1}{Ï}{{\"{I}}}{1}{Ð}{{\DH }}{1}{Ñ}{{\~{N}}}{1}{Ò}{{\`{O}}}{1}{Ó}{{\'{O}}}{1}{Ô}{{\^{O}}}{1}{Õ}{{\~{O}}}{1}{Ö}{{\"{O}}}{1}{×}{{\texttimes }}{1}{Ø}{{\O }}{1}{Ù}{{\`{U}}}{1}{Ú}{{\'{U}}}{1}{Û}{{\^{U}}}{1}{Ü}{{\"{U}}}{1}{Ý}{{\'{Y}}}{1}{Þ}{{\TH }}{1}{ß}{{\ss }}{1}{à}{{\`{a}}}{1}{á}{{\'{a}}}{1}{â}{{\^{a}}}{1}{ã}{{\~{a}}}{1}{ä}{{\"{a}}}{1}{å}{{\aa }}{1}{æ}{{\ae }}{1}{ç}{{\c{c}}}{1}{è}{{\`{e}}}{1}{é}{{\'{e}}}{1}{ê}{{\^{e}}}{1}{ë}{{\"{e}}}{1}{ì}{{\`{\i}}}{1}{í}{{\'{\i}}}{1}{î}{{\^{\i}}}{1}{ï}{{\"{\i}}}{1}{ð}{{\dh }}{1}{ñ}{{\~{n}}}{1}{ò}{{\`{o}}}{1}{ó}{{\'{o}}}{1}{ô}{{\^{o}}}{1}{õ}{{\~{o}}}{1}{ö}{{\"{o}}}{1}{÷}{{\textdiv }}{1}{ø}{{\o }}{1}{ù}{{\`{u}}}{1}{ú}{{\'{u}}}{1}{û}{{\^{u}}}{1}{ü}{{\"{u}}}{1}{ý}{{\'{y}}}{1}{þ}{{\th }}{1}{ÿ}{{\"{y}}}{1}}
%% end: pdflatex-specific listings configuration
}
%% End of generic listing adjustments
%% The listings package as tcolorbox for Sage code
%% We do as much styling as possible with tcolorbox, not listings
%% Sage's blue is 50%, we go way lighter (blue!05 would also work)
%% Note that we defuse listings' default "aboveskip" and "belowskip"
\definecolor{sageblue}{rgb}{0.95,0.95,1}
\tcbset{ sagestyle/.style={left=0pt, right=0pt, top=0ex, bottom=0ex, middle=0pt, toptitle=0pt, bottomtitle=0pt,
boxsep=4pt, listing only, fontupper=\small\ttfamily,
breakable, parbox=false, 
listing options={language=Python,breaklines=true,breakatwhitespace=true, extendedchars=true, aboveskip=0pt, belowskip=0pt}} }
\newtcblisting{sageinput}{sagestyle, colback=sageblue, sharp corners, boxrule=0.5pt, toprule at break=-0.3pt, bottomrule at break=-0.3pt, }
\newtcblisting{sageoutput}{sagestyle, colback=white, colframe=white, frame empty, before skip=0pt, after skip=0pt, }
%% More flexible list management, esp. for references
%% But also for specifying labels (i.e. custom order) on nested lists
\usepackage{enumitem}
%% Lists of references in their own section, maximum depth 1
\newlist{referencelist}{description}{4}
\setlist[referencelist]{leftmargin=!,labelwidth=!,labelsep=0ex,itemsep=1.0ex,topsep=1.0ex,partopsep=0pt,parsep=0pt}
%% hyperref driver does not need to be specified, it will be detected
%% Footnote marks in tcolorbox have broken linking under
%% hyperref, so it is necessary to turn off all linking
%% It *must* be given as a package option, not with \hypersetup
\usepackage[hyperfootnotes=false]{hyperref}
%% configure hyperref's  \url  to match listings' inline verbatim
\renewcommand\UrlFont{\small\ttfamily}
%% Hyperlinking active in electronic PDFs, all links solid and blue
\hypersetup{colorlinks=true,linkcolor=blue,citecolor=blue,filecolor=blue,urlcolor=blue}
\hypersetup{pdftitle={BUNTES}}
%% If you manually remove hyperref, leave in this next command
\providecommand\phantomsection{}
%% Graphics Preamble Entries
\usepackage{tikz,tkz-graph,tkz-berge,tikz-cd,pstricks,auto-pst-pdf}
\usepackage{pgfplots}
%\usetikzlibrary{external}
%\tikzexternalize[prefix=tikz/]
\usetikzlibrary{arrows}
\pgfplotsset{compat=newest}
\pgfdeclarelayer{background}
\pgfsetlayers{background,main}
%% If tikz has been loaded, replace ampersand with \amp macro
\ifdefined\tikzset
    \tikzset{ampersand replacement = \amp}
\fi
%% extpfeil package for certain extensible arrows,
%% as also provided by MathJax extension of the same name
%% NB: this package loads mtools, which loads calc, which redefines
%%     \setlength, so it can be removed if it seems to be in the 
%%     way and your math does not use:
%%     
%%     \xtwoheadrightarrow, \xtwoheadleftarrow, \xmapsto, \xlongequal, \xtofrom
%%     
%%     we have had to be extra careful with variable thickness
%%     lines in tables, and so also load this package late
\usepackage{extpfeil}
%% Custom Preamble Entries, late (use latex.preamble.late)
\bibliographystyle{alpha}

%% Begin: Author-provided packages
%% (From  docinfo/latex-preamble/package  elements)
\usepackage{xypic}\usepackage{newpxtext}\usepackage{newpxmath}\usepackage{cancel}\usepackage{mathrsfs}\usepackage{mathtools}\usepackage{pgfplots}%% End: Author-provided packages
%% Begin: Author-provided macros
%% (From  docinfo/macros  element)
%% Plus three from MBX for XML characters


\newenvironment{smallermatrix}[1]
{\arraycolsep=0.5pt\def\arraystretch{0.5}\tiny
\array{#1}}
{\endarray}

\def\coloneqq{\mathrel{\mathop:}\mathrel{\mkern-1.2mu}=}
\def\eqqcolon{=\mathrel{\mkern-1.2mu}\mathrel{\mathop:}}




\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\newcommand{\ideal}[1]{\mathfrak{#1}}
\newcommand{\lie}[1]{\operatorname{\mathfrak{#1}}}
\newcommand{\sheaf}[1]{\operatorname{\mathcal{#1}}}
\DeclareMathOperator{\Lie}{Lie}

\newcommand{\diff}{\mathop{}\!\mathrm{d}}
\newcommand{\cinf}{C^\infty}
\newcommand{\inv}{^{-1}}
\newcommand{\units}{^{\times}}

\newcommand{\legendre}[2]{\left(\frac{#1}{#2}\right)}
\newcommand{\pair}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\lb}{[}
\newcommand{\rb}{]}
\newcommand{\powerseries}[2]{#1[[#2]]}


\newcommand{\partder}[2][]{\frac{\partial #1}{\partial #2}}


\providecommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}
\DeclareMathOperator{\Sha}{III}


\newcommand{\NN}{\mathbf{N}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\HH}{\mathbf{H}}
\newcommand{\FF}{\mathbf{F}}
\newcommand{\GG}{\mathbf{G}}
\newcommand{\ints}{\mathcal{O}}
\newcommand{\adeles}{\mathbf{A}}

\newcommand{\alg}{\mathrm{alg}}

\newcommand{\subgroup}{\mathrel{\subseteq}}

\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\catname}[1]{{\mathrm{\textbf{#1}}}}
\newcommand{\Rings}{\mathrm{Rings}}

\newcommand{\Ar}{\mathrm{Ar}}
\newcommand{\dR}{\mathrm{dR}}
\newcommand{\crys}{\mathrm{crys}}
\newcommand{\cris}{\mathrm{cris}}
\newcommand{\et}{\mathrm{\acute{e}t}}
\newcommand{\rig}{\mathrm{rig}}
\newcommand{\sing}{\mathrm{sing}}
\newcommand{\Pet}{\mathrm{Pet}}

\newcommand{\pinf}{{1/p^\infty}}

\newcommand{\colim}{\operatornamewithlimits{\underset{\longrightarrow}{colim}}}
\newcommand{\acts}{\circlearrowright}
\newcommand\rightrightrightarrows{
    \mathrel{\substack{\textstyle\rightarrow\\[-0.6ex]
        \textstyle\rightarrow \\[-0.6ex]
        \textstyle\rightarrow}}
}

\newcommand{\ab}{\mathrm{ab}}
\newcommand{\alm}{\mathrm{a}}
\newcommand{\an}{\mathrm{an}}
\newcommand{\alt}{\mathrm{alt}}
\newcommand{\cyc}{\mathrm{cyc}}
\newcommand{\divisible}{\mathrm{div}}
\newcommand{\id}{\mathrm{id}}
\newcommand{\un}{\mathrm{un}}
\newcommand{\nr}{\mathrm{nr}}
\newcommand{\ur}{\mathrm{ur}}
\newcommand{\tamer}{\mathrm{tr}}
\newcommand{\ns}{\mathrm{ns}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\pre}{\mathrm{pre}}
\newcommand{\reg}{\mathrm{reg}}
\newcommand{\spec}{\mathrm{spec}}
\newcommand{\Set}{\mathrm{Set}}
\newcommand{\sep}{\mathrm{sep}}
\newcommand{\St}{\mathrm{St}}
\newcommand{\tors}{\mathrm{tors}}
\newcommand{\transpose}{\mathrm{T}}
\newcommand{\semis}{\mathrm{ss}}


\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\Ass}{Ass}
\DeclareMathOperator{\Supp}{Supp}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\Hom}{Hom}
\newcommand{\sheafHom}{\mathscr{Hom}}
\DeclareMathOperator{\Nat}{Nat}
\DeclareMathOperator{\Br}{Br}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\Tgt}{Tgt}
\DeclareMathOperator{\sprep}{sp}
\DeclareMathOperator{\vol}{Vol}

\DeclareMathOperator{\divisor}{div}
\DeclareMathOperator{\divisors}{Div}
\DeclareMathOperator{\Div}{Div} 
\DeclareMathOperator{\Cl}{Cl}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\Jac}{Jac}
\DeclareMathOperator{\Princ}{Princ}
\DeclareMathOperator{\Cycles}{Cycles}
\DeclareMathOperator{\supp}{supp}

\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Tor}{Tor}

\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\Fil}{Fil}


\DeclareMathOperator{\polylog}{\mathcal{L}}

\DeclareMathOperator{\disc}{disc}

\DeclareMathOperator{\Tan}{Tan}
\DeclareMathOperator{\Cotan}{Cotan}
\DeclareMathOperator{\Sing}{Sing}

\DeclareMathOperator{\Sel}{Sel}
\DeclareMathOperator{\redu}{red}
\DeclareMathOperator{\Reg}{Reg}
\DeclareMathOperator{\Rep}{Rep}

\DeclareMathOperator{\rk}{rk}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\coim}{coim}
\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\Span}{span}
\DeclareMathOperator{\characteristic}{char}
\DeclareMathOperator{\orient}{or}
\DeclareMathOperator{\leadterm}{lt}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Ad}{Ad}

\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Proj}{Proj}
\DeclareMathOperator{\Spf}{Spf}
\DeclareMathOperator{\Spv}{Spv}
\DeclareMathOperator{\Spa}{Spa}
\DeclareMathOperator{\Spm}{Spm}
\DeclareMathOperator{\specialisation}{sp}
\DeclareMathOperator{\Max}{Max}
\newcommand{\Gal}[2]{\operatorname{Gal}(#1/#2)}
\newcommand{\absgal}[1]{\operatorname{Gal}(\overline{#1}/#1)}
\newcommand{\sepgal}[1]{\operatorname{Gal}(#1^\sep/#1)}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\res}{res}


\DeclareMathOperator{\power}{\mathcal{P}}
\DeclareMathOperator{\aff}{\mathbf{A}}
\DeclareMathOperator{\PP}{\mathbf{P}}
\DeclareMathOperator{\norm}{Norm}
\DeclareMathOperator{\trace}{Tr}
\DeclareMathOperator{\Fr}{Fr}
\DeclareMathOperator{\Frob}{Frob}
\DeclareMathOperator{\NS}{NS}
\DeclareMathOperator{\Der}{Der}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Out}{Out}
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\vf}{\mathcal{V}}
\DeclareMathOperator{\krulldim}{krulldim}
\DeclareMathOperator{\trdeg}{trdeg}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Prob}{Prob}

\DeclareMathOperator{\Mat}{Mat}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\PSL}{PSL}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\specialorthogonal}{SO}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\USp}{USp}
\DeclareMathOperator{\orth}{O}
\DeclareMathOperator{\unitary}{U}
\DeclareMathOperator{\specialunitary}{SU}
\DeclareMathOperator{\Sym}{Sym}

\DeclareMathOperator{\Aff}{Aff}

\DeclareMathOperator{\ch}{ch}
\newcommand{\lt}{<}
\newcommand{\gt}{>}
\newcommand{\amp}{&}
%% End: Author-provided macros
\begin{document}
\frontmatter
%% begin: half-title
\thispagestyle{empty}
{\centering
\vspace*{0.28\textheight}
{\Huge BUNTES}\\[2\baselineskip]
{\LARGE BU Number Theory Expository Seminar}\\
}
\clearpage
%% end:   half-title
%% begin: adcard
\thispagestyle{empty}
\null%
\clearpage
%% end:   adcard
%% begin: title page
%% Inspired by Peter Wilson's "titleDB" in "titlepages" CTAN package
\thispagestyle{empty}
{\centering
\vspace*{0.14\textheight}
%% Target for xref to top-level element is ToC
\addtocontents{toc}{\protect\hypertarget{x:book:buntes}{}}
{\Huge BUNTES}\\[\baselineskip]
{\LARGE BU Number Theory Expository Seminar}\\[3\baselineskip]
{\Large BUNTES Attendees (notes by Alex)}\\[3\baselineskip]
{\Large January 29, 2020}\\}
\clearpage
%% end:   title page
%% begin: copyright-page
\thispagestyle{empty}
\vspace*{\stretch{2}}
\vspace*{\stretch{1}}
\null\clearpage
%% end:   copyright-page
%% begin: table of contents
%% Adjust Table of Contents
\setcounter{tocdepth}{1}
\renewcommand*\contentsname{Contents}
\tableofcontents
%% end:   table of contents
\mainmatter
%
%
\typeout{************************************************}
\typeout{Chapter 1 Abelian Varieties}
\typeout{************************************************}
%
\begin{chapterptx}{Abelian Varieties}{}{Abelian Varieties}{}{}{x:chapter:chapter-abelian-varieties}
\begin{introduction}{}%
These are notes for BUNTES Fall 2017, the topic is Abelian varieties, they were last updated January 29, 2020. We are using Milne's abelian varieties notes primarily, for more details see \href{http://math.bu.edu/people/angusmca/buntes/fall2017.html}{the webpage}. These notes are by Alex, feel free to email me at \href{mailto:alex.j.best@gmail.com}{\nolinkurl{alex.j.best@gmail.com}} to report typos\slash{}suggest improvements, I'll be forever grateful.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 1.2 Introduction (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Introduction (Angus)}{}{Introduction (Angus)}{}{}{x:section:sec-av-intro}
%
%
\typeout{************************************************}
\typeout{Subsection 1.2.1 Definitions}
\typeout{************************************************}
%
\begin{subsectionptx}{Definitions}{}{Definitions}{}{}{x:subsection:subsec-abvar-defs}
\begin{definition}{Abelian varieties.}{x:definition:def-buntes-abvar}%
An \terminology{abelian variety} is a complete connected algebraic group.%
\end{definition}
\begin{definition}{Algebraic groups.}{x:definition:def-alg-gp}%
An \terminology{algebraic group} is an algebraic variety \(G\) along with regular maps \(m\colon G\times G\to G\), \(e \colon * \to G\),  \(\operatorname{inv}\colon G\to G\) such that the following diagrams commute.%
\par
Identity%
\begin{equation*}
\xymatrix{
\ast\times G\ar[dr]_{\sim}\ar[r]^{e\times \id} & G\times G\ar[d]_m &G\times \ast\ar[l]^{\id\times e}\ar[dl]^\sim\\
& G &
}
\end{equation*}
%
\par
Inverse%
\begin{equation*}
\xymatrix{
G\ar[d]\ar[r]^{\operatorname{inv}, \id} & G\times G\ar[d]_m &G\ar[l]^{\id, \operatorname{inv}}\ar[d]\\
\ast\ar[r]_e& G &\ast\ar[l]_e
}
\end{equation*}
%
\par
Associativity%
\begin{equation*}
\xymatrix{
G \times G \times G \ar[d]_{m\times \id}\ar[r]^{\id\times m} & G\times G\ar[d]_m\\
G\times G\ar[r]_m & G
}
\end{equation*}
%
\end{definition}
\begin{definition}{Complete varieties.}{x:definition:def-abelian-complete-var}%
A variety \(X\) is \terminology{complete} if every projection map%
\begin{equation*}
X\times Y \to Y
\end{equation*}
is closed.%
\end{definition}
\begin{example}{Abelian varieties.}{g:example:idm204354469776}%
%
\begin{itemize}[label=\textbullet]
\item{}Elliptic curves.%
\item{}Weil restriction \(\Res_{K/\QQ} E\) of an elliptic curve \(E\).%
\item{}Jacobian varieties of curves.%
\end{itemize}
%
\end{example}
Plan:%
\begin{itemize}[label=\textbullet]
\item{}Some motivation via elliptic curves.%
\item{}Gathering some material about ``completeness''.%
\item{}Prove that abelian varieties are abelian.%
\end{itemize}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.2.2 Elliptic curves (\(\characteristic(k) \ne 2,3\))}
\typeout{************************************************}
%
\begin{subsectionptx}{Elliptic curves (\(\characteristic(k) \ne 2,3\))}{}{Elliptic curves (\(\characteristic(k) \ne 2,3\))}{}{}{g:subsection:idm204354465376}
\begin{theorem}{}{}{x:theorem:thm-equivalent-ec}%
TFAE for a projective curve \(E\) over \(k\).%
\begin{enumerate}
\item\hypertarget{x:li:item-cubic-eq}{}\(E\) is given by \(Y^2Z = X^3 + aXZ^2 + bZ^3\), \(4a^3 + 27b^2 \ne 0\).%
\item\hypertarget{x:li:item-nonsing-pt}{}\(E\) is nonsingular of genus 1 with a distinguished point \(P_0\).%
\item\hypertarget{x:li:item-nonsing-gp}{}\(E\) is nonsingular with an algebraic group structure.%
\item\hypertarget{x:li:item-cmplx}{}(if \(k \subseteq \CC\)) such that \(E(\CC) = \CC/\Lambda\) for some lattice \(\Lambda \subseteq \CC\).%
\end{enumerate}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204354457200}
Strategy: \hyperlink{x:li:item-cubic-eq}{Item~1} \(\iff\) \hyperlink{x:li:item-nonsing-pt}{Item~2} \(\iff\)\hyperlink{x:li:item-nonsing-gp}{Item~3} and \hyperlink{x:li:item-nonsing-pt}{Item~2} \(\implies\) \hyperlink{x:li:item-cmplx}{Item~4} \(\implies\) \hyperlink{x:li:item-cubic-eq}{Item~1}.%
\par
\hyperlink{x:li:item-cubic-eq}{Item~1} \(\implies\) \hyperlink{x:li:item-nonsing-pt}{Item~2} is done.%
\par
\hyperlink{x:li:item-nonsing-pt}{Item~2} \(\implies\)\hyperlink{x:li:item-cubic-eq}{Item~1}: Riemann-Roch states that \(l(D) = l(K-D) +  \deg(D) + 1 -g \) so here \(l(D) = l(K-D) + \deg (D)\) further is \(D\gt 0\) then \(l(K-D) = 0\) in which case \(l(D) = \deg(D)\). Consider \(L(nP_0)\) for \(n \gt 0\) Riemann-Roch implies that \(l(nP_0) = n\) then it always contains the constants.%
\begin{equation*}
L(P_0) = k
\end{equation*}
%
\begin{equation*}
L(2P_0) = k \oplus kx
\end{equation*}
%
\begin{equation*}
L(3P_0) = k \oplus kx \oplus ky
\end{equation*}
%
\begin{equation*}
\vdots
\end{equation*}
%
\begin{equation*}
L(6P_0) = k \oplus kx \oplus ky \oplus k x^2 \oplus ky^2 \oplus kxy \oplus kx^3/\sim
\end{equation*}
so we must have a relation which after manipulation is of the desired form. We get an embedding%
\begin{equation*}
E \hookrightarrow \PP^2
\end{equation*}
%
\begin{equation*}
P\mapsto (x(P):y(P): 1) \,(P\ne P_0)
\end{equation*}
%
\begin{equation*}
P_0 \mapsto (0:1 : 0)
\end{equation*}
and thus \(E\) is of the desired form.%
\end{proofptx}
\begin{definition}{Elliptic curves.}{x:definition:def-abelian-elliptic-curve}%
An \terminology{elliptic curve} over \(k\) is any\slash{}all of \hyperref[x:theorem:thm-equivalent-ec]{that~\ref{x:theorem:thm-equivalent-ec}}.%
\end{definition}
Which of the above characterisations generalise to abelian varieties?%
\begin{enumerate}
\item{}No, in general we don't know that the equations look like.%
\item{}One could possibly replace ``genus'' with a condition on the dimension of cohomology groups.%
\item{}Yes, this is essentially the definition.%
\item{}Yes, stay tuned!%
\end{enumerate}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.2.3 Complete varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Complete varieties}{}{Complete varieties}{}{}{x:subsection:subsec-complete-vars}
Idea: if \(X \times Y\) had product topology (instead of its Zariski topology) then complete is equivalent to compact.%
\par
We'd like to gather a few results about complete varieties we can use to access properties of abelian varieties (like abelianness).%
\begin{proposition}{}{}{g:proposition:idm204354436336}%
Let \(V\) be a complete variety. Given any morphism \(\phi\colon V \to W\) \(\phi (V) \) is closed.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354434512}
Let \(\Gamma_\phi = \{(v, \phi(v))\} \subseteq V\times W\) be the graph of \(\phi\). Its a closed subvariety of \(V\times W\). Under the projection \(V\times W \to W\), the image of \(\Gamma_\phi\) is \(\phi(V)\) and thus closed.%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204354431504}%
If \(V\) is complete and connected, any regular function on \(V\) is constant.%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354430144}
A regular function is a morphism \(f\colon V \to \aff^1\). By the above \(f(V) \subseteq \aff^1\) is closed, and this is a finite set of points. But connected implies we just have one point.%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204354428768}%
Let \(V \) be a complete connected variety. Let \(W\) be an affine variety. Given \(\phi\colon V\to W\), then \(\phi (V)\) is a point.%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354426480}
We have an embedding \(W \hookrightarrow \aff^n\). On \(\aff^n\) we have the coordinate functions \(\aff^n \xrightarrow{x_i} \aff^1\). The composition%
\begin{equation*}
V \xrightarrow\phi W \hookrightarrow\aff^n \to \aff^1
\end{equation*}
be the above is constant. Thus the coordinates of \(\phi(V)\) are constant, so \(\phi(V) = \{\text{pt}\}\).%
\end{proofptx}
A final result of interest that I won't prove today:%
\begin{theorem}{}{}{g:theorem:idm204354423056}%
Projective varieties are complete.%
\end{theorem}
The main goal of this section is to prove the following theorem:%
\begin{theorem}{Rigidity.}{}{x:theorem:thm-rigidity}%
Let \(V,W\) be varieties such that \(V\) is complete and  \(V\times W\) is geometrically irreducible. Let \(\alpha\colon V\times W \to U\) be a morphism such that \(\exists u_0\in U(k), v_0\in V(k), w_0\in W(k)\) with \(\alpha(V\times\{w_0\}) = \alpha (\{v_0\}\times W ) = \{u_0\}\). Then \(\alpha (V\times W) = \{u_0\}\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204354417968}
Since \(V\times W\) is geometrically irreducible, \(V\) must be connected. Denote the projection \(q\colon V\times W \to W\). Let \(U_0 \ni u_0\) be an open neighborhood. We consider the set%
\begin{equation*}
Z = \{w\in W : \alpha((v,w)) \not\in U_0 \text{ for some } v\in V\} = q(\alpha^{-1}(U\smallsetminus U_0))
\end{equation*}
Since \(q\) is closed, \(Z\subseteq W\) is closed. Since \(w_0\in W\smallsetminus Z\), \(W\smallsetminus Z\) is a nonempty open subset of \(W\).%
\par
Consider \(w \in W\smallsetminus Z\). Since \(V\times\{w\} \cong V\) it is complete and connected. Thus%
\begin{equation*}
\alpha(V\times \{w\}) = \{\text{pt}\} = \alpha((v_0,w)) = \{u_0\}
\end{equation*}
which implies that%
\begin{equation*}
\alpha(V\times (W\smallsetminus Z)) = \{u_0\}
\end{equation*}
Since \(V\times (W\smallsetminus Z) \subseteq V\times W\) is open and \(V\times W\) is irreducible, it is dense. So \(\alpha(V\times W) = \{u_0\}\).%
\end{proofptx}
\begin{proposition}{}{}{g:proposition:idm204354409808}%
Let \(A,B\) be abelian varieties. Every morphism \(\alpha \colon A \to B \) is the composition of a homomorphism and a translation.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354408368}
First compose by a translation on \(B\) such that \(\alpha(0) = 0\). Consider the map%
\begin{align*}
\phi \colon A\times A\amp\to B\\
(a,a')               \amp\mapsto \alpha(a+a') - \alpha(A) -\alpha(a')
\end{align*}
Then%
\begin{align*}
\phi(A\times\{0\}) \amp = \alpha(a+ 0) - \alpha(a) - \alpha(0) = 0\\
\phi(\{0\}\times A) \amp = \alpha(0+ a) - \alpha(0) - \alpha(a) = 0\text{.}
\end{align*}
By the \hyperref[x:theorem:thm-rigidity]{rigidity theorem~\ref{x:theorem:thm-rigidity}} \(\phi(A\times A) = \{0\}\) hence \(\alpha(a + a') = \alpha(a) + \alpha(a')\).%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204354403680}%
Abelian varieties are abelian.%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354403136}
The inversion map \(a \mapsto -a\) sends \(0\) to \(0\), thus is a homomorphism. Therefore%
\begin{equation*}
a+ b - a -b = a+b -(a+b) = 0
\end{equation*}
and so%
\begin{equation*}
a+b=b+a\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.3 Abelian varieties over \(\CC\) (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Abelian varieties over \(\CC\) (Alex)}{}{Abelian varieties over \(\CC\) (Alex)}{}{}{x:section:sec-av-complex}
\begin{introduction}{}%
The goal of this talk is to understand what abelian varieties look like over \(\CC\). The goal for me is to understand what a (principal) polarisation is and why it is important.%
\par
First immediate question: why study complex theory at all? The most classical field, algebraically closed, archimidean, characteristic 0.%
\par
Recall\slash{}rapidly learn the picture for elliptic curves, given \(E\) an elliptic curve we have for some \(\Lambda\) a rank 2 lattice in \(\CC\)%
\begin{align*}
\CC/\Lambda \amp\xrightarrow{\sim} E(\CC) \subseteq \PP^2(\CC)\\
z\amp\mapsto (\wp(z) : \wp'(z) : 1)\\
0\amp\mapsto (0 : 1 : 0)
\end{align*}
where%
\begin{equation*}
\wp(z) = \frac{1}{z^2} + \sum_{\lambda \in \Lambda\smallsetminus\{0\}} \frac{1}{(z-\lambda)^2} - \frac{1}{\lambda^2}\text{.}
\end{equation*}
This is a meromorphic function whose image lands in%
\begin{equation*}
y^2 = 4x^3 - g_2 x - g_3\text{.}
\end{equation*}
So the \(\CC\) points of an elliptic curve are topologically a torus.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.1 Abelian varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Abelian varieties}{}{Abelian varieties}{}{}{g:subsection:idm204354393776}
Naturally one asks: does this generalise? Let \(A\) be an abelian variety over \(\CC\), what does \(A(\CC)\) look like? Another torus?%
\begin{proposition}{}{}{g:proposition:idm204354391872}%
\(A(\CC)\) is a compact, connected, complex lie group.%
\end{proposition}
\begin{proposition}{}{}{g:proposition:idm204354391056}%
Let \(A\) be an abelian variety of dimension \(g\) over \(\CC\). Then we have%
\begin{equation*}
A(\CC) \cong V/\Lambda
\end{equation*}
where \(V\) is a \(g\) dimensional complex vector space and \(\Lambda\) is a full rank lattice of \(V\) (i.e \(\Lambda\) is a discrete subgroup of \(V\) s.t. \(\RR\otimes \Lambda  = V\)).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354385728}
Differential geometry gives us a map of complex manifolds, the exponential map%
\begin{equation*}
\exp\colon\Tgt_0(A(\CC)) \to A(\CC)
\end{equation*}
this is holomorphic. And since \(A(\CC)\) is abelian, this is a homomorphism also. In general this is locally an isomorphism around 0.%
\par
Claim: \(\exp\) is injective. There exists a neighborhood \(U\supseteq 0\) s.t. \(\exp(U) \cong U\). Consider the image \(\exp(\Tgt_0 A(\CC))\). For \(x\in \exp(\Tgt_0 A(\CC))\), \(\{U+x\}\) are all open and give a cover. Thus \(\exp(\Tgt_0A(\CC))\) is open. Since \(A(\CC)\) is connected we are thus reduced to showing \(\exp(\Tgt_0 A(\CC))\) is closed also. Since \(\exp\) is a homomorphism, the image is a subgroup. So its complement is the union of its non-trivial cosets, which is open. Thus \(\exp(\Tgt_0A(\CC))\) is closed. Giving \(\exp(\Tgt_0A(\CC)) = A(\CC)\), which proves the claim.%
\par
\(\exp\) is a local isomorphism, which gives that \(\ker(\exp)\) is discrete, i.e. a lattice. We now have%
\begin{equation*}
A(\CC) \cong \Tgt_0A(\CC)/ \ker(\exp)
\end{equation*}
so as \(A(\CC)\) is compact we cannot have a kernel which is not full rank, as otherwise the quotient could not be compact.%
\end{proofptx}
\begin{definition}{}{x:definition:def-complex-torus}%
We call any such \(V/\Lambda\) a \terminology{complex torus}.%
\end{definition}
From the above isomorphism we can now read off properties of \(A(\CC)\) as a group.%
\begin{proposition}{}{}{g:proposition:idm204354374768}%
\(A(\CC)\) is divisible, and \(A(\CC)\lb n\rb \cong (\ZZ/n\ZZ)^{2g}\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354373520}
%
\begin{equation*}
A(\CC)  \cong V/\Lambda \cong (\RR/\ZZ)^{2g}
\end{equation*}
isomorphisms as groups, thus \(A(\CC)\) is divisible. Further, \((\RR/\ZZ)\lb n \rb = (\frac 1n \ZZ)/\ZZ\).%
\end{proofptx}
Question: Given a complex torus \(V/\Lambda\), does there exist an abelian variety \(A\) such that \(A(\CC) \cong V/\Lambda\)?%
\begin{example}{}{g:example:idm204354370368}%
%
\begin{itemize}[label=\textbullet]
\item{}%
\begin{equation*}
\CC/\Lambda \cong E(\CC) \text{ always in dim 1}
\end{equation*}
%
\item{}%
\begin{equation*}
\CC^2/\Lambda^2 \cong (E\times E)(\CC) \text{ sometimes yes in higher dimension}
\end{equation*}
%
\item{}%
\begin{equation*}
\CC^2/\langle (i, 0), (i\sqrt p, i), (1, 0), (0, 1)\rangle_\ZZ
\end{equation*}
for \(p\) prime??? (I guess not, see Mumford)%
\end{itemize}
%
\end{example}
\begin{theorem}{Chow.}{}{g:theorem:idm204354367904}%
If \(X\) is an analytic submanifold of \(\PP^n(\CC)\) then \(X\) is an algebraic subvariety.%
\end{theorem}
By this theorem it is enough to analytically imbed \(V/\Lambda \hookrightarrow \PP^m\). We can try and do this by mimicing the elliptic curve strategy, find enough functions \(\theta \colon V/\Lambda \to \CC\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.2 Cohomology}
\typeout{************************************************}
%
\begin{subsectionptx}{Cohomology}{}{Cohomology}{}{}{g:subsection:idm204354364624}
\begin{proposition}{}{}{g:proposition:idm204354364224}%
Let \(X = V/\Lambda\). Then%
\begin{equation*}
H^r (X,\ZZ) \cong \{\text{alternating }r\text{-forms } \Lambda\times\cdots\times\Lambda\to \ZZ\}\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354362784}
\(\pi\colon V\to V/\Lambda\) is a universal covering map, so%
\begin{equation*}
\Lambda = \pi^{-1} (0 ) \cong \pi_1(X,0)\text{.}
\end{equation*}
Because all these spaces are nice%
\begin{equation*}
H^1 (X,\ZZ) \cong \Hom(\pi_1(X), \ZZ) \cong \Hom(\Lambda, \ZZ)\text{.}
\end{equation*}
To extend to \(r \ne 1\) use the Künneth formula:%
\begin{equation*}
\xymatrix{
\bigwedge^r(H^1(X_1\times X_2, \ZZ)) \ar@{=}[r]\ar@{=}[d]^{\text{Künneth}} & H^r(X_1\times X_2 , \ZZ)\ar@{=}[dd]^{\text{Künneth}}\\
\bigwedge^r(H^1(X_1, \ZZ)\otimes H^1(X_2, \ZZ)) \ar@{=}[d]& \\
\bigoplus_{p+q=r}(\bigwedge^p(H^1(X_1, \ZZ))\otimes\bigwedge^q(H^1(X_2, \ZZ))) \ar@{=}[r] & \bigoplus_{p+q=r}(H^p(X_1, \ZZ)\otimes H^q(X_2, \ZZ))
}
\end{equation*}
Since we know the proposition for \(S^1 = \RR/\ZZ\) by taking products and applying the above we get it for all complex tori \(V/\Lambda\).%
\end{proofptx}
\begin{proposition}{}{}{g:proposition:idm204354358656}%
There is a correspondence%
\begin{align*}
\{\text{Hermitian forms }H \text{ on } V\} \amp\leftrightarrow\{\text{Alternating forms }E\colon V\times V\to\RR,\,E(iu,iv) = E(u,v)\}\\
H\amp\mapsto \im H\\
E(iu,v)+ i E(u,v) \amp\mapsfrom E\text{.}
\end{align*}
%
\end{proposition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.3 Line bundles}
\typeout{************************************************}
%
\begin{subsectionptx}{Line bundles}{}{Line bundles}{}{}{g:subsection:idm204354356864}
Now we will consider line bundles on \(X = V/\Lambda\), that is%
\begin{equation*}
L\xrightarrow{\pi} X
\end{equation*}
such that for any \(x\in X\) there exists \(U\ni x\) with \(\pi^{-1} (U) \cong \CC \times U\). We can obtain these from hermitian forms and some auxiliary data as follows.%
\begin{definition}{}{g:definition:idm204354353984}%
If \(H\) is a hermitian form on \(V\) such that \(E(\Lambda\times\Lambda) \subseteq \ZZ\) there exists a map%
\begin{equation*}
\alpha \colon \Lambda \to \CC^*  = \{z\in \CC^* : |z| = 1\}
\end{equation*}
such that%
\begin{equation*}
\alpha(u + v) = e^{i\pi E(u,v)} \alpha(u) \alpha(v)\text{.}
\end{equation*}
%
\par
Further, there is a line bundle \(L(H, \alpha)\) on \(X\) which is defined by quotienting \(\CC\times V\) by \(\Lambda\) which acts via%
\begin{equation*}
\phi_u(\lambda, v) = (\alpha(u)e^{\pi H(v,u) + \frac12 \pi H(u,u)}\lambda, v+u)\text{ for } u\in \Lambda\text{,}
\end{equation*}
we'll denote by \(e_u\) the factor \(\alpha(u)e^{\pi H(v,u) + \frac12 \pi H(u,u)}\) for brevity.%
\end{definition}
\begin{theorem}{Appell-Humbert.}{}{x:theorem:thm-appell-humbert}%
Any line bundle on \(X\) is of the form \(L(H,\alpha)\) for some \(H\), \(\alpha\) as above. Further%
\begin{equation*}
L(H_1, \alpha_1) \otimes L(H_2, \alpha_2)  = L(H_1+ H_2, \alpha_1\alpha_2)\text{.}
\end{equation*}
In fact we have the following diagram%
\begin{equation*}
\xymatrix{
0 \ar[r] &
\Hom(\Lambda, \CC) \ar[r]\ar[d] &
\{\text{data } (H,\alpha)\} \ar[r]\ar[d] &
\{\text{gp. of Herm. } H \text{ w/ }E(\Lambda\times \Lambda) \subseteq \ZZ\} \ar[r]\ar[d] &
0 \\
0 \ar[r] &
\Pic^0(X) \ar[r] &
\Pic(X) \ar[r]_c &
\ker(H^2(X,\ZZ) \to H^2(X,\sheaf O_X)) \ar[r]&
0
}
\end{equation*}
where \(\Pic(X)\) is the group of all line bundles on \(X\) and \(\Pic^0\) is the subgroup of those which are topologically trivial.%
\end{theorem}
We wanted functions \(X\to \CC\). Now we can instead consider sections \(s\) of \(L(H,\alpha) \xrightarrow{\pi} X\) i.e. maps \(s\colon X\to L(H,\alpha)\) with \(\pi\circ s = \id\). Denote the space of such sections \(H^0(X,L(H,\alpha))\).%
\begin{definition}{Theta functions.}{x:definition:def-theta-function}%
The sections of \(L(H, \alpha)\)  correspond to holomorphic functions%
\begin{equation*}
\theta \colon V \to \CC
\end{equation*}
such that \(\theta(z+ u) = e_u \theta(z)\), we will call such a \(\theta\) a \terminology{theta function} for \((H,\alpha)\).%
\end{definition}
If \(H\) is not positive definite the space of such functions is 0!%
\begin{proposition}{}{}{x:proposition:prop-dimension-sections-complex}%
If \(H\) is positive definite, then the dimension of \(H^0(X, L(H,\alpha))\) is \(\sqrt{\det E}\) where we really mean the determinant of a matrix for \(E\) with respect to an integral basis.%
\end{proposition}
\begin{theorem}{Lefschetz.}{}{g:theorem:idm204354332608}%
Given a positive definite \(H\), there exists an imbedding \(X \hookrightarrow \PP^m\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204354330960}
Sketch: Let \(L = L(H,\alpha)\), consider \(L(H,\alpha)^{\otimes 3} = L(3H, \alpha^3)\), take a basis of \(\theta_0,\ldots, \theta_d\) of \(H^0(X, L^{\otimes 3})\).%
\par
Claim: \(\Theta\colon z\mapsto (\theta_0(z) :\cdots :\theta_d (z)) \subseteq \PP^d\) is an embedding.%
\par
To see that this is well defined, we must give a section of \(L^{\otimes 3}\) not vanishing at \(z\) for all \(z\in X\). Let \(\theta \in H^0(X,L)\smallsetminus \{0\}\). Then pick \(a,b\) such that the section of \(L^{\otimes 3}\) given by%
\begin{equation*}
\theta(z-a)\theta(z-b) \theta(z+ a+b)
\end{equation*}
does not vanish. This is possible and thus we have a nonvanishing section of \(L^{\otimes 3}\).%
\par
For injectivity, show that if the above section has the same values on \(z_1,z_2\) then it is a theta function for some sublattice. Almost all sections aren't theta functions for a sublattice (this uses \hyperref[x:proposition:prop-dimension-sections-complex]{Proposition~\ref{x:proposition:prop-dimension-sections-complex}}).%
\par
Something similar must be done for tangent vectors.%
\end{proofptx}
\begin{definition}{Riemann forms.}{x:definition:def-riemann-form}%
A \terminology{Riemann form} is \(E\colon \Lambda \times \Lambda \to \ZZ\) alternating such that%
\begin{equation*}
E_\RR \colon V\times V\to \RR
\end{equation*}
has the property that \(E(iu,iv) = E(u,v)\) and  the corresponding Hermitian form is positive definite.%
\end{definition}
\begin{definition}{Polarizable tori.}{x:definition:def-polarizable}%
A complex torus \(X = V/\Lambda\) is \terminology{polarizable} if there exists a Riemann form \(E\) on \(\Lambda\).%
\end{definition}
\begin{example}{Proposition.}{g:example:idm204354316880}%
Every \(\CC/\Lambda\) where \(\Lambda = \langle 1,\tau\rangle_{\ZZ}\) is polarizable.%
\par
To see this take%
\begin{equation*}
E(u,v) = \frac{u\bar v}{\im \tau}
\end{equation*}
as a Riemann form.%
\end{example}
Putting everything together we have obtained an equivalence of categories%
\begin{equation*}
\{\text{abelian varieties over } \CC\} \leftrightarrow \{\text{polarizable complex tori}\}\text{.}
\end{equation*}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.4 Isogenies}
\typeout{************************************************}
%
\begin{subsectionptx}{Isogenies}{}{Isogenies}{}{}{g:subsection:idm204354313632}
\begin{definition}{Isogenies of complex tori.}{x:definition:def-isogeny-tori}%
An \terminology{isogeny} of complex tori is a homomorphism \(V/\Lambda \to V'/\Lambda'\) with finite kernel.%
\end{definition}
\begin{definition}{Dual vector spaces.}{g:definition:idm204354311200}%
Given \(V\) a complex vector space, let%
\begin{equation*}
V^* = \{f\colon V\to \CC : f(u+v) = f(u)+f(v),\,f(\alpha v) = \bar \alpha f(v) \}
\end{equation*}
and given \(\Lambda \subset V\) a lattice, let%
\begin{equation*}
\Lambda^* = \{f\in V^* : f(\lambda) \in \ZZ\,\forall \lambda\in \Lambda\}\text{.}
\end{equation*}
%
\end{definition}
\begin{definition}{Dual tori.}{x:definition:def-dual-torus}%
If \(X = V/\Lambda\), \(X^\vee = V^*/ \Lambda^*\) is the \terminology{dual torus}.%
\end{definition}
\begin{proposition}{Existence of Weil pairing.}{}{x:proposition:prop-weil-pair}%
%
\begin{equation*}
X\times X^\vee \to \CC
\end{equation*}
so%
\begin{equation*}
X[n] \times X^\vee[n] \to \left(\frac{1}{n^2} \ZZ/\frac{1}{n} \ZZ\right) \cong \ZZ/n\ZZ
\end{equation*}
this is called the \terminology{Weil pairing}.%
\end{proposition}
Can a complex torus be isogenous to its own dual? If \(X\) is polarizable then%
\begin{align*}
X \amp\to X^\vee\\
v\amp\mapsto H(v,-)
\end{align*}
is an isogeny.%
\begin{definition}{}{x:definition:def-complex-pol}%
A \terminology{polarization} is an isogeny \(X \to X^\vee\).%
\end{definition}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.4 Rational Maps into Abelian Varieties (Maria)}
\typeout{************************************************}
%
\begin{sectionptx}{Rational Maps into Abelian Varieties (Maria)}{}{Rational Maps into Abelian Varieties (Maria)}{}{}{x:section:sec-rational-maps-avs}
\begin{introduction}{}%
Note all varieties are irreducible today.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.4.1 Rational maps}
\typeout{************************************************}
%
\begin{subsectionptx}{Rational maps}{}{Rational maps}{}{}{g:subsection:idm204354299472}
\(V,W\) varieties \(/K\). Consider pairs \((U,\phi_U)\), where \(\emptyset \ne  U \subset V\) an open subset so \(U\) is dense, and \(\phi_U \colon U \to W\) is a regular map.%
\begin{definition}{Rational maps.}{x:definition:def-rational-map}%
\((U,\phi_U)\), \((U',{\phi_{U'}})\) are equivalent if \(\phi_U\) and \(\phi_{U'}\) agree on \(U \cap U'\). An equivalence class \(\phi\) of \(\{(U, \phi_U)\}\) is a \terminology{rational map} \(\phi \colon V \dashrightarrow W\) If \(\phi\colon V \dashrightarrow W\) is defined at   \(v\in V\) if \(v\in U\) for some \((U,\phi_U) \in \phi\).%
\end{definition}
\begin{note}{}{g:note:idm204354289856}%
The set \(U_1 = \bigcup U\) where  \(\phi\) is defined is open and \((U_1,\phi_1) \in \phi\) where \(\phi_1 \colon U_1 \to W\) restricts to \(\phi_U\) on \(U\).%
\end{note}
\begin{example}{}{g:example:idm204354286944}%
%
\begin{enumerate}
\item{}Let \(\emptyset \ne W \subseteq V\) be open. Then the rational map \(V\dashrightarrow W\) induced by \(\id \colon W \to W\) will not extend to \(V\). To avoid this, assume \(W \) is complete (so \(W = V\)).%
\item{}\(C \colon y^2 = x^3\), then \(\alpha\colon \aff^1 \to C\), \(a\mapsto (a^2,a^3)\) is a regular map, restricting to an isomorphism  \(\aff^1 \smallsetminus \{0 \} \to C \smallsetminus \{0\}\). The inverse of \(\alpha|_{\aff^1\smallsetminus \{0\}}\) represents \(\beta \colon C \dashrightarrow \aff^1\) which does not extend to \(C\). This corresponds on function fields to%
\begin{equation*}
K(t) \to K(x,y)
\end{equation*}
%
\begin{equation*}
t\mapsto y/x
\end{equation*}
which does not send \(K[y]_{(t)}\) to \(K[x,y]_{(x,y)}\).%
\item{}Given a nonsingular surface \(V,\, P\in V\) then \(\exists \alpha\colon W \to V\) regular that induces an isomorphism \(\alpha\colon W\smallsetminus \alpha^{-1} (P) \to V\smallsetminus P\), but \(\alpha^{-1}(P)\) is a projective line. The rational map represented by \(\alpha^{-1}\) is not regular on \(V\) (where to send \(P\)?).%
\end{enumerate}
%
\end{example}
\begin{theorem}{Milne 3.1.}{}{x:theorem:thm-milne-3-1}%
A rational map \(\phi\colon V\dashrightarrow W\) from a nonsingular variety \(V\) to a complete variety \(W\) is defined on an open subset  \(U \subseteq V\) whose complement has codimension \(\ge 2\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204354272208}
(\(V\) a curve) \(V\) nonsingular curve, \(\emptyset\ne U\subseteq V\) open, \(\phi\colon U \to W\) a regular map.%
\begin{equation*}
\xymatrix{
& V\\
U\ar[ur]\ar[dr] \ar[r] & U' \subseteq Z \subseteq V\times W \ni (v,w)\ar[d]_q \ar[u]_p \\
& W \ni w
}
\end{equation*}
\(U'\) is the image of \(U\), \(Z = \overline{U'}\). \(W \) is complete, \(Z\) closed implies \(p(Z) \subseteq V\) is closed. Also, \(U \subseteq p(Z) \implies p(Z)= V\).%
\begin{equation*}
U\xrightarrow{\sim} U' \to U
\end{equation*}
so%
\begin{equation*}
U' \xrightarrow{\sim} U
\end{equation*}
%
\begin{equation*}
Z \twoheadrightarrow V
\end{equation*}
this implies \(Z \xrightarrow\sim V\). Then \(q|_Z \colon Z \to W\) is the extension of \(\phi \) to \(V\).%
\end{proofptx}
\begin{theorem}{Milne 3.2.}{}{x:theorem:thm-milne-3-2}%
A rational map \(\phi\colon V\dashrightarrow A\) from a nonsingular variety \(V\) to an abelian variety \(W\), extends to all of \(V\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204354261136}
\hyperref[x:theorem:thm-milne-3-1]{Theorem~\ref{x:theorem:thm-milne-3-1}} \hyperref[x:lemma:lem-milne-3-3]{Lemma~\ref{x:lemma:lem-milne-3-3}}%
\end{proofptx}
\begin{lemma}{}{}{x:lemma:lem-milne-3-3}%
Let \(\phi\colon V \dashrightarrow G\) be a map from a nonsingular variety to a group variety. Then either \(\phi\) is defined on all of \(V\) or the set where \(\phi\) is not defined is closed of pure codimension 1.%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204354257376}
Fix \((U, \phi_U) \in \phi\) and consider%
\begin{equation*}
\Phi\colon V\times V \dashrightarrow G
\end{equation*}
represented by%
\begin{equation*}
U\times U\xrightarrow{\phi_U\times\phi_U} G\times G \xrightarrow{\id\times\operatorname{inv}} G\times G \xrightarrow{m} G
\end{equation*}
%
\begin{equation*}
(x,y) \mapsto \phi_U(x) \phi_U(y)^{-1}
\end{equation*}
Check \(\phi\) is defined at \(x\) iff \(\Phi\) is defined at \((x,x)\) (and in this case \(\Phi(x,x) = e\)). This is equivalent to the map \(\Phi^*\colon \sheaf O_{G,e} \to K(V\times V)\) induced by  \(\Phi\) satisfying   \(\im(\sheaf O_{G,e}) \subseteq \sheaf O_{V\times V, (x,x)}\) For a nonzero function \(f\) on \(V\times V\), write \(\divisor(f) = \divisor(f)_0 - \divisor(f)_\infty\) which are effective divisors. Then%
\begin{equation*}
\sheaf O_{V\times V, (x,x)} = \{0\} \cup \{f\in K(V\times V) : \divisor(f)_\infty \text{ does not contain }(x,x)\}\text{.}
\end{equation*}
Suppose \(\phi\) is not defined at \(x\), then there exists \(f\in \im(\sheaf O_{G,e})\) s.t. \((x,x) \in \divisor(f)_\infty\). Then \(\Phi\) is not defined at any \((y,y) \in \Delta \cap  \divisor(f)_\infty = \divisor(f^{-1})_0\), which is a pure codimension 1 subset of \(\Delta\) by Milne's AG thm 9.2. The corresponding subset in \(V\) is of pure codimension 1, and \(\phi\) is not defined there.%
\end{proofptx}
\begin{theorem}{Milne 3.4.}{}{x:theorem:thm-milne-3-4}%
Let \(\alpha \colon V \times W \to A\) be a morphism from a product of nonsingular varieties into an abelian variety. If \(\alpha (V\times\{w_0\}) = \{a_0 \} =  \alpha(\{v_0 \}\times W)\) for some \(a_0 \in A\), \(v_0\in V\), \(w_0 \in W\), then \(\alpha(V\times W) = \{a_0\}\).%
\end{theorem}
\begin{corollary}{Milne 3.7.}{}{x:corollary:cor-milne-3-7}%
Every rational map \(\alpha \colon G\dashrightarrow A\) from a group variety into an abelian variety is the composition of a homomorphism and a translation in \(A\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354240256}
Since group varieties are nonsingular, \(\alpha\colon G \to A\) is a regular map by \hyperref[x:theorem:thm-milne-3-2]{Theorem~\ref{x:theorem:thm-milne-3-2}}. The rest is as proof of Corollary 1.2.%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.4.2 Dominating and birational maps}
\typeout{************************************************}
%
\begin{subsectionptx}{Dominating and birational maps}{}{Dominating and birational maps}{}{}{g:subsection:idm204354238832}
\begin{definition}{Dominating maps.}{x:definition:def-dominating-maps}%
\(\phi\colon V \dashrightarrow W\) is \terminology{dominating} if \(\im (\phi_U)\) is dense in \(W\) for a representative \((U,\phi_U)\in \phi\).%
\end{definition}
Exercise: A dominating \(\phi\colon V\dashrightarrow W\) defines a homomorphism \(K(W) \to K(V)\) and any such homomorphism arises from a unique dominating rational map.%
\begin{definition}{}{x:definition:def-birational}%
\(\phi\colon V \dashrightarrow W\) is \terminology{birational} if the corresponding \(K(W)\to K(V)\) is an isomorphism or, equivalently if there exists \(\psi\colon W\dashrightarrow V \) s.t. \(\phi\circ \psi\) and \(\psi\circ\phi\) are the identity wherever they are defined. In this case we say \(V\) and \(W\) are \terminology{birationally equivalent}.%
\end{definition}
\begin{note}{}{g:note:idm204354229424}%
In general birational equivalence does not imply isomorphic. E.g. \(V\) a variety \(\emptyset \ne W\subsetneq V\) an open subset, or \(V= \aff^1, W \colon y^2 =x^3\).%
\end{note}
\begin{theorem}{Milne 3.8.}{}{x:theorem:prop-milne-3-8}%
If two abelian varieties are birationally equivalent then they are isomorphic as abelian varieties.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204354226496}
\(A,B\) abelian varieties with \(\phi \colon A\dashrightarrow B\) a birational map with inverse \(\psi\). Then by \hyperref[x:theorem:thm-milne-3-2]{Theorem~\ref{x:theorem:thm-milne-3-2}} \(\phi ,\psi\) extend to regular maps   \(\phi\colon A \to B \), \(\psi\colon B\to A\) and \(\phi\circ\psi,\psi\circ\phi\) are  the identity everywhere. This implies that \(\phi\) is an isomorphism of  algebraic varieties and after composition with a translation, \(\phi\) is also a group isomorphism.%
\end{proofptx}
\begin{proposition}{Milne 3.9.}{}{x:proposition:prop-milne-3-9}%
Any rational map \(\aff^1 \dashrightarrow A\) or \(\PP^1 \dashrightarrow A\), for \(A\) an abelian variety is constant.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354219360}
\hyperref[x:theorem:thm-milne-3-2]{Theorem~\ref{x:theorem:thm-milne-3-2}} implies \(\alpha \colon \aff^1 \dashrightarrow A\) extends to \(\alpha \colon \aff^1\to A\) and we may assume \(\alpha(0) = e\). \((\aff^1, +)\): \(\alpha(x+y) = \alpha(x) + \alpha(y)\) for all \(x,y\in \aff^1(K) = K\). \((\aff^1\smallsetminus\{0\}, \cdot)\): \(\alpha(xy) = \alpha(x) + \alpha(y) + c\) for all \(x,y\in K^\times\). These can only hold at the same time if \(\alpha\) is constant. \(\PP^1 \dashrightarrow A\) is constant, since its constant on affine patches.%
\end{proofptx}
\begin{definition}{}{x:definition:def-unirational}%
\(V/\overline K\) is \terminology{unirational} if there is a dominating map \(\aff^n \dashrightarrow V\), where \(n = \dim_{\overline K} V\). \(V/K\) is unirational if \(V/K\) is.%
\end{definition}
\begin{proposition}{Milne 3.10.}{}{x:proposition:prop-milne-3-10}%
Every rational map \(V\dashrightarrow A\) from \(V\) unirational to \(A\) abelian is constant.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354208096}
Wlog \(K = \overline K\). Since \(V\) is unirational we get \(\beta \colon \PP^1\times\cdots\times\PP^1 \dashrightarrow V\dashrightarrow A\), which extends to \(\beta \colon \PP^1\times\cdots\times\PP^1 \to A\). Then by Milne corollary 1.5, there exist regular maps \(\beta_i \colon \PP^1 \to A\) s.t. \(\beta(x_1,\ldots, x_n) = \sum \beta_i(x_i)\) and by \hyperref[x:proposition:prop-milne-3-9]{Proposition~\ref{x:proposition:prop-milne-3-9}} each \(\beta_i\) map is constant.%
\end{proofptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.5 Theorem of the Cube (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Theorem of the Cube (Ricky)}{}{Theorem of the Cube (Ricky)}{}{}{x:section:sec-thm-cube}
%
%
\typeout{************************************************}
\typeout{Subsection 1.5.1 Crash Course in Line Bundles}
\typeout{************************************************}
%
\begin{subsectionptx}{Crash Course in Line Bundles}{}{Crash Course in Line Bundles}{}{}{x:subsection:sec-crash-course-line-bundles}
Consider \(\RR^2\), \(f\colon \RR \to \RR\) , \(f(x,y) = x^2 + y^2 -1\), now \(S = \{f=0\}\subseteq \RR^2\) is a closed submanifold (in fact a circle). Question: Do all closed submanifolds arise in this way? Lets switch to \(\CC\) better analogies with AG.%
\begin{example}{}{g:example:idm204354200064}%
Let \(X\in \PP^n(\CC)\), the answer here is no! (Because \(f\colon X \to \CC^1\) is constant!) Want to define functions locally that give us level sets, but gluing such will give us a global section. Instead glue in a different way (i.e. into different ``copies'' of \(\CC\)) so that this doesn't happen.%
\end{example}
\begin{example}{}{g:example:idm204354197664}%
\(X\in \PP_\CC^1\), \(\sheaf O_X\) the structure sheaf.%
\begin{equation*}
X = U_0 \cup U_1 = (\aff^1,t) \cup(\aff^1,s)
\end{equation*}
on \(U_0\cap U_1\), \(t = s^{-1}\). What is a global section of \(\sheaf O_X\), a section of \(U_0\) and a section of \(U_1\) that glue. \(\sheaf O_X(U_0) =  k[t], \sheaf O_X(U_1) =  k[s]\) so given \(f(t), g(s)\) these glue to a global section iff \(f(t) = g(1/t)\) so \(f,g\) must be constant.%
\end{example}
\begin{definition}{Line bundles.}{x:definition:def-line-bundle}%
A \terminology{line bundle} on \(X\) is a locally free \(\sheaf O_X\)-module of rank 1, i.e. \(\exists \{U_i\}\) open cover along with isomorphisms \(\phi_i\colon \sheaf L|_{U_i} \xrightarrow\sim \sheaf O_X |_{U_i}\).%
\end{definition}
\begin{inlineexercise}{}{g:exercise:idm204354188912}%
Alternative definition: A line bundle on \(X\) is equivalent to the following data:%
\begin{itemize}[label=\textbullet]
\item{}An open cover of \(X\).%
\item{}Transition maps \(\tau_{ij} \in \GL_1(\sheaf O_X(U_i\cap U_j))\) satisfying \(\tau_{ij}\tau_{jk} =\tau_{ik}\) and \(\tau_{ii} = \id\).%
\end{itemize}
%
\end{inlineexercise}
\begin{example}{}{g:example:idm204354185552}%
On \(X = \PP^n_k\), we have line bundles \(\sheaf O(d)\) for all \(d\in \ZZ\). Just have to give cover and transition functions, use usual open cover \(\{U_i\}\) with \(U_i\cong \aff^n\). Then \(\tau_{ji}\) is given by multiplication by \((x_i/x_j)^d\).%
\end{example}
\begin{inlineexercise}{}{g:exercise:idm204354182048}%
%
\begin{equation*}
H^0(X,\sheaf O(d)) ( = \Gamma (X,\sheaf O(d)))
\end{equation*}
\(= k\)vector space spanned by deg. \(d\) homogeneous polynomials in \(k[x_0,\ldots, x_n]\).%
\end{inlineexercise}
\begin{inlineexercise}{}{g:exercise:idm204354180112}%
All line bundles on \(\PP^n\) are isomorphic to some \(\sheaf O(d)\).%
\end{inlineexercise}
We say a line bundle \(\sheaf L\) on \(X\) is trivial if \(\sheaf L \cong \sheaf O_X\). Given \(\sheaf L_1\) and \(\sheaf L_2\) on \(X\) (line bundles) we can create a new line bundle \(\sheaf L = \sheaf L_1 \otimes \sheaf L_2\). So isomorphism classes of line bundles on \(X\) with \(\otimes\) form a group, denoted \(\Pic(X)\) with identity \(\sheaf O_X\) and inverses \(\sheaf L^{-1} = \Hom(\sheaf L , \sheaf O_X)\).%
\begin{example}{}{g:example:idm204354173344}%
By previous exercise \(\Pic(\PP_k^n) \cong \ZZ\) since \(\sheaf O_X(d_1) \otimes \sheaf O_X(d_2)  \cong \sheaf O_X(d_1+d_2)\).%
\end{example}
\begin{fact}{}{}{g:fact:idm204354171872}%
If \(f\colon X \to Y\), then given \(\sheaf L\) on \(Y\) we can pullback to a line bundle \(f^* \sheaf L\) on \(X\), definition is complicated. We also know that \(f^*\) commutes with \(\otimes\) so in fact (as \(f^*\sheaf O_Y = \sheaf O_X\)) we get a homomorphism \(f^* \colon \Pic(Y) \to \Pic(X)\).%
\end{fact}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.5.2 Relation to (Weil) divisors}
\typeout{************************************************}
%
\begin{subsectionptx}{Relation to (Weil) divisors}{}{Relation to (Weil) divisors}{}{}{x:subsection:sec-reln-weil}
Let \(X\) be a normal variety, call \(Z\subseteq X\), a closed subvariety of codimension 1, a \terminology{prime divisor}. Then a divisor on \(X\) is a formal sum%
\begin{equation*}
D = \sum_{Z\subseteq X} n_Z\cdot Z
\end{equation*}
of prime divisors.%
\par
Let \(K = K(X)\) be the function field of \(X\). Given \(f\in K^\times\) we can define%
\begin{equation*}
\divisor (f) = \sum v_Z(f) \cdot Z\text{.}
\end{equation*}
%
\par
Given \(D \in \Div(X)\), we can define a line bundle \(\sheaf L(D)\) on \(X\) via%
\begin{equation*}
\sheaf L(D)(U) = \{f\in K^\times : (D + \divisor (f))|_U\ge 0 \} \cup \{0\}
\end{equation*}
where \(D|_U = \sum_{Z\cap U\ne \emptyset} n_Z\cdot (Z\cap U)\).%
\begin{proposition}{}{}{g:proposition:idm204354160032}%
The map%
\begin{equation*}
\Cl(X) = \Div(X)/\Princ(X) \xrightarrow{\sheaf L(\cdot)} \Pic(X)
\end{equation*}
is an isomorphism.%
\end{proposition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.5.3 Onto cubes}
\typeout{************************************************}
%
\begin{subsectionptx}{Onto cubes}{}{Onto cubes}{}{}{x:subsection:sec-onto-cubes}
\begin{theorem}{Theorem of the cube.}{}{x:theorem:thm-cube}%
Let \(U,V,W\) be complete varieties. If \(\sheaf L \) is a line bundle on \(U\times V\times W\) s.t. \(\sheaf L|_{\{u_0\}\times V\times W},\sheaf L|_{U\times \{v_0\}\times W}, \sheaf L|_{U\times V\times \{w_0\}}\) are all trivial then \(\sheaf L\) is trivial.%
\end{theorem}
\begin{corollary}{Milne 5.2.}{}{x:corollary:cor-5-2}%
Let \(A\) be an abelian variety. Let \(p_i\colon A\times A\times A \to A\) be the projection onto the \(i\)th coordinate. \(p_{ij} = p_i+p_j\), \(p_{123} = p_1+p_2+p_3\). Then for any \(\sheaf L\) on \(A\), the line bundle%
\begin{equation*}
\sheaf M  = p_{123}^*\sheaf L \otimes p_{12}^*\sheaf L^{-1}\otimes p_{23}^*\sheaf L^{-1}\otimes p_{13}^*\sheaf L^{-1} \otimes p_1^*\sheaf L \otimes p_2^*\sheaf L \otimes p_3^*\sheaf L
\end{equation*}
is trivial.%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354150240}
Let  \(m \colon A\times A \to A\) be multiplication (addition?) and \(p,q\) the projections \(A\times A \to A\). Then the composites of the maps \(\phi\colon A\times A \to A \times A \times A, \phi(x,y) = (x,y,0)\) with \(p_{123}, p_{12}, p_{23}, p_{13}, p_1, p_2, p_3\) are respectively \(m,m,q, p, p, q, 0\). Hence the restriction of \(\sheaf M\) to \(A \times A \times \{0\}\) is%
\begin{equation*}
m^* \sheaf L \otimes m^* \sheaf L^{-1} \otimes q^* \sheaf L^{-1} \otimes p^*\sheaf L^{-1} \otimes p^*\sheaf L \otimes q^*\sheaf L \otimes \sheaf O_{A\times A}
\end{equation*}
this is trivial by tensor commuting with pullback. Similarly \(\sheaf M\) restricts to a trivial bundle on \(A\times \{0\} \times A\) and \(\{0\}\times A \times A\). So by \hyperref[x:theorem:thm-cube]{theorem of the cube~\ref{x:theorem:thm-cube}} \(\sheaf M\) is trivial.%
\end{proofptx}
\begin{corollary}{Milne 5.3.}{}{x:corollary:cor-5-3}%
Let \(f,g, h\colon V \to A\) (\(A\) abelian). Then for any \(\sheaf L\) on \(A\) the bundle%
\begin{equation*}
\sheaf M  = (f+g+h)^*\sheaf L \otimes (f+g)^*\sheaf L^{-1}\otimes (f+h)^*\sheaf L^{-1}\otimes (g+h)^*\sheaf L^{-1} \otimes   f^*\sheaf L \otimes   g^*\sheaf L \otimes   h^*\sheaf L
\end{equation*}
is trivial.%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354139920}
\(\sheaf M\) is the pullback of the line bundle of \hyperref[x:corollary:cor-5-2]{Corollary~\ref{x:corollary:cor-5-2}} via the map \((f,g,h) \colon V \to A\times A\times A\).%
\end{proofptx}
On \(A\) we have \(n_A \colon A\to A\) be \(n_A(a) = a+\cdots + a\) (\(n\) times) for \(n\in \ZZ\).%
\begin{corollary}{Milne 5.4.}{}{x:corollary:cor-5-4}%
For \(\sheaf L\) on \(A\) we have%
\begin{equation*}
n^*_A\sheaf L \cong \sheaf L^{(n^2 + n)/2} \otimes (-1)_A^* \sheaf L^{(n^2 - n)/2}
\end{equation*}
In particular if \((-1)^* \sheaf L = \sheaf L\) (symmetric) then \(n_A^* \sheaf L = \sheaf L^{n^2}\). And if \((-1)^* \sheaf L = \sheaf L^{-1}\) (antisymmetric) then \(n_A^* \sheaf L = \sheaf L^{n}\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354131792}
Use \hyperref[x:corollary:cor-5-3]{Corollary~\ref{x:corollary:cor-5-3}} with \(f= n_A, g = 1_A, h = (-1)_A\). So the line bundle%
\begin{equation*}
(n)^*\sheaf L \otimes (n+1)^*\sheaf L^{-1}\otimes (n-1)^*\sheaf L^{-1}\otimes (1-1)^*\sheaf L^{-1} \otimes   n^*\sheaf L \otimes   1^*\sheaf L \otimes   (-1)^*\sheaf L
\end{equation*}
is trivial i.e.%
\begin{equation*}
(n+1)^*\sheaf L =  (n-1)^*\sheaf L^{-1}\otimes n^*\sheaf L^2 \otimes   \sheaf L \otimes   (-1)^*\sheaf L
\end{equation*}
in statement \(n = 1\) is clear, so use \(n=1\) in the above to get%
\begin{equation*}
2_A^*\sheaf L \cong \sheaf L^2 \otimes \sheaf L \otimes (-1)^*_A \sheaf L\cong \sheaf L^3 \otimes (-1)_A^*\sheaf  L\text{.}
\end{equation*}
Then induct on \(n\) in above.%
\end{proofptx}
\begin{theorem}{Theorem of the square (Milne 5.5).}{}{x:theorem:thm-square}%
Let \(\sheaf L\) be an invertible sheaf (line bundle) on \(A\). Let \(t_a \colon A\to A\) be translation by \(a\in A(k)\). Then%
\begin{equation*}
t_{a+b}^*\sheaf L \otimes \sheaf L \cong t_a^*\sheaf L \otimes t_b^* \sheaf L\text{.}
\end{equation*}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204354124192}
Use \hyperref[x:corollary:cor-5-3]{Corollary~\ref{x:corollary:cor-5-3}} with \(f=  \id\), \(g(x)  = a, h(x) = b\) to get%
\begin{equation*}
t_{a+b}^*\sheaf L \otimes t_{a}^*\sheaf L ^{-1}\otimes t_b^* \sheaf L ^{-1} \otimes \sheaf L
\end{equation*}
is trivial.%
\end{proofptx}
\begin{remark}{}{g:remark:idm204354121952}%
Tensor by \(\sheaf L^{-2}\) in the above equation to get%
\begin{equation*}
t_{a+b}^*\sheaf L \otimes\sheaf L^{-1} \cong ( t_{a}^*\sheaf L \otimes \sheaf L^{-1}) \otimes(t_b^* \sheaf L\otimes \sheaf L^{-1})\text{.}
\end{equation*}
This gives a group homomorphism%
\begin{equation*}
A(k) \to \Pic(A)
\end{equation*}
via%
\begin{equation*}
a\mapsto t_a^*\sheaf L \otimes \sheaf L^{-1}
\end{equation*}
for any \(\sheaf L \in \Pic(A)\).%
\end{remark}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.6 The Adventures of BUNTES (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{The Adventures of BUNTES (Sachi)}{}{The Adventures of BUNTES (Sachi)}{}{}{x:section:sec-adventures-buntes}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.1 In which we are introduced to an important homomorphism, review some concepts and our story begins}
\typeout{************************************************}
%
\begin{subsectionptx}{In which we are introduced to an important homomorphism, review some concepts and our story begins}{}{In which we are introduced to an important homomorphism, review some concepts and our story begins}{}{}{g:subsection:idm204354118432}
Abelian variety  \(X\), we know this is a complete group variety, our goal is to give an embedding \(X\to \PP^N\) for some \(N\). This motivates the study of line bundles.%
\par
Last time Ricky proved theorem of \hyperref[x:theorem:thm-cube]{cube~\ref{x:theorem:thm-cube}} and \hyperref[x:theorem:thm-square]{square~\ref{x:theorem:thm-square}}. For any line bundle  \(L\) on \(X\), there is a group homomorphism \(\Phi_L\colon X \to \Pic(X)\) via \(x\mapsto T_x^* L\otimes L^{-1}\). Be careful \(T_x^*\) is \(-x\), convention, who knows why.%
\begin{example}{}{g:example:idm204354112208}%
Let \(X =E\) an elliptic curve, \(L = L((0))\), \(x\mapsto (x) - (0)\), in this case this is in \(\Pic^0(E) \cong E \cong \widehat E\),%
\end{example}
\begin{proposition}{}{}{g:proposition:idm204354109968}%
This is translation invariant.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354109424}
Translate by \(q\in E\). \((x+q) - (q)\) take \(p\) to be the third point on the line with \(x,q\), \((x) + (q) + (p) \cong 3(0)\) and \((x+q) + (p) \cong 2 (0)\) subtracting these gives \((x) - (x+q) +(q) \cong (0)\) or \((x) - (0) \cong (x+q) -(q)\).%
\end{proofptx}
What about the converse of this, what can we say about translation invariant line bundles%
\begin{equation*}
K(L) = \{x\in X : T_x^* L \cong L\}\text{?}
\end{equation*}
%
\begin{proposition}{}{}{g:proposition:idm204354104880}%
\(K(L)\) is Zariski closed in \(X\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354103680}
Consider \(m^* L \otimes p_2^*L^{-1}\) on \(X\times X\), then%
\begin{equation*}
\{x : \text{this is trivial on }\{x\}\times X\}
\end{equation*}
is closed. \hyperref[x:theorem:thm-see-saw]{See-saw~\ref{x:theorem:thm-see-saw}} implies restriction is pullback%
\begin{equation*}
T_x^*L \otimes L^{-1}
\end{equation*}
so this is \(K(L)\).%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.2 In which Pooh discovers our main theorem}
\typeout{************************************************}
%
\begin{subsectionptx}{In which Pooh discovers our main theorem}{}{In which Pooh discovers our main theorem}{}{}{g:subsection:idm204354100464}
\begin{proposition}{}{}{g:proposition:idm204354100032}%
Let \(X\) be an abelian variety and \(L\) a line bundle, \(L = L(D)\) then TFAE:%
\begin{enumerate}
\item{}\(H(D) = \{x\in X: T_x^*D  = D \}\) is finite.%
\item{}\(K(L) = \{x\in X: T_x^*L  \cong L \}\) is finite.%
\item{}\(|2D|\) is basepoint free and defines a finite morphism \(X\to \PP^N\).%
\item{}\(L\) is ample.%
\end{enumerate}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354095472}
\begin{case}{}{3. to 4..}{g:case:idm204354095344}
Is algebraic geometry.%
\end{case}
\begin{case}{}{2. to 1..}{g:case:idm204354094656}
Follows as being equal is stronger than being linearly equivalent.%
\end{case}
\begin{case}{}{4. to 2..}{g:case:idm204354093920}
\hyperref[x:subsection:sec-ample-L-finite-KL]{Section~\ref{x:subsection:sec-ample-L-finite-KL}}%
\end{case}
\begin{case}{}{3. to 4..}{g:case:idm204354092864}
\hyperref[x:subsection:sec-finite-HD-finite-PN]{Section~\ref{x:subsection:sec-finite-HD-finite-PN}}%
\end{case}
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.3 In which Owl proves the ampleness of \(L\) implies finiteness of \(K(L)\)}
\typeout{************************************************}
%
\begin{subsectionptx}{In which Owl proves the ampleness of \(L\) implies finiteness of \(K(L)\)}{}{In which Owl proves the ampleness of \(L\) implies finiteness of \(K(L)\)}{}{}{x:subsection:sec-ample-L-finite-KL}
4. to 2. Assume \(L\) ample and \(K(L)\) is infinite. Let \(Y\) be the connected component at 0 of \(K(L)\), \(\dim Y \gt 0\). Show trivial bundle is ample on \(Y\) implies \(Y\) is affine, But \(Y\) is closed and therefore complete so this is a contradiction. \(L|_Y\) ample \(\lb-1\rb^* L|_Y\) is ample. \(L|_Y\otimes \lb -1\rb^*L|_Y\) is ample, consider%
\begin{align*}
d\colon \amp Y \to Y\times Y\\
\amp y\mapsto (y,-y)
\end{align*}
\(m\circ d = \) constant, \(d^*m^* (L) = \sheaf O_Y\), LHS is \(L|_Y \otimes [-1]^* L|_Y\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.4 In which Rabbbit sets out on a long journey to prove finiteness of \(H(D)\) implies \(|2D|\) is basepoint free and gives a finite map \(X \to \PP^N\)}
\typeout{************************************************}
%
\begin{subsectionptx}{In which Rabbbit sets out on a long journey to prove finiteness of \(H(D)\) implies \(|2D|\) is basepoint free and gives a finite map \(X \to \PP^N\)}{}{In which Rabbbit sets out on a long journey to prove finiteness of \(H(D)\) implies \(|2D|\) is basepoint free and gives a finite map \(X \to \PP^N\)}{}{}{x:subsection:sec-finite-HD-finite-PN}
\begin{note}{}{g:note:idm204354081440}%
\(|2D|\) is always basepoint free.%
\end{note}
Apply the \hyperref[x:theorem:thm-square]{theorem of the square~\ref{x:theorem:thm-square}}: \(T_{x+y}^*D + D \cong T_x^* D + T_y^*D\), let \(y = -x\), \(2D \cong T_x^* D + T_{-x}^*D\). (\(D\) effective) For any \(y\in X\), choose some \(x\) s.t. RHS doesn't contain \(y\). \(E = 2D\)%
\begin{equation*}
\psi_E\colon X \to \PP^N
\end{equation*}
can we make this finite? If \(\psi_E\) is not finite then \(\psi(C) = \text{pt}\) for some irreducible curve \(C\) (Zariski's main theorem). For each divisor in \(|E|\) either it contains \(C\) or fails to intersect \(C\) by changing \(E\) if necessary, assume \(E \cap C = \emptyset\).%
\begin{claim}{}{}{g:claim:idm204354072832}%
\(T_x^*E\cap C= \emptyset\) or all of \(C\) for all \(x\in X\).%
\end{claim}
\begin{proofptx}{}{g:proof:idm204354071216}
Intersection numbers are constant.%
\end{proofptx}
\begin{proofptx}{}{g:proof:idm204354070784}
\(\sheaf O(T_x^*E)|_{\widetilde C}\), when \(x=0\) this is trivial so \(\deg =0\). So \(\deg = 0\) for all line bundles. \(E\) effective implies \(C\cap T_x^* E = \emptyset\) for all \(x\) s.t. \(\cap\) is not in \(C\).%
\end{proofptx}
\begin{claim}{}{}{g:claim:idm204354066736}%
\(E\) is invariant by translation by \(x - y\) for \(x,y \in C\).%
\end{claim}
\begin{proofptx}{}{g:proof:idm204354065104}
If \(e \in E\), \(T_{x-e}^*(E) \cap C \ne \emptyset\). This is as \(x\) is in it, \(x-(x-e) =e\), because it is nonempty it's all of \(C\). So \(y\) is in it. So \(y- (x-e) \in E\). This is also \(e - (x-y) \in E\), so \(E\) is invariant under \(T^*_{x-y}\)%
\end{proofptx}
Now assume \(H(E) = \{x\in X: T_x^*E  = E \}\) is finite. But if \(\psi_E(C) = \text{pt}\) then \(T_{x-y}^*(E)  = E\) for all \(x,y\in C\). So \(H\) is not finite, a contradiction. So \(\psi_E\) can't collapse a curve so \(\psi_E\) is finite.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.5 In which Piglet discovers a corollary}
\typeout{************************************************}
%
\begin{subsectionptx}{In which Piglet discovers a corollary}{}{In which Piglet discovers a corollary}{}{}{g:subsection:idm204354057424}
\begin{corollary}{}{}{g:corollary:idm204354056992}%
Abelian varieties are projective.%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354056432}
Let \(X\) be an abelian variety, \(U \subseteq X\) be an open affine set, \(0\in U\), \(X\smallsetminus U = D_1 \cup \cdots \cup D_t\) irreducible divisors. Let \(D = \sum D_i\), then claim: \(H(D) = \{x\in X: T_x^*D  = D \}\) is finite. If \(H\subseteq U\), \(U\) affine, then \(H\) closed subvariety of an abelian variety, hence complete, so its finite. If \(x\in H\) then \(-x \in H\). Now claim that if \(x\in H\) then \(T_x^*\) preserves \(U\), if not let \(u\in U\). Suppose \(u-x = d\) for some \(d\in D\) then \(u = d+x\) which is \(d\) translated by \(-x\) so \(d+x \in D\) so \(u\in D\). But contradiction, oh no! So \(T_x^*\) preserves \(U\), for all \(x\in H\), as \(0 \in U\), for all \(x\in H\) we have \(0-x \in U\) and  \(0+x\in U\) so \(H\subseteq U\).%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204354043520}%
Abelian varieties are divisible. \(X[n]\) is finite for \(n\ge 1\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354042144}
\([n]\colon X \to X\) and \(X[n]\) is the kernel of this. Note that for \(x\in X[n]\)%
\begin{equation*}
[n]\circ T_x = [n]
\end{equation*}
\(y\in X\), then \(n(y-x) = ny - nx = ny\) so for all \(L \in \Pic X\)%
\begin{equation*}
T_x^*([n]^* L ) \cong ([n]^* L)
\end{equation*}
which implies%
\begin{equation*}
K([n]^* L ) \supseteq X[n]
\end{equation*}
and we just need to find \(L\) s.t. this is finite. \(X\) projective implies there exists an ample \(L\). The \hyperref[x:theorem:thm-cube]{theorem of the cube~\ref{x:theorem:thm-cube}} implies%
\begin{equation*}
[n]^*L \cong L^{\frac{n^2 + n}{2}} \otimes L^{\frac{n^2 - n}{2}}
\end{equation*}
where both terms on the right are ample, hence the left is also.%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.6 Epilogue: In which we might discuss isogenies}
\typeout{************************************************}
%
\begin{subsectionptx}{Epilogue: In which we might discuss isogenies}{}{Epilogue: In which we might discuss isogenies}{}{}{g:subsection:idm204354035984}
\begin{definition}{}{g:definition:idm204354035552}%
\(f\colon X \to Y\) a morphism of varieties, get a field extension \(k(X)/f^*k(Y)\), if \(\dim X = \dim Y\) and \(f\) is surjective. Then this is a finite field extension and \(\deg f\) is \(d = \lb k(X) : f^*k(Y)\rb\) and \(d = \#f^{-1}(y)\) for almost all \(y\).%
\end{definition}
\begin{definition}{}{x:definition:def-isogenies-avs}%
A homomorphism of abelian varieties \(f\colon X \to Y\) is an \terminology{isogeny} if \(f\) is surjective with finite kernel.%
\end{definition}
\begin{corollary}{}{}{g:corollary:idm204354029568}%
Degree of \(\lb n\rb\) is \(n^{2g}\), if \(n\) is prime to the characteristic of \(k\), \(k = \overline k\), \(g = \dim X\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204354026592}
Let \(D\) be an ample symmetric divisor, e.g.%
\begin{equation*}
D = D' + [-1]^* D'
\end{equation*}
know \(\lb n \rb^* D \sim n^2 D\)%
\begin{equation*}
\deg([n]^*(D\cdot\ldots\cdot D)) = ([n]^*D\cdot \ldots\cdot [n]^*D) = (n^2 D\cdot\ldots\cdot n^2 D)= n^{2g} (D\cdot \ldots\cdot D)\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.7 Line Bundles and the Dual Abelian Variety (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Line Bundles and the Dual Abelian Variety (Angus)}{}{Line Bundles and the Dual Abelian Variety (Angus)}{}{}{x:section:sec-dual-ab}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.1 Introduction}
\typeout{************************************************}
%
\begin{subsectionptx}{Introduction}{}{Introduction}{}{}{g:subsection:idm204354023744}
\begin{paragraphs}{Meta-goal.}{g:paragraphs:idm204354023360}%
Understand line bundles on abelian varieties.%
\end{paragraphs}%
\begin{paragraphs}{Setup.}{g:paragraphs:idm204354022656}%
\(A\) an abelian variety \(/k\).%
\end{paragraphs}%
\begin{paragraphs}{Last time.}{g:paragraphs:idm204354021328}%
For \(L\) a line bundle on \(A\) we get a map%
\begin{align*}
\phi_L\colon A(K) \amp\to \Pic(A)\\
a\amp\mapsto t_a^* L\otimes L^{-1}
\end{align*}
where%
\begin{equation*}
\Pic(A) = \{\text{line bundles on } A\}/\sim\text{.}
\end{equation*}
This a is a group homomorphism (by the \hyperref[x:theorem:thm-square]{theorem of the square~\ref{x:theorem:thm-square}}). We define%
\begin{equation*}
K(L)(k) = \ker(\phi_L) = \{a\in A(k) : t_a^* L \simeq L\}\text{.}
\end{equation*}
%
\end{paragraphs}%
\begin{paragraphs}{Today.}{g:paragraphs:idm204354017360}%
We are going to package these into a big map%
\begin{align*}
\phi\colon \Pic(A)\amp\to \Hom(A(k), \Pic(A))\\
L \amp\mapsto \phi_L\text{.}
\end{align*}
%
\begin{proposition}{}{}{g:proposition:idm204354015808}%
%
\begin{enumerate}
\item{}\(\phi\) is a group homomorphism%
\item{}%
\begin{equation*}
\phi_{t_a^* L}  = \phi_L
\end{equation*}
%
\end{enumerate}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354014320}
\begin{case}{}{1.}{g:case:idm204354014192}
%
\begin{align*}
\phi_{L\otimes M}(a) \amp = t_a^*(L\otimes M) \otimes(L\otimes M)^{-1}\\
\amp = t_a^*L\otimes L^{-1} t_a^*M\otimes M^{-1}\\
\amp = \phi_L\otimes \phi_M
\end{align*}
%
\end{case}
\begin{case}{}{2.}{g:case:idm204354012528}
%
\begin{align*}
\phi_{t_b^*L}(a) \amp = t_a^*(t_b^*L) \otimes(t_b^*L)^{-1}\\
\amp = t_{a+b}^*L \otimes(t_b^*L)^{-1}\\
\amp = t_{a}^*L \otimes t_b^*L \otimes L^{-1} \otimes (t_b^*L)^{-1}\\
\amp = \phi_L(a)
\end{align*}
by  the \hyperref[x:theorem:thm-square]{theorem of the square~\ref{x:theorem:thm-square}}%
\end{case}
\end{proofptx}
\begin{definition}{}{g:definition:idm204354009920}%
%
\begin{align*}
\Pic^0(A) \amp = \ker(\phi)\\
\amp = \{ L \in \Pic(A) : \phi_L = 0\}\\
\amp = \{ L \in \Pic(A) : t_a^* L\simeq L \ \forall a\in A(k)\}\\
\amp = \{\text{translation invariant line bundles}\}/\sim
\end{align*}
%
\end{definition}
\end{paragraphs}%
\begin{paragraphs}{Goals.}{g:paragraphs:idm204354008176}%
Study \(\Pic^0(A)\), give it an abelian variety structure, solve a moduli problem, demonstrate some duality.%
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.2 Aside: alternate description of \(\Pic^0(A)\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Aside: alternate description of \(\Pic^0(A)\)}{}{Aside: alternate description of \(\Pic^0(A)\)}{}{}{g:subsection:idm204354007008}
\begin{definition}{Algebraic Equivalence.}{x:definition:def-alg-equivalence}%
Two line bundles \(L_1,L_2\)  on an abelian variety are \terminology{algebraically equivalent} if there exists a variety \(Y\) with line bundle \(L\) on \(A\times Y\) and points \(y_1y_2 \in Y\) s.t. \(L|_{A\times\{y_1\}} \simeq L_1, L|_{A\times\{y_2\}} \simeq L_2\).%
\end{definition}
\begin{remark}{}{g:remark:idm204354002128}%
This looks like homotopy.%
\end{remark}
\begin{proposition}{}{}{g:proposition:idm204354001712}%
%
\begin{equation*}
\Pic^0(A) = \{\text{line bundles which are alg. equiv to } \sheaf O_A\}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204354000992}
\hyperlink{x:biblio:bib-polishchuck}{[81]}.%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.3 See-Saws}
\typeout{************************************************}
%
\begin{subsectionptx}{See-Saws}{}{See-Saws}{}{}{g:subsection:idm204354000240}
\begin{theorem}{See-saw theorem.}{}{x:theorem:thm-see-saw}%
Let \(X,T\) be varieties      \(X\) complete, let \(L\) be a line bundle  on \(X\times T\), let \(T_1 = \{t\in T : L|_{X\times\{t\}} \text{ is trivial}\}\) then \(T_1\) is closed in \(T\). Further let \(p_2\colon X\times T_1 \to T_1\), then \(L|_{X\times T_1} \cong p^*_2 M\) for some line bundle \(M\) on \(T_1\).%
\end{theorem}
\begin{remark}{}{g:remark:idm204353994096}%
In fact \(M = p_{2*}L\).%
\end{remark}
\begin{corollary}{that no one states\slash{}only Milne.}{}{g:corollary:idm204353993296}%
Let X, T be as above and let \(L, M\) be line bundles on \(X\times T\) s.t.%
\begin{equation*}
L|_{X\times \{t\}} \cong M|_{X\times \{t\}} \forall t\in T
\end{equation*}
%
\begin{equation*}
L|_{\{t\}\times X} \cong M|_{\{t\}\times X} \text{ for some } x\in X
\end{equation*}
then \(L\cong M\).%
\end{corollary}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.4 Properties of \(\Pic^0 A\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Properties of \(\Pic^0 A\)}{}{Properties of \(\Pic^0 A\)}{}{}{g:subsection:idm204353990416}
\begin{lemma}{}{}{g:lemma:idm204353989744}%
\(L\in \Pic^0(A)\) and \(m,p_1,p_2\colon A\times A \to A\)%
\begin{enumerate}
\item{}%
\begin{equation*}
m^* L \cong p_1^* L\otimes p_2^* L
\end{equation*}
%
\item{}Given \(f,g \colon X \to A\)%
\begin{equation*}
(f+g)^* L \cong f^* L \otimes g^* L
\end{equation*}
%
\item{}%
\begin{equation*}
[n]^* L \cong L^{\otimes n}
\end{equation*}
%
\item{}%
\begin{equation*}
\phi_L(A(k)) \subseteq \Pic^0(A)
\end{equation*}
for \(L \in \Pic (A)\).%
\end{enumerate}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204353985840}
\begin{case}{}{1.}{g:case:idm204353985712}
%
\begin{equation*}
(m^*L\otimes (p_1^*l)^{-1} \otimes (p_2^*l)^{-1})|_{A\times\{a\}} = t_a^*L \otimes L^{-1} = \sheaf O_A
\end{equation*}
%
\begin{equation*}
(m^*L\otimes (p_1^*l)^{-1} \otimes (p_2^*l)^{-1})|_{\{a\}\times A} = t_a^*L \otimes L^{-1} = \sheaf O_A
\end{equation*}
by \hyperref[x:theorem:thm-see-saw]{see-saw~\ref{x:theorem:thm-see-saw}} whole thing is trivial on \(A\times A\).%
\end{case}
\begin{case}{}{2.}{g:case:idm204353983264}
%
\begin{equation*}
(f+g)^*L\cong (f\times g)^* m^*L \cong (f\times g)^*(p_1^*L \otimes p_2^*L) \cong f^*L \otimes g^*L
\end{equation*}
%
\end{case}
\begin{case}{}{3.}{g:case:idm204353982384}
Induction of 3.%
\end{case}
\begin{case}{}{4.}{g:case:idm204353981696}
%
\begin{equation*}
\phi_{\phi_L(a)} = \phi_{t^*_a L}\otimes L^{-1} = \phi _{t_a^*L}\otimes L^{-1} = \phi_L \otimes \phi_{L^{-1}} = 0\qedhere
\end{equation*}
%
\end{case}
\end{proofptx}
\begin{proposition}{}{}{g:proposition:idm204353980800}%
If \(L\) is nontrivial in \(\Pic^0(A)\) then \(H^i(A,L) = 0\) \(\forall i\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204353978656}
If \(H^0(A,L) \ne 0\), we would have  a nontrivial section \(s\) of \(L\) then \(\lb -1\rb ^* s\) is   a nontrivial section of \(\lb-1\rb^* L = L^{-1}\). But if both \(L\) and \(L^{-1}\) have  a nontrivial section then \(L \cong \sheaf O_A\). So since \(L\) is nontrivial \(H^0(A,L) = 0\). Now assume \(H^i(A,L) = 0\) for all \(i\lt j\). Consider%
\begin{gather*}
A\xrightarrow{\id \times 0} A\times A \xrightarrow m A\\
a\mapsto (a,0)\mapsto a
\end{gather*}
this gives%
\begin{equation*}
H^j(A, L) \to H^j(A\times A, m^*L) \to H^j(A,L)
\end{equation*}
which composes to the identity.%
\begin{equation*}
H^j(A\times A, m^*L) =  H^j(A\times A, p_1^*L \otimes p_2^*L) = \bigoplus_{i=0}^j H^i(A,L) \otimes H^{j-i}(A,L)
\end{equation*}
by Künneth. The RHS is 0 by the inductive hypothesis. So the identity on \(H^j(A,L)\) factors through 0, hence the group is 0.%
\end{proofptx}
We now think of \(\phi_L\) as a map \(\phi_L \colon A(k) \to \Pic^0(A)\) with kernel \(K(L) (k)\).%
\begin{theorem}{}{}{g:theorem:idm204353969232}%
If \(K(L)(k)\) is finite then \(\phi_L\) is surjective.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204353967872}
Idea is to study%
\begin{equation*}
\Lambda (L) =  m^* L \otimes (p_1^* L)^{-1} \otimes (p_2^* L)^{-1}\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
Given an ample line bundle \(L\) on \(A\) we now have an isomophism of groups%
\begin{equation*}
A(k)/K(L)(k) \cong \Pic^0(A)
\end{equation*}
the LHS allows us to put an abelian variety structure on \(\Pic^0(A)\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.5 The Dual Abelian Variety}
\typeout{************************************************}
%
\begin{subsectionptx}{The Dual Abelian Variety}{}{The Dual Abelian Variety}{}{}{g:subsection:idm204353964992}
\begin{theorem}{}{}{g:theorem:idm204353964576}%
Let \(A\) be an abelian variety and \(L\) an ample line bundle on \(A\), then the quotient scheme \(A/K(L)\) exists and is an abelian variety of the same dimension as \(A\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204353961952}
(Sketch) (characteristic 0) Cover \(A\) by affine opens \(U_i = \Spec R_i\) such that for all \(a \in A\) the orbit \(K(L)a \subseteq U_i\) for some \(i\). We can do this because abelian varieties are projective. Then we say \(U_i / K(L) = \Spec(R^{K(L)}_i)\) then glue. (details in Mumford, II sec, 6  appendix). Since we are in characteristic 0, the quotient scheme is in fact a variety.%
\end{proofptx}
\begin{definition}{Dual abelian varieties.}{x:definition:def-dual-abvar}%
The \terminology{dual abelian variety} is%
\begin{equation*}
\hat A = A/K(L)\text{.}
\end{equation*}
%
\end{definition}
\begin{remark}{}{g:remark:idm204353956832}%
%
\begin{itemize}[label=\textbullet]
\item{}%
\begin{equation*}
\hat A(K) = \Pic^0(A)
\end{equation*}
%
\item{}We have an isogeny%
\begin{equation*}
\phi_L\colon A \to \hat A\text{.}
\end{equation*}
%
\end{itemize}
%
\end{remark}
\begin{theorem}{}{}{x:theorem:thm-poincare-bundle}%
There is a unique line bundle \(\sheaf P\) on \(A\times \hat A\) called the \terminology{Poincaré bundle} such that%
\begin{enumerate}
\item{}%
\begin{equation*}
\sheaf P|_{A\times \{x\}} \in \Pic^0(A) \text{ for all }x\in \hat A
\end{equation*}
%
\item{}%
\begin{equation*}
\sheaf P|_{0\times \hat A} = 0
\end{equation*}
%
\item{}If \(Z\) is a  scheme with a line bundle \(R\) on \(A\times Z\) satisfying 1., 2., there exists a unique%
\begin{equation*}
f\colon Z\to \hat A
\end{equation*}
s.t.%
\begin{equation*}
(\id\times f)^* \sheaf P = R\text{.}
\end{equation*}
%
\end{enumerate}
That is \((\hat A, \sheaf P)\)  represents the functor%
\begin{equation*}
Z \mapsto \left\{ L\in \Pic (A\times Z) : \substack{ L|_{A\times \{z\}} \in \Pic^0(A) \forall z\in Z \\L|_{ 0 \times Z } = 0}\right\}/\sim\text{.}
\end{equation*}
%
\end{theorem}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.6 Dual morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Dual morphisms}{}{Dual morphisms}{}{}{g:subsection:idm204353948656}
Let \(f\colon A\to B\) be a homomorphism of abelian varieties. Let \(\sheaf P_A,\sheaf P_B\) be the Poincaré bundles on  \(A\) and \(B\). Consider \(M=    (F\times \id_{\hat B})^* \sheaf P_B\) on \(A\times \hat B\), then%
\begin{enumerate}
\item{}%
\begin{equation*}
M|_{A\times \{x\}} \in \Pic^0(A)
\end{equation*}
%
\item{}%
\begin{equation*}
M|_{\{0\} \times \hat B} = 0
\end{equation*}
%
\end{enumerate}
thus by the universal property we get a unique morphism%
\begin{equation*}
\hat f\colon \hat B \to \hat A
\end{equation*}
satisfying%
\begin{equation*}
(\id_A\times \hat f)^* \sheaf P_A = (f\times \id_{\hat B})^*\sheaf P_B\text{.}
\end{equation*}
%
\begin{definition}{Dual morphisms.}{x:definition:def-dual-morp-abvar}%
\(\hat f\) as above is called the \terminology{dual morphism}.%
\end{definition}
\begin{remark}{}{g:remark:idm204353941424}%
%
\begin{itemize}[label=\textbullet]
\item{}%
\begin{equation*}
\hat f\colon \hat B = \Pic^0(B) \to \hat A(k) = \Pic^0(A)
\end{equation*}
%
\begin{equation*}
L\mapsto f^*L
\end{equation*}
%
\item{}%
\begin{equation*}
\hat{\lb n_A\rb} = [n_{\hat A}]
\end{equation*}
%
\end{itemize}
%
\end{remark}
Consider the Poincaré bundle \(\sheaf P_{\hat A}\) on \(\hat A \times \hat{\hat{A}}\), now think of \(\sheaf P_A\) as living on \(\hat A \times A\). By the universal property of \(\sheaf P_{\hat A}\) get a unique morphism%
\begin{equation*}
\operatorname{can}_A\colon A\to\hat{\hat A}\text{.}
\end{equation*}
%
\begin{theorem}{}{}{g:theorem:idm204353936992}%
\(\operatorname{can}_A\) is an isomorphism.%
\end{theorem}
\begin{lemma}{}{}{g:lemma:idm204353936160}%
%
\begin{equation*}
\phi_{f^*L} = \hat f\circ \phi_L\circ f\text{.}
\end{equation*}
%
\end{lemma}
\begin{proposition}{}{}{g:proposition:idm204353935344}%
If \(f\colon A \to B\) is an isogeny, then \(\hat f\colon \hat B \to \hat A\) is an isogeny. Further if \(N  = \ker f\), then \(\hat N = \ker \hat f\) is the Cartier  dual of \(N\).%
\end{proposition}
\begin{definition}{Symmetric morphisms, (principal) polarizations.}{x:definition:def-princ-pol}%
A morphism \(f\colon A \to \hat A\) is \terminology{symmetric} if \(f = \hat f\circ \operatorname{can}_A\)%
\par
A \terminology{polarization} is a symmetric isogeny \(f\colon A \to \hat A\) s.t. \(f=  \phi_L\) for some ample line bundle \(L\) on \(A\).%
\par
A \terminology{principal polarization} is a polarization of degree 1, i.e. an isomorphism.%
\end{definition}
\begin{remark}{}{g:remark:idm204353927312}%
Elliptic curves always admit principal polarization.%
\par
If one wishes to mimic the theory of elliptic curves, one should study principally polarized abelian varieties.%
\end{remark}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.8 Endomorphisms and the Tate module (Berke)}
\typeout{************************************************}
%
\begin{sectionptx}{Endomorphisms and the Tate module (Berke)}{}{Endomorphisms and the Tate module (Berke)}{}{}{x:section:sec-endomorphisms}
\begin{introduction}{Motivation.}%
%
\begin{align*}
f \colon \PP^n\subseteq V_1 \amp\to V_2 \subseteq \PP^m,\,V_i = V(I_i)\\
P\amp \mapsto \cdots
\end{align*}
%
\begin{equation*}
f = \lb f_1 : \cdots : f_m\rb ,\,f_i\in \overline K (V_1)
\end{equation*}
this feels quite restrictive, an isogeny is even more so, rational, regular, homomorphism, surjective, finite kernel. It feels like there won't be too many but we have multiplication by \(n\) etc. so we should ask how many are there that will surprise us? I.e. what is%
\begin{equation*}
\rank_\ZZ \Hom(A,B) = ?
\end{equation*}
%
\par
Notation: \(A,B,C , A_i,  B_i\) are all abelian varieties. \(l \ne \characteristic k\), \(\sim\) is isogeny.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.8.1 Poincaré's complete reducibility theorem}
\typeout{************************************************}
%
\begin{subsectionptx}{Poincaré's complete reducibility theorem}{}{Poincaré's complete reducibility theorem}{}{}{g:subsection:idm204353921504}
\begin{theorem}{Poincaré's complete reducibility theorem.}{}{x:theorem:thm-poincare-reducibility}%
Let \(B\subseteq A\) then there is \(C\subseteq A\) s.t. \(B \cap C\) is finite and \(B+C = A\). I.e. \(B\times C \to A,\,(b,c) \mapsto b+c\) is an isogeny.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204353917696}
Choose \(\sheaf L\) ample on \(A\)%
\begin{equation*}
\xymatrix{
B\ar[r]^i \ar[d]_{\phi_{i*\sheaf L}} & A \ar[d]_\sim^{\phi_{\sheaf L}} \\
\hat B & \hat A \ar[l]_{\hat i}
}
\end{equation*}
\(C\) is defined to be the connected component of \(\phi^{-1}_{\sheaf L}(\ker \hat i)\) in \(A\)%
\begin{equation*}
\dim C = \dim \ker \hat i \ge \dim \hat A - \dim \hat B = \dim A - \dim B\text{.}
\end{equation*}
%
\par
\(B \cap C\) finite, \(z\in B\), \(z\in B\cap \phi_{\sheaf L^{-1}} (\ker \hat i) = T_z^* \sheaf L \otimes \sheaf L^{-1} |_B\) is trivial if and only if \(z\in K(\sheaf L|_B)\). So \(\sheaf L|_B\) ample implies \(K(\sheaf L|_B)\) finite and so \(B\cap C\) is finite. So \(B\times C \to A\) has finite kernel and%
\begin{equation*}
\dim (B\times C) = \dim B + \dim C \ge \dim A
\end{equation*}
and surjective implies its an isogeny.%
\end{proofptx}
\begin{definition}{Simple abelian varieties.}{x:definition:def-simple-av}%
\(A\) is called \terminology{simple} if there does not exists \(B\subseteq A\) other than \(B = 0,A\).%
\end{definition}
\begin{corollary}{}{}{x:corollary:cor-ab-var-product-simple}%
%
\begin{equation*}
A \sim A_1^{n_1} \times \cdots \times A_k^{n_k}
\end{equation*}
\(A_i \not\sim A_j\) for \(i\ne j\) and \(A_i\) simple.%
\end{corollary}
\begin{corollary}{}{}{g:corollary:idm204353905488}%
\(\alpha \in \Hom(A,B)\) for \(A,B\) simple then \(\alpha\) is an isogeny or \(0\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204353903456}
\(\alpha(A) \subseteq B\) which implies \(\alpha(A)  = B\) or \(0\). The connected component of 0 of \(\ker \alpha\) will be an abelian subvariety of \(A\), denote it \(C\) If \(C = 0\) then \(\ker \alpha\) is finite, if \(C = A\) then \(\alpha = 0\). So \(\alpha\) is an isogeny or \(0\).%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204353898192}%
If \(A,B\) are simple and  \(A\not\sim B\) then \(\Hom(A,B) = 0\).%
\end{corollary}
\begin{definition}{}{g:definition:idm204353896448}%
%
\begin{equation*}
\End^0(A) = \End(A) \otimes \QQ\text{.}
\end{equation*}
%
\end{definition}
\begin{lemma}{}{}{g:lemma:idm204353895648}%
If \(\alpha \colon A\to B\) is an isogeny, then there exists \(\beta \colon B\to A\) s.t. \(\beta \circ \alpha = n_A\) for some \(n \ge 1\).%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204353893408}
\(\alpha\) an isogeny implies \(\ker \alpha\) is finite. So there exists \(n\) with \(n \ker \alpha = 0\). \(\ker\alpha \subseteq \ker n_A\)%
\begin{equation*}
\xymatrix{
& A \ar[dl]_\alpha \ar[d]\ar[r]^{n_A} & A \\
B\ar[r]_\sim \ar@/_3.0pc/[urr]_{\exists | \beta} & A/\ker\alpha \ar[d]\ar[ur]_{\circ} &\\
& A/n_A &
}
\end{equation*}
so \(\beta\circ \alpha = n_A\), also \(\alpha \circ \beta = n_B\).%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204353889584}%
\(A\) is simple then \(\End^0(A)\) is a division ring, \(\alpha^{-1} = \beta \otimes \frac 1n\).%
\end{corollary}
\begin{corollary}{to Poincaré reducibility theorem.}{}{g:corollary:idm204353887920}%
If%
\begin{equation*}
A\sim A_1^{n_1} \times \cdots \times A_k^{n_k}
\end{equation*}
then%
\begin{equation*}
\End^0(A) \simeq \prod \End^0(A_i)^{n_i^2}\text{.}
\end{equation*}
%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204353886192}
%
\begin{align*}
\End(A) \otimes \QQ \amp \simeq \prod_{i,j} \Hom(A_i^{n_i}, A_j^{n_j}) \otimes \QQ\\
\amp \simeq \prod_{i} \End(A_i)^{n_i^2} \otimes \QQ\\
\amp \simeq \prod_{i} \End^0(A_i)^{n_i^2}\qedhere
\end{align*}
%
\end{proofptx}
\begin{theorem}{7.2.}{}{g:theorem:idm204353884800}%
If \(\dim A = g\) then \(\deg n_A  =n^{2g}\).%
\end{theorem}
\begin{corollary}{}{}{g:corollary:idm204353883200}%
\(\characteristic k \nmid n\) implies \(\ker(n_A) \simeq (\ZZ/n\ZZ)^{2g}\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204353881952}
If  \(m | n\) then \(|\ker (m_A)| = m^{2g}\), then use structure theorem.%
\end{proofptx}
In particular if we let \(A\lb l^n\rb = A(k^\sep) \lb l^n\rb\), then \(A\lb l^n\rb \simeq (\ZZ/l^n)^{2g}\) Define%
\begin{equation*}
T_l(A) = \varprojlim_n A[l^n],\, A[l^{n+1}] \xrightarrow{l} A[l]
\end{equation*}
%
\begin{proposition}{}{}{g:proposition:idm204353879168}%
%
\begin{equation*}
T_l \simeq (\ZZ_l)^{2g}
\end{equation*}
%
\end{proposition}
\(\alpha \colon A \to B\) induces%
\begin{equation*}
T_l\alpha\colon T_l(A) \to T_l(B)
\end{equation*}
%
\begin{equation*}
(a_1,a_2, \ldots) \mapsto(\alpha(a_1),\alpha(a_2), \ldots)
\end{equation*}
%
\begin{lemma}{}{}{g:lemma:idm204353877312}%
%
\begin{equation*}
\Hom(A,B) \hookrightarrow \Hom(T_l(A), T_l(B))
\end{equation*}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204353876624}
Let \(\alpha \in \Hom(A,B)\) and assume \(T_l \alpha = 0\) then%
\begin{equation*}
\ker (\alpha|_{A_i}) \supseteq A_i[l^n] \forall n
\end{equation*}
for any simple component \(A_i\) of \(A\) so \(\alpha =0\) on each \(A_i\) and hence \(\alpha = 0\) on \(A\).%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204353872480}%
\(\Hom(A,B)\) is torsion free.%
\end{corollary}
Recall we are interested in knowing about \(\rank_\ZZ\Hom(A,B) = ?\), can we bound this? If we could show that%
\begin{equation*}
\Hom(A,B) \otimes \ZZ_l \hookrightarrow \Hom(T_l(A),T_l(B))
\end{equation*}
we could conclude, so:%
\par
%
\begin{equation*}
\xymatrix{
\Hom(A,B)\otimes \ZZ_l \ar[d]_{\sim} \ar@{^(->}[r]     & \Hom(T_lA,T_lB)\ar[d]_{\sim} \\
\prod_{i,j} (\Hom(A_i, B_j) \otimes \ZZ_l) \ar@{^(->}[r] & \prod_{i,j}\Hom(T_lA_i, T_l B_j)
% TODO right arrows hooks, fix
}
\end{equation*}
\(A_i + B_j = 0\), \(A_i\sim B_j\) \(\Hom(A_i, B_j) \hookrightarrow \End(A_i)\). Assume \(A= B\) and \(A\) simple, then \(\End(A) \otimes \ZZ_l \hookrightarrow \End(T_l(A))\).%
\begin{definition}{}{g:definition:idm204353867120}%
\(V/k\) then \(f\colon V \to k\) is called a (homogenous) polynomial function of degree \(d\) if \(\forall \{v_1,\cdots, v_m\}\subseteq V\) linearly independent.%
\begin{equation*}
f(\lambda_1 v_1 + \lambda_2 v_2 +\cdots + \lambda_m v_m)
\end{equation*}
is given by a homogenous polynomial of degree \(d\) in \(\lambda_i\) i.e.%
\begin{equation*}
f(\lambda_1 v_1 + \lambda_2 v_2 +\cdots + \lambda_m v_m) = P(\lambda_1,\ldots, \lambda_m)
\end{equation*}
for some \(P\in k\lb X_m\rb\) homogenous of degree \(d\).%
\end{definition}
%
\begin{equation*}
\deg\colon \End(A) \to \ZZ
\end{equation*}
\(\alpha\) an isogeny iff \(\deg \alpha\), \(\alpha\) not an isogeny iff \(0\).%
\begin{theorem}{}{}{g:theorem:idm204353860304}%
\(\deg\) uniquely extends to a polynomial function of degree \(2g\) on \(\End^0(A) \to \QQ\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204353858640}
(of above continued)%
\par
%
\begin{equation*}
\End(A) \otimes \ZZ_l \hookrightarrow\End(T_l(A))
\end{equation*}
for \(A\) simple iff for any finitely generated \(M \subseteq \End(A)\)%
\begin{equation*}
M \otimes \ZZ_l \hookrightarrow \End(T_l(A))
\end{equation*}
%
\par
Claim:%
\begin{equation*}
M^{\text{div}} = \{f\in \End(A) : nf\in M \text{ for some }n\ge 1\}
\end{equation*}
is finitely generated.%
\par
Proof: \(M^\text{div} = (M\otimes \QQ) \cap \End(A)\) \(\deg \colon M \otimes \QQ \to \QQ\) is a polynomial so it is continuous.%
\begin{equation*}
U = \{\phi\in M \otimes \QQ : \deg \phi \lt 1\}
\end{equation*}
is open in \(M \otimes \QQ\) but \(U \cap M^\text{div} = 0\) so \(M^\text{div} \) is a discrete subgroup of the finite dimensional \(\QQ\)-vector space \(M \otimes \QQ\) so \(M^\text{div}\) is finitely generated. \(M \hookrightarrow M^\text{div}\) so \(M \otimes \ZZ_l \hookrightarrow M^\text{div} \otimes \ZZ_l\) so  we may assume \(M = M^\text{div}\).%
\par
Let \(f_1,\ldots, f_r\) be a \(\ZZ\)-basis for \(M\) and suppose that \(\sum a_iT_l(f_i)=0\) for some \(a_i \in \ZZ_l\) not all 0. We can assume not all \(a_i\) are divisible by \(l\). Choose \(a_i' \in \ZZ\) s.t. \(a_i'=a_i \pmod{l}\)%
\begin{equation*}
f = \sum a_i' f_i \in \End(A)
\end{equation*}
we then have%
\begin{equation*}
f = \sum a_i' T_lf_i
\end{equation*}
is 0 on the first coordinate of \(T_l\). So \(A\lb l \rb \subseteq \ker f\) so there exists \(g\) with \(f= lg\) \(f\in M\) implies \(g\in M^\text{div} = M\) so \(g = \sum b_i f_i\) and \(f = \sum lb_i f = \sum a_i f_i\) hence \(l\mid a_i\) for all \(i\) a contradiction. So \(\End(A)\otimes \ZZ_l \hookrightarrow \End(T_l(A))\).%
\par
Therefore%
\begin{equation*}
\Hom(A,B) \otimes \ZZ_l \hookrightarrow \Hom(T_l(A), T_l(B))
\end{equation*}
%
\begin{equation*}
\rank_\ZZ \Hom(A,B) \le 4 \dim A\dim B\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.9 Polarizations and Étale cohomology (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Polarizations and Étale cohomology (Alex)}{}{Polarizations and Étale cohomology (Alex)}{}{}{x:section:sec-polarizations-etale}
\begin{introduction}{}%
Plan: polarizations, a little cohomological warmup and a cool finiteness result. Étale cohomology.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.9.1 Polarizations}
\typeout{************************************************}
%
\begin{subsectionptx}{Polarizations}{}{Polarizations}{}{}{g:subsection:idm204353838240}
\begin{definition}{Polarizations.}{x:definition:def-polarization}%
A \terminology{polarization} of an abelian variety \(A/k\) is an isogeny%
\begin{equation*}
\lambda \colon A \to \hat A
\end{equation*}
such that%
\begin{equation*}
\lambda \simeq_{\overline k} \lambda_{\sheaf{L}} : a\mapsto t_a^*\sheaf L \otimes \sheaf L^{-1}
\end{equation*}
for an ample invertible sheaf \(\sheaf L\) on \(A_{\overline k}\).%
\par
We then have a notion of degree, polarizations of degree 1 (i.e. isomorphisms \(A\to \hat A\)) are called \terminology{principal polarizations}.%
\end{definition}
\begin{remark}{}{g:remark:idm204353833056}%
This is in fact equivalent to the \hyperref[x:definition:def-princ-pol]{previous definition~\ref{x:definition:def-princ-pol}}, see \hyperlink{x:biblio:bib-vandergeer-moonen}{[47,~cor. 11.5]}.%
\end{remark}
Natural questions: what does the line bundle \(\sheaf L\) tell us about the polarization? Can we tell principality?%
\par
To answer this we must (rapidly) recall (Zariski) sheaf cohomology. But this will help us in the next section too.%
\par
A line bundle (or indeed any sheaf) defines for us for any open subset \(U \hookrightarrow X\) an abelian group of sections \(\sheaf L(U)\).%
\par
However taking (global) sections doesn't play well with exact sequences!%
\begin{example}{Classic example.}{g:example:idm204353828528}%
Let \(X = \CC^*\) and consider%
\begin{equation*}
0 \to \ZZ \hookrightarrow \sheaf O_X \xrightarrow{e^{2\pi i -}} \sheaf O_X^* \to 0
\end{equation*}
but%
\begin{equation*}
0 \to \ZZ \to \sheaf O_X(X) \to \sheaf O_X^*(X)
\end{equation*}
is not surjective on the right, for example \(f(z) = z\) is a nowhere vanishing meromorphic function on \(X\) but its not \(\exp\) of anything. Upshot: maps of sheaves can be surjective (by being so locally) but not globally.%
\end{example}
To understand\slash{}control this phenomenon we introduce \(H^1(X, \sheaf F)\) fitting into the above and so on.%
\par
Explicitly: for a sheaf \(\sheaf F\) we fix an injective resolution%
\begin{equation*}
0\to \sheaf F \to \sheaf I_0 \to \sheaf I_1 \to \cdots
\end{equation*}
which we then take global sections of to get a chain complex%
\begin{equation*}
0\to \Gamma(X,\sheaf F) \to \Gamma(X,\sheaf I_0) \to \Gamma(X,\sheaf I_1) \to \cdots
\end{equation*}
and we truncate and take cohomology of this to measure ``failure of exactness''%
\begin{equation*}
H^0(X, \sheaf F) , H^1(X, \sheaf F) , H^2(X, \sheaf F) , \ldots\text{.}
\end{equation*}
%
\begin{definition}{Euler-Poincaré characteristic.}{x:definition:def-euler-poincare-char}%
Define the \terminology{Euler-Poincaré characteristic} of a line bundle \(\sheaf L\) to be%
\begin{equation*}
\chi(\sheaf L) = \sum (-1)^i \dim_k H^i(A,\sheaf L)\text{.}
\end{equation*}
%
\end{definition}
\begin{theorem}{Riemann-Roch.}{}{g:theorem:idm204353819088}%
Let \(A\) be an abelian variety of dimension \(g\) then%
\begin{enumerate}
\item{}The degree of \(\lambda_{\sheaf L}\) is \(\chi(\sheaf L)^2\).%
\item{}If \(\sheaf L = \sheaf L(D)\) then \(\chi(\sheaf L) = (D^g)/g!\), this is the \(g\)-fold self intersection number of \(D\).%
\end{enumerate}
%
\end{theorem}
\begin{theorem}{Vanishing.}{}{g:theorem:idm204353814272}%
If \(\#K( \sheaf L)\lt \infty\) then there is a unique integer \(0\le i(\sheaf L) \le g\) with \(H^i(A, \sheaf L) \ne  0\) and \(H^p(A, \sheaf L) = 0\) for all \(p \ne i\). Moreover \(i(\sheaf L^{-1}) = g - i(\sheaf L)\).%
\end{theorem}
Recall \hyperref[x:subsection:sec-ample-L-finite-KL]{Subsection~\ref{x:subsection:sec-ample-L-finite-KL}}: So for ample \(\sheaf L\) we have \(K(\sheaf L)\) finite, so the vanishing theorem applies. Additionally for very ample \(\sheaf L\) we know \(H^0(A,\sheaf L) \ne 0\) so in this case we get vanishing of higher cohomology.%
\begin{theorem}{Finiteness.}{}{g:theorem:idm204353808288}%
Let \(k\) be a finite field, and   \(g,d\ge 1\) integers. Up to isomorphism there are only finitely many abelian varieties \(A/k\) of dimension \(g\) and with a polarization of degree \(d^2\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204353805344}
(Super sketch)%
\par
Over a finite field implies there is an ample \(\sheaf L\) with \(\lambda_{\sheaf L}\) a polarization of degree \(d^2\), then using above \(\chi(\sheaf L^3) = 3^g d\) and \(\sheaf L^3\) is very ample hence \(\dim H^0(A, \sheaf L^3) = 3^g d\) so we get an embedding into \(\PP^{3^g d - 1}\).%
\par
The degree of \(A\) in \(\PP^{3^g d - 1}\) is \(((3D)^g) = 3^g d(g!)\) . It is determined by its Chow form, which by these formulae has some (large) bounded degree, as we are over a finite field however there are only finitely many such.%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.9.2 Étale Cohomology of Abelian Varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Étale Cohomology of Abelian Varieties}{}{Étale Cohomology of Abelian Varieties}{}{}{g:subsection:idm204353799968}
See \hyperlink{x:biblio:bib-milne-etale}{[77]} or \hyperlink{x:biblio:bib-tamme}{[96]}.%
\par
Recall for abelian varieties over \(A/\CC\) we considered singular cohomology of the complex points \(A(\CC)\). Indeed this theory was strongly connected to the lattice \(\Lambda\) defining \(A(\CC)\).%
\par
We saw that in fact \(\pi_1(A,0) = \pi^{-1} (0) = \Lambda \subseteq V\) which was the universal covering space of \(A(\CC)\). We want to emulate this over a general field.%
\par
We want to allow multiplication by \(n\) to define finite covers for our abelian varieties as they did before.%
\par
Problem: Zariski topology is too coarse: we can't find an open \(U\) set around \(0 \in A\) such that \(\lb 2\rb \colon U \to A\) is an isomorphism onto its image. Isogenies are not local isomorphisms for the Zariski topology.%
\par
How on earth do we ``allow'' maps which are clearly not local isomorphisms to become such? First what do we mean by local isomorphism?%
\begin{equation*}
\xymatrix{
f^{-1}(U)\ar[d] \ar[r]^{\sim} & U\ar@{^(->}[d]^i\\
X \ar[r]_f & Y
}\text{.}
\end{equation*}
There exists an open subset \(U\) such that the base change \(X \times_Y U\) is isomorphic with \(\coprod U\) of several copies of \(U\) in a compatible way with the map to \(U\).%
\par
So let's cheat, the best isomorphism is the identity map%
\begin{equation*}
\xymatrix{
X\ar[d] \ar[r]^{\sim} & X\ar[d]^f\\
X \ar[r]_f & Y
}
\end{equation*}
if we define an ``open set'' \(U\) to be a morphism \(X \to Y\) with the properties we want, then all such become local isomorphisms.%
\par
By taking our \emph{topology} to be given by some maps we decide are decent covering maps we can circumvent these difficulties.%
\par
What is the correct class of morphisms to take here, we feel like our \(\lb n\rb\) maps should count. Taking inspiration from differential geometry perhaps, we are led to the notion of a local diffeomorphism, an étale map.%
\begin{definition}{}{g:definition:idm204353783904}%
Let \(X,Y\) be nonsingular varieties over \(k = \overline k\). Then \(f\colon X\to Y\) is étale at a point \(P\in X\) if%
\begin{equation*}
\diff f\colon\Tgt_{P}(X) \to \Tgt_{f(P)} (Y)
\end{equation*}
is an isomorphism.%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204353781408}%
Let \(f \colon \aff^m\to \aff^m\) then \(f\) is étale at \((a_1, \cdots, a_m)\) iff%
\begin{equation*}
\left(\frac{\partial(X_i \circ f)}{\partial Y_j}|_{(a_k)} \right)
\end{equation*}
is nonsingular.%
\end{proposition}
\begin{example}{A non-étale map.}{g:example:idm204353779136}%
Consider the map%
\begin{align*}
\aff^2 \amp\to \aff^2\\
(x,y) \amp\mapsto (x^3, x^2 + y)
\end{align*}
we can see that the image of \(y= 0\) is the nodal cubic (\(Y^3 = X^2\)), which is messed up (singular) at \((0,0)\). The jacobian is%
\begin{equation*}
\begin{pmatrix} 3x^2 \amp 0 \\ 2x \amp 1\end{pmatrix}
\end{equation*}
so this matrix is singular exactly when \(x= 0\) (unless characteristic 3). So the map is not étale at these points.%
\end{example}
\begin{proposition}{}{}{g:proposition:idm204346418720}%
The maps \(\lb n\rb\) are étale on an abelian variety \(A/k\) for all  \(\characteristic{k} \nmid n\)%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204346417056}
Key point \(\diff (\alpha+ \beta)_0 = (\diff \alpha )_0 + (\diff \beta)_0\). So the map on tangent spaces is simply multiplication by \(n\).%
\end{proofptx}
\begin{definition}{Étale morphisms.}{x:definition:def-etale}%
A morphism \(f\colon X\to Y\) of schemes is \terminology{étale} if it is flat and unramified.%
\par
Flatness for finite morphisms of varieties is equivalent to each fibre \(f^{-1}(t)\) being of equal cardinality, counting multiplicities.%
\end{definition}
All isogenies are finite and flat.%
\begin{definition}{}{g:definition:idm204346412672}%
Let \(\mathrm{FEt}/X\) be the category of finite étale maps \(\pi\colon Y \to X\) (i.e. finite étale coverings of \(X\)).%
\par
Then after picking a basepoint \(x\in X\) we can map%
\begin{equation*}
F\colon \mathrm{FEt}/X\to \mathrm{Set}
\end{equation*}
%
\begin{equation*}
\pi\mapsto \Hom_X(x,Y) \approx\pi^{-1}(x)\text{.}
\end{equation*}
%
\par
This is in fact pro-representable, i.e. there exists a system%
\begin{equation*}
\tilde X = (X_i)_{i\in I}
\end{equation*}
with%
\begin{equation*}
F(Y) = \Hom(\tilde X ,Y) = \varinjlim_i \Hom(X_i, Y)\text{.}
\end{equation*}
%
\par
We then define%
\begin{equation*}
\pi_1(X,x) = \Aut_X(\tilde X) = \varprojlim_i \Aut_X(X_i)\text{.}
\end{equation*}
%
\end{definition}
So we need to understand étale covers of abelian varieties. Following \hyperlink{x:biblio:bib-vandergeer-moonen}{[47]}:%
\begin{proposition}{surprising proposition.}{}{g:proposition:idm204346406512}%
Let \(X\)  be a complete variety over a field \(k\) with \(e\in X(k)\) and \(m \colon X\times X\to X\) s.t. \(m(e,x) = m(x,e) = x\) for all \(x \in X\). Then \((X, m,e)\) is an abelian variety.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204346402736}
(Sketch)%
\par
Let%
\begin{equation*}
\tau\colon X\times X \to X\times X
\end{equation*}
%
\begin{equation*}
\tau(x,y) = (xy,y)
\end{equation*}
so \(\tau^{-1} (e,e) = (e,e)\). Some exercise in Hartshorne implies \(\im \tau\) has dimension \(2\dim X\).%
\par
Reduce to algebraically closed case.%
\par
Let%
\begin{equation*}
\tau^{-1}(\{e\} \times X) =  \{(x,y) : xy = e\} = \Gamma \subseteq X\times X
\end{equation*}
as \(\tau \) is surjective we get \(p_2 \colon \Gamma \to X\) is also so pick an irreducible \(\Gamma_1 \subseteq \Gamma\) with \(p_2(\Gamma_1) = X\). This also implies \(p_1(\Gamma_1) = X\).%
\par
Let%
\begin{equation*}
f\colon \Gamma_1 \times X\times X \to X
\end{equation*}
%
\begin{equation*}
f((x,y),z,w) = x((yz)w)
\end{equation*}
then%
\begin{equation*}
f(\Gamma_1 \times\{e\}\times\{e\}) = \{eee\} = \{e\}
\end{equation*}
so a version of \hyperref[x:theorem:thm-rigidity]{rigidity~\ref{x:theorem:thm-rigidity}} gives%
\begin{equation*}
x((yz)w) = zw\ \forall (x,y) \in \Gamma_1,\,z,w\in X
\end{equation*}
So letting \(w = e\) we get%
\begin{equation*}
x(yz) = z\text{.}
\end{equation*}
Fix \(y \in X(k)\), and then by surjectivity we can find \(x,z \in X(k)\) with \((x,y)\in \Gamma_1 \ni (y,z)\). So we get%
\begin{equation*}
x = x(yz) = ze = z
\end{equation*}
and so \(y\) has both a left and right inverse. We then multiply above by \(y\) to get%
\begin{equation*}
y(zw) = y(x((yz)w)) = (yz)w
\end{equation*}
so \(X(k)\) is associative.%
\end{proofptx}
\begin{theorem}{Lang-Serre.}{}{g:theorem:idm204346390000}%
Let \(X/k\) be an abelian variety and \(Y/k\) a variety with \(e_Y\in Y(k)\) s.t. \(f\colon Y \to X\) is an étale covering where \(f(e_Y) = e_X\). Then \(Y\) can be given the structure of an abelian variety so that \(f\) is a separable isogeny.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204346386208}
Must construct a group law on \(Y\):%
\par
Take the graph of \(m\colon X\times X \to X\)%
\begin{equation*}
\Gamma_X \subseteq X\times X\times X
\end{equation*}
and pullback along \(f\times f\times f\) to%
\begin{equation*}
\Gamma'_Y \subseteq Y\times Y\times Y
\end{equation*}
fix the connected component \(\Gamma_Y\) containing \((e_Y,e_Y,e_Y)\).%
\par
Call the projections from \(\Gamma_Y\) \(q_I\). Now we must show that \(q_{12}\colon \Gamma_Y \to Y\times Y\) is an isomorphism, then \(m_Y\colon Y\times Y \to Y\) can be defined as \(q_3 \circ q_{12}^{-1}\). \(q_{12}\) has sections \(s_1,s_2\) over \(\{e_Y\}\times Y\), \(Y\times \{e_Y\}\) respectively given by \(s_1(e_Y,y) = (e_Y,y,y)\) and \(s_2(y,e_y,y) = (y,e_y,y)\). So \(m_Y\) satisfies the conditions of the surprising proposition.%
\begin{equation*}
\xymatrix{
\Gamma_Y \ar[r]\ar[d]_{q_{12}} & \Gamma_X\ar[d]^{p_{12}} \\
Y\times Y \ar[r]_{f\times f} & X\times X
}
\end{equation*}
the horizontal maps are étale coverings and the rightmost an isomorphism so \(q_{12}\) is an étale covering. The projection \(p_2 \circ q_{12} = q_2 \colon \Gamma_Y\to Y\) is smooth proper. Fact: all fibres of \(q_2\) are irreducible. So \(Z = q_2^{-1} (e_Y) = q_{12}^{-1}(Y\times \{e_Y\})\) is irreducible. Moreover \(q_{12}\) restricts to an étale covering \(Z \to Y = Y\times\{e_Y\}\) of  the same degree, but \(s_2\) is a section of this covering, hence it is an isomorphism. Hence \(q_{12}\) has degree 1 and is therefore an isomorphism as required.%
\end{proofptx}
So we have some control over the finite étale maps, what does the covering space look like? Last week we saw that for an isogeny \(\alpha\colon B \to A\) we could find \(\beta \colon A \to B\) with \(\beta\circ\alpha = \lb n\rb\colon A \to A\). This means we can take our universal covering space to be%
\begin{equation*}
(A)_{i\in I}
\end{equation*}
with multiplication by \(n\) maps.%
\par
So we find%
\begin{equation*}
\pi_1^\et(A,0) =\varprojlim_n \Aut_A(A\xrightarrow{[n]} A)=  \varprojlim_n A[n]\text{.}
\end{equation*}
%
\begin{theorem}{}{}{g:theorem:idm204346369120}%
%
\begin{equation*}
H^1_\et(A , \ZZ_l) = \Hom(\pi_1(A,0), \ZZ_l) = \Hom(T_l,\ZZ_l)
\end{equation*}
%
\end{theorem}
\begin{theorem}{}{}{g:theorem:idm204346368416}%
%
\begin{equation*}
H^r(A_\et, \ZZ_l) = \bigwedge^r H^1(A_\et, \ZZ_l)
\end{equation*}
%
\end{theorem}
Note that Milne gives a combined proof of the above two statements, this relies on some theorems on Hopf algebras such as \hyperlink{x:biblio:bib-borel-hopf}{[25,~Theoreme 6.1]}.%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.10 Weil pairings (Maria)}
\typeout{************************************************}
%
\begin{sectionptx}{Weil pairings (Maria)}{}{Weil pairings (Maria)}{}{}{x:section:sec-weil-pairings}
%
%
\typeout{************************************************}
\typeout{Subsection 1.10.1 Weil pairings on elliptic curves}
\typeout{************************************************}
%
\begin{subsectionptx}{Weil pairings on elliptic curves}{}{Weil pairings on elliptic curves}{}{}{g:subsection:idm204346364592}
Start with elliptic curves, later repeat for abelian varieties. \(E/k\) an elliptic curve, \(m\ge 2\), if \(\characteristic(k) = p \gt 0\) \((m,p) = 1\). The Weil \(e_m\)-pairing \(e_m \colon E\lb m\rb \times E\lb m \rb \to \mu_m\) is defined as follows: Fix \(T\in E\lb m \rb\) then \(f\in \overline  k (E)\) s.t. \(\divisor(f) = m(T) - m(0)\). Fix \(T' \in E\) with \(mT' = T\) and \(g\in \overline k(E)\) s.t. \(\divisor(g) = \lb m \rb^*(T) = \lb m \rb^*(0)= \sum_{R\in E\lb m \rb} (T+R) - (R)\). Check \(\divisor (f\circ \lb m \rb) = \divisor(g^m)\), hence%
\begin{equation*}
f\circ [m] = c g^m
\end{equation*}
so can assume \(f\circ \lb m \rb = g^m\). For \(s \in E\lb m \rb\), \(x\in E\):%
\begin{equation*}
g(x + s) = f([m]x + [m]s) = f([m]x) = g(x)^m
\end{equation*}
%
\begin{equation*}
\frac{g(\cdot + s)^m}{g(\cdot)} \colon E \to \PP^1
\end{equation*}
is then a constant function, since not surjective. So we define%
\begin{align*}
e_m\colon E[m]\times E[m] \amp\to \mu_m\\
(s,t)\amp \mapsto \frac{g_t(x+s)}{g_t(x)}
\end{align*}
will state many properties later, but for now. \(e_m\) is compatible:%
\begin{equation*}
e_{mm'} (a,a')^{m'} = e_m(m'a, m'a') \ \forall a,a' \in E[mm']
\end{equation*}
so for any \(l\ne \characteristic(k)\) prime we can combine \(e_{l^n}\)-pairings into an \(l\)-adic Weil pairing on \(T_l E\)%
\begin{equation*}
e \colon T_l E\times T_lE \to T_l \mu = \ZZ_l(1)
\end{equation*}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.10.2 Weil pairings on abelian varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Weil pairings on abelian varieties}{}{Weil pairings on abelian varieties}{}{}{g:subsection:idm204346351696}
Story will be broadly similar to before but we must use the dual, which doesn't appear in the presentation for elliptic curves.%
\par
Let \(A/k\) be an abelian variety \(k = \overline k\). We construct a Weil \(e_m\)-pairing%
\begin{align*}
e_m \colon A[m]\times A^\vee [m] \amp\to \mu_m\\
(a,a') \amp\mapsto \frac{g\circ t_a(x)}{g(x)} = \frac{g(x+a)}{g(x)}
\end{align*}
Fix \(a\in A\lb m\rb,\,a'\in A^\vee\lb m\rb\) say \(a'\) corresponds to \(\sheaf L\) and a divisor \(D\) then \(\sheaf L^m \) and \(m_A^* \sheaf L\) are trivial so \(\exists f,g \in k(A)\) s.t.%
\begin{equation*}
\divisor (f) = m D
\end{equation*}
%
\begin{equation*}
\divisor (g) = m_A^* D
\end{equation*}
again we have%
\begin{equation*}
\divisor( f\circ m_A) = \divisor (g^m)
\end{equation*}
%
\begin{equation*}
g(x+a)^m = g(x)^m
\end{equation*}
%
\begin{proposition}{}{}{g:proposition:idm204346344144}%
The Weil \(e_m\)-pairing has the following properties%
\begin{enumerate}
\item{}\(e_m\) is bilinear%
\begin{equation*}
e_m(a_1+a_2,a') = e_m(a_1,a')e_m(a_2, a')
\end{equation*}
%
\begin{equation*}
e_m(a,a'_1+a'_2) = e_m(a,a'_1)e_m(a,a'_2)
\end{equation*}
%
\item{}\(e_m\) is non-degenerate: if \(e_m(a,a') = 1 \forall a\in A\lb m\rb\) then \(a' = 0\) (and likewise for the reverse).%
\item{}\(e_m\) is Galois-invariant... but we assume \(\overline k =k\) so we ignore this.%
\item{}\(e_m\) is compatible%
\begin{equation*}
e_{mm'} (a,a')^{m'} = e_m(m'a, m'a') \ \forall a \in A[mm'], a'\in A^\vee [mm']
\end{equation*}
\((mm',\characteristic k) = 1\)%
\end{enumerate}
%
\end{proposition}
\begin{corollary}{}{}{g:corollary:idm204346338336}%
There exists a bilinear non-degenerate (Galois invariant) pairing%
\begin{equation*}
e_l = e \colon T_lA \times T_lA^\vee \to T_l\mu
\end{equation*}
%
\begin{equation*}
((a_n), (a'_n)) \mapsto (e_{l^n}(a_,a'_n))
\end{equation*}
%
\end{corollary}
For a homomorphism \(\lambda \colon A \to A^\vee\) we define%
\begin{equation*}
e_m^\lambda \colon A[m]\times A [m] \to \mu_m
\end{equation*}
%
\begin{equation*}
(a,a') \mapsto e_m(a, \lambda(a'))
\end{equation*}
%
\begin{equation*}
e_m \colon T_lA\times T_l A \to T_l \mu
\end{equation*}
%
\begin{equation*}
(a,a') \mapsto e_m(a, \lambda(a'))\text{.}
\end{equation*}
%
\begin{paragraphs}{Notation.}{g:paragraphs:idm204346335072}%
If \(\lambda = \lambda_{\sheaf L} e^{\sheaf L} = e^{\lambda_{\sheaf L}}\).%
\end{paragraphs}%
\begin{proposition}{}{}{g:proposition:idm204346333952}%
For a homomorphism \(\alpha \colon A \to B\)%
\begin{enumerate}
\item{}%
\begin{equation*}
e(a,\alpha^\vee(b)) = e(\alpha (a), b) \forall a \in T_lA,\,b\in T_l B
\end{equation*}
%
\item{}%
\begin{equation*}
e^{\alpha^\vee \lambda \alpha}(a,a') = e ^\lambda (\alpha(a), \alpha(a'))
\end{equation*}
for \(a,a' \in T_l(A)\), \(\lambda \in \Hom(B,B^\vee)\).%
\item{}%
\begin{equation*}
e^{\alpha^* \sheaf L} (a,a') = e^{\sheaf L}(\alpha (a),\alpha(a'))
\end{equation*}
\(a,a'\in T_lA\) \(\sheaf L\in \Pic(B)\).%
\item{}%
\begin{equation*}
\Pic A  \to \Hom( \bigwedge^2 T_lA , T_l\mu)
\end{equation*}
%
\begin{equation*}
\sheaf L \mapsto e^{\sheaf L}
\end{equation*}
is a homomorphism (in particular \(e^{\sheaf L}\) is  skew-symmetric).%
\end{enumerate}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204346328496}
%
\begin{enumerate}
\item{}\(a = (a_n) \in T_lA\) \(b\in (b_n) \in T_l B^\vee\) fix a divisor \(D \) on \(B\) representing \(b_n\) and \(g\in k(B)\) s.t. \(\divisor (h) = (l^n_B)^* D\). Then \(\alpha^* D\) represents \(\alpha^\vee(b_n)\) so:%
\begin{equation*}
\divisor(g\circ \alpha) = \alpha^*\divisor (g) = \alpha^*(l^n_B)^* D = (l_A^n)^* \alpha^* D\text{.}
\end{equation*}
So%
\item{}%
\begin{equation*}
e^{\alpha^{\vee}\lambda \alpha} (a,a') = e(a, \alpha^\vee\lambda \alpha(a')) = e(\alpha(a),\lambda (\alpha(a'))) = e^\lambda (\alpha(a), \alpha(a'))\text{.}
\end{equation*}
%
\item{}%
\begin{equation*}
\lambda_{\alpha^* \sheaf L} = \alpha^\vee \lambda_{\sheaf L} \alpha
\end{equation*}
%
\item{}Follows from \(\lambda_{\sheaf L\otimes \sheaf L'} = \lambda_{\sheaf L} + \lambda_{\sheaf L'}\).%
\end{enumerate}
%
\end{proofptx}
\begin{example}{Computation over \(\CC\).}{g:example:idm204346321728}%
\(A/\CC\) be an abelian variety%
\begin{equation*}
0\to \ZZ \to \sheaf O_A \xrightarrow{e^{2\pi i (\cdot)}} \sheaf O^\times \to 0
\end{equation*}
induces%
\begin{equation*}
H^1(A(\CC), \ZZ) \to H^1(A(\CC), \sheaf O) \to H^1(A(\CC), \sheaf O^\times) \simeq \Pic A \to H^2(A(\CC), \ZZ)
\end{equation*}
and%
\begin{equation*}
H^1(A(\CC), \sheaf O)/ H^1(A(\CC), \ZZ) \simeq A^\vee(\CC) = \Pic^0(A)
\end{equation*}
so we get an exact sequence%
\begin{equation*}
0 \to \NS(A) \to H^2 (A(\CC),\ZZ) \to H^2(A(\CC),\sheaf O_A)
\end{equation*}
%
\begin{equation*}
\lambda \mapsto E_\lambda
\end{equation*}
then we can regard \(E_\lambda\) as a skew-symmetric 2-form on \(H_1(A(\CC), \ZZ)\). Mumford pg. 237 proves%
\begin{equation*}
\xymatrix{
H_1(A(\CC), \ZZ) \times H_1(A(\CC), \ZZ) \ar[r] \ar[d] & \ZZ\ni m \ar[d] \\
T_l \times T_l \ar[r] & T_l \mu \ni \zeta^m
}
\end{equation*}
commutes with - sign so \(e^\lambda (a,a') = \zeta^{-E(a,a')}\)%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.10.3 Results about polarizations}
\typeout{************************************************}
%
\begin{subsectionptx}{Results about polarizations}{}{Results about polarizations}{}{}{g:subsection:idm204346316304}
\(k = \overline k\) \(p = \characteristic (k) \ge 0\).%
\begin{theorem}{13.4.}{}{g:theorem:idm204346314928}%
Let \(\alpha\colon A\to B\) be an isogeny of degree prime to \(\characteristic k\) and \(\lambda \in \NS(A)\) then \(\lambda = \alpha^* \lambda '\) for \(\lambda ' \in \NS(B) \iff \forall l |\deg(\alpha)\) \(l\) prime there exists a skew-symmetric form \(f\colon T_lB\times T_lB \to T_l\mu\) s.t. \(e^\lambda(a,a') = f(\alpha(a), \alpha(a'))\) for all \(a,a' \in T_l(A)\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204346310192}
Milne 1986 16.4%
\end{proofptx}
\begin{corollary}{13.5.}{}{g:corollary:idm204346309792}%
\(l \ne \characteristic (k)\) \(\lambda \in \NS(A) \) is divisible by \(l^n \iff e^\lambda\) is divisible by \(l^n\) in \(\Hom (\bigwedge^2 T_lA, T_l \mu)\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204346306960}
Apply theorem 13.4 with \(\alpha = l^n\).%
\end{proofptx}
\begin{lemma}{13.7.}{}{g:lemma:idm204346306144}%
Let \(\sheaf P\) be the Poincaré sheaf on \(A\times A^\vee\) then%
\begin{equation*}
e^{\sheaf P} ((a,b),(a',b')) = \frac{e(a,b')}{e(a',b)}
\end{equation*}
for all \(a,a' \in T_l A\), \(b,b' \in T_l A^\vee\).%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204346303264}
Milne 1986 16.7. Use:%
\begin{equation*}
(1+ \lambda_{\sheaf L})^* \sheaf P \cong m^* \sheaf L \otimes p^* \sheaf L^{-1} \otimes q^* \sheaf L^{-1}\qedhere
\end{equation*}
%
\end{proofptx}
\begin{proposition}{13.6.}{}{x:proposition:prop-milne-av-13-6}%
Assume \(\characteristic k \ne l,2\) then a homomorphism \(\lambda\colon A\to A^\vee\) is \(\lambda = \lambda_{\sheaf L}\) for some \(\sheaf L \in \Pic A\) iff \(e^\lambda\) is skew-symmetric.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204346299168}
\begin{case}{}{}{g:case:idm204346299040}
Clear.%
\end{case}
\begin{case}{}{}{g:case:idm204346298448}
\(e^\lambda\) is skew-symmetric, define \(\sheaf L = (1 \times \lambda)^* \sheaf P\) then  \(\forall a,a' \in T_l A\)%
\begin{equation*}
e(a,\lambda_{\sheaf L} (a') ) = e^{\sheaf L}(a,a') = e^{(1\times \lambda)^* \sheaf P} (a,a') = e^{\sheaf P}((a,\lambda (a)), (a',\lambda(a'))) = \frac{e(a,\lambda (a'))}{ e(a',\lambda(a))}
\end{equation*}
%
\begin{equation*}
= \frac{e^\lambda(a,a')}{ e^\lambda(a',a)} = (e^\lambda(a,a'))^2 = e(a,2\lambda (a'))
\end{equation*}
so \(2\lambda = \lambda_{\sheaf L}\). So by corollary 13.5 \(\lambda_{\sheaf L} = 2\lambda_{\sheaf L'}\) for some \(\sheaf L' \in \Pic A\) so \(\lambda = \lambda_{\sheaf L'}\).%
\end{case}
\end{proofptx}
\begin{definition}{}{g:definition:idm204346294384}%
For a  polarization \(\lambda \colon A\to A^\vee\) define%
\begin{equation*}
e^{\lambda} \colon \ker(\lambda)\times \ker(\lambda) \to \mu_m
\end{equation*}
%
\begin{equation*}
(a,a')\mapsto e_m(a,\lambda(b))
\end{equation*}
where \(m \) kills \(\ker(\lambda)\) and \(b \in A\) s.t.\(mb = a'\).%
\end{definition}
Check: this is well defined.%
\begin{note}{}{g:note:idm204346290704}%
\(e^\lambda\) is skew-symmetric.%
\end{note}
\begin{proposition}{13.8.}{}{g:proposition:idm204346290016}%
\(\alpha\colon A \to B\) is an isogeny of degree prime to \(p\), \(\lambda\colon A\to A^\vee\) polarization then \(\lambda = \alpha^* \lambda', \,\lambda' \colon B\to B^\vee\) polarization iff%
\begin{equation*}
\ker(\alpha) \subset \ker \lambda
\end{equation*}
%
\begin{equation*}
e^{\lambda} \text{ is trivial on } \ker (\alpha)\times \ker(\alpha)
\end{equation*}
%
\end{proposition}
\begin{note}{}{g:note:idm204346286944}%
If \(\lambda = \alpha^* \lambda'\) then%
\begin{equation*}
\deg(\lambda) = \deg (\lambda') \deg(\alpha)^2\text{.}
\end{equation*}
%
\end{note}
\begin{corollary}{13.10.}{}{g:corollary:idm204346285696}%
\(A\) an abelian variety, \(\lambda \colon A \to A^\vee\) is a polarization with \((\deg (\lambda), p) = 1\) then \(A\) is  isogenous to a principally polarized abelian variety.%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204346283296}
Fix \(l |\deg(\lambda)\) prime. Choose a subgroup \(N\subseteq \ker \lambda\) of order \(l\) let \(\alpha \colon A\to A/N = B\) \(N\) is cyclic and \(e^\lambda\) is skew-symmetric so \(e^{\lambda}\) is trivial on \(N\times N\) so \(B\) has a polarization of degree \(\deg(\lambda) / l^2\) by 13.8.%
\end{proofptx}
\begin{corollary}{13.11.}{}{g:corollary:idm204346278688}%
Let \(\lambda\) be a polarization of \(A\) s.t. \(\ker (\lambda) \subseteq A\lb m \rb\) for some \((m,p)=1\). If \(\exists \alpha \colon A \to A\) s.t. \(\alpha(\ker (\lambda)) \subseteq \ker(\lambda)\) and \(\alpha^\vee \lambda \alpha = - \lambda\) on \(A\lb m^2\rb\) then \(A\times A^\vee\) is principally polarized.%
\end{corollary}
\begin{theorem}{13.12 (Zarhin's trick).}{}{g:theorem:idm204346274016}%
For any abelian variety \(A\) \((A\times A^\vee)^4\) is principally polarized.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204346272352}
Fix \(\lambda \colon A\to A^\vee\) polarization, assume \(\ker (\lambda) \subseteq A\lb m \rb\) \((m, p) = 1\) there exists \(a,b,c,d \in \ZZ\) s.t. \(a^2 + b^2 + c^2 + d^2 = m^2  - 1 = -1 \pmod {m^2}\) then%
\begin{equation*}
\begin{pmatrix} a\amp -b \amp-c\amp -d \\ b\amp a \amp d \amp -c \\ c\amp -d \amp a \amp b \\ d \amp c \amp -b \amp a\end{pmatrix}
\end{equation*}
works.%
\end{proofptx}
\begin{corollary}{13.13.}{}{g:corollary:idm204346269232}%
Let \(k\) be a finite field, then for each \(g \in \ZZ\) there exist only finitely many isomorphism classes of abelian varieties of dimension \(g\) over \(k\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204346266720}
\(A/k\) an abelian variety of dimension \(g\), so \((A\times A^\vee)^4\) is an abelian variety of dimension \(8g\) with a principal polarization so using theorem 11.2 there are finitely many (up to \(\simeq\)) of those. Also \((A\times A^\vee)^4\) has finitely many direct factors (theorem 15.3).%
\end{proofptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.11 The Rosati involution (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{The Rosati involution (Alex)}{}{The Rosati involution (Alex)}{}{}{x:section:sec-rosati}
Let \(A/k\) be an abelian variety and \(f \in \End(A)\). Via pullback we get \(\hat f \in \End(\hat A)\), in the case where \(A\) is polarized i.e. we have an isogeny \(\phi \colon A\to \hat A\) we might wonder what the relation is between \(\hat f\) and \(f\). E.g. \(\hat \id = \id\) but here we have \(\hat \phi \id \phi = \lb \deg \phi\rb\), this is a little ugly, depends on the degree of our polarization. If we work with \(\Hom^0(A,B) = \Hom(A,B) \otimes \QQ\) rather than \(\Hom(A,B)\) we have a bona fide inverse \(\phi\inv\) of an isogeny \(\phi\). So now we can ask precisely, what is the relationship of the endomorphism \(f^\dagger = \phi^{-1}\circ \hat f \circ \phi\in \End^0(A)\) with \(f\)?%
\par
What sort of properties does this map \(f \mapsto f^\dagger\) have?%
\begin{definition}{The Rosati involution.}{g:definition:idm204346255456}%
The map \(\phi^{-1} \hat{-} \phi =  {-}^\dagger \colon \End^0(A) \to \End^0(A)\) is called the \terminology{Rosati involution}.%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204346253744}%
\(-^\dagger\) is \(\QQ\)-linear%
\end{proposition}
\begin{proposition}{}{}{g:proposition:idm204346252544}%
\(-^\dagger\) is an anti-homomorphism i.e.%
\begin{equation*}
(fg)^\dagger = g^\dagger f^\dagger
\end{equation*}
%
\end{proposition}
\begin{proposition}{}{}{g:proposition:idm204346251424}%
Recall the \(l\)-adic Weil pairing for \(l \ne \characteristic(k)\), fix \(a,a'\in V_lA = T_lA\otimes \QQ\), then%
\begin{equation*}
e_l^\phi(f a ,a') = e_l^\phi(a, f^\dagger a')\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204346249184}
%
\begin{equation*}
e_l^\phi(f a ,a')  = e_l(fa, \phi a')= e_l(a, \hat f \phi a') = e_l(a, \phi\phi\inv \hat f \phi a') =  e_l^\phi(a, f^\dagger a')\qedhere
\end{equation*}
%
\end{proofptx}
\begin{proposition}{}{}{g:proposition:idm204346248528}%
\(-^\dagger\) is an involution, i.e.%
\begin{equation*}
{\alpha^\dagger}^{\dagger} = \alpha\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204346247280}
We apply the previous proposition and skew-symmetry of a polarization (over some extension)%
\begin{equation*}
e_l^\lambda(\alpha a,a') = e_l^\lambda(a, \alpha^\dagger a') = e_l^\lambda({\alpha^\dagger}^{\dagger} a, a')
\end{equation*}
for all \(a,a'\in V_l A\).%
\end{proofptx}
So we have a weird algebra with a weird operation, what can we do? Perhaps inspired by the killing form of a lie algebra:%
\par
We can form a bilinear form using the trace%
\begin{equation*}
\End^0(A) \times \End^0(A) \to \QQ
\end{equation*}
%
\begin{equation*}
(f,g) \mapsto \tr(fg^\dagger)\text{.}
\end{equation*}
%
\begin{proposition}{}{}{g:proposition:idm204346244032}%
This is positive definite. In fact%
\begin{equation*}
\tr(ff^\dagger) = 2g\frac{(D^{g-1}\cdot f^*(D))}{(D^g)}
\end{equation*}
for \(\phi = \phi_{\sheaf L(D)}\).%
\end{proposition}
So given a simple abelian variety we have a division algebra  \(/ \QQ\) equipped with  a positive definite involution.%
\begin{definition}{Albert algebras?}{x:definition:def-albert-alg}%
A division algebra \(D\) finite over \(\QQ\) with an involution \('\) such that \(\tr_{D/\QQ}(xx') > 0\ \forall x\in D^\times\) is called an \terminology{Albert algebra}.%
\end{definition}
Such algebras were studied by Albert who proved an important classification theorem.%
\begin{theorem}{Albert (1934\slash{}5).}{}{g:theorem:idm204346238288}%
Let \((D, ')\) be an Albert algebra, let \(K\) be the center of \(D\) and \(K_0\) the subfield fixed by \('\). Then we have the following classification%
\begin{enumerate}
\item{}Type I: \(D = K = K_0\) a totally real number field and \('\) is the identity.%
\item{}Type II: \(D\) is a quaternion algebra over \(K = K_0\) a totally real field, that is split at all infinite places and \('\) is defined by letting starting with the standard quaternion algebra conjugation for which \(x + x^* = \tr(x)\) and then letting \(x' = ax^* a^{-1}\) for some \(a \in D\) for which \(a^2 \in K\) and is totally negative.%
\item{}Type III: \(D\) is a quaternion algebra over \(K = K_0\) a totally real field, that is ramified at all infinite places and \('\) is the standard quaternion algebra conjugation as above.%
\item{}Type IV: \(D\) is a division algebra over a CM field \(K\) and \(K_0\) is the maximal totally real subfield. Additionally if \(v\) is a finite place with \(v = \bar v\) we have \(\operatorname{Inv}_v(D) = 0\) and \(\operatorname{Inv}_v(D) + \operatorname{Inv}_{\bar v}(D) = 0\) for all places \(v\).%
\end{enumerate}
%
\end{theorem}
There is a fascinating table in Mumford, page 200 or something.%
\par
As one might hope, changing the polarization does not change the type of the algebra + involution pair.%
\par
One might wonder which endomorphisms are invariant under this process? I.e. what is%
\begin{equation*}
\{f \in \End^0(A) : f^\dagger = f\}\text{.}
\end{equation*}
Equivalently, for which \(f\) is the dual given by conjugating by our polarization.%
\par
We can map%
\begin{equation*}
\QQ \otimes_\ZZ \NS(X) = \QQ \otimes_\ZZ \Pic X/\Pic^0 X \to \Hom(A, \hat A)
\end{equation*}
%
\begin{equation*}
\sheaf M \mapsto \phi_{\sheaf M}\text{,}
\end{equation*}
however we also have an isomorphism%
\begin{equation*}
\Hom^0(A, \hat A) \xrightarrow{\sim} \End^0(A)
\end{equation*}
%
\begin{equation*}
\phi \mapsto \lambda\inv \phi
\end{equation*}
for some fixed polarization \(\lambda\), hence we can view \(\NS(A)\otimes \QQ\) inside \(\End^0(A)\).%
\begin{proposition}{}{}{g:proposition:idm204346220384}%
Assume \(k\) algebraically closed. The image of%
\begin{equation*}
\QQ \otimes_\ZZ \NS(X) \to \End^0(A)
\end{equation*}
is the fixed subspace%
\begin{equation*}
\{f \in \End^0(A) : f^\dagger = f\}\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204346218528}
Fix \(\alpha \in \End^0(A)\) and \(l\ne \characteristic(k)\) odd. Applying \hyperref[x:proposition:prop-milne-av-13-6]{Proposition~\ref{x:proposition:prop-milne-av-13-6}} we see that \(\lambda \alpha = \phi_{\sheaf L}\) for some \(\sheaf L\) iff \(e^{\lambda\alpha}_l\) is skew-symmetric, but we also have%
\begin{equation*}
e_l^{\lambda\alpha}(a,a')=  e_l^{\lambda}(a,\alpha a') = -e_l^\lambda(\alpha a',a) = -e_l(a', \hat\alpha \lambda a)
\end{equation*}
for all \(a,a' \in V_lA\) this is the same as requiring \(\lambda\alpha = \hat \alpha \lambda\) i.e. \(\alpha = \alpha^\dagger\). .%
\end{proofptx}
Another cool result we can now prove (in fact this was the reason Weil introduced the notion of a polarization).%
\begin{theorem}{}{}{g:theorem:idm204346213200}%
The automorphism group of a polarized abelian variety is finite.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204346212608}
Let \(\alpha\) be an automorphism of \((A, \lambda)\) i.e. \(\lambda =\hat \alpha  \lambda \alpha\), then \(\alpha^\dagger \alpha= 1\) and so%
\begin{equation*}
\alpha \in \End(A)\cap \{\beta \in \End(A) \otimes \RR: \trace(\alpha^\dagger \alpha) = 2g\}
\end{equation*}
but \(\End(A)\) is discrete inside the compact RHS.%
\end{proofptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.12 Abelian Varieties over finite fields (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Abelian Varieties over finite fields (Ricky)}{}{Abelian Varieties over finite fields (Ricky)}{}{}{x:section:sec-avs-over-ffs}
Set \(q = p^m\), \(p\) prime. Given \(X/\FF_q\) have  geometric Frobenius \(\pi_X\colon X \to X\) which acts as \(\id\) on \(|X|\) and sends \(f\to f^q\) for \(f\in \sheaf O_X(U)\).%
\begin{example}{}{g:example:idm204346203600}%
\(X \hookrightarrow \PP^n\) then \(\pi_X(a_0:\cdots :a_n) = (a_0^q : \cdots :a_n^q)\).%
\end{example}
We also have absolute Frobenius%
\begin{equation*}
F\colon X\to X^{(p)}\text{.}
\end{equation*}
%
\begin{example}{}{g:example:idm204346201632}%
%
\begin{equation*}
X \colon y^2 = x^3 + i / \FF_q
\end{equation*}
%
\begin{equation*}
X^{(p)} \colon y^2 = x^3 + i^3 = x^3 - i / \FF_q
\end{equation*}
%
\end{example}
We see that \(X^{(p^m)} = X\) and \(F^m = \pi_X\).%
\begin{equation*}
\xymatrix{
X \ar[drr] \ar[dr]\ar[ddr] & &\\
& X^{(p)} \ar[d]\ar[r] & X\ar[d]\\
& \FF_q \ar[r]_p &\FF_q
}
\end{equation*}
%
\par
If \(f\colon X \to Y\) of \(\FF_q\)-schemes then \(\pi_Y \circ f = f\circ \pi_X\). Now let \(X\) be an abelian variety over \(\FF_q\). From above, we have \(\pi_X\) commutes with all elements of \(\End^0(X) = \End^0(X)\otimes \QQ\). Let \(f_X\) be the characteristic polynomial of \(T_l(\pi_X) \colon V_l(X) \to V_l(X)\) for \(l \ne p\).%
\par
An alternative definition is to take \(f_X\in \ZZ\lb X\rb\) monic of degree \(2g \), \(g = \dim X\) s.t.%
\begin{equation*}
f_X(n) = \deg([n] -\pi_X)\text{,}
\end{equation*}
see 12.8.%
\begin{proposition}{16.3.}{}{g:proposition:idm204346192528}%
Assume \(X\) is elementary, (i.e. its isogenous to \(A^n\) for some \(A\) simple). Then  \(\QQ\lb \pi_X\rb\subseteq \End^0(X)\) is a field and \(f_X\) is a power of the minimal polynomial of \(\pi_X\) over \(\QQ\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204346188736}
Since \(X\) is elementary \(Z(\End^0(X))\) is  a field containing \(\QQ\lb \pi_X\rb\). Let \(g\) be the minimal polynomial of \(\pi_X\) over \(\QQ\). Let \(\alpha\) be a root of \(f\). Then \(g(\alpha)\) is an eigenvalue of \(g(V_l(\pi_X)) = V_l(g(\pi_X)) = V_l(0) = 0\). Hence \(g(\alpha) = 0\).%
\end{proofptx}
\begin{theorem}{16.4.}{}{x:theorem:thm-milne-16-4}%
Let \(g= \dim (X)\).%
\begin{enumerate}
\item{}Every root of \(f_X\) \(\alpha \in \CC\) satisfies \(|\alpha| = q^{1/2}\).%
\item{}If \(\alpha\) is  a root of \(f_X\), then \(\bar \alpha\) with the same multiplicity. In particular if \(\alpha = \pm \sqrt q\) then it occurs with even multiplicity.%
\end{enumerate}
%
\end{theorem}
We need some facts before proving this: Ref 5.20, 5.21%
\begin{itemize}[label=\textbullet]
\item{}There exists%
\begin{equation*}
V\colon X^{(p)} \to X
\end{equation*}
such that%
\begin{equation*}
V\circ F = [p]_X
\end{equation*}
and%
\begin{equation*}
F \circ V = [p]_{X^{(p)}}\text{.}
\end{equation*}
Using \(\deg F = p^g \)  get \(\deg V = p^g\)%
\item{}By induction \(\lb p^m\rb = V^m \circ F^m\).%
\end{itemize}
%
\par
We also need some facts about \(F\) and \(V\) relative to \(X^\vee\).%
\begin{equation*}
F_X^\vee = V_{X^\vee} \colon (X^\vee)^{(p)} \to X^\vee
\end{equation*}
identifying \((X^\vee)^{(p)} = (X^{(p)})^\vee\), Ref 7.33, 7.34.%
\begin{proofptx}{}{g:proof:idm204346172896}
Reduce to the case where \(X\) is simple, we have%
\begin{equation*}
h\colon X\to X_1 \times X_2 \times \cdots \times X_s
\end{equation*}
an isogeny with \(X_i\) simple, then \(h\) induces an isomorphism%
\begin{equation*}
h\colon V_l(X)\xrightarrow{\sim} \bigoplus_i V_l(X_i)
\end{equation*}
so \(f_X = f_{X_1} \cdots f_{X_s}\). Hence we can assume \(X\) is simple.%
\par
Let \(\lambda \colon X \to X^\vee\) be a polarization of \(X\) and \(\dagger\) be the corresponding Rosati involution on \(\End^0(X)\) we will show that \(\pi_X\pi_X^\dagger = q\).%
\begin{equation*}
\pi_X \pi_X^\dagger = \pi_X \lambda^{-1} \pi_X^\vee \lambda = \lambda^{-1} \pi_{X^\vee} \pi_X^\vee \lambda = \lambda^{-1} \lb q \rb \lambda = \lb q \rb
\end{equation*}
To see \(\pi_{X^\vee} = \pi_X^\vee = q\) we use \(\pi_X = F^m\) and \(\pi_X^\vee = V^m \). So \(\pi_{X^\vee} \pi_X^\vee = F^MV^M = p^m = q\). As \(X\) is simple \(\QQ\lb \pi_X\rb\) is a field. Thus \(f_X\) is a power of \(g\), the minimal polynomial of \(\pi_X/\QQ\). So the complex roots of \(f_X\) are \(\iota(\pi_X)\)  for every embedding \(\QQ\lb \pi_X\rb\hookrightarrow \CC\). since \(\pi_X^\dagger = q/ \pi_X\), we see that%
\begin{equation*}
\QQ[\pi_X] \subseteq \End^0(X)
\end{equation*}
is stable under \(\dagger\). We have two cases for such a \(K = \QQ\lb \pi_X \rb \)%
\begin{enumerate}
\item{}\(K\) is  totally real and \(\dagger = \id\).%
\item{}\(K\) is a CM field and \(\dagger = \overline{\cdot}\).%
\end{enumerate}
hence we get%
\begin{equation*}
\iota(\pi_X\pi_X^\dagger) = \iota(\pi_X) \overline{\iota(\pi_X)} = q
\end{equation*}
for any \(\iota\colon K \to \CC\).%
\par
If \(\pm \sqrt q\) is  a root  of  \(f_X\) then we are in the case of \(K\) totally real. If \(\sqrt q\) has multiplicity \(n\). Then \(-\sqrt q\) has multiplicity \(2g-n\). Thus \(f_X(0) = (-1)^n   q^g\). But also \(f_X(0 ) = \deg(0 - \pi_X) = q^g\). Hence \(n \) is even.%
\end{proofptx}
\begin{paragraphs}{Honda-Tate.}{g:paragraphs:idm204346152240}%
The correspondence between isogeny classes of \(X/\FF_q\) and conjugacy classes of \(q\)-Weil numbers is a bijection. (i.e. algebraic integers \(\alpha\) s.t. \(|\iota \alpha| = \sqrt q\) for all \(\iota \colon \QQ(\alpha) \hookrightarrow \CC\)).%
\end{paragraphs}%
\par
Using relations between a curve \(C/\FF_q\) and its Jacobian \(J(C) \), one can show:%
\begin{theorem}{Hasse-Weil-Serre bound.}{}{g:theorem:idm204346148224}%
%
\begin{equation*}
q + 1 - g\lfloor 2\sqrt q\rfloor \le \#C(\FF_{q}) \le q + 1 + g\lfloor 2\sqrt q\rfloor
\end{equation*}
where \(g=  g(C)\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204346146656}
Hint: Use Lefschetz trace and \(H^1(C, \QQ_l) \simeq H^1(J(C) , \QQ_l)\).%
\end{proofptx}
Application: Let \(J = J_0(103) = J(X_0(103))\). \(J\sim J_+ \times J_-\).%
\begin{equation*}
J_{\pm} = \im(w \pm \id)
\end{equation*}
\(w\) Atkin-Lehner. \(\dim J = 8\) and \(\dim(J_-) = 6\). In fact \(\exists f\in  S_2( \Gamma_0(103))\) an eigenform s.t. if%
\begin{equation*}
f=\sum_{n\ge 1} a_n q^n
\end{equation*}
then \(\lb \QQ(a_n)_{n \ge 1}: \QQ\rb =6\) and \(\tr( F_{J_-,p};  T_l(J_-)) = \tr_{K/\QQ}(a_p)\)  for \(l \ne p, p\ne 103\) We can compute \(\tr_{K/\QQ} ( a_2) = 4\). This implies that \(J_- \times \FF_2\) is not the Jacobian of a curve \(/\FF_2\), if it were, then  if \(J_- \times \FF_2 = J(C)\) then via Lefschetz trace formula%
\begin{equation*}
\#C(\FF_2) = 2+1 - 4 = -1
\end{equation*}
similar thing at 17.%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.13 Tate's Isogeny Theorem (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{Tate's Isogeny Theorem (Sachi)}{}{Tate's Isogeny Theorem (Sachi)}{}{}{x:section:sec-tate-thm}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.1 The Theorem}
\typeout{************************************************}
%
\begin{subsectionptx}{The Theorem}{}{The Theorem}{}{}{g:subsection:idm204346137904}
\begin{theorem}{Tate.}{}{x:theorem:thm-tate-isog}%
Let \(A,B/\FF_q = k\), \(q = p^n\), \(l\ne p\) be abelian varieties and \(G = \Gal{k^s}{k}\), then%
\begin{equation*}
\Hom_{k}(A,B)\otimes \ZZ_l \to \Hom_G(T_l A, T_lB) = \Hom_{\ZZ_l}(T_lA,T_lB)^G
\end{equation*}
(where the \(G\) action on \(\Hom_{\ZZ_l}(T_l A, T_lB)\) is \((gf)(x) = gf(g^{-1}x)\)) is an isomorphism.%
\end{theorem}
\begin{remark}{}{g:remark:idm204346132992}%
Tate's theorem is also true for function fields over finite fields (Zarhin) and fields that are finitely generated over their prime field (Faltings), e.g. number fields. Not true over algebraically closed fields though.%
\end{remark}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.2 Motivation}
\typeout{************************************************}
%
\begin{subsectionptx}{Motivation}{}{Motivation}{}{}{g:subsection:idm204346132384}
Let \(\pi_A\) and \(\pi_B\) be the (relative) Frobenii on \(V_l(A), V_l(B)\)%
\begin{equation*}
\Hom_{k}(A,B)\otimes \QQ_l \to \Hom_G(V_l A, V_lB)
\end{equation*}
\(P_A,P_B\) characteristic polynomials of \(\pi_A,\pi_B\).%
\par
Toy Weil conjectures: \(P_A, P_B\) have \(\ZZ\)-coefficients, don't depend on the choice of \(l\). Provided that induced action of Frobenii are semisimple, we can find a number \(r(P_A,P_B)\) then Tate implies%
\begin{equation*}
r(P_A,P_B) = \dim_{\QQ_l} \Hom_G (V_l(A), V_l(B)) = \rank \Hom_k(A,B)
\end{equation*}
%
\begin{corollary}{}{}{g:corollary:idm204346127056}%
Let \(A, B\) be abelian varieties over \(\FF_q\) and \(P_A, P_B\) as above%
\begin{enumerate}
\item{}%
\begin{equation*}
\rank \Hom_k(A,B) = r(P_A,P_B)
\end{equation*}
%
\item{}TFAE%
\begin{enumerate}
\item{}\(B\) is \(k\)-isogenous to an abelian subvariety of \(A\)%
\item{}\(V_lB\) is \(G\)-isomorphic to a \(G\)-subrepresentation of \(V_lA\) for \(l \ne \characteristic k\)%
\item{}%
\begin{equation*}
P_B | P_A
\end{equation*}
%
\end{enumerate}
%
\end{enumerate}
we also have similar statements for equivalence, but get a nice statement about counting points over all extensions determining an abelian variety.%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204346120208}
%
\begin{equation*}
\alpha \colon V_l(B)\hookrightarrow V_l(A)
\end{equation*}
the surjectivity in Tate's theorem means we can choose \(u \in \Hom_k(B,A) \otimes \QQ_l\). \(V_l(u) = \alpha\). Choose \(u \in \Hom_k(B,A) \otimes \QQ\) arbitrarily close to \(\alpha\). Lower semicontinuity implies if \(V_l(u)\) is close enough to \(\alpha\), can ensure \(V_l(u)\) is injective (\(\ker (V_l (u)) = 0\)) take multiple to get \(u \in \Hom_k(B,A)\). Since \(T_l (u)\) is injective \(u \) is an isogeny to an abelian subvariety.%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.3 Isogeny category}
\typeout{************************************************}
%
\begin{subsectionptx}{Isogeny category}{}{Isogeny category}{}{}{g:subsection:idm204346114736}
Recall: The isogeny category, \hyperref[x:theorem:thm-poincare-reducibility]{Theorem~\ref{x:theorem:thm-poincare-reducibility}}, \hyperref[x:corollary:cor-ab-var-product-simple]{Corollary~\ref{x:corollary:cor-ab-var-product-simple}}. So we have  a category \(\cat{Isog}\) of abelian varieties with%
\begin{equation*}
\Hom_{\cat{Isog}}(A,B) = \Hom_\cat{AV}(A,B)\otimes \QQ\text{.}
\end{equation*}
Now if \(f \colon A \to B\) there exists \(g\colon B \to A\) an isogeny and \(n\in \ZZ_{\ge 1}\) s.t. \(gf = \lb n \rb\). So \(\frac 1n g\) is an inverse for \(f \in \cat{Isog}\) so isogenies are isomorphisms in \(\cat{Isog}\).%
\par
\(\cat{Isog}\) is a semisimple abelian category. The simples are simple abelian varieties.%
\begin{enumerate}
\item{}Decomposition up to isogeny into a product of simple abelian varieties is unique.%
\item{}If \(A\) is simple \(\End A \otimes \QQ\) is a division algebra over \(\QQ\). Reason: If \(A\) is simple in an abelian category, if \(\End A \supseteq k\) a field implies it's a division algebra.%
\end{enumerate}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.4 Reductions}
\typeout{************************************************}
%
\begin{subsectionptx}{Reductions}{}{Reductions}{}{}{g:subsection:idm204346105584}
\begin{lemma}{}{}{g:lemma:idm204346105184}%
%
\begin{enumerate}
\item{}%
\begin{equation*}
\ZZ_l \otimes \Hom_\cat{AV} (A,B) \to \Hom_H(T_l, T_lB)
\end{equation*}
is an isomorphism if and only if%
\begin{equation*}
\QQ_l \otimes \Hom_\cat{AV} (A,B) \to \Hom_G(V_l A, V_l B)
\end{equation*}
is an iso%
\item{}If for every \(C\),%
\begin{equation*}
\QQ_l \otimes \End_\cat{AV} (C) \to \End_G(V_l C)
\end{equation*}
is an isomorphism then the above is an isomorphism for every pair \(A,B\).%
\end{enumerate}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204346102016}
%
\begin{enumerate}
\item{}The first map is always injective, the cokernel is torsion free, hence free. It's an isomorphism if and only if \(\QQ_l \otimes \coker = 0\) As \(\QQ_l\) is flat over \(\ZZ_l\) the second map injective and its cokernel is \(\QQ_l \otimes\) the cokernel of the first map.%
\item{}%
\begin{equation*}
C = A\times B
\end{equation*}
then%
\begin{equation*}
\End^0(C) = \End^0(A)\oplus \Hom^0(A,B) \oplus \Hom^0(B,A) \oplus \End^0(B)
\end{equation*}
and%
\begin{equation*}
\End_G(V_lC) = \End_G(V_lA)\oplus \Hom_G(V_lA,V_lB) \oplus \Hom_G(V_lB,V_lA) \oplus \End_G(V_lB)
\end{equation*}
which the injection above preserves, in  particular if the last map is an isomorphism, so are the rest.%
\end{enumerate}
%
\end{proofptx}
One more reduction!%
\begin{equation*}
E_l = \End_k(A) \otimes \QQ_l\subseteq \End_{\QQ_l} (V_lA)
\end{equation*}
%
\begin{equation*}
F_l = \QQ_l[G] \subseteq \End_{\QQ_l} (V_lA)
\end{equation*}
automorphisms of \(V_l(A) \) coming from \(G\).%
\begin{note}{}{g:note:idm204346096032}%
\(E_l\) coming from \(k\)-rational endomorphisms commute with the Galois action%
\begin{equation*}
F_l\subseteq C_{\End_{\QQ_l}(V_l(A))}(E_l)
\end{equation*}
want equality.%
\end{note}
\begin{lemma}{}{}{g:lemma:idm204346094416}%
%
\begin{enumerate}
\item{}The last map of the reduction lemma is an isomorphism if and only if%
\begin{equation*}
C(C(E_l)) = \End_G(V_l(A))
\end{equation*}
%
\item{}If \(F_l\) is semisimple the map is an isomorphism if and only if%
\begin{equation*}
C(E_l) = F_l
\end{equation*}
%
\end{enumerate}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204346092304}
%
\begin{enumerate}
\item{}Double centralizer theorem, if \(E_l\) is semisimple then \(C(C(E_l))= E_l\). Poincaré reducibility implies%
\begin{equation*}
A\sim \prod A_i^{m_i}
\end{equation*}
%
\begin{equation*}
\End^0(A) = \End^0(\prod A_i^{m_i}) = \prod \Mat_{m_i}(\End^0(A_i))
\end{equation*}
a finite dimensional division algebra \(/\QQ\). A matrix algebra over a finite dimensional division algebra is semisimple.%
\item{}If \(F_l\) is semisimple%
\begin{equation*}
C(E_l) = F_l \iff E_l = C(C(E_l))
\end{equation*}
so%
\begin{equation*}
E_l = C(F_l) = \End_G(V_l(A))\text{.}\qedhere
\end{equation*}
%
\end{enumerate}
%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.5 Proof of Tate using finiteness}
\typeout{************************************************}
%
\begin{subsectionptx}{Proof of Tate using finiteness}{}{Proof of Tate using finiteness}{}{}{g:subsection:idm204346087952}
We introduce a hypothesis: \(\operatorname{Hyp}(k,A,l)\) there exist only finitely many (up to \(k\)-isomorphism) abelian varieties \(B\) s.t. there is a \(k\)-isogeny of \(l\)-power degree from \(B\to A\).%
\par
\(D =C(E_l)\) want that \(C(D) = \End_G(V_l(A))\) know \(C(D) \subseteq E_l \subseteq \End_G(V_l(A))\) want \(C(D) \supseteq \End_G(V_l(A))\). Let \(\alpha \in \End_G(V_l(A))\) show that it commutes with everything in \(D\). Equivalently let \(W\) be the graph of \(\alpha\)%
\begin{equation*}
W = \{(x,\alpha x) \in V_l(A)\times V_l(A)\} \subseteq V_l(A)\times V_l(A)
\end{equation*}
note \(g\in G\) then \(g\acts (x,\alpha x) = (gx,g\alpha x ) = (gx, \alpha(gx))\).%
\begin{equation*}
\alpha\in C(D) \iff \forall x\in V_l(A), d\in D
\end{equation*}
%
\begin{equation*}
\alpha d x = d\alpha x \iff (d\oplus d)W \subseteq W \forall d\in D
\end{equation*}
%
\begin{equation*}
W\ni (dx, d\alpha x) = (dx, \alpha d x)
\end{equation*}
%
\begin{lemma}{Technical lemma.}{}{g:lemma:idm204346079008}%
If \(W\subseteq V_l(A)\) is \(G\)-stable subspace then there exists \(u\in E_l\) s.t. \(u V_l(A) = W\).%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204346076544}
For \(n \in \ZZ_{\ge 0}\) let \(U_n = (W\cap T_l(A)) + l^n T_A\) which is a \(G\)-stable lattice in \(V_l A\),%
\begin{equation*}
l^nT_lA \subseteq U_n \subseteq T_l A
\end{equation*}
let \(\mathcal K_n \subseteq A\lb l^n \rb (k^s) = T_l A/ l^n T_l A\) be the image of \(U_n\). \(\mathcal K_n\) is stable under \(G\)-action on \(A\lb l^n \rb (k^s)\) which implies \(\mathcal K_n = K_n (k^s)\). Let \(\pi_n \colon A \to B_n = A/ K_n\), \(\iota_n \colon B_n \to A\) unique isogeny s.t.%
\begin{equation*}
\iota_n \circ \pi_n  =  \lb [l^n]_A
\end{equation*}
then \(T_lB \cong U_n\) as \(\ZZ_l\)-modules with \(G\)-action. As \(T_l(\iota_n) \colon U_n =T_l B  \to T_l A\) is the inclusion map. Assuming \(\operatorname{Hyp}(k,A,l)\) we can find \(n = n_1 \lt n_2 \lt \cdots\) s.t. we have%
\begin{equation*}
\alpha_i \colon B_n \xrightarrow{\sim} B_{n_i}
\end{equation*}
%
\begin{equation*}
\xymatrix{
B_n \ar[r]^{\alpha_i} & B_{n_i} \ar[d]_{\iota_{n_i}}\\
A\ar[u]_{\pi_n} \ar@{-->}_{u_i}[r] & A
}
\end{equation*}
\(u_i = \iota_{n_i} \circ \alpha_i \circ \pi_n\) is an endomorphism of \(A\) on Tate modules \(T_l(u_i)\) is induced map%
\begin{equation*}
T_l A \xrightarrow{[l^n]} U_n \xrightarrow{T_l\alpha_i} U_{n_i} \hookrightarrow T_l A
\end{equation*}
because \(\ZZ_l \otimes \End A\) is a free \(\ZZ_l\)-module of finite rank compact in \(l\)-adic topology subsequence of \(u_i \to u\) in \(\ZZ_l \otimes \End A\)%
\begin{equation*}
U_{n_1} \supseteq U_{n_2} \supseteq \cdots
\end{equation*}
the endomorphism of \(T_l u\) maps \(T_l A\) to \(\bigcap_{i=1}^\infty U_{n_i} = W\cap T_l A\) passing to \(\QQ_l\)-coefficients, note \(\QQ_l(W\cap T_l A) = \QQ_l(l^n(W\cap T_l A)) = W\) so \(\im(V_l(u)) =W\).%
\end{proofptx}
Why does the hypothesis hold.%
\begin{fact}{}{}{g:fact:idm204346059552}%
There exists a moduli space of \(d\)-polarised abelian varieties of \(\dim = g\) \(A_{g,d}\) which is a stack of finite type \(/k\).%
\end{fact}
%
\begin{equation*}
A_{g,d}( k) = \{(A,\lambda) : A , \lambda \colon A \to A^\vee,\ \deg d \}
\end{equation*}
Zahrin's trick: \(A\) abelian variety \((A\times A^\vee)^4\) is principally polarized. Finiteness of direct factors \(B\subseteq A\) \(A\simeq B\times C\).%
\begin{corollary}{}{}{g:corollary:idm204346055088}%
If \(k = \FF_q\) exists only finitely many isogeny classes of abelian varieties of \(\dim g\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204346053696}
\(A\) is a direct factor \((A\times A^\vee)^4 \in A_{8g,1}\).%
\end{proofptx}
\begin{proofptx}{}{g:proof:idm204346052608}
of Tate.%
\par
Apply technical lemma to \(V_l(A\times A)\) and \(W\) so%
\begin{equation*}
(d\oplus d) W = (d \oplus d) uV_l(A\times A) = u(d\oplus d) V_l(A\times A) \subseteq uV_l(A\times A) = W
\end{equation*}
%
\begin{equation*}
\implies C(D) \supseteq \End_G(V_l(A))\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.14 The Honda Tate Theorem (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{The Honda Tate Theorem (Angus)}{}{The Honda Tate Theorem (Angus)}{}{}{x:section:sec-honda-tate}
\begin{introduction}{}%
\(q = p^n\), \(A\) a simple abelian variety over \(\FF_q\), \(\pi_A\) the frobenius on \(A\), \(\End^0(A) = \QQ\otimes \End(A)\), \(f_A\) is the charpoly of \(A\) (i.e. of \(\pi_A\)).%
\begin{fact}{}{}{g:fact:idm204346045680}%
%
\begin{itemize}[label=\textbullet]
\item{}\(\End^0(A)\) is a division ring.%
\item{}\(\QQ\lb \pi\rb\) is a field.%
\item{}\(\displaystyle Z(\End^0(A)) = \QQ\lb \pi_A\rb\)%
\end{itemize}
%
\end{fact}
\begin{lemma}{The Weil Conjectures.}{}{g:lemma:idm204346043648}%
The roots of \(f_A\) all have absolute value \(\sqrt q\). Alternatively, under all embeddings%
\begin{equation*}
\iota \colon \QQ\lb \pi_A\rb \hookrightarrow \CC,\,|\iota(\pi_A)| = \sqrt q\text{.}
\end{equation*}
%
\end{lemma}
\begin{definition}{\(q\)-Weil numbers.}{g:definition:idm204346041504}%
A \(q\)-\terminology{Weil number} is an algebraic integer \(\pi\) s.t.%
\begin{equation*}
\forall \iota \colon \QQ\lb \pi\rb \hookrightarrow \CC,\,|\iota(\pi)| = \sqrt q
\end{equation*}
we say that two \(q\)-Weil numbers are conjugate if they have the same minimal polynomial over \(\QQ\), and write \(\pi \sim \pi'\).%
\end{definition}
From the facts so far we have a map%
\begin{equation*}
\{\text{simple AVs}/\FF_q\}\to \{q\text{-Weil numbers}\}
\end{equation*}
%
\begin{equation*}
A \mapsto \pi_A
\end{equation*}
%
\begin{theorem}{}{}{g:theorem:idm204346036592}%
We have a bijection%
\begin{equation*}
\{\text{isogeny classes of simple AVs}/\FF_q\}\xrightarrow{\sim} \{\text{conjugacy classes of }q\text{-Weil numbers}\}
\end{equation*}
%
\begin{equation*}
A \mapsto \pi_A\text{.}
\end{equation*}
%
\end{theorem}
We need to show this is well-defined, injectivity and surjectivity.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.14.1 Honda-Tate map}
\typeout{************************************************}
%
\begin{subsectionptx}{Honda-Tate map}{}{Honda-Tate map}{}{}{g:subsection:idm204346034928}
Recall:%
\begin{corollary}{}{}{g:corollary:idm204346034256}%
Let \(A,B\) be abelian varieties over \(\FF_q\) with rational Tate modules \(V_l A, V_lB\) then%
\begin{equation*}
A\sim_{\text{isog}} B \iff V_l A \simeq V_l B \forall l \ne p\text{.}
\end{equation*}
%
\end{corollary}
\begin{corollary}{}{}{g:corollary:idm204346032016}%
%
\begin{equation*}
A\sim_{\text{isog}} B \iff f_A = f_B
\end{equation*}
%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204346031328}
By above \(V_l A \simeq V_lB\) for all \(l \ne p\) but \(f_A\) (resp. \(f_B\)) is the charpoly of \(\pi_a\) (\(\pi_B\)) on \(V_l A\) (\(V_l(B)\)).%
\par
The Galois modules \(V_lA\) and \(V_l B\) are semisimple. The Brauer-Nesbitt theorem says \(f_A = f_B \implies V_lA \simeq V_lB \) for \(l\ne p\).%
\end{proofptx}
Recalling that \(f_A\) is a power of the minimal polynomial of \(\pi_A\),%
\begin{equation*}
A \sim_{\text{isog}} B\implies  f_A =f_B \implies \pi_A \sim \pi_B\text{.}
\end{equation*}
So the Honda-Tate map is well defined.%
\par
This doesn't quite give injectivity because a priori \(f_A\) and \(f_B\) could be powers of the minpolys of \(\pi_A, \pi_B\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.14.2 Injectivity and Brauer groups}
\typeout{************************************************}
%
\begin{subsectionptx}{Injectivity and Brauer groups}{}{Injectivity and Brauer groups}{}{}{g:subsection:idm204346022320}
From last time:%
\begin{proposition}{}{}{g:proposition:idm204346021632}%
There exists a certain quantity \(r(f_A, f_B)\) such that%
\begin{equation*}
r(f_A, f_B) = \rank \Hom(A,B)\text{.}
\end{equation*}
%
\end{proposition}
\begin{corollary}{}{}{g:corollary:idm204346020240}%
Let \(d = \lb \End^0(A) : \QQ(\pi_A) \rb^{1/2}\), let \(h_A = \operatorname{minpoly}_\QQ(\pi_A)\) then \(f_A = h_A^d\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204346018416}
Study the formula for \(r(f_A, f_A)\) Edixhoven-van der Geer-Moonen 16.22.%
\end{proofptx}
So the next step is to try and recover \(\End^0(A)\) from \(\pi\).%
\begin{definition}{Central simple algebras.}{x:definition:def-abvar-csa}%
A \terminology{central simple algebra} \(B/k\) is a \(k\)-algebra \(B\) with no two-sided ideals and \(Z(B) = k\).%
\end{definition}
\begin{theorem}{Artin-Wedderburn.}{}{g:theorem:idm204346013264}%
Any such algebra is isomorphic to \(M_n(D)\) for \(D\) a division ring over \(k\).%
\end{theorem}
\begin{definition}{Brauer groups.}{x:definition:def-brauer-gp}%
The \terminology{Brauer group} of \(k\) \(\operatorname{Br}(k)\) is the set of central simple algebras under \(\otimes\) modulo the algebras \(M_n(k)\).%
\end{definition}
\begin{fact}{}{}{g:fact:idm204346008000}%
%
\begin{itemize}[label=\textbullet]
\item{}If \(k = \overline k\), \(\operatorname{Br}(k) = 0\).%
\item{}\(k\) complete nonarchimidean \(\operatorname{Br}(k) = \QQ/\ZZ\)%
\item{}\(\displaystyle \operatorname{Br}(\RR) = \ZZ/2\ZZ\)%
\end{itemize}
Given a place \(v\) of \(k\) we get a map%
\begin{equation*}
\operatorname{Br}(k) \to \operatorname{Br}(k_v)
\end{equation*}
%
\begin{equation*}
D \mapsto D\otimes k_v
\end{equation*}
in fact we get an injection%
\begin{equation*}
\operatorname{Br}(k) \hookrightarrow \prod_v \operatorname{Br}(k_v) \simeq \prod_{v\text{ nonarch}} \QQ/\ZZ \times \prod_{v\text{ real}} \ZZ/2\ZZ
\end{equation*}
%
\begin{equation*}
D\mapsto (\operatorname{inv}_v(D))_v
\end{equation*}
these \(\operatorname{inv}_v(D)\) are called the \terminology{local invariants}.%
\end{fact}
\begin{proposition}{}{}{x:proposition:prop-elem-av-local-invs}%
Let \(A/\FF_q\) be an elementary abelian variety. Let \(K = \QQ(\pi_A)\) then%
\begin{equation*}
\operatorname{inv}_v(\End^0(A)) = \begin{cases} \frac{v(\pi_A)}{v(q)} [k_v: \QQ_p], \amp v|p\\ \frac 12,\amp v\text{ real}\\ 0, \amp \text{else}\end{cases}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345999552}
Edixhoven-van der Geer-Moonen 16.30.%
\end{proofptx}
\begin{proposition}{}{}{g:proposition:idm204345999120}%
Let \(d= \lb \End^0(A) : \QQ(\pi_A) \rb^{1/2}\) then \(d\) is the least common denominator of all the \(\operatorname{inv}_v(\End^0(A))\).%
\end{proposition}
\begin{corollary}{}{}{g:corollary:idm204345997328}%
%
\begin{equation*}
\pi_A\sim \pi_B \iff f_A = f_B\text{.}
\end{equation*}
%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204345996528}
\(\Leftarrow\) done.%
\par
\(\Rightarrow\) Let \(D_{\pi_A} , D_{\pi_B}\) be the division rings with invariants specified as in \hyperref[x:proposition:prop-elem-av-local-invs]{Proposition~\ref{x:proposition:prop-elem-av-local-invs}}. \(\pi_A\sim \pi_B \implies D_{\pi_A} \simeq D_{\pi_B} \implies f_A = \operatorname{minpoly}(\pi_A) ^d = f_B\).%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.14.3 Surjectivity and CM theory}
\typeout{************************************************}
%
\begin{subsectionptx}{Surjectivity and CM theory}{}{Surjectivity and CM theory}{}{}{g:subsection:idm204345993824}
We need to show that for \(\pi\) a \(q\)-Weil number there exists an abelian variety \(A/\FF_q\) such that \(\pi_A \sim \pi\).%
\begin{definition}{}{g:definition:idm204345991488}%
Such a \(q\)-Weil number \(\pi\) is called effective.%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204345990144}%
A \(q\)-Weil number \(\pi\) is effective if and only if \(\pi^N\) is effective for some \(N\in \ZZ_{\ge 1}\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345987968}
\(\Rightarrow\) clear.%
\par
\(\Leftarrow\) By assumption we have \(A'/k\) a simple abelian variety s.t. \(\pi_{A'} \sim  \pi^N\) for \(k\) a degree \(N\) extension of \(\FF_q\). Let%
\begin{equation*}
A = \Res_{k/\FF_q}(A')
\end{equation*}
on the rational Tate modules we have%
\begin{equation*}
V_l A = \Ind_{G_k}^{G_{\FF_q}} (V_lA')
\end{equation*}
where%
\begin{equation*}
G_k = \Gal{\overline{\FF_q}}{k}
\end{equation*}
%
\begin{equation*}
G_{\FF_q} = \Gal{\overline{\FF_q}}{\FF_q}
\end{equation*}
since \(G_k\), \(G_{\FF_q}\) are abelian, by studying the induced action, one can see%
\begin{equation*}
\Ind_{G_k}^{G_{\FF_q}} (\pi_{A'}) = \pi_A^N
\end{equation*}
in particular \(f_A(T) = f_{A'}(T^N)\). Choosing a simple factor \(A_i\) one gets \(\pi_{A_i} \sim \pi\).%
\end{proofptx}
So it is sufficient to show \(\pi^N\) is effective.%
\par
Strategy for proving surjectivity%
\begin{enumerate}
\item{}Construct a division algebra \(D_\pi\).%
\item{}Choose a CM field \(L\) splitting \(D_\pi\).%
\item{}Find an abelian variety \(A/\CC\) of type \((L, \Phi)\).%
\item{}In fact \(A\) is defined over  a number field \(K\) and has good reduction at \(v|p\).%
\item{}Apply the Shimura-Taniyama formula to relate \(\pi_A\) to \(\Phi\).%
\item{}Choose \(\Phi\) wisely (in retrospect in 3) to relate \(\pi\) to \(\pi_A\).%
\item{}Show \(\pi_A^N = \pi^{N'}\).%
\end{enumerate}
%
\par
\(D_\pi\) is given by the invariants described by \(\pi\) (and \(K = \QQ(\pi)\)).%
\begin{proposition}{}{}{g:proposition:idm204345970048}%
There exists a CM field \(L/\QQ(\pi)\) such that \(L\) splits \(D_\pi\) and further%
\begin{equation*}
[L:\QQ(\pi) ] = [ D_\pi: \QQ(\pi)]^{1/2}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345967968}
Two cases:%
\begin{enumerate}
\item{}\(\QQ(\pi)\) is totally real, in which case \(\QQ(\pi) = \QQ\) or \(\QQ(\sqrt{p})\).%
\item{}\(\QQ(\pi)\) is a CM field with totally real subfield \(\QQ(\pi + q/\pi)\).%
\end{enumerate}
In the case%
\begin{enumerate}
\item{}Choose \(L = \QQ(\pi)(\sqrt{-p})\).%
\item{}Let \(d= \lb D_\pi: \QQ(\pi)\rb^{1/2}\). This \(L\) splits \(D_\pi\).%
\end{enumerate}
%
\end{proofptx}
\begin{definition}{CM types.}{x:definition:def-cm-type}%
For a CM field \(L\) all the embeddings%
\begin{equation*}
\iota\colon L \hookrightarrow \CC
\end{equation*}
come in complex conjugate pairs, choosing an embedding for each pair defines a subset \(\Phi\subseteq \Hom(L, \CC)\) such that%
\begin{equation*}
\Phi \cup \overline \Phi = \Hom(L,\CC)
\end{equation*}
%
\begin{equation*}
\Phi \cap \overline \Phi = \emptyset
\end{equation*}
such a choice of \(\Phi \) is called a \terminology{CM type}.%
\end{definition}
Let \(A/\CC\) be an abelian variety with CM by \(L\) i.e.%
\begin{equation*}
L\hookrightarrow \End^0(A)
\end{equation*}
then%
\begin{equation*}
\CC\otimes L = \prod_\iota \CC
\end{equation*}
acts on the tangent space at the origin \(\Lie(A)\).%
\begin{proposition}{}{}{g:proposition:idm204345956112}%
The action of \(\CC\otimes L\) factors through the quotient \(\prod_{\iota\in \Phi} \CC\) for some CM type \(\Phi\). We then say \(A/\CC\) is of type \((L,\Phi)\).%
\end{proposition}
\begin{theorem}{}{}{g:theorem:idm204345953472}%
For any CM type \((L,\Phi)\) there exists an abelian variety \(A/\CC\) of type \((L, \Phi)\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345951664}
Found in Shimura-Taniyama.%
\end{proofptx}
The fact that \(A\) is in fact defined over  a number field \(K\) is also in Shimura-Taniyama.%
\begin{theorem}{}{}{g:theorem:idm204345950128}%
Let \(A/K\) be an abelian variety which admits CM. Then \(A/K\) admits potentially good reduction at all places \(v\) of \(K\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345947904}
Highly nontrivial, Neron models, Chevalley decomposition, Neron-Ogg-Shafarevich criterion, result of Grothendieck on potentially stable reduction.%
\end{proofptx}
After passing to a finite extension we will assume \(A/K\) has good reduction at places \(v|p\). So we have a reduction \(A_{\FF_{q'}}/\FF_{q'}\). For a place \(w|p\) of \(L\) let%
\begin{equation*}
\Sigma_w = \Hom(L_w, \CC_p)
\end{equation*}
%
\begin{equation*}
\Phi_w = \Phi \cap \Sigma_w\text{.}
\end{equation*}
%
\begin{theorem}{Shimura-Taniyama formula.}{}{g:theorem:idm204345944272}%
For all places \(w|p\) of \(L\),%
\begin{equation*}
\frac{w(\pi_{A_{\FF_{q'}}})}{w(q')} = \frac{\#\Phi_w}{\#\Sigma_w}
\end{equation*}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345942336}
Tate has a proof using CM theory of \(p\)-divisible groups.%
\end{proofptx}
Recall we fixed \(\pi\) and from this we deterministically formed \(\QQ(\pi), D_{\pi}, L\) however we have no restriction on our choice of \(\Phi\).%
\begin{lemma}{}{}{g:lemma:idm204345939888}%
We can choose \(\Phi\) such that for all places \(w|p\) of \(L\),%
\begin{equation*}
\frac{w(\pi)}{w(q)} = \frac{\#\Phi_w}{\#\Sigma_w}
\end{equation*}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204345937824}
Let \(v = w|_{\QQ(\pi)}\) be the place of \(\QQ(\pi)\) below \(w\). Let%
\begin{equation*}
n_w = \frac{w(\pi)}{w(q)}\#\Sigma_w = \frac{w(\pi)}{w(q)}[L_w :\QQ_p]
\end{equation*}
%
\begin{equation*}
= \frac{w(\pi)}{w(q)}[L_w :\QQ(\pi)_v ][ \QQ(\pi)_v:\QQ_p]
\end{equation*}
by recalling the formula for the local invariants of \(D_\pi\) we get%
\begin{equation*}
n_w = \operatorname{inv}_w(D_\pi\otimes_{\QQ(\pi)} L)\text{.}
\end{equation*}
But \(L\) splits \(D_\pi\) so \(n_w \in \ZZ\), further%
\begin{equation*}
n_w + n_{\overline w} = \left( \frac{w(\pi)}{w(q)}  + \frac{\overline w(\pi)}{\overline w(q)} \right) \#\Sigma_w
\end{equation*}
%
\begin{equation*}
= \left( \frac{w(\pi\overline \pi)}{w(q)} \right) \#\Sigma_w = \#\Sigma_w
\end{equation*}
check the CM type \(\Phi = \bigcup_w \Phi_w\) where for each \(w\) \(\# \Phi_w = n_w\). Then the formula follows.%
\end{proofptx}
Combining the previous result with the Shimura-Taniyama formula we get that for all places \(w|p\)%
\begin{equation*}
\frac{w(\pi_{A_{\FF_{q'}}})}{w(q')} = \frac{w(\pi)}{w(q)}\text{.}
\end{equation*}
Taking the correct power,%
\begin{equation*}
w\left( \frac {\pi^m_{A_{\FF_{q'}}}}{\pi^{m'}}\right) = 0 \forall w|p
\end{equation*}
%
\begin{equation*}
\pi,\pi_{A_{\FF_{q'}}}|q^{m'}
\end{equation*}
%
\begin{equation*}
\implies w(\cdots) = 0 \forall w \nmid p
\end{equation*}
since \(|\pi^{m'}|_w = |\pi_{A_{\FF_{q'}}}^m|_w = (q^{m'})^{1/2} \forall \text{ infinite places}\)%
\begin{equation*}
\pi_{A_{\FF_{q'}}}/ \pi_A^{m'}
\end{equation*}
is a root of unity \(\pi^N_{A_{\FF_{q'}}} = \pi^{N'}\).%
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 2 Dessins d'Enfants}
\typeout{************************************************}
%
\begin{chapterptx}{Dessins d'Enfants}{}{Dessins d'Enfants}{}{}{x:chapter:chapter-dessins}
\begin{introduction}{}%
These are notes for BUNTES Spring 2018, the topic is Dessins d'Enfants, they were last updated January 29, 2020. For more details see \href{http://math.bu.edu/people/angusmca/buntes/spring2018.html}{the webpage}. These notes are by Alex, feel free to email me at \href{mailto:alex.j.best@gmail.com}{\nolinkurl{alex.j.best@gmail.com}} to report typos\slash{}suggest improvements, I'll be forever grateful.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 2.1 Overview (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Overview (Angus)}{}{Overview (Angus)}{}{}{x:section:sec-dessins-overview}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.1 Belyi morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Belyi morphisms}{}{Belyi morphisms}{}{}{g:subsection:idm204345924144}
Let \(X\) be an algebraic curve over \(\CC\) (i.e. a compact Riemann surface) when is \(X\) defined over \(\overline \QQ\)?%
\begin{theorem}{Belyi.}{}{g:theorem:idm204345921824}%
An algebraic curve \(X/\CC\) is defined over \(\overline \QQ \iff\) there exists a morphism \(\beta \colon X \to \PP^1 \CC\) ramified only over \(\{0,1,\infty\}\).%
\end{theorem}
\begin{definition}{Ramified.}{x:definition:def-dess-ramified}%
(AG) A morphism \(f \colon X \to Y\) is \terminology{ramified} at \(x \in X\) if on local rings the induced map \(f^\# \colon \sheaf O_{Y,f(x)} \to \sheaf O_{X,x}\) descended to%
\begin{equation*}
\sheaf O_{Y,f(x)}/\ideal m \to \sheaf O_{X,x}/ f^\#(\ideal m)
\end{equation*}
is not a finite separable field extension.%
\par
(RS) A morphism \(f \colon X \to Y\) is ramified at \(x \in X\) if there are charts around \(x\) and \(f(x)\) such that \(f(x) = x^n\). This \(n\) is the \terminology{ramification index}.%
\end{definition}
\begin{definition}{Belyi morphisms.}{x:definition:def-belyi-morphism}%
A \terminology{Belyi morphism} is one ramified only over \(\{0,1,\infty\}\)%
\par
A \terminology{clean Belyi morphism} or \terminology{pure Belyi morphism} is a Belyi morphism where the ramification indices over 1 are all exactly 2.%
\end{definition}
\begin{lemma}{}{}{g:lemma:idm204345909600}%
A curve \(X\) admits a Belyi morphism iff it admits a clean Belyi morphism.%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204345908624}
If \(\alpha \colon X\to \PP^1 \CC\) is Belyi, then \(\beta = 4\alpha(1-\alpha)\) is a clean Belyi morphism.%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.2 Dessin d'Enfants}
\typeout{************************************************}
%
\begin{subsectionptx}{Dessin d'Enfants}{}{Dessin d'Enfants}{}{}{g:subsection:idm204345907344}
\begin{definition}{}{x:definition:def-dessin-denfant}%
A \terminology{dessin d'Enfant} (or Grothendieck Dessin or just \terminology{Dessin}) is a triple \((X_0,X_1,X_2)\) where \(X_2\) is a compact Riemann surface, \(X_1\) is a graph, \(X_0 \subset X_1\) is a finite set of points, where \(X_2 \smallsetminus X_1\) is a collection of open cells. \(X_1 \smallsetminus X_0\) is a disjoint union of line segments%
\end{definition}
\begin{lemma}{}{}{g:lemma:idm204345902544}%
The data of a dessin is equivalent to a graph with an ordering on the edges coming out of each vertex.%
\end{lemma}
\begin{definition}{Clean dessins.}{x:definition:def-clean-dessin}%
A \terminology{clean dessin} is a dessin with a colouring (white and black) on the vertices such that adjacent vertices do not share a colour.%
\end{definition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.3 The Grothendieck correspondence}
\typeout{************************************************}
%
\begin{subsectionptx}{The Grothendieck correspondence}{}{The Grothendieck correspondence}{}{}{g:subsection:idm204345900240}
Given a Belyi morphism \(\beta\colon X \to \PP^1 \CC\) the graph \(\beta^{-1}(\lb 0,1\rb)\) defines a dessin.%
\begin{theorem}{}{}{g:theorem:idm204345898688}%
The map%
\begin{equation*}
\{\text{(Clean) Belyi morphisms}\} \to \{\text{(clean) dessins}\}
\end{equation*}
%
\begin{equation*}
\beta \mapsto \beta\inv([0,1])
\end{equation*}
is a bijection up to isomorphisms.%
\end{theorem}
\begin{example}{}{g:example:idm204345897360}%
%
\begin{equation*}
\PP^1 \CC\to \PP^1\CC
\end{equation*}
%
\begin{equation*}
x\mapsto x^3
\end{equation*}
%
\par
%
\begin{equation*}
\PP^1 \CC\to \PP^1\CC
\end{equation*}
%
\begin{equation*}
x\mapsto x^3 + 1
\end{equation*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.4 Covering spaces and Galois groups}
\typeout{************************************************}
%
\begin{subsectionptx}{Covering spaces and Galois groups}{}{Covering spaces and Galois groups}{}{}{g:subsection:idm204345895072}
A Belyi morphism defines a covering map.%
\begin{equation*}
\tilde \beta\colon \tilde X \to \PP^1 \CC\smallsetminus \{0,1,\infty\}
\end{equation*}
the coverings are controlled by the profinite completion of%
\begin{equation*}
\pi_1 (\PP^1 \CC\smallsetminus \{0,1,\infty\}) = \ZZ * \ZZ = F_2\text{.}
\end{equation*}
%
\begin{theorem}{}{}{g:theorem:idm204345892864}%
There is a faithful action%
\begin{equation*}
\absgal\QQ \acts \hat\pi_1 (\PP^1 \CC\smallsetminus \{0,1,\infty\})
\end{equation*}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345892016}
By Belyi's theorem every elliptic curve \(E/\overline \QQ\) admits a Belyi morphism. For each \(j \in \overline\QQ\) there exists an elliptic curve \(E_j/\overline \QQ\) with \(j\)-invariant \(j\).%
\par
Given \(\sigma \in \absgal{\QQ}\),%
\begin{equation*}
\sigma(E_j) = E(\sigma(j))
\end{equation*}
assume \(\sigma \mapsto 1\),%
\begin{equation*}
E_j \cong E_{\sigma(j)}\ \forall j
\end{equation*}
%
\begin{equation*}
j = \sigma(j) \ \forall j
\end{equation*}
a contradiction.%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204345887200}%
We have a faithful action of \(\absgal{\QQ}\) on dessins.%
\end{corollary}
\begin{theorem}{}{}{g:theorem:idm204345886240}%
We have a faithful action of \(\absgal{\QQ}\) on the set of dessins of any fixed genus.%
\end{theorem}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.5 Exercises}
\typeout{************************************************}
%
\begin{subsectionptx}{Exercises}{}{Exercises}{}{}{g:subsection:idm204345885248}
\begin{inlineexercise}{}{g:exercise:idm204345884848}%
Compute the Dessins for the following Belyi morphisms%
\begin{enumerate}
\item{}%
\begin{equation*}
\PP^1\CC\to \PP^1\CC,\,x\mapsto x^4
\end{equation*}
%
\item{}%
\begin{equation*}
\PP^1\CC\to \PP^1\CC,\,x\mapsto x^2(3-2x)
\end{equation*}
%
\item{}%
\begin{equation*}
\PP^1\CC\to \PP^1\CC,\,x\mapsto \frac{1}{x(2-x)}
\end{equation*}
%
\end{enumerate}
%
\end{inlineexercise}
\begin{inlineexercise}{}{g:exercise:idm204345882832}%
Give an alternate proof of the fact that \(X\) admits a Belyi morphism if and only if it admits a clean Belyi morphism using dessins and the Grothendieck correspondence.%
\end{inlineexercise}
\begin{inlineexercise}{}{g:exercise:idm204345881760}%
Prove that a Belyi morphism corresponding to a tree, that sends \(\infty\) to \(\infty\) is a polynomial.%
\end{inlineexercise}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.2 Riemann Surfaces I (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Riemann Surfaces I (Ricky)}{}{Riemann Surfaces I (Ricky)}{}{}{x:section:sec-dessins-riemann-surfaces}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.1 Definitions}
\typeout{************************************************}
%
\begin{subsectionptx}{Definitions}{}{Definitions}{}{}{g:subsection:idm204345879536}
\begin{definition}{}{x:definition:def-top-riem-surface}%
A \terminology{topological surface} is a Hausdorff space \(X\) wich has a collection of charts%
\begin{equation*}
\{\phi_i \colon U_i \xrightarrow\sim \phi_i(U_i) \subseteq \CC,\,\text{open}\}_{i\in I}
\end{equation*}
such that%
\begin{equation*}
X= \bigcup_{i\in I} U_i\text{.}
\end{equation*}
We call \(X\) a \terminology{Riemann surface} if the transition functions \(\phi_i\circ \phi_j^{-1}\) are holomorphic.%
\end{definition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.2 Examples}
\typeout{************************************************}
%
\begin{subsectionptx}{Examples}{}{Examples}{}{}{g:subsection:idm204345875184}
\begin{example}{}{g:example:idm204345874784}%
Open subsets of \(\CC\), e.g.%
\begin{equation*}
\CC
\end{equation*}
%
\begin{equation*}
\mathbf D = \{z\in \CC : |z| \lt 1 \}
\end{equation*}
%
\begin{equation*}
\HH = \{z\in \CC : \im z \gt 0 \}\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204345872848}%
\(\hat \CC = \) Riemann sphere \(= \CC\cup \{\infty\}\). A basis of neighborhoods of \(\infty\) is given by%
\begin{equation*}
\{z\in \CC : |z| \gt R \} \cup \{\infty\}\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204345870736}%
%
\begin{equation*}
\PP^1(\CC )= \{ [z_0 :z_1 ] : (z_0,z_1) \ne (0,0)\}
\end{equation*}
%
\begin{equation*}
U_0 =\{[z_0,z_1] : z_0 \ne 0\}\to \CC
\end{equation*}
%
\begin{equation*}
[z_0:z_1] \mapsto \frac{z_1}{z_0}
\end{equation*}
%
\begin{equation*}
U_1 =\{[z_0,z_1] : z_1 \ne 0\}\to \CC
\end{equation*}
%
\begin{equation*}
[z_0:z_1] \mapsto \frac{z_0}{z_1}\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204345868688}%
Let \(\Lambda = \ZZ \oplus \ZZ i \subseteq \CC\) then \(X = \CC/\Lambda\) is a Riemann surface.%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.3 Morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Morphisms}{}{Morphisms}{}{}{g:subsection:idm204345867280}
\begin{definition}{(Holo\slash{}Mero)-morphisms of Riemann surfaces.}{x:definition:def-morph-riem-surf}%
A \terminology{morphism of Riemann surfaces} is a continuous map%
\begin{equation*}
f\colon S\to S'
\end{equation*}
such that for all charts \(\phi, \psi\) on  \(S, S'\) respectively we have \(\psi \circ f \circ \phi\inv\) is holomorphic.%
\par
We call a morphism \(f\colon S\to \CC\) a \terminology{holomorphic function} on \(S\).%
\par
We say \(f \colon S \to \CC\) is a \terminology{meromorphic function} is \(f\circ \phi\inv\) is meromorphic.%
\end{definition}
\begin{inlineexercise}{}{g:exercise:idm204345860384}%
The set of meromorphic functions on a Riemann surface form a field.%
\end{inlineexercise}
We denote the field of meromorphic functions by \(\mathcal M (S)\).%
\begin{proposition}{1.26.}{}{g:proposition:idm204345859072}%
%
\begin{equation*}
\mathcal M(\hat \CC) = \CC(z)\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345858000}
Let \(f\colon \hat\CC \to \CC\) be meromorphic. Then the number of poles of \(f\) is finite say at \(a_1, \ldots, a_n\). So, locally at  \(a_i\) we can write%
\begin{equation*}
f(z) = \sum_{j=1}^{j_i} \frac{\lambda_{j,i}}{(z-a_i)^j} + h_i(z)
\end{equation*}
with \(h_i\) holomorphic. Then%
\begin{equation*}
f(z) - \sum_{i=1}^n \sum_{j=1}^{j_i} \frac{\lambda_{j,i}}{(z-a_i)^j}
\end{equation*}
is holomorphic everywhere. By Liouville's theorem this is constant.%
\end{proofptx}
We say \(S,S'\) are isomorphic if \(\exists f\colon S\to S'\), \(g\colon S'\to S\) morphisms such that \(f\circ g = \id_{S'}\), \(g\circ f = \id_{S}\).%
\begin{inlineexercise}{}{g:exercise:idm204345852048}%
Show that%
\begin{equation*}
\hat \CC \simeq \PP^1(\CC)\text{.}
\end{equation*}
%
\end{inlineexercise}
\begin{remark}{}{g:remark:idm204345851104}%
\(\CC \not\simeq \mathbf D\) by Liouville.%
\par
If \(S, S'\) are connected compact Riemann surfaces, then any nonconstant morphism \(f\colon S \to S'\) is surjective. (Nonconstant holomorphic maps are open)%
\end{remark}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.4 Ramification}
\typeout{************************************************}
%
\begin{subsectionptx}{Ramification}{}{Ramification}{}{}{g:subsection:idm204345849200}
\begin{definition}{Orders of vanishing.}{x:definition:def-riem-order-vanish}%
The \terminology{order of vanishing} at \(P\in S\) of a holomorphic function on \(S\) is defined as follows: For \(\phi\) a  chart centered at \(P\) write%
\begin{equation*}
f\circ \phi\inv (z) = a_n z^n + a_{n+1}z^{n+1} + \cdots,\,a_n\ne 0
\end{equation*}
then \(\ord_P(f) = n\).%
\par
More generally, for \(f\colon S \to S'\) we can define \(m_P(f)\) (\terminology{multiplicity} of \(f\) at \(P\)) by using a chart \(\psi\) on \(S'\) and setting%
\begin{equation*}
m_P(f) = \ord_P(\psi\circ f)\text{.}
\end{equation*}
%
\par
If \(m_P(f)\ge 2\) then we call \(P\) a \terminology{branch point} of \(f\) and call \(f\) ramified at \(P\).%
\end{definition}
\begin{example}{}{g:example:idm204345838384}%
%
\begin{equation*}
f\colon \CC \to \CC,\,f(z) = z^2\text{.}
\end{equation*}
The chart \(\phi_a(z) = z-a\) is centered at \(a \in \CC\). Then to compute \(m_a(f)\) we compute%
\begin{equation*}
f\circ \phi\inv_a(z) = a^2 + 2az + z^2
\end{equation*}
hence%
\begin{equation*}
\ord_a(f) =\begin{cases} 0,\amp \text{ if } a\ne 0\\ 2,\amp\text{ if } a= 0\end{cases}\text{.}
\end{equation*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.5 Genus}
\typeout{************************************************}
%
\begin{subsectionptx}{Genus}{}{Genus}{}{}{g:subsection:idm204345835344}
\begin{theorem}{Rado.}{}{g:theorem:idm204345834944}%
Any orientable compact surface can be triangulated.%
\end{theorem}
\begin{fact}{}{}{g:fact:idm204345834096}%
Riemann surfaces are orientable.%
\end{fact}
Given such an oriented polygon coming from a Riemann surface, we can associate a word \(w\) to it from travelling around the perimeter.%
\begin{example}{}{g:example:idm204345832560}%
For the sphere \(w = a\inv ab\inv bc\inv c\).%
\end{example}
\begin{fact}{}{}{x:fact:fact-existence-genus}%
Every such word can be normalised without changing the corresponding Riemann surface.%
\begin{equation*}
w = \begin{cases} w_0 = aa\inv,\\ w_g = a_1b_1 a_1\inv b_1\inv \cdots a_gb_g a_g\inv b_g\inv\end{cases}
\end{equation*}
The (uniquely determined) \(g\) is the \terminology{genus} of the surface.%
\end{fact}
\begin{example}{}{g:example:idm204345829344}%
\(w_1 = a_1b_1 a_1\inv b_1 \inv\).%
\par
\(w_2 = a_1b_1 a_1\inv b_1a_2b_2 a_2\inv b_2 \inv\).%
\end{example}
\begin{theorem}{}{}{g:theorem:idm204345827984}%
%
\begin{equation*}
\chi (S) = v- e + f = 2-2g(S)\text{.}
\end{equation*}
%
\end{theorem}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.3 Riemann Hurwitz Formula (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{Riemann Hurwitz Formula (Sachi)}{}{Riemann Hurwitz Formula (Sachi)}{}{}{x:section:sec-riemann-hurwitz}
\begin{inlineexercise}{Unimportant.}{g:exercise:idm204345826432}%
The genus is invariant under changing triangulation.%
\end{inlineexercise}
In particular there are at least two distinct ways of thinking about genus for Riemann surfaces \(R\)%
\begin{enumerate}
\item{}%
\begin{equation*}
\chi(R) = V -E + F = 2-2g
\end{equation*}
%
\item{}The dimension of the space of holomorphic differentials on \(R\).%
\end{enumerate}
%
\par
Goal: given \(R\) calculate genus%
\begin{equation*}
y^2 = (x+1)(x-1)(x+2)(x-2)
\end{equation*}
so in an ad hoc way%
\begin{equation*}
y = \sqrt{(x+1)(x-1)(x+2)(x-2)}
\end{equation*}
when \(x\) is not a root of the above we have two distinct values for \(y\), we can imagine two copies of \(\CC\) sitting above each other and then square root will land in both copies. We have to make branch cuts between the roots and glue along these to account for the fact that going around a small loop surrounding a root will change the sign of our square root. We end up with something looking like a torus here.%
\par
Here we examined the value where there were not enough preimages when we plugged in a value for \(x\). The idea is to project to \(x\), and understand the number of preimages.%
\begin{equation*}
P(x,y) = y^n + p_{n-1}(x) y^{n-1} + \cdots + p_0(x)
\end{equation*}
an  irreducible polynomial.%
\begin{equation*}
R= \{(x,y) : P(x,y) = 0\}\text{.}
\end{equation*}
If we fix \(x_0 \in \PP^1 \CC\) we can analyse how many \(y\) values lie over this \(x\). If we have fixed our coefficients we expect \(n\) solutions in \(y\) over \(\CC\), i.e. points \((x_0,y)\in R\).%
\par
For some values of \(x_0\) this will not be true, there will be fewer \(y\)-values, this occurs when we have a multiple root. This happens precisely when the discriminant of this polynomial vanishes, the discriminant is a polynomial and so has finitely many roots.%
\begin{definition}{Branch points.}{x:definition:def-branch-point}%
Let \(\pi\colon R \to \PP^1 \CC\). We say \(x_0\) is a \terminology{branch point} if there are fewer than \(n\) distinct \(y\)-values above \(x\). Then define the \terminology{total branching index}%
\begin{equation*}
b = \sum_{x\in \PP^1 \CC} (\deg(\pi) - \# \pi\inv (x))\text{.}
\end{equation*}
%
\end{definition}
\begin{claim}{}{}{x:claim:claim-euler-degree-total-branching}%
%
\begin{equation*}
\chi(R) = \deg \pi \cdot \chi(\PP^1\CC)  - b\text{.}
\end{equation*}
%
\end{claim}
\begin{lemma}{}{}{g:lemma:idm204345808688}%
Locally given some choice of coordinates a non-constant morphism of Riemann surfaces%
\begin{equation*}
f\colon R \to S
\end{equation*}
is given by \(w\mapsto w^n\). More precisely given \(r \in R\), \(f(r) = s\) and \(V_s \ni s\) a small neighbourhood choose an identification of%
\begin{equation*}
V_s \xrightarrow \Psi D
\end{equation*}
which sends \(s \mapsto 0\) and we can find an analytic identification%
\begin{equation*}
r\in R_r \xrightarrow \phi D
\end{equation*}
such that%
\begin{equation*}
f(U_r) \subseteq V_s\text{.}
\end{equation*}
%
\begin{equation*}
\xymatrix{U_r \ar[r]^f \ar[d]_\phi & V_s \ar[d]^\Psi \\ D \ar[r]_{w\mapsto w^m} & D}
\end{equation*}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204345803600}
In Sachi's notes.%
\end{proofptx}
\begin{proofptx}{}{g:proof:idm204345803216}
Of \hyperref[x:claim:claim-euler-degree-total-branching]{Claim~\ref{x:claim:claim-euler-degree-total-branching}}.%
\par
Triangulate \(R\) so that every face lies in some small coordinate neighborhood s.t.%
\begin{equation*}
\pi \colon R\to \PP^1 \CC
\end{equation*}
is given by \(w \mapsto w^m\), s.t. every edge, all branch points are vertices. This ensures that each face edge and vertex has \(n  = \deg (\pi)\) preimages (except branch points). Then accounting for branch points we have \(\deg(\pi) -  \# \pi\inv (x_0)\) preimages.%
\end{proofptx}
\begin{example}{}{g:example:idm204345799808}%
\(P(x,y)\) plane curve, classically have%
\begin{equation*}
g = \frac{(d-1)(d-2)}{2}
\end{equation*}
\(\PP^2 = \{ \lb x:y:z \rb\}\) and \((\PP^2)^* = \lb a:b:c \rb\), lines in \(\PP^2\)%
\begin{equation*}
ax + by + cz = 0
\end{equation*}
and we have lines \(\leftrightarrow\) points. We have \(C^*\) the dual curve in \(\PP^2\) cut out by the tangent lines \(t_Q\) for \(Q \in C\). Claim \(\deg C^* = (d-1)d\).%
\par
Want%
\begin{equation*}
R:\{P(x,y) = 0\} \xrightarrow\pi \PP^1\CC
\end{equation*}
compute \(b\). In other words, if we fix an arbitrary point \(Q\in C\) then there are \(d(d-1)\) lines through \(Q\) which are tangent to \(C\). Projecting to the \(x\)-coordinate \(\iff\) family of lines through a point at \(\infty\) \(\iff\) \(\ast\) line in \((\PP^2)^*\). We have a new question: How many points does this line intersect (up to multiplicity). By bezout \(\iff  \deg C^*\).%
\par
Proof (Matt emerton) Consider a point on \(C\) in \(\PP^2\) such that no tangent line to the curve at   \(\infty\) passes through it. Move this point to the origin. If we write%
\begin{equation*}
P(x,y) = f_d + f_{d-1} + \cdots + f_0
\end{equation*}
then%
\begin{equation*}
(f_d, f_{d-1}) = 1
\end{equation*}
suppose they share a linear factor:%
\begin{equation*}
0 = (f_d)_x x + (f_d)_y y + f_{d-1}\text{,}
\end{equation*}
then this defines a line through the origin. (Because this gives an equation of an asymptote, this is a contradiction).%
\begin{equation*}
f_d + f_{d-1} + \cdots + f_0 = 0
\end{equation*}
%
\begin{equation*}
d f_d + (d-1) f_{d-1} + \cdots + f_1 = 0
\end{equation*}
%
\begin{equation*}
\implies
\end{equation*}
%
\begin{equation*}
\begin{cases}  f_d + f_{d-1} + \cdots + f_0 = 0 \\ f_{d-1} + 2f_{d-2} + \cdots + (d-1) f_1 = 0\end{cases}\text{.}
\end{equation*}
Now these have \(d(d-1)\) common solutions. \(C^*\) has degree \(d(d-1)\) so \(b = d(d-1)\). Riemann-Hurwitz implies%
\begin{equation*}
\chi(R) = 2\deg \pi - d(d-1)
\end{equation*}
%
\begin{equation*}
\chi(R) = 2d - d(d-1)
\end{equation*}
so%
\begin{equation*}
g=  \frac{(d-1)(d-2)}{2}\text{.}
\end{equation*}
%
\end{example}
\begin{paragraphs}{A 3-fold equivalence of categories.}{g:paragraphs:idm204345781472}%
Amazing synthesis.%
\begin{enumerate}
\item{}Analysis: Compact connected riemann surfaces.%
\item{}Algebra: Field extensions \(K/\CC\) where \(K\) is finitely generated of transcendence degree 1 over \(\CC\).%
\item{}Geometry: Complete nonsingular irreducible algebraic curves in \(\PP^n\).%
\end{enumerate}
%
\par
3) curve \(\to\) 2) field extension. Over \(C\) all rational functions \(\frac{P(x)}{Q(x)}\) \(\deg P= \deg Q\), \(P,Q \colon C\to \CC \cup \{\infty\}\).%
\par
3) \(\to\) 1) take complex structure induced by \(\PP^n\).%
\par
1) \(\to\) 2) associated field of meromorphic functions on \(X\).%
\par
1) \(\to\) 3) Any curve which is holomorphic has an embedding into \(\PP^n\) (Riemann-Roch).%
\par
2) \(\to\) 1) \(K/\CC\) consider valuation rings \(R\) such that \(K\supseteq R\supseteq \CC\).%
\begin{example}{}{g:example:idm204345770464}%
\(g =0\), \(\PP^1 \CC\) \(\CC(t)\), \(\CC\cup \{\infty\}\).%
\end{example}
\begin{example}{}{g:example:idm204345768464}%
\(g =1\), elliptic curves, \(f(x,y,z)\) smooth plane cubic, \(f= 0\), \(\CC(\sqrt{f(x)}, x)\).%
\begin{equation*}
\CC/\Lambda \to \PP^2
\end{equation*}
%
\begin{equation*}
z\mapsto (z,\wp(z), \wp'(z))
\end{equation*}
%
\begin{equation*}
z\not\in \Lambda
\end{equation*}
backwards%
\begin{equation*}
(x,y) \mapsto \int_{(x_0, y_0)}^{(x,y)} \frac{\diff x}{y}
\end{equation*}
%
\end{example}
\end{paragraphs}%
\begin{paragraphs}{Riemann-Hurwitz (generally).}{g:paragraphs:idm204345765072}%
There's nothing that doesn't generalise about the previous proof.%
\begin{claim}{}{}{x:claim:claim-riemann-hurwitz}%
For \(\pi\colon R\to S\) a non-constant morphism of compact Riemann surfaces%
\begin{equation*}
\chi(R) = \deg \pi \cdot \chi(S)  - \sum_{x\in S} (\deg(\pi) - \#\pi\inv(x))\text{.}
\end{equation*}
%
\end{claim}
\begin{corollary}{}{}{g:corollary:idm204345762432}%
There are no non-constant morphisms from a sphere to a surface of genus \(\gt 0\).%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204345761440}
%
\begin{equation*}
f\colon \PP^1 \CC \to S
\end{equation*}
%
\begin{equation*}
\chi(\PP^1 \CC) = \deg f \chi(S) - b
\end{equation*}
%
\begin{equation*}
2 = (+)\cdot (-) - b\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
\begin{inlineexercise}{}{g:exercise:idm204345760176}%
%
\begin{equation*}
x^n  +y^ n + z^n = 0
\end{equation*}
is not solvable in non-constant polynomials for \(n \gt 2\).%
\end{inlineexercise}
\begin{inlineexercise}{}{g:exercise:idm204345758912}%
%
\begin{equation*}
E = \CC/ \ZZ + \ZZ i
\end{equation*}
multiplication by \(i\) rotates \(x \mapsto xi\) let \(x \sim xi\). If we mod out by \(\sim\) to get \(E/\sim\) this is still a Riemann surface and the quotient map%
\begin{equation*}
f \colon E \to E / \sim
\end{equation*}
is nice, compute the branch points  of order 4 and order 2.%
\end{inlineexercise}
\begin{inlineexercise}{}{g:exercise:idm204345755472}%
\(X\) compact Riemann surface of \(g\ge 2\) then there are at most \(84(g-1)\) automorphisms of \(X\).%
\end{inlineexercise}
\begin{inlineexercise}{}{g:exercise:idm204345753424}%
Klein quartic%
\begin{equation*}
x^3 y + y^3 z + z^3 x = 0
\end{equation*}
has 168 automorphisms and is genus 3.%
\end{inlineexercise}
\end{paragraphs}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.4 Riemann Surfaces and Discrete Groups (Rod)}
\typeout{************************************************}
%
\begin{sectionptx}{Riemann Surfaces and Discrete Groups (Rod)}{}{Riemann Surfaces and Discrete Groups (Rod)}{}{}{x:section:sec-rs-discrete-groups}
\begin{introduction}{}%
Welcome to BUGLES (Boston university geometry learning expository seminar), the reason it is called bugles is because bugles are hyperbolic, and today we will see a lot of hyperbolic objects.%
\par
Plan%
\begin{enumerate}
\item{}Uniformization%
\item{}Fuchsian groups%
\item{}Automorphisms of Riemann surfaces%
\end{enumerate}
%
\begin{proposition}{}{}{g:proposition:idm204345749728}%
%
\begin{equation*}
\Aut(\hat \CC) =  \{ z\mapsto \frac{az+b }{cz+d}\}
\end{equation*}
%
\begin{equation*}
\Aut(\CC) = \left\{z \mapsto za+b\right\}
\end{equation*}
%
\begin{equation*}
\Aut(\HH) = \{ z\mapsto \frac{az+b }{cz+d},a,b,c,d\in \RR \} = \PSL_2(\RR)
\end{equation*}
%
\end{proposition}
\begin{theorem}{}{}{g:theorem:idm204345748384}%
\(\Sigma\) has a universal cover \(\widetilde \Sigma\) with \(\pi_1 ( \Sigma) = 1\). \(\widetilde \Sigma \to \Sigma\) holomorphic. \(\Sigma  = \widetilde \Sigma /G\) for \(G = \pi_1(\Sigma)\). \(G\) acts freely and properly discontinuously.%
\end{theorem}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.4.1 Uniformization}
\typeout{************************************************}
%
\begin{subsectionptx}{Uniformization}{}{Uniformization}{}{}{g:subsection:idm204345745040}
\begin{theorem}{}{}{g:theorem:idm204345744640}%
The only simply connected Riemann surfaces are \(\hat \CC\), \(\CC\), \(\HH\).%
\end{theorem}
\begin{theorem}{}{}{g:theorem:idm204345742880}%
\(\Sigma\) is a Riemann surface then%
\begin{align*}
g= 0 : \Sigma \amp\cong \hat \CC\\
g= 1 : \Sigma \amp\cong \CC/ \Lambda\\
g\ge2: \Sigma \amp\cong \HH/ K\text{.}
\end{align*}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345740912}
\(g = 0\) Uniformization.%
\par
\(g \ge 1\) \(\hat \CC\) can't be a cover by Riemann-Hurwitz. \(g = 1\) \(\pi_1 (\Sigma) = \ZZ \oplus \ZZ\) abelian.%
\par
Claim: no subgroup of \(\Aut (\HH) \) is isomorphic to \(\ZZ \oplus \ZZ\) acting freely and properly discontinuously. So \(\widetilde\Sigma = \hat \CC\) \(z\mapsto az+b\) free id \(a=1\) so \(z\mapsto z+\lambda_1\) \(z\mapsto z+\lambda_2\).%
\par
\(g= 2\) \(\pi_1(\Sigma)\) is not abelian but \(z\mapsto z + \lambda_1\) is abelian!%
\begin{equation*}
\Sigma = \HH/K,\, K \subseteq \PSL_2(\RR)\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
\begin{paragraphs}{Goal.}{g:paragraphs:idm204345733312}%
Understand \(\Sigma \) through \(\widetilde \Sigma\) and \(G\).%
\end{paragraphs}%
\begin{paragraphs}{Fuchsian groups.}{g:paragraphs:idm204345731408}%
\(g \ge 2\).%
\begin{equation*}
\Aut (\HH) = \PSL_2(\RR) = \operatorname{Isom}^+ ( \HH, \frac{|\diff z|^2}{\Im Z})
\end{equation*}
hyperbolic \(\HH, \mathbf D\) and \(\PSL_2(\RR)\) acts transitively on geodesics.%
\begin{definition}{Fuchsian groups.}{x:definition:def-fuchsian-group}%
A \terminology{Fuchsian group} is a discrete subgroup of \(\PSL_2(\RR)\).%
\end{definition}
\begin{remark}{}{g:remark:idm204345727088}%
(proof in book) Even if \(\Gamma\) doesn't act freely the quotient%
\begin{equation*}
\HH \to \HH/\Gamma
\end{equation*}
is still a covering map and \(\HH/\Gamma\) is a Riemann surface.%
\end{remark}
\end{paragraphs}%
\begin{paragraphs}{Reflections on \(\HH\).}{g:paragraphs:idm204345725344}%
Say \(\mu\) is a geodesic in \(\HH\), i.e. a horocycle. There is \(M \in \PSL_2(\RR)\) with \(M\mu\) the imaginary axis. Then \(R = -\bar z\) is the reflection  over the imaginary axis. Now \(R_\mu = M\inv\circ R \circ M\) is a reflection over \(\mu\).%
\begin{equation*}
R_\mu = \frac{a\bar z  + b}{ c\bar z + d}\not\in \PSL_2(\RR)
\end{equation*}
this is a a problem for us.%
\end{paragraphs}%
\begin{paragraphs}{Triangle groups.}{g:paragraphs:idm204345720800}%
Given \(n, m, l\in \ZZ \cup \{\infty\}\) then there is a hyperbolic triangle with angles \(\pi/n,\pi/m, \pi/l\) if%
\begin{equation*}
\frac 1n + \frac 1m + \frac 1l \lt 1\text{.}
\end{equation*}
With area \(\pi(1 -  \frac 1n - \frac 1m - \frac 1l)\).%
\par
In the disk model we can start with a wedge of the disk and by adding a choice third geodesic with endpoints on the edge we can adjust the other angles to be what we like.So we can construct hyperbolic triangles with whatever angles we like. Then let \(R_1\) be the reflection over 1 edge, \(R_2\) , \(R_3\) similarly. By reflecting our original triangle \(T\) with these reflections we can tessellate the disk, colouring alternately the triangles obtained using an odd or even number of reflections.%
\par
The only remaining problem is that \(R_i\)'s are not in \(\PSL_2(\RR)\). The solution is to define \(x_1 = R_3 \circ R_1\), \(x_2 = R_1 \circ R_2\), \(x_3 = R_2 \circ R_3\) which are all in \(\PSL_2(\RR)\) now. Now we need to take the union of two adjacent triangles before as a fundamental domain, some quadrilateral that still tessellates. So we have formed a Fuchsian group from our triangles.%
\par
A presentation for this group is%
\begin{equation*}
\langle x_1, x_2, x_3 | x_1 ^n = x_2 ^ m = x_3 ^l = x_1x_2x_3 = 1\rangle
\end{equation*}
note \(n,m,l\) can still be \(\infty\).%
\begin{definition}{Triangle groups.}{x:definition:def-triangle-groups}%
Let \(\Gamma_{n,m,l}\) be the \terminology{triangle group} with signature \((1/n, 1/m, 1/l)\).%
\end{definition}
\begin{remark}{}{g:remark:idm204345708560}%
%
\begin{equation*}
\frac 1n + \frac 1m + \frac 1l = 1
\end{equation*}
%
\begin{equation*}
\frac 1n + \frac 1m + \frac 1l \gt 1
\end{equation*}
still work on \(\CC\) and \(\hat \CC\) respectively.%
\end{remark}
\begin{example}{\(\PSL_2(\ZZ)\).}{g:example:idm204345706736}%
Consider \(\Gamma_{2,3,\infty}\) angles \(\pi/2, \pi/3, 0\). We can draw such a triangle in the upper half plane with vertices \(i, e^{\pi i/3}, \infty\). So a fundamental domain will be the region obtained by reflecting through the imaginary axis, given by \(-\frac 12 \le \Re z \le \frac 12\), \(|z| \ge 1\). We have \(R_1 = \frac{1}{\bar z}, R_2 = -\bar z +1,R_3 = -\bar z\) so \(x_1 = \frac{-1}{z}, x_2 = \frac{1}{-z+1}, x_3 = z+1\). Then \(\Gamma_{2,3,\infty} \cong \PSL_2(\ZZ)\). Sometimes denoted \(\Gamma(1)\).%
\end{example}
\begin{observation}{}{g:observation:idm204345701552}%
If \(\Gamma_1 \lt \Gamma_2\) and \(T\) is a fundamental domain of \(\Gamma_2\) then if \(\gamma_1, \gamma_2, \ldots, \gamma_n \in \Gamma_2\) are representatives of \(\Gamma_1\backslash \Gamma_2\) then%
\begin{equation*}
\bigcup \gamma_i (T)
\end{equation*}
is a fundamental domain for \(\Gamma_1\).%
\end{observation}
\begin{example}{\(\Gamma(1)\).}{g:example:idm204345698160}%
%
\begin{equation*}
\Gamma(2) = \{\begin{pmatrix} a\amp b \\ c\amp d\end{pmatrix} = \id \pmod 2 \}
\end{equation*}
then%
\begin{equation*}
[\Gamma(1) : \Gamma(2)] = 6
\end{equation*}
representatives of \(\Gamma(2) \backslash \Gamma(1)\) are%
\begin{equation*}
x_1 = \id,\,x_2 = \frac{-1}{z-1}, x_3 = \frac{z-1}{z},\, x_4 = \frac{z-1}{z},\,x_5 = \frac{-z}{x-1},\,x_6 = \frac{-1}{z}\text{.}
\end{equation*}
Lets see what these do, for example if \(z= e^{i\theta}\)%
\begin{equation*}
\Re(x_2(z) = \frac{-1}{e^{i\theta} - 1} = \frac{-e^{i\theta} + 1}{2- 2\cos \theta}) = \frac{1-\cos \theta}{ 2- 2\cos \theta} \frac 12
\end{equation*}
if we plot this we see we get two copies of a 0,0,0 triangle so this corresponds to \(\Gamma_{\infty,\infty,\infty}\).%
\begin{equation*}
\langle x_1, x_2, x_3 | x_1x_2x_3 = 1\rangle = \langle x_1,x_2\rangle = \pi_1(\PP^1\smallsetminus\{0,1,\infty\})\text{.}
\end{equation*}
%
\end{example}
\begin{proposition}{}{}{g:proposition:idm204345693632}%
\(S_1 = \HH/ \Gamma_1\), \(S_2 = \HH/\Gamma_2\) then%
\begin{equation*}
S_1 \cong S_2 \iff \Gamma_1 = T\circ \Gamma_2 \circ T\inv,\,T\in \PSL_2(\RR)\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345691936}
\(\Leftarrow\) Define an \(\phi\colon S_1 \to S_2\) via \(\phi(\lb z\rb_1) = \lb T(z)\rb_2\).%
\par
\(\Rightarrow\) Take a lift%
\begin{equation*}
\xymatrix{
\HH\ar[r]^{\tilde\phi}\ar[d] & \HH\ar[d] \\
\HH/\Gamma_1\ar[r]_\phi & \HH/\Gamma_2
}
\end{equation*}
then \(T= \tilde \phi\).%
\end{proofptx}
\begin{proposition}{}{}{g:proposition:idm204345688736}%
\(\Gamma\) a Fuchsian group acts freely%
\begin{equation*}
\Aut(\HH/\Gamma) = N(\Gamma)/\Gamma\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345687504}
Previous proposition, set \(\Gamma_1 = \Gamma_2\)%
\begin{equation*}
N(\Gamma) \to \Aut(\HH/\Gamma)
\end{equation*}
kernel is \(\Gamma\).%
\end{proofptx}
\begin{corollary}{}{}{g:corollary:idm204345685968}%
Let \(\Sigma\) be a Riemann surface with \(g \ge 2\) then%
\begin{equation*}
|\Aut(\Sigma)| \lt \infty\text{.}
\end{equation*}
%
\end{corollary}
\begin{proofptx}{}{g:proof:idm204345684176}
%
\begin{equation*}
\xymatrix{
\HH \ar[dr]^{\phi_1} \ar[d]_{\phi_2}\\
S =\HH/\Gamma \ar[r]_f & \HH/N(\Gamma) = S/\Aut(S)
}
\end{equation*}
since \(\phi_1,\phi_2\) are holomorphic then so is \(f\). So \(\deg f=  | N(\Gamma) /\Gamma|\) and \(\deg f  \lt \infty\).%
\end{proofptx}
Say \(\Sigma\), \(g\ge 2\), \(G\subseteq \Aut(\Sigma)\). Let \(\bar g\) be the genus of \(\Sigma /G\)%
\begin{equation*}
2g - 2 = |G| (2\bar g - 2) + \sum_p (I(p) - 1) = |G|(2\bar g - 2 + \sum_{i=1}^n (1 - \frac{1}{|I(p_i)|}))
\end{equation*}
where \(I(p)\) is the stabiliser of \(p\) in \(G\) and \(\{p_i\}\) area maximal set of fixed points of \(G\) inequivalent under the action of \(G\).%
\begin{inlineexercise}{}{g:exercise:idm204345676480}%
\(\Sigma,\,g\ge 2\) then \(|\Aut(\Sigma)| \le 84(g-1)\). Hint: cases.%
\end{inlineexercise}
\begin{inlineexercise}{}{g:exercise:idm204345675248}%
Consider%
\begin{equation*}
1 \to \Gamma(n) \to \Gamma(1) \to \PSL_2(\ZZ/n\ZZ) \to 1
\end{equation*}
compute genus of \(\HH/\Gamma(n)\).%
\end{inlineexercise}
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.5 Riemann Surfaces and Discrete Groups II (Jim)}
\typeout{************************************************}
%
\begin{sectionptx}{Riemann Surfaces and Discrete Groups II (Jim)}{}{Riemann Surfaces and Discrete Groups II (Jim)}{}{}{x:section:sec-rs-discrete-groups-ii}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.1 Moduli space of compact Riemann surfaces with genus \(g\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Moduli space of compact Riemann surfaces with genus \(g\)}{}{Moduli space of compact Riemann surfaces with genus \(g\)}{}{}{g:subsection:idm204345673056}
\(g =0\). Uniformization tells us that up to isomorphisms all Riemann surfaces of genus \(0\) are \(\PP^1\) hence the moduli space \(\mathcal M _0  = \{\text{pt}\}\).%
\par
\(g = 1\). Uniformization tells us that each Riemann surface of genus \(1\) is a torus and can be written as \(\CC/ \omega_1\ZZ+ \omega_2\ZZ \to \CC/(\ZZ \oplus \tau \ZZ)\), with \(\tau = \pm \omega_1/\omega_2\).%
\begin{proposition}{2.54.}{}{g:proposition:idm204345668640}%
%
\begin{equation*}
\mathcal M_1 \simeq \HH/ \PSL_2(\ZZ) \simeq \CC\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345667552}
Idea: Existence of%
\begin{equation*}
\CC/ \Lambda_{\tau_1} \xrightarrow{\sim} \CC/\Lambda_{\tau_2}
\end{equation*}
with \(\bar T (\lb 0 \rb) = \lb 0 \rb\) is equivalent to the existence of \(T \in \Aut(\CC)\) (choose \(T(z) = wz\)) such that \(w(\ZZ\oplus \tau_1 \ZZ) = \ZZ\oplus \tau_2\ZZ\). This in turn is equivalent to the existence of%
\begin{equation*}
A,A' \in \GL_2(\ZZ)
\end{equation*}
s.t. \(\det (A) = \det(A') = \pm 1\) so that%
\begin{equation*}
\begin{pmatrix} w\\ w\tau_1 \end{pmatrix} A \begin{pmatrix}1\\ \tau_2\end{pmatrix} = A' \begin{pmatrix} w \\ w\tau_1 \end{pmatrix}
\end{equation*}
%
\begin{equation*}
\implies \tau_q = A \psi_2 = \frac{a\tau_2 + b}{c\tau_2 + d}
\end{equation*}
and \(A \in \PSL_2(\RR)\). Implies \(A\in \PSL_2(\ZZ)\) as both \(\tau_1,\tau_2 \in \HH\). Conversely if%
\begin{equation*}
\tau_1 = \frac{a\tau_2 + b}{c\tau_2 + b}
\end{equation*}
isomorphism is induced by \(T(z) = (c\tau_2 + d) z\).%
\end{proofptx}
\(g \gt 1\) \(\mathcal M_g\) is a complex variety of dimension \(3g-3\). Uniformization tells us that describing a Riemann surface amounts to specifying \(2g\) real \(2\times 2\) matrices \(\{\gamma_i\}_{i=1}^{2g}\) such that%
\begin{enumerate}
\item{}\(\det(\gamma_i) = 1\) which implies that \(\gamma_i\) depends on 3 real parameters so we have a total of \(6g\).%
\item{}\(\prod_{i=1}^g \lb \gamma_i, \gamma_{g+i}\rb = \begin{pmatrix} 1\amp 0 \\ 0\amp 1\end{pmatrix}\) 3 relations, so \(6g- 3\). Since for any \(\gamma \in \PSL_2(\RR)\) \(\Gamma = \langle \gamma_i \rangle\) and \(\gamma\Gamma \gamma\inv\) uniformize isomorphic Riemann surfaces implies \(6g-6\) real parameters, so \(3g-3\) complex parameters.%
\end{enumerate}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.2 Monodromy}
\typeout{************************************************}
%
\begin{subsectionptx}{Monodromy}{}{Monodromy}{}{}{g:subsection:idm204345653424}
Let \(f\colon S_1 \to S\) be a morphism of degree \(d\) ramified over \(y_1,\ldots, y_n \in S\). For \(y\in S\smallsetminus \{y_1,\ldots, y_n\}\) we have a group homomorphism%
\begin{equation*}
M_f\colon \pi_1(S \smallsetminus \{y_1, \ldots, y_n\} )\to \operatorname{Bij} (f\inv (y))
\end{equation*}
%
\begin{equation*}
\gamma \mapsto M_f(\gamma) = \sigma_\gamma\inv\text{.}
\end{equation*}
\(\sigma_\gamma\) is defined as follows:%
\begin{equation*}
\gamma \in \pi_1(S\smallsetminus \{ y_1,\ldots, y_n\})
\end{equation*}
lifts to a path \(\widetilde \gamma\) from \(x\in f\inv(y)\) to another \(x' \in f\inv(y)\) set \(\sigma_\gamma(x) =x'\). If we number the points in \(f\inv (y)\) we may think of \(M_f(\pi_1)\subseteq \Sigma_d\), via some \(\phi\colon \{1,\ldots, d\}\to f\inv (y)\). \(\operatorname{Mon}(f)\) is the image of \(M_f(\pi_1)\) in \(\Sigma_d\).%
\begin{paragraphs}{Monodromy and Fuchsian groups.}{g:paragraphs:idm204345645040}%
Let%
\begin{equation*}
\pi \colon \HH/\Gamma_1 \to \HH/ \Gamma
\end{equation*}
be the Fuchsian group representation of the map%
\begin{equation*}
f\colon S_1 \to S\ni y\text{.}
\end{equation*}
Identifications \(y = \lb z_0 \rb_\Gamma\) for some \(z_0 \in \HH\).%
\begin{equation*}
\pi_1 (S\smallsetminus \{y_1,\ldots, y_n\}) \simeq \Gamma
\end{equation*}
%
\begin{equation*}
f\inv(y ) = \{ [\beta z_0]_{\Gamma_1}\}
\end{equation*}
where \(\beta\) runs along a set of representatives of \(\Gamma_1\backslash \Gamma\).%
\par
%
\begin{equation*}
M_f \colon \Gamma \to \operatorname{Bij} (\Gamma_1\backslash \Gamma)
\end{equation*}
%
\begin{equation*}
\gamma \mapsto M_f(\gamma)
\end{equation*}
%
\begin{equation*}
\implies \gamma \sim \pi_1([z_0,\gamma(z_0)])
\end{equation*}
where \(\lb z_0, \gamma(z_0) \rb\) is a path in \(\HH\). Lift this loop to \(\HH/\Gamma_1\) is the path \(\pi_{\Gamma_1}(\beta \lb z_0, \gamma_0(z_0)\rb)\). which corresponds to \(\Gamma_1 \beta \gamma\), this implies \(\sigma_\gamma(\Gamma_1\beta)  = \Gamma_1 \beta\gamma\).%
\begin{corollary}{2.59.}{}{g:corollary:idm204345637168}%
%
\begin{equation*}
M_\pi \colon \Gamma \to \operatorname{Bij} (\Gamma_1 \backslash \Gamma)
\end{equation*}
induces an isomorphism%
\begin{equation*}
\frac{\Gamma}{\bigcap_{\beta\in \Gamma_1} \beta\inv \Gamma_1 \beta} \simeq \operatorname{Mon}(\pi)
\end{equation*}
%
\end{corollary}
characterize morphisms by monodromy. Let \(f_i\) have degree 2, non conjugate.%
\begin{proposition}{2.63.}{}{g:proposition:idm204345634896}%
For \(S\) a compact Riemann surface and \(\beta = \{ a_1, \ldots, a_n\} \subset S\) for some \(d \ge 1\) there are only finitely many pairs \((\tilde S, f)\) where \(\tilde S\) is a compact Riemann surface and%
\begin{equation*}
f\colon \tilde S \to S
\end{equation*}
is a degree \(d\) morphism with branching  value set \(\beta\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345630656}
Special case: Assume \(S = \PP^1\) and \(n=3\).%
\begin{equation*}
\Gamma = \Gamma(2) = \{ A \in \PSL_2(\ZZ) : A = \id \pmod 2\}
\end{equation*}
%
\begin{equation*}
= \pi_1 (S' \smallsetminus \{0,1,\infty\})
\end{equation*}
is generated by \(\gamma_1, \gamma_2\) so any map \(M_f \colon \Gamma(2) \to \Sigma_d\) is determined by  images of \(\gamma_1, \gamma_2\).%
\end{proofptx}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.3 Galois coverings}
\typeout{************************************************}
%
\begin{subsectionptx}{Galois coverings}{}{Galois coverings}{}{}{g:subsection:idm204345627344}
\begin{definition}{}{g:definition:idm204345626928}%
A covering \(f\colon S_1\to S_2\) is Galois (or regular, or normal) if the covering group%
\begin{equation*}
\Aut(S,f) =  \{ h\in \Aut(S_1) : f\circ h= f\} = G
\end{equation*}
acts transitively on each fibre. With this notion we can think of \(S_1 \to S_1/G\).%
\end{definition}
\begin{proposition}{2.65.}{}{g:proposition:idm204345624992}%
%
\begin{equation*}
f\colon S_1 \to S_2
\end{equation*}
is Galois if and only if%
\begin{equation*}
f^* \colon M(S_2 ) \to M(S_1)
\end{equation*}
is a Galois extension. In this case \(\Aut(S_1, f)  \simeq \Gal{M(S_1)}{M(S_2)}\).%
\end{proposition}
\begin{example}{}{g:example:idm204345622992}%
Hyperelliptic covers of \(\PP^1\) given by%
\begin{equation*}
S = \{ y^2 = \prod_{i=1}^N (x- a_i)\} \to \PP^1
\end{equation*}
%
\begin{equation*}
(x,y) \to x
\end{equation*}
covering group \(G\) is order 2 generated by the involution  \(J(x,y) = (x,-y)\).%
\end{example}
\begin{proposition}{2.66.}{}{g:proposition:idm204345620480}%
A covering%
\begin{equation*}
f\colon S_1 \to S_2
\end{equation*}
is normal\slash{}Galois  iff%
\begin{equation*}
\deg(f)  = |\operatorname{Mon}(f)|\text{.}
\end{equation*}
%
\end{proposition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.4 Normalization of coverings of \(\PP^1\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Normalization of coverings of \(\PP^1\)}{}{Normalization of coverings of \(\PP^1\)}{}{}{g:subsection:idm204345618800}
Let \(f\colon S \to \PP^1\) be a cover of \(\deg d \gt 0\) with \(\operatorname{Mon}(f) \le \Sigma_d\).%
\par
The normalisation%
\begin{equation*}
\tilde f \colon \tilde S \to \PP^1
\end{equation*}
associated to \(f\) has \(\operatorname{Mon} (f) \cong \Aut( \tilde S, \tilde g\) and \(\tilde f ^* \colon M(\PP^1 ) \to M(\PP^1) \) is the normalisation of the extension%
\begin{equation*}
f^* \colon M(\PP^1 ) \hookrightarrow M(S)
\end{equation*}
%
\par
Normalization of extensions \(K \hookrightarrow L\) is a Galois extension of \(K \) of lowest possible degree containing \(L\).%
\begin{definition}{}{g:definition:idm204345612592}%
Normalization of \(f\colon S\to \PP^1\) \(\deg d \gt 0 \) is a Galois covering \(\tilde f \colon \tilde S \to \PP^1 \) of  lowest possible degree s.t. \(\exists \pi \colon \tilde S \to S\) with  the diagram commuting.%
\end{definition}
\begin{corollary}{2.73.}{}{g:corollary:idm204345610256}%
%
\begin{equation*}
\operatorname{Mon}(f)  \simeq \Aut(\tilde S, \tilde f)
\end{equation*}
%
\end{corollary}
Interpretation in terms of Fuchsian groups:%
\begin{proposition}{}{}{g:proposition:idm204345608976}%
Let \(f\colon S_1 \to S\) be a covering of Riemann surfaces \(S_1\smallsetminus f\inv \{ y_1, \ldots, y_n \} \to S \smallsetminus\{ y_1, \ldots, y_n \}\). The unramified cover and \(\pi \colon \HH/ \Gamma_1 \to \HH/ \Gamma\) the Fuchsian group representatives. The normalisation of \(f\) can be represented as the compactification of%
\begin{equation*}
\HH/ \bigcap_{\gamma \in \Gamma} \gamma \inv \Gamma_1 \gamma \to \HH/\Gamma_1 \to \HH/\Gamma
\end{equation*}
so the covering group is isomorphic to \(\Gamma/ \bigcap \gamma \inv \Gamma_1 \gamma \simeq \operatorname{Mon}(f)\).%
\end{proposition}
\begin{example}{}{g:example:idm204345605552}%
Let \(F(x,y) = y^2x - (y-1)^3\) consider%
\begin{equation*}
S_F \to \PP^1
\end{equation*}
%
\begin{equation*}
(x,y) \to x
\end{equation*}
\(S_F\) has genus 0. \(S_F \to \PP^1\) is of degree 3 and ramified at most over \(0, \frac{-27}{4}, \infty\). \(\operatorname{Mon}(x)  \simeq \Sigma_3\) so not a normal covering. Normalization of \((S_F, x)\) is \(S_{\tilde F} , \tilde x)\) where%
\begin{equation*}
\tilde F (x,y) = y^2 ( 1-y)^2 x +  (1-y + y^2)
\end{equation*}
%
\end{example}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.6 Belyi's theorem (Maria)}
\typeout{************************************************}
%
\begin{sectionptx}{Belyi's theorem (Maria)}{}{Belyi's theorem (Maria)}{}{}{x:section:sec-belyi-thm}
\begin{introduction}{}%
\begin{theorem}{}{}{g:theorem:idm204345600128}%
Let \(S \) be a compact riemann surface, then the following are equivalent.%
\begin{enumerate}
\item{}\(S\) is defined over \(\overline\QQ\) (iff over  a number field)%
\item{}\(S\) admits a morphism \(f \colon S \to \PP^1\) with at most 3 branching values.%
\end{enumerate}
%
\end{theorem}
\begin{definition}{Belyi functions.}{x:definition:def-belyi-function}%
A meromorphic function with less than 4 branching values is a \terminology{Belyi function}.%
\end{definition}
\begin{remark}{}{g:remark:idm204345595424}%
%
\begin{enumerate}
\item{}Branching values can be taken to be in \(\{0,1,\infty\}\).%
\item{}If \(S \ne \PP^1\), then \(f \colon S \to \PP^1\) has at least 3 branching values%
\end{enumerate}
%
\end{remark}
\begin{definition}{Belyi polynomials.}{x:definition:def-belyi-poly}%
Let \(m,n \in \NN\), \(\lambda = m/(m+n)\), define%
\begin{equation*}
P_\lambda(x) = P_{m,n}(x) = \frac{(m+1)^{m+n}}{m^mn^n} x^m(1-x)^n
\end{equation*}
\terminology{Belyi polynomials}.%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204345590528}%
\(P_\lambda\) satisfies%
\begin{enumerate}
\item{}\(P_\lambda\) ramifies at exactly \(0,1,\lambda, \infty\).%
\item{}\(P_\lambda(0) = P_\lambda(1) = 0, P_\lambda(\lambda) = 1, P_\lambda(\infty) = \infty\).%
\end{enumerate}
%
\end{proposition}
\begin{example}{}{g:example:idm204345588016}%
%
\begin{equation*}
S_\lambda : y^2 = x(x-1)(x-\lambda)
\end{equation*}
with \(\lambda = m/(m+n)\). From ex. 1.32%
\begin{equation*}
x\colon S_\lambda \to \PP^1
\end{equation*}
%
\begin{equation*}
(x,y) \mapsto x
\end{equation*}
%
\begin{equation*}
\infty \mapsto \infty
\end{equation*}
ramifies over \(0,1,\lambda,\infty\). Then \(f = P_\lambda \circ x \colon S_\lambda \to \PP^1\) ramifies exactly at \((0,0), (1,0), (\lambda,0), \infty\). With branching values \(0,0,1,\infty\) so that \(f\) is a Belyi function.%
\end{example}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.1 Proof of a) implies b)}
\typeout{************************************************}
%
\begin{subsectionptx}{Proof of a) implies b)}{}{Proof of a) implies b)}{}{}{g:subsection:idm204345583552}
\begin{note}{}{g:note:idm204345583136}%
Its enough to show \(\exists f\colon S\to \PP^1\) ramified over \(\{0,1,\infty, \lambda_1, \ldots, \lambda_n\} \subseteq \QQ \cup \{\infty\}\). Given this we can repeatedly use Belyi polynomials to obtain \(g\colon S \to \PP^1\) ramified over \(\{0,1, \infty\}\).%
\end{note}
Write \(S = S_F\)%
\begin{equation*}
F(x,y) = p_0(x)y^n + \cdots + p_n(x)
\end{equation*}
defined over \(\overline \QQ\lb x,y\rb\). Let \(B_0 =  \{\mu_1, \ldots, \mu_s\}\) be the branching values of \(x\colon S_F\to \PP^1\).%
\par
Theorem 1.86 says that the each \(\mu_i\) is \(\infty\), a root of \(p_0(x)\) or a common root of \(F, F_y\) which implies by lemma 1.84 that \(B_0 \subseteq \overline \QQ \cup\{\infty\}\) . If \(B_0\subseteq \QQ\cup\{\infty\}\) we are done otherwise let \(m_1(T) \in \QQ\lb T \rb\) be the minimal polynomial of \(\{\mu_1, \ldots, \mu_s\}\). Let \(\{\beta_1, \ldots, \beta_d\}\) be the roots of \(m_1' (T) \) and \(p'(T)\) their min. poly. Note : \(\deg P(t) \lt \deg m'_1(T)\)%
\par
Note: \(\operatorname{Branch}(g\circ f) = \operatorname{Branch}(g) \cup g(\operatorname{Branch}(f))\) branching values.%
\par
So \(B_1 \operatorname{Branch}(m_1 \circ x) = m_1(\{\text{roots of }m_1'\}) \cup\{0,\infty\}\).%
\begin{equation*}
S\xrightarrow x \PP^1 \xrightarrow{m_1} \PP^1
\end{equation*}
If \(B_1 \subseteq \QQ \cup \{\infty\}\) done. Otherwise let \(m_2(T) \) be the minimal polynomial \(/\QQ\) of \(\{m_1(\beta_1) ,\ldots, m_1(\beta_d) \}\), \(B_2 = \operatorname{Branch}(m_2\circ m_2 \circ x)\). Fact: \(\deg(m(t)) \lt \deg(m_1(T))\).%
\par
Repeat inductively until \(B_k \subseteq \QQ \cup \{\infty\}\) which is guaranteed by the decreasing degrees.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.2 Algebraic characterization of morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Algebraic characterization of morphisms}{}{Algebraic characterization of morphisms}{}{}{g:subsection:idm204345567888}
\begin{proposition}{}{}{g:proposition:idm204345567456}%
Defining a morphism \(f \colon S_F\to S_G\) is equivalent to giving a pair of rational functions%
\begin{equation*}
f=  (R_1, R_2),\,R_i= \frac{P_i}{Q_i},\,    P_i,Q_i\in \CC[x,y],\,Q_i\not\in (F)
\end{equation*}
such that \(Q_1^{\deg_x(G)}Q_2^{\deg_y(G)} G(R_1, R_2) = HF\) for some \(H \in \CC\lb x, y\rb\). \(f(R_1, R_2)\) is an isomorphism if there exists an inverse morphism \(h\colon S_G\to S_F\).%
\end{proposition}
\begin{remark}{}{g:remark:idm204345564192}%
%
\begin{equation*}
\xymatrix{
S_f \ar[r]^f \ar[dr]_m & S_G \ar[d]_h \\
& S_D
}
\end{equation*}
The fact that this diagram commutes can be expressed by polynomial identities.%
\end{remark}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.3 Galois action}
\typeout{************************************************}
%
\begin{subsectionptx}{Galois action}{}{Galois action}{}{}{g:subsection:idm204345563344}
Let \(\operatorname{Gal}(\CC) = \Gal{\CC}{\QQ}\).%
\begin{definition}{}{g:definition:idm204345562288}%
For \(\sigma \in \operatorname{Gal}(\CC)\), \(a\in \CC\) denote \(a^\sigma = \sigma(a)\),%
\begin{enumerate}
\item{}If \(P = \sum a_{ij} x^iy^j \in \CC\lb x,y\rb\) set%
\begin{equation*}
P^\sigma = \sum a^\sigma_{ij} x^iy^j \in \CC\lb x,y\rb
\end{equation*}
if \(R = P/Q\) set \(R^\sigma = P^\sigma / Q^\sigma\).%
\item{}If \(S \simeq S_F\), \(S^\sigma = S_{F^\sigma}\).%
\item{}If \(\Psi = (R_1, R_2)\) \(S_F\to S_G\) is a morphism, set \(\Psi^ \sigma = (R_1^\sigma , R_2 ^\sigma) \colon S_{F^\sigma} \to S_{G^\sigma}\).%
\item{}For an equivalence class \((S,f) = (S_F, R(x,y))\) of ramified covers of \(\PP^1\) set \((S,f)^\sigma = (S^\sigma, f^\sigma) = (S_{F^\sigma}, R^\sigma (x,y))\).%
\end{enumerate}
%
\end{definition}
\begin{inlineexercise}{}{g:exercise:idm204345554128}%
Verify this Galois action is well-defined (lemma 3.12).%
\end{inlineexercise}
Recall: \(S_F\) is    constructed from a noncompact Riemann surface \(S_F^\times \subseteq \CC^2\) by adding finitely many points, (theorem 1.86). If \(P=  (a,b) \in S_F^\times\) then \(P^\sigma = (a^\sigma, b^\sigma)\). What about the other points?%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.4 Points and valuations}
\typeout{************************************************}
%
\begin{subsectionptx}{Points and valuations}{}{Points and valuations}{}{}{g:subsection:idm204345551472}
\begin{definition}{}{g:definition:idm204345551056}%
Let \(\mathcal M\) be a function field. A (discrete) valuation of \(\mathcal M\) is \(v \colon \mathcal M^* \to \ZZ\) s.t.%
\begin{enumerate}
\item{}\(\displaystyle v(\phi\psi) = v(\phi)  + v(\psi)\)%
\item{}\(\displaystyle v(\phi\pm\psi) \ge \min\{ v(\phi)  , v(\psi)\}\)%
\item{}\(v(\phi) = 0 \) if \(\phi \in \CC^*\)%
\item{}\(v\) is nontrivial \(\exists \phi : v(\phi)\ne 0\)%
\end{enumerate}
set \(v(0) = \infty\).%
\end{definition}
Facts:%
\begin{equation*}
A_v = \{\phi \in \mathcal M : v(\phi) \ge 0 \} \subseteq \mathcal M
\end{equation*}
is a subring that is a local ring with a maximal ideal%
\begin{equation*}
M_v = \{ \phi\in \mathcal M : v(\phi) \gt 0\} = (\phi)
\end{equation*}
for some \(\phi\) a uniformizer.%
\par
If \(v(\phi) = 1\) \(v\) is normalised.%
\begin{proposition}{3.15.}{}{g:proposition:idm204345543312}%
Every point \(P \in S\) a compact Riemann surface defines a valuation on \(\mathcal M(S)\) by \(v_P(\phi) = \ord_P(\phi)\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345541216}
Easy exercise.%
\end{proofptx}
\begin{theorem}{3.23.}{}{g:theorem:idm204345540816}%
For any compact Riemann surface \(S\)%
\begin{equation*}
P\in S \mapsto v_P = \ord_P
\end{equation*}
gives a 1-1 correspondence between points of \(S\) and normalised valuations on \(\mathcal M(S)\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345538448}
Sketch: First prove it for \(S = \PP^1\).%
\par
Inductively meromorphic functions separate points.%
\par
Surjectivity study behaviour of valuations in finite extensions of fields and use a nonconstant morphism \(f\colon S \to \PP^1\) to reduce to the case of \(\PP^1\).%
\end{proofptx}
\begin{paragraphs}{Galois action on points.}{g:paragraphs:idm204345536096}%
\begin{definition}{}{g:definition:idm204345535680}%
%
\begin{enumerate}
\item{}Given a valuation \(v\) on \(\mathcal M(S)\) define a valuation \(v^\sigma\) on \(\mathcal M(S^\sigma)\) by \(v^\sigma = v\circ \sigma^{-1}\) i.e. \(v^\sigma(\psi^\sigma) = v(\psi)\) for all \(\psi \in \mathcal M(S)\).%
\item{}For \(P \in S\) define \(P^\sigma \in S^\sigma\) as the unique point in \(S^\sigma\) s.t. \(v_{P^\sigma} = (v_P)^\sigma\).%
\end{enumerate}
%
\end{definition}
\begin{proposition}{3.25.}{}{g:proposition:idm204345529952}%
%
\begin{enumerate}
\item{}For \(\sigma\in \operatorname{Gal}(\CC)\), \(P\mapsto P^\sigma\) is a bijection \(S\to S^\sigma\).%
\item{}On \(P \in S_F^\times\) this agrees with the previous definition of \(P^\sigma\).%
\item{}\(a^\sigma = a\) for all \(a\in \QQ \cup \{\infty\}\) for all \(\sigma \in \operatorname{Gal}(\CC)\).%
\end{enumerate}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345525088}
Sketch%
\begin{enumerate}
\item{}\(a \mapsto a^{\sigma^{-1}}\).%
\item{}Follows as in proof of 3.22%
\item{}Obvious for \(a \in \QQ\), for \(\infty\):%
\begin{equation*}
(v_\infty)^\sigma (x-1) = v_\infty(x- a^{\sigma^{-1}}) = 1 = v_\infty(x-1)
\end{equation*}
for all \(a\in \CC\) implies \((v_\infty)^{\sigma^{-1}} = v_\infty\) implies \(\infty^\sigma  = \infty\).%
\end{enumerate}
%
\end{proofptx}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.5 Elementary invariants of the action of \(\operatorname{Gal}(\CC)\).}
\typeout{************************************************}
%
\begin{subsectionptx}{Elementary invariants of the action of \(\operatorname{Gal}(\CC)\).}{}{Elementary invariants of the action of \(\operatorname{Gal}(\CC)\).}{}{}{g:subsection:idm204345520880}
\begin{remark}{}{g:remark:idm204345520032}%
The bijection \(S \leftrightarrow S^\sigma\) is not holomorphic. In general \(S\) and \(S^\sigma\) are not isomorphic.%
\end{remark}
\begin{theorem}{}{}{g:theorem:idm204345518336}%
The action of \(\operatorname{Gal}(\CC)\) on pairs \((S,f)\) satisfies%
\begin{enumerate}
\item{}%
\begin{equation*}
\deg(f^\sigma) = \deg(f)
\end{equation*}
%
\item{}%
\begin{equation*}
(f(P))^\sigma = f^\sigma(P^\sigma)
\end{equation*}
%
\item{}%
\begin{equation*}
\ord_{P^\sigma}(f^\sigma) = \ord_P(f)
\end{equation*}
%
\item{}\(a\in \hat \CC\) is a branching value of \(f\) iff \(a^\sigma\) is a branching value of \(f^\sigma\).%
\item{}\(\operatorname{genus}(S) = \operatorname{genus}(S^\sigma)\) i.e. they are homeomorphic.%
\item{}\(\operatorname{Aut}(S,f) \to \operatorname{Aut}(S^\sigma, f^\sigma)\) via \(h \mapsto h^\sigma\) is a group homomorphism.%
\item{}The monodromy group \(\operatorname{Mon}(f)\) of \((S,f)\) is isomorphic to \(\operatorname{Mon}(f^\sigma)\) of \((S^\sigma , f^\sigma)\).%
\end{enumerate}
%
\end{theorem}
We will use properties 1 and 4 at least.%
\begin{proposition}{Criterion 3.29.}{}{g:proposition:idm204345509792}%
For a compact Riemann surface \(S\) the following are equivalent%
\begin{enumerate}
\item{}\(S\) is defined over \(\overline \QQ\).%
\item{}\(\{S^\sigma\}_{\sigma \in \operatorname{Gal}(\CC)}\) contains only finitely many isomorphism classes of Riemann surfaces.%
\end{enumerate}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345506832}
1 implies 2: \(S =S_F\), \(F = K\lb x,y\rb\) for \(K\) a number field then%
\begin{equation*}
| \{F^\sigma \}_{\sigma \in \operatorname{Gal}(\CC)} | \le [K : \QQ]
\end{equation*}
%
\par
2 implies 1 is section 3.7.%
\end{proofptx}
\begin{paragraphs}{Proof of b implies a in Belyi's theorem (3.61).}{g:paragraphs:idm204345504576}%
Suppose \(f \colon S\to \PP^1\) is a morphism of degree \(d\) with branching values \(\{0,1,\infty\}\). By theorem 3.28 \(\forall \sigma \in \operatorname{Gal}(\CC)\)%
\begin{equation*}
f^\sigma \colon  S^\sigma \to \PP^1
\end{equation*}
is a morphism of degree \(d\) and branching values are%
\begin{equation*}
\{\sigma(0), \sigma(1), \sigma(\infty)\} = \{0,1,\infty\}\text{.}
\end{equation*}
So \(\{f^\sigma\}_{\sigma \in\operatorname{Gal}(\CC)}\) gives rise to only finitely many monodromy homomorphisms.%
\begin{equation*}
F_{f^\sigma}\colon \pi_1(\PP^1 \smallsetminus \{0,1,\infty\}) \to \Sigma_d
\end{equation*}
the fundamental group is free on two generators so there are only finitely many such maps. Theorem 2.61 implies \(\{S^\sigma\}_{\sigma \in \operatorname{Gal}(\CC)}\) contains only finitely many equivalence classes so by the criterion  \(S\) is defined over \(\overline\QQ\).%
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.6 The field of definition of Belyi functions (3.8)}
\typeout{************************************************}
%
\begin{subsectionptx}{The field of definition of Belyi functions (3.8)}{}{The field of definition of Belyi functions (3.8)}{}{}{g:subsection:idm204345498480}
\begin{proposition}{}{}{g:proposition:idm204345498032}%
Belyi functions are defined over \(\overline \QQ\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345497072}
Use the same methods as in 3.7.%
\end{proofptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.7 Dessins (Berke)}
\typeout{************************************************}
%
\begin{sectionptx}{Dessins (Berke)}{}{Dessins (Berke)}{}{}{x:section:sec-dessins}
\begin{introduction}{}%
%
\begin{equation*}
G_\QQ \acts (X,D) \leftrightarrow (S,f) \acts G_\QQ
\end{equation*}
where \((X,D)\) is a dessin, \((S,f)\) is a Belyi pair.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.7.1 Dessins}
\typeout{************************************************}
%
\begin{subsectionptx}{Dessins}{}{Dessins}{}{}{g:subsection:idm204345494336}
\begin{definition}{}{g:definition:idm204345493936}%
A dessin is  a pair \((X,D)\) where \(X\) is an oriented compact topological surface and \(D\subset X\) is a finite graph:%
\begin{enumerate}
\item{}D is connected%
\item{}D is bicoloured%
\item{}\(X \smallsetminus D\) is a disjoint union of topological disks.%
\end{enumerate}
%
\end{definition}
Not all of these are so important (for example 3 implies 1 (but the converse does not hold)). We can also obtain a bicoloured graph from an uncoloured graph by subdividing all edges and colouring the new vertices black and the others white.%
\par
A single edge in a sphere is, a single edge in a torus is not.%
\begin{paragraphs}{Permutation representation of a Dessin.}{g:paragraphs:idm204345490000}%
Label the edges of  a dessin \(\{1, \ldots, N\}\) then%
\begin{equation*}
\sigma_0(i) = \text{subsequent edge in the cycle around the white vertex of }i
\end{equation*}
as we have a positive orientation on the edges%
\begin{equation*}
\sigma_1(i) = \text{subsequent edge in the cycle around the black vertex of }i\text{.}
\end{equation*}
Then we define%
\begin{definition}{}{g:definition:idm204345487840}%
\((\sigma_0, \sigma_1)\) is the permutation representation pair of \((X,D)\).%
\end{definition}
Say%
\begin{equation*}
\sigma_0 = (1 , \ldots, N_1) (N_1 + 1 , \ldots, N_2)\cdots
\end{equation*}
a product of disjoint cycles. Then each of these cycles corresponds to a  white vertex, where the length of the cycle is the degree of the corresponding vertex. Same for \(\sigma_1\) and black vertices.%
\par
%
\begin{equation*}
\{\text{cycles appearing in the decomposition of }\sigma_0\sigma_1\}
\end{equation*}
%
\begin{equation*}
\updownarrow
\end{equation*}
%
\begin{equation*}
\{\text{faces of }D\}
\end{equation*}
%
\begin{inlineexercise}{}{g:exercise:idm204345484224}%
Prove this.%
\end{inlineexercise}
\begin{remark}{}{g:remark:idm204345483696}%
\(D\) connected implies that \(\langle \sigma_0, \sigma_1 \rangle\) is transitive on \(\Sigma_N\). As \(D\) is bicoloured the cycles on \(D\) contain an even number of edges.%
\end{remark}
A dessin is not a triangulation of \(X\) but%
\begin{equation*}
\chi (X) = \#V -  \#E  + \#F
\end{equation*}
proof later.%
\begin{proposition}{}{}{g:proposition:idm204345480160}%
%
\begin{equation*}
\chi(X) = (\#\text{cycles of }\sigma_0+\#\text{cycles of }\sigma_1) - N + \#\{\text{cycles of }\sigma_0\sigma_1\}\text{.}
\end{equation*}
%
\end{proposition}
%
\begin{equation*}
(\sigma_0, \sigma_1) \leadsto (X',D)
\end{equation*}
%
\begin{equation*}
\langle \sigma_0, \sigma_1 \rangle \subseteq \Sigma_N
\end{equation*}
is transitive.%
\begin{proposition}{}{}{g:proposition:idm204345478368}%
There exists \((X,D)\) with permutation representation \((\sigma_0, \sigma_1)\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345476976}
Write \(\sigma_0\sigma_1 = \tau_1 \cdots \tau_k\), \(\tau_i\) disjoint cycles each of length \(n_i\) with \(\sum n_i = N\). Create \(k\) faces bounded by \(2n_1, \ldots, 2n_k\) vertices, and assign the vertices white and black colours so that the graph is bicoloured. As \(\sigma_0\sigma_1\) should jump two each time we get an identification of all edges which we then  glue using \(\sigma_0\).%
\end{proofptx}
\begin{definition}{}{g:definition:idm204345473040}%
We say that%
\begin{equation*}
(X_1, D_1) \sim (X_2, D_2)
\end{equation*}
if there exists an orientation preserving homeomorphism \(\phi \colon X_1 \to X_2\), \(\phi|_{D_1} \colon D_1 \xrightarrow\sim D_2\).%
\end{definition}
\begin{theorem}{}{}{g:theorem:idm204345471184}%
%
\begin{equation*}
\{\text{Dessins}\}/\sim \leftrightarrow \{( \sigma_0, \sigma_1),\,\langle \sigma_0, \sigma_1 \rangle \subseteq \Sigma_N \text{ transitive}\}/\sim
\end{equation*}
%
\end{theorem}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.7.2 Dessins 2 Belyi pairs}
\typeout{************************************************}
%
\begin{subsectionptx}{Dessins 2 Belyi pairs}{}{Dessins 2 Belyi pairs}{}{}{g:subsection:idm204345470384}
Triangle decomposition of \((X,D) \leadsto T(D)\) a set of triangles that cover \(D\) and intersect along edges or at vertices.%
\begin{example}{}{g:example:idm204345468800}%
Edge in the sphere, add an extra vertex \(\times\) not on the edge and get a decomposition into two triangles.%
\end{example}
We will label triangles by \(T_j^\pm\) as there are two for each edge, by orientation some are the same.%
\par
%
\begin{equation*}
T(D) \leadsto f_D \colon X\to \hat\CC
\end{equation*}
Glue%
\begin{equation*}
f_j^? \colon T_j^? \to \overline\HH^?
\end{equation*}
for \(?\in \{+,-\}\), where \(f_j^+  = f_j^-\) on the intersection. Where \(\partial T_j \xrightarrow\sim \RR \cup\{\infty\}\)%
\begin{equation*}
\text{black} \mapsto0
\end{equation*}
%
\begin{equation*}
\text{white} \mapsto1
\end{equation*}
%
\begin{equation*}
\times \mapsto\infty
\end{equation*}
and we have \(\operatorname{Branch}(f_D) \subseteq \{0,1,\infty\}\). Now \(\deg f_D = \#\text{edges of }D\), \(m_v(f_D) = \deg v\), \(f_D^{-1}(\lb 0 , 1 \rb) = D\). Modify \(X\) a little bit and use some lemma to get \(S_D \simeq_{\text{top}} X\) for some Riemann surface with \(f_D\colon S_D \to \PP^1\).%
\begin{definition}{}{g:definition:idm204345460784}%
\((S,f)\) is a Belyi pair with \(S\) compact Riemann surface and  \(f\) a Belyi function on \(S\).%
\begin{equation*}
(S_1,f_1) \sim (S_2, f_2)
\end{equation*}
if it is an isomorphism of ramified coverings.%
\end{definition}
So we can now go in both directions.%
\begin{equation*}
\{\text{Dessins}\}/\sim
\end{equation*}
%
\begin{equation*}
\updownarrow
\end{equation*}
%
\begin{equation*}
\{\text{Belyi pairs}\}/\sim
\end{equation*}
%
\begin{equation*}
(X,D) \mapsto (S_D, f_D)
\end{equation*}
%
\begin{equation*}
(S, D_f) \mapsfrom (S,f)
\end{equation*}
%
\par
Now to define the Galois action%
\begin{equation*}
G_\QQ\acts \{\text{Dessins}\}\leftrightarrow \{\text{Belyi pairs}\}
\end{equation*}
%
\begin{equation*}
\xymatrix{
(X,D)\ar[d] \ar@{-->}[r] & (X,D)^\sigma \\
(S_D,f_D)\ar[r] & (S_D^\sigma,f_D^\sigma)^\sigma \ar[u]
}
\end{equation*}
%
\par
The \(G_\QQ\) action is faithful on dessins of genus \(g\).%
\begin{example}{}{g:example:idm204345454304}%
Same example \(\PP^1\) with a single edge, \(f_D  = z\), \(\deg f_D = \#\) edges, \(m_v(f)=  \deg v\).%
\end{example}
\begin{inlineexercise}{}{g:exercise:idm204345452128}%
String.%
\end{inlineexercise}
\begin{inlineexercise}{}{g:exercise:idm204345451600}%
\(n\) star.%
\end{inlineexercise}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.8 A Sandwich Table of Dessins d'Enfants}
\typeout{************************************************}
%
\begin{sectionptx}{A Sandwich Table of Dessins d'Enfants}{}{A Sandwich Table of Dessins d'Enfants}{}{}{x:section:sec-sandwich}
Alex: So I haven't typed this section as it was a lot of pictures and I haven't got nice scans of them, will try at some point (maybe?). Angus' notes can be found at \url{http://math.bu.edu/people/angusmca/buntes/spring2018.html}.%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.9 Belyi's theorem, effective Mordell and ABC (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Belyi's theorem, effective Mordell and ABC (Angus)}{}{Belyi's theorem, effective Mordell and ABC (Angus)}{}{}{x:section:sec-beyi-abc}
We begin with one of the most famous results in arithmetic geometry.%
\begin{theorem}{Mordell conjecture\slash{}Falting's theorem.}{}{g:theorem:idm204345447872}%
Let \(C\) be an algebraic curve of genus \(\ge 2\) over a number field \(K\). Then \(C(K)\) is finite.%
\end{theorem}
There are many proofs of this, Falting's being the original and most famous.%
\begin{remark}{}{g:remark:idm204345445040}%
Falting's proof is not effective. That is, it cannot predict the number of points or give any bounds.%
\end{remark}
Today we'll show how this theorem follows from a (much harder conjecture), but how this nonetheless gives new insight into the question of effectiveness. Specifically we'll show ABC implies Mordell.%
\begin{quote}%
``Mordell is as easy as ABC''- Zagier%
\end{quote}
\begin{conjecture}{ABC.}{}{g:conjecture:idm204345443360}%
Let \(A,B,C\in \ZZ\) s.t. \(\gcd(A,B,C)  =1 \) and \(A+B+C=0\), then for all \(\epsilon \gt 0\) there exists a constant \(k_\epsilon\) s.t.%
\begin{equation*}
N(A,B,C) \gt k_\epsilon H(A,B,C)^{1-\epsilon}
\end{equation*}
where%
\begin{equation*}
N(A,B,C) =  \prod_{p|ABC} p
\end{equation*}
%
\begin{equation*}
H(A,B,C) = \max(|A|,|B|,|C|)\text{.}
\end{equation*}
%
\end{conjecture}
This is a remarkably deep statement about the integers. Something surprising about how one compares the additive and multiplicative structures of the integers.%
\par
For our purposes (to connect it to the curves and Mordell) we'd like to remove the dependence on integrality and coprimality, by making it scaling invariant.%
\par
We now define%
\begin{equation*}
H(A,B,C) = \prod_{v}\max(|A|_v,|B|_v,|C|_v)
\end{equation*}
%
\begin{equation*}
N(A,B,C) =  \prod_{p\in I} p
\end{equation*}
for%
\begin{equation*}
I = \{p \text{ prime} : \max(|A|_p,|B|_p,|C|_p) \gt \min(|A|_p,|B|_p,|C|_p)\}\text{.}
\end{equation*}
%
\begin{inlineexercise}{For sanity.}{g:exercise:idm204345436992}%
%
\begin{equation*}
H(\lambda A,\lambda B,\lambda C)  = H(A,B,C)
\end{equation*}
%
\begin{equation*}
N(\lambda A,\lambda B,\lambda C)  = N(A,B,C)
\end{equation*}
for \(\lambda, A,B,C \in \QQ\units\). Moreover if \(A,B,C \in \ZZ\) and \(\gcd = 1\) then we recover the original definition.%
\end{inlineexercise}
Since we have \(A+ B+C = 0\) and our functions are scaling invariant, they only depend on \(r=  - A/B\). We'll also reformulate it over an arbitrary number field \(K\).%
\par
Note that to satisfy the hypotheses of the conjecture we require%
\begin{equation*}
r \in \PP^1_K \smallsetminus \{0,1,\infty\}\text{.}
\end{equation*}
%
\par
We now define%
\begin{equation*}
H(r) = \prod_{v}\max(1,|r|_v)
\end{equation*}
%
\begin{equation*}
N(r) =  \prod_{p\in I} p
\end{equation*}
for%
\begin{equation*}
I = \{p \text{ prime} : \max(v_p(r), v_p(1/r), v_p(r-1)) \gt 0                      \}\text{.}
\end{equation*}
%
\begin{remark}{}{g:remark:idm204345430480}%
In fact this new height is off from the old one by a constant factor, but since ABC allows for a constant factor this won't trouble us.%
\end{remark}
\begin{paragraphs}{Motivation: ABC implies Fermat bound.}{g:paragraphs:idm204345429952}%
One can see this simply by assuming a solution%
\begin{equation*}
x^n + y^n  =z^n ,\, n \ge3
\end{equation*}
and setting%
\begin{equation*}
(A,B,C)=  (x^n,y^n, z^n)
\end{equation*}
then%
\begin{equation*}
N(A,B,C) = \prod_{p|ABC} p  \le |xyz| \lt \max(|x|^3,|y|^3,|z|^3) = H(A,B,C)^{3/n}\text{.}
\end{equation*}
So setting%
\begin{equation*}
\epsilon = 1 - 3/n
\end{equation*}
for \((A,B,C)\) s.t. \(H(A,B,C)\) is sufficiently large we get a contradiction to ABC. Thus ABC gives us a bound on the possible solutions to the Fermat equation, reducing the remainder of the conjecture to a finite computation.%
\par
Let us phrase this in the following alternate way: Let%
\begin{equation*}
F_n \colon x^n + y^n + z^n = 0
\end{equation*}
be the Fermat curve and consider the function%
\begin{equation*}
f\colon F_n \to \PP^1
\end{equation*}
%
\begin{equation*}
(x:y:z) \mapsto -\left(\frac{x}{y}\right)^n
\end{equation*}
ramified over \(0,1, \infty\).%
\begin{note}{}{g:note:idm204345424480}%
\(\deg(f) = n^2\)%
\par
Each of \(0,1,\infty\) has \(n \) preimages in \(F_n(\overline \QQ)\).%
\end{note}
The idea now is that \(N(A,B, C)\) is measuring ramification, while \(H(A, B,C)\) is a height function. The note above tells us that each of \(0, 1, \infty\) contributes a factor of \(O(H(A,B,C)^{n/n^2})\) to \(N(A,B,C)\). So in this formulation, what we used was the existence of a rational function \(f\) such that%
\begin{equation*}
\#\{p\in C(\overline \QQ): f(p) \in \{0,1,\infty\}\} \lt \deg (f)\text{.}
\end{equation*}
%
\begin{inlineexercise}{}{g:exercise:idm204345419024}%
If \(C\)  has genus 0 or 1, no such \(f\) can exist (hint: Riemann-Hurwitz).%
\end{inlineexercise}
\end{paragraphs}%
\begin{paragraphs}{ABC implies a bound on Mordell.}{g:paragraphs:idm204345417664}%
We begin with a technical proposition:%
\begin{proposition}{}{}{g:proposition:idm204345416944}%
Let \(K\) be a number field an d \(C/K\) a  curve. Let \(f \in K(C)\) be a rational function of degree \(d\). Then for \(p \in C(K) \smallsetminus f\inv(0)\) we have%
\begin{equation*}
\log N_0(f(p)) \lt (1- b_f(0)/d) \log H(f(p)) + O(\sqrt{\log H(f(p))} + 1)
\end{equation*}
with the following notation%
\begin{equation*}
N(r)  =N_0(r) N_1(r) N_\infty(r)
\end{equation*}
%
\begin{equation*}
N_0(r) = \prod_{\ideal p \supseteq (r)} \norm(\ideal p)
\end{equation*}
%
\begin{equation*}
N_1(r) = \prod_{\ideal p \supseteq (1-r)} \norm(\ideal p)
\end{equation*}
%
\begin{equation*}
N_\infty(r) = \prod_{\ideal p \supseteq (1/r)} \norm(\ideal p)
\end{equation*}
%
\begin{equation*}
b_f(0) = \sum_{f(p) = 0} (e_p - 1)\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204345412080}
The genus 0 case follows from the fact that the \(f\) is a rational function (and in fact the error term is \(O(1)\)) (exercise). For the general case we need the theory of log heights on curves. From this we require the following%
\begin{itemize}[label=\textbullet]
\item{}For \(D\) a divisor on \(C\) we have  a height function%
\begin{equation*}
h_D(\cdot)
\end{equation*}
which is well defined up to  \(O(1)\).%
\item{}If%
\begin{equation*}
D=  \sum m_k D_k
\end{equation*}
is a decomposition into irreducible divisors, then%
\begin{equation*}
h_D(P) = \sum m_k h_{D_k}(P)\text{.}
\end{equation*}
%
\item{}For \(\Delta\) a degree 0 divisor%
\begin{equation*}
h_{\Delta} (P) = O(\sqrt{\log H(f(P))} + 1)\text{.}
\end{equation*}
%
\end{itemize}
%
\par
Let \(D = \divisor_0(f) = \sum m_k D_k\), \(D' = \sum_{f(P) = 0} (P)\) then \(b_f(0) = \deg D'\). Then%
\begin{equation*}
\log H(f(P)) = h_D(P) + O(1) = \sum m_k h_{D_k}(P) + O(1)
\end{equation*}
since \(\log H(f(P))\) is also a height function relative to \(D\). We now turn to \(N_0(f(P))\). Any prime occurring in this must also occur in \(h_{D_k}(P)\) for some \(k\) (except for a finite set \(\{p : p|f \text{ or } p \text{ bad red. for } C\}\)). Then%
\begin{equation*}
N_0(f(P))  \lt \sum h_{D_k}(P) + O(1) = h_{D'}(P) + O(1)\text{.}
\end{equation*}
Letting%
\begin{equation*}
\Delta = (\deg D) D' - (\deg D') D
\end{equation*}
we have%
\begin{equation*}
h_{\Delta} (P) = O(\sqrt{\log H(f(P))} + 1)
\end{equation*}
thus%
\begin{equation*}
\log N_0(f(P)) \lt h_{D'} (P) + O(1)
\end{equation*}
%
\begin{equation*}
= \frac{1}{\deg D} (\deg D') h_{D'} (P) + O(1)
\end{equation*}
%
\begin{equation*}
= \frac{1}{\deg D} (\deg D') h_{D} (P) + O(\sqrt{\log H(f(P))} + 1)
\end{equation*}
%
\begin{equation*}
= \frac{1- b_f(0)}{d} \log  H(f(P)) + O(\sqrt{\log H(f(P))} + 1)\qedhere
\end{equation*}
%
\end{proofptx}
\begin{remark}{}{g:remark:idm204345399024}%
One can show the above for \(N_1, N_\infty\) instead making the appropriate replacements for \(f\).%
\end{remark}
Adding the three terms together we get%
\begin{equation*}
\log N_0(f(P))N_1(f(P)) N_\infty(f(P))
\end{equation*}
%
\begin{equation*}
\lt \left(\left(1- \frac{b_f(0)}{d}\right) +\left(1- \frac{b_f(1)}{d}\right)+\left(1- \frac{b_f(\infty)}{d}\right)\right) \log H(f(P)) + O(\cdots)
\end{equation*}
%
\begin{equation*}
\log N(f(P)) \lt \frac 1d \left(\# f\inv(0)+\# f\inv(1)+\# f\inv(\infty) \right) \log H(f(P)) + O(\cdots)
\end{equation*}
%
\begin{equation*}
\lt \frac md \log H(f(P))+ O(\cdots)
\end{equation*}
where%
\begin{equation*}
m = \#\{P \in C(\overline \QQ) : f(P) \in \{0,1,\infty\}\}
\end{equation*}
exponentiating we get%
\begin{equation*}
N(f(P)) \lt H(f(P))^{m/d} K\text{.}
\end{equation*}
%
\begin{theorem}{ABC implies Mordell.}{}{g:theorem:idm204345395024}%
ABC implies Mordell.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345394192}
Let \(C\) be a given curve of genus \(g \ge 2\) Belyi's theorem gives a function%
\begin{equation*}
f\colon C \to \PP^1
\end{equation*}
ramified over \(\{0,1,\infty\}\). By Riemann-Hurwitz \(m  = d + 2 - 2g\), \(d = \deg (f)\) \(m\) as above. Thus \(m \lt d\), thus we can pick \(0 \lt  \epsilon  \lt 1 - \frac md\) and so for sufficiently large \(H(f(P))\) (i.e. all but finitely many) we have a counterexample to ABC.%
\end{proofptx}
\begin{remark}{Closing remarks.}{g:remark:idm204345389488}%
Belyi's theorem gives an algorithm for determining \(f \colon C \to \PP^1\) i.e. it is effective.%
\par
One can also show ABC implies Siegel's theorem.%
\par
In fact it can be shown that a particular effective form of Mordell (applied to \(y^2 + y = x^5\)) for all number fields implies ABC. This is related to Szpiro's conjecture.%
\end{remark}
References:%
\begin{enumerate}
\item{}Elkies - ABC implies Mordell%
\item{}Serre - Lectures on Mordell-Weil%
\end{enumerate}
%
\end{paragraphs}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.10 Dessins, integer points on elliptic curves and a proof of the ABC conjecture (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Dessins, integer points on elliptic curves and a proof of the ABC conjecture (Alex)}{}{Dessins, integer points on elliptic curves and a proof of the ABC conjecture (Alex)}{}{}{x:section:sec-dessins-integer-pts-abc}
%
%
\typeout{************************************************}
\typeout{Subsection 2.10.1 A proof of the ABC theorem (for polynomials)}
\typeout{************************************************}
%
\begin{subsectionptx}{A proof of the ABC theorem (for polynomials)}{}{A proof of the ABC theorem (for polynomials)}{}{}{g:subsection:idm204345369008}
Last week Angus told us about the incredibly powerful ABC conjecture and its arithmetic consequences (apparently). This week we will prove this conjecture (for polynomials). The proof is very similar to some of the things Angus mentioned, but seeing as I wasn't there its new to me... Following Goldring \slash{} Stothers \slash{} Parab.%
\par
Let \(K\) be algebraically closed of characteristic 0, with \(f \in K\lb x \rb\), we can define the radical as before%
\begin{equation*}
\operatorname{rad}(f) = \prod_{p | f} p
\end{equation*}
over the primes\slash{}irreducibles dividing \(f\), this is the maximal squarefree polynomial dividing \(f\). How do we measure the size of a polynomial? Let \(r(f) = \deg \operatorname{rad}(f)\), and \(h(f_1, \ldots, f_n) = \max\{\deg f_i\}\). This is a complicated way of saying%
\begin{equation*}
\#\{x \in K : f(x) = 0 \}\text{,}
\end{equation*}
but we do so to emphasise the link with ABC.%
\par
The result is then%
\begin{theorem}{Mason-Stothers.}{}{g:theorem:idm204345363776}%
Let%
\begin{equation*}
e,f,g\in K[x],\,e + f = g
\end{equation*}
be pairwise coprime and all of height \(\gt 0\). Then%
\begin{equation*}
h(e,f,g) \lt r(efg) = r(e) + r(f)  + r(g)\text{.}
\end{equation*}
%
\par
We have sharpness if and only if \(f/g\) is a Belyi map for \(\PP^1 \to \PP^1\) with \((f/g)(\infty) \in \{0,1,\infty\}\). Another way of saying this is that if \(\deg f = \deg g\) then their leading coefficients are equal, and hence \(\deg (e) \lt \deg (f)\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345359184}
First of all we note that the statement is symmetric in \(e,f,g\), so we may arrange that \(h(g) \le h(e,f)\) which implies that \(h(e) = h(f) = h(e,f,g)\). The second statement is less obviously invariant but note that \(\phi\) is  a Belyi function is equivalent to \(1-\phi\) and \(1/\phi\) being Belyi also and this preserves \(\phi(\infty) \in \{0,1,\infty\}\), so rearranging does not change the truth of the second statement either. Let \(\phi = f/g\) so \(\deg(\phi) = \max\{\deg (f), \deg(g)\} = h(e,f,g)\), we will denote this by \(h\) now. Apply Riemann-Hurwitz (surprise-surprise)%
\begin{equation*}
-2 = -2h + \sum_{x\in \PP^1} e_\phi(x) - 1\text{.}
\end{equation*}
Let%
\begin{equation*}
R_y = \sum_{x : f(x) = y} e_\phi(x) - 1
\end{equation*}
be the ramification above \(y\), we will consider \(B_0, B_1, B_\infty\). These ramification numbers will simply be \(h - \#(\phi\inv(y))\). Lets begin with \(R_1\), we have \(f(x)/g(x) = 1\) so \(e(x) = 0\) and in fact%
\begin{equation*}
R_1 = h(e) - r(e) = h - r(e)\text{.}
\end{equation*}
For \(R_0\) we have either \(f(x) = 0\) or \(g(x) = \infty\). Having \(g(x) = \infty\) means \(x = \infty\) but this cannot really happen as \(h(f) \ge h(g)\). So this is really just%
\begin{equation*}
\sum_{x : f(x) = 0} e_\phi(x) - 1 = h  - r(f)\text{.}
\end{equation*}
Finally \(\phi(x) = \infty\) only when \(g(x) = 0\) or \(x = \infty\). If \(h(f) = h(g)\) then \(\phi(\infty) \ne \infty\) and we have simply%
\begin{equation*}
R_\infty = h - r(g)\text{.}
\end{equation*}
If \(h(g) \lt h(f)\) then we also have \(\phi(\infty) = \infty\) so we pick up an extra preimage and we get instead%
\begin{equation*}
R_\infty = h - (r(g) + 1)\text{.}
\end{equation*}
%
\par
Back up in Riemann-Hurwitz this comes down (magically?) to%
\begin{equation*}
-2 = \cancelto{0}{-2 h + h + h} + h - r(e) -r(f) - r(g) + R - \delta_{h(f) \gt h(g)}
\end{equation*}
so%
\begin{equation*}
R = h - r(efg) - 2 + \delta_{h(f) \gt h(g)}
\end{equation*}
but of course \(R \ge 0\) so%
\begin{equation*}
h \ge r(efg) + 1
\end{equation*}
with equality exactly when%
\begin{equation*}
h = r(efg) + 1 \implies R = 0,\, h(f) \gt h(g)\text{.}
\end{equation*}
\(R= 0\) is equivalent to being Belyi.%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.10.2 Back to number theory}
\typeout{************************************************}
%
\begin{subsectionptx}{Back to number theory}{}{Back to number theory}{}{}{g:subsection:idm204345340464}
That was all well and good, but this is a number theory seminar, not a function field analogues of number theory seminar, so let's take it back to why we are all here, solving Diophantine equations.%
\par
Let's try and find nontrivial integral points on Mordell curves!%
\begin{equation*}
E_k\colon y^2 = x^3 + k\text{.}
\end{equation*}
%
\begin{example}{}{g:example:idm204345338832}%
%
\begin{equation*}
1001^2 = 5009^3 - (5009^3 - 1001^2)
\end{equation*}
so I found a large point on%
\begin{equation*}
y^2 = x^3 - (5009^3 - 1001^2) = x^3 - 125675213728
\end{equation*}
are you not impressed?%
\end{example}
Although this point would look slightly non-trivial if I started with the curve \(5009^3\) is roughly \(125675213728\) anyway so you should only be impressed if I find points of height somewhat larger than the coefficients. We should probably ask that%
\begin{equation*}
|x|^3 \gt |k|
\end{equation*}
by some margin at least.%
\par
A nice question is then given \(k\) how big can an integer point \((x,y)\) on \(E_k\) be? Bounds are known, e.g.  Via work of Baker we get%
\begin{equation*}
\max(|x|, |y|) \lt e^{10^{10}|k|^{1000}}\text{.}
\end{equation*}
Ouch.%
\par
If we want to study more realistic bounds we can instead reverse the problem. Can we minimise \(x^3 - y^2\) for integer \(x,y\), how close can the square of a large integer and the cube of a large integer be? Euler showed that \(|x^3 - y^2| = 1\) has only 1 (interesting) solution, for example.%
\par
Marshall Hall was interested in this, did some nice computations and conjectured:%
\begin{conjecture}{Marshall Hall's conjecture, 1970.}{}{g:conjecture:idm204345331664}%
If%
\begin{equation*}
x^3 - y^2 = k
\end{equation*}
for integers \(x,y\) then%
\begin{equation*}
|k| \gt \frac{\sqrt{|x|}}{5}
\end{equation*}
(or \(k =0\)...).%
\end{conjecture}
This is false!%
\begin{example}{Elkies (who else?).}{g:example:idm204345328912}%
If%
\begin{equation*}
x= 5853886516781223,\,y = 447884928428402042307918
\end{equation*}
is a point on%
\begin{equation*}
y^2 = x^3 - 1641843
\end{equation*}
then%
\begin{equation*}
\frac{\sqrt{|x|}}{k} = 46.6004943471754\text{.}
\end{equation*}
%
\end{example}
This is far larger than the previous best known, but still remains the record as far as I can tell. It seems Hall's conjecture is unlikely to be true for any fixed constant, but the following of Stark-Trotter is more believable.%
\begin{conjecture}{Stark-Trotter\slash{}Weak Hall.}{}{g:conjecture:idm204345326288}%
For any  \(\epsilon \gt 0\) there is some \(C(\epsilon)\) such that for any \(x,y\) integers%
\begin{equation*}
|x^3 - y^2| \gt C(\epsilon) x^{\frac12 - \epsilon}
\end{equation*}
for any \(x \gt C(\epsilon)\).%
\end{conjecture}
If Hall's\slash{}Stark-Trotter is true we get a \emph{huge} improvement on Baker%
\begin{equation*}
\frac{\sqrt{|x|}}{|k|} \lt 100 \implies x \lt 10^4k^2
\end{equation*}
and hence%
\begin{equation*}
y^2 = x^3 + k \lt 10^{12}k^6 + k
\end{equation*}
giving polynomial bounds on \(x,y\) in terms of \(k\).%
\par
How might one find such triple \((x,y,k)\) that is extremal? One approach is to try and come up with a parametrisation of nice triples. We can search for polynomials \(X(t),Y(t), K(t)\) and then plug in various integer values for \(t\) and hope for the best. To give ourselves the best chance of succeeding we want \(K(t)\) to be smaller than \(X(t)^3\) and \(Y(t)^2\) for some values of \(t\). This leads us to ask for \(K\) to be of smallest degree possible. So how low can we go?%
\par
This is the point where we come full circle right, we are searching for%
\begin{equation*}
X(t)^3 - Y(t)^2 = K(t)
\end{equation*}
with degree of \(K\) minimised, so we apply Mason-Stothers to see that, if \(M\) is the degree of the left hand terms we have \(\deg(X) = 2m\) and \(\deg (Y) = 3m\), indeed \(h\) in Mason-Stothers is then \(6m\) We also have \(r(X^3) = r(X) \le 2m\) and \(r(X^2) = r(Y) \le 3m\) so together Mason-Stothers gives%
\begin{equation*}
6m \lt 2m + 3m + r(K)
\end{equation*}
or \(m \lt r(K)\). So we have lower-bounded the degree of \(K\) in terms of \(\frac 12 \deg(X)\) for example.%
\par
We just proved:%
\begin{conjecture}{Birch B. J., Chowla S., Hall M., Jr., Schinzel A. On the difference \(x^3 - y^2\), 1965..}{}{g:conjecture:idm204345310784}%
Let \(X, Y\) be two coprime polynomials with \(X^3,Y^2\) of equal degree (\(6m\)) and equal leading coefficient, then%
\begin{equation*}
K = X^3 - Y^2
\end{equation*}
is of degree \(\gt m\).%
\par
(Now the speaker has just given a theorem with an inequality, so in order to appear smart one of you should ask is this bound sharp.)%
\par
The bound is sharp, this can mean several things in general, originally it was asked that for infinity many \(m\) there is an example where \(\deg K = m + 1\).%
\end{conjecture}
The first part was proved initially by Davenport (in the same year, and journal). The second part had to wait until '81 for Stothers to prove it.%
\par
Someone else should probably also ask, how is any of this related to Dessins?%
\par
To prove sharpness we have to exhibit for each \(m\) triple of polynomials \(X,Y,K\) of degrees \(2m,3m,m+1\). Coming up with polynomial families is hard, drawing stupid pictures is easy, can Dessins aid us here?%
\par
Lets back-track, when we proved Mason-Stothers we also said that sharpness was equivalent to \(f/g\) being Belyi, so \(X(t)^3/K(t) = (K(t) + Y(t)^2) / K(t) = Y(t)^2/K(t) + 1\) should be a Belyi map of degree \(6m\) from \(\PP^1\to \PP^1\). What does its ramification look like? We should have all preimages of \(0\) degree 3, preimages of \(1\) degree 2, and above infinity \(m + 1\) points of degree \(1\) and the remaining of degree \(6m - (m + 1) = 5m - 1\).%
\par
How can we draw a Dessin like this? Begin with a tree with all internal vertices degree 3, with \(2m\) vertices, this will have \(2m - 1\) edges, and as it is trivalent by the handshake lemma%
\begin{equation*}
3 \#\{\text{internal}\} + \#\{\text{leaves}\} =  4m - 2
\end{equation*}
and%
\begin{equation*}
\#\{\text{internal}\} + \#\{\text{leaves}\} =  2m
\end{equation*}
giving%
\begin{equation*}
2\#\{\text{internal}\} =  2m - 2
\end{equation*}
%
\begin{equation*}
\#\{\text{internal}\} =  m - 1
\end{equation*}
%
\begin{equation*}
\#\{\text{leaves}\} =  m + 1
\end{equation*}
Add loops to the leaves, you now have a clean Dessin as above. It has \(2m- 1 + m + 1 = 3m\) edges. We have a face for every loop of degree 1, and one on the outside of degree \(m+ 1 +2(2m-1)  = 5m - 1\) as each internal edge is traversed twice if you walk around the outside. So this works!%
\begin{example}{}{g:example:idm204345294848}%
For \(m= 1\)%
\begin{equation*}
(x^2 + 2)^3 - (x^3 + 3x)^2 = 3x^2 + 8\text{.}
\end{equation*}
\(m= 2\)%
\begin{equation*}
(x^4 - 4x)^3 - (x^6 -6x^3+6)^2  = 8x^3 - 36\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204345292912}%
For \(m =5\)%
\begin{equation*}
X(t) = \frac 19 (t^{10} + 6t^7 +15 t^4 + 12t)
\end{equation*}
%
\begin{equation*}
Y(t) = \frac{1}{54} (2t^{15} + 18t^{12} +72 t^9 + 144 t^6 + 135 t^3 + 27)
\end{equation*}
%
\begin{equation*}
K(t) = -\frac{1}{108} (3t^{6} + 14t^3 +27)
\end{equation*}
and we can let \(t = -3\) to get \(X(-3) = 5234\), \(Y(-3) = -378661\) and \(K(-3) = -17\), so we have a point%
\begin{equation*}
(5234, 378661) \in E_{17} \colon y^2 = x^3 + 17
\end{equation*}
letting \(t = \pm 9\) we get%
\begin{equation*}
|384242766^3 - 7531969451458^2| = 14668
\end{equation*}
%
\begin{equation*}
|390620082^3 - 7720258643465^2| = 14857
\end{equation*}
both of which have%
\begin{equation*}
\frac{\sqrt{|x|}}{k} \approx 1.33\text{,}
\end{equation*}
these get lower as we increase \(t\) though.%
\end{example}
We should expect this decrease from this method as if \(\deg X = 2m\) and \(\deg K = m + 1\) then \(\sqrt{X(t)}/K(t)\) grows like \(t^{m}/t^{m+1} = t\inv\).%
\par
Can we do the same for abc?%
\par
Take the Dessin with a deg 1 vertex at infinity, degree 3 at 0 with an edge surrounding 1, we get a Belyi function%
\begin{equation*}
f(x) = \frac{64x^3}{(x+9)^3 (x+1)},\,f(x) - 1 = -\frac{(x^2 - 18x -27)^2}{(x+9)^3(x+1)}
\end{equation*}
plugging in \(x=a/b\) and cross multiplying gives%
\begin{equation*}
64a^3 b + (a^2 - 18ab - 27b^2)^2 = (a+9b)^3(a+b)
\end{equation*}
which could of course be verified independently, but how would you find this identity without Dessins? Now for \(a = -32, b= 23\) we get%
\begin{equation*}
- 2^{21} \cdot 23 +  11^2 =  -1 \cdot 3^2 \cdot 5^6 \cdot 7^3
\end{equation*}
or%
\begin{equation*}
11^2 + 3^2 \cdot 5^6 \cdot 7^3 = 2^{21} \cdot 23
\end{equation*}
This is the second highest quality abc triple known with quality%
\begin{equation*}
\frac{\log c}{\log R} = 1.62599
\end{equation*}
(the current winner has quality \(1.6299\)).%
\begin{paragraphs}{References.}{g:paragraphs:idm204345280432}%
A semi-random order, maybe starting at the top is nice though. If you have trouble finding something let me know.%
\begin{enumerate}
\item{}On Computing Belyi Maps - J. Sijsling, J. Voight%
\item{}Belyi Functions: Examples, Properties, and Applications - Zvonkin (really nice survey)%
\item{}On Davenport’s bound for the degree of \(f^3 - g^2\) and Riemann's Existence Theorem - Umberto Zannier%
\item{}Unifying Themes Suggested by Belyi's Theorem - Wushi Goldring%
\item{}Polynomial Identities and Hauptmoduln - W. W. Stothers%
\item{}Elliptic Surfaces and Davenport-Stothers Triples -  Tetsuji Shioda%
\item{}The abc-theorem, Davenport’s inequality and elliptic surfaces - Tetsuji Shioda%
\item{}It's As Easy As abc -  Andrew Granville, Thomas J. Tucker%
\item{}Polynomial and Fermat-Pell families that attain the Davenport-Mason bound - Noam D. Elkies, Mark Watkins (on Watkins webpage)%
\item{}Halltripels en kindertekeningen - Hans Montanus (in Dutch, but math is universal right?)%
\item{}Computational Number Theory and Algebraic Geometry Spring 2012, taught by Noam Elkies, notes by Jason Bland%
\item{}Davenport-Zannier polynomials over \(\QQ\) - Fedor Pakovich, Alexander K. Zvonkin (a nice extension perhaps?)%
\item{}Minimum Degree of the Difference of Two Polynomials over Q, and Weighted Plane Trees -  Fedor Pakovich,  Alexander K. Zvonkin (as above)%
\item{}The ABC-conjecture for polynomials - Abhishek Parab%
\item{}On Marshall Hall's Conjecture and Gaps Between Integer Points on Mordell Elliptic Curves - Ryan D'Mello%
\item{}Neighboring powers - F. Beukers, C. L. Stewart (a more general problem, but nice history and examples)%
\item{}Rational Points Near Curves and Small Nonzero \(| x^3 - y^2|\) via Lattice Reduction - Elkies%
\item{}ABC implies Mordell - Elkies%
\item{}Dessins d'enfant -  Jeroen Sijsling (master thesis)%
\item{}Algorithms and differential relations for Belyi functions - Mark van Hoeij, Raimundas Vidunas.%
\item{}Belyi functions for hyperbolic hypergeometric-to-Heun transformations -  Mark van Hoeij, Raimundas Vidunas (has application to ABC over number fields at the end)%
\item{}Some remarks on the S-unit equation in function fields  - Umberto Zannier%
\item{}A note on integral points on elliptic curves - Mark Watkins%
\item{}On Hall’s conjecture - Andrej Dujella (more recent progress)%
\item{}Hecke Groups, Dessins d'Enfants and the Archimedean Solids -  Yang-Hui He, and James Read%
\item{}Belyi functions for Archimedean solids - Nicolas Magot, Alexander Zvonkin (didn't really use this but it's nice!)%
\end{enumerate}
%
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.11 Three Short Stories about Belyi's theorem (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Three Short Stories about Belyi's theorem (Ricky)}{}{Three Short Stories about Belyi's theorem (Ricky)}{}{}{x:section:sec-three-short-stories-belyi}
\begin{introduction}{}%
\begin{theorem}{}{}{g:theorem:idm204345268032}%
\(X /\CC\) a curve. Then \(X\) is defined over \(\overline \QQ\) iff there exists a Belyi map%
\begin{equation*}
\phi \colon X\to \PP^1
\end{equation*}
such that \(B(\phi) \subseteq  \{0,1,\infty\}\).%
\end{theorem}
Main reference: Unifying Themes Suggested by Belyi's Theorem - Wushi Goldring%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.11.1 The case of the Rising Degree}
\typeout{************************************************}
%
\begin{subsectionptx}{The case of the Rising Degree}{}{The case of the Rising Degree}{}{}{g:subsection:idm204345265232}
\begin{definition}{}{x:definition:def-belyi-degree}%
The \terminology{Belyi degree} of \(X/\overline \QQ\) (a curve) is the minimal degree of \(\phi\colon X \to \PP^1\) a Belyi map.%
\end{definition}
Question, how does the Belyi degree of \(X/\overline \QQ\) relate to the arithmetic of \(X\)?%
\begin{definition}{}{x:definition:def-field-of-moduli}%
The \terminology{field of moduli} of \(X/\overline\QQ\) is the intersection over all fields \(\subseteq \overline \QQ\) over which \(X\) is defined. Similarly for a morphism \(\phi \colon X \to Y\).%
\end{definition}
\begin{remark}{}{g:remark:idm204345258464}%
This is not the same as the field of definition always.%
\end{remark}
Given \(X/\overline \QQ\) with field of moduli \(K\) we say \(X\) has good (resp. semistable) reduction at \(\ideal p \subseteq \ints_K\) if there exists a model for \(X\) over \(\ints_{K_{\ideal p}}\) s.t. the special fibre is smooth (resp. semistable) reduction.%
\par
For \(p\in \ZZ\) we say \(X\) has good\slash{}semistable reduction at \(p\) if it dies for all \(\ideal p | p\).%
\begin{theorem}{Zapponi.}{}{x:theorem:thm-zapponi}%
If \(X/\overline \QQ\) then the Belyi degree of \(X\) is at least the largest prime \(p \in \ZZ\) such that \(X\) has bad semistable reduction at \(p\).%
\end{theorem}
\begin{remark}{}{g:remark:idm204345250048}%
%
\begin{enumerate}
\item{}The lower bound is not ``sharp'' because  there exist \(E/K\) with good reduction everywhere, but no degree 1 maps \(\phi \colon E \to \PP^1\).%
\item{}If%
\begin{equation*}
E\colon y^2 = x^3 + x^2 + p
\end{equation*}
then \(E\) has bad semistable reduction at \(p\) so the Belyi degree of \(E\) is \(\ge p\).%
\end{enumerate}
%
\end{remark}
\begin{theorem}{Beckmann.}{}{x:theorem:thm-beckmann}%
Let \(\phi \colon X \to \PP^1\) be a Belyi map with field of moduli \(M\). Let \(G\) be the Galois group of the Galois closure of \(\phi\). Then for all \(p\) such that \(p \nmid |G|\), \(\tilde \phi \colon \tilde X \to \PP^1\) has good reduction at \(p\) and \(p\) is unramified in \(M\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345240432}
Of Zapponi.%
\par
Let \(\phi\colon X \to \PP^1\) be a Belyi map of degree \(n\). Let \(K\) be the field of moduli of \(X\), \(M\) the field of moduli of \(\phi\) then \(M/K\) is a finite extension. Take \(G\) as above and let \(\ideal p \subseteq \ints_K\) be a place of bad semistable reduction for \(X\). Then \(\wp| \ideal p\) for \(\wp \subseteq \ints_M\) is a place of bad semistable reduction for \(\phi\). By \hyperref[x:theorem:thm-beckmann]{Theorem~\ref{x:theorem:thm-beckmann}} \(p \mid |G|\) for \(p\in \ZZ\) below \(\ideal p\) but \(G \hookrightarrow S_n\) which implies \(p|n!\) so \(p\le n\).%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.11.2 Finitists Dream}
\typeout{************************************************}
%
\begin{subsectionptx}{Finitists Dream}{}{Finitists Dream}{}{}{g:subsection:idm204345231296}
Recall that if \(k \) is a perfect field of characteristic \(p\) then%
\begin{equation*}
\phi \colon C_1 \to C_2
\end{equation*}
is said to be tamely ramified at \(P\in C_1\) if \(p\nmid e_\phi(P)\) (wildly ramified if \(p |e_\phi(P)\)).%
\begin{theorem}{Wild \(p\)-Belyi.}{}{g:theorem:idm204345228064}%
For \(C\) a curve over \(k\) perfect of characteristic \(p\), there exists a ``wild Belyi map''%
\begin{equation*}
\phi \colon C\to \PP^1
\end{equation*}
such that \(B(\phi) = \{\infty\}\). I.e. every curve \(/k\) is birational to an étale cover of \(\aff^1\).%
\end{theorem}
\begin{example}{}{g:example:idm204345223584}%
%
\begin{equation*}
\mathbf G_m \to \aff^1
\end{equation*}
%
\begin{equation*}
x \mapsto x^p + \frac 1x
\end{equation*}
but the tame étale fundamental group of \(\aff^1\) is 0.%
\end{example}
\begin{theorem}{Tame \(p\)-Belyi (Saidi).}{}{g:theorem:idm204345222016}%
Let \(p \gt 2\). For \(C/\overline \FF_p\) there exists \(\phi\colon C \to \PP^1\) tamely ramified everywhere (i.e. possibly unramified) with%
\begin{equation*}
B(\phi) \subseteq \{0,1,\infty\}\text{.}
\end{equation*}
%
\end{theorem}
\begin{lemma}{Fulton.}{}{g:lemma:idm204345219056}%
Let \(p \gt 2\) then for \(C/k\) (\(k\) algebraically closed of characteristic \(p\)) there exists \(\psi \colon C\to \PP^1\) such that%
\begin{equation*}
e_\psi(P) \le 2\text{.}
\end{equation*}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204345215792}
Of Tame \(p\)-Belyi%
\par
Take \(\psi \colon C\to \PP^1\) as in the lemma then%
\begin{equation*}
B(\psi) \subseteq \PP^1(\FF_{p^m})
\end{equation*}
for some \(m\). Define%
\begin{equation*}
f\colon \PP^1\to \PP^1
\end{equation*}
by%
\begin{equation*}
x\mapsto x^{p^m -1}\text{.}
\end{equation*}
Take \(\phi = f\circ \psi\). So \(\pi\) is tamely ramified everywhere and \(B(\phi) \subseteq \{0,1,\infty\}\).%
\end{proofptx}
Analogue of Fulton's lemma is that there exists%
\begin{equation*}
\tau \colon C\to \PP^1
\end{equation*}
for \(\characteristic (k) \ne 3\) such that \(e_\tau(P) = 1\) or \(3\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.11.3 In the Stacks}
\typeout{************************************************}
%
\begin{subsectionptx}{In the Stacks}{}{In the Stacks}{}{}{g:subsection:idm204345209312}
\begin{observation}{}{g:observation:idm204345208912}%
\(\PP^1 \smallsetminus \{0,1,\infty\}\) is the moduli space of genus 0 curves with four (ordered) marked points.%
\begin{equation*}
(\PP^1, \alpha_1,\alpha_2,\alpha_3,\alpha_4) \mapsto \im(\alpha_4) \text{ when } \alpha_1 \mapsto 0,\alpha_2\mapsto 1, \alpha_3 \mapsto \infty\text{.}
\end{equation*}
%
\end{observation}
\begin{definition}{}{g:definition:idm204345207616}%
Let \(\mathcal M_{g,n}\) be the moduli space of genus \(g\) curves with \(n\) (ordered) marked points (then \(\mathcal M_{g,\lb n\rb}\) is the same for unordered points). If \(n\) is large enough relative to \(g\) then \(\mathcal M_{g,n}\) will be a scheme (but the unordered version will not).%
\end{definition}
\begin{example}{}{g:example:idm204345204064}%
%
\begin{equation*}
\mathcal M_{0,4} \simeq \PP^1 \smallsetminus \{0,1,\infty\}
\end{equation*}
%
\end{example}
\begin{question}{Braungardt.}{g:question:idm204345203328}%
Is every \(X/\overline \QQ\) (smooth projective variety) birational to a finite étale cover of some \(\mathcal M_{g,\lb n \rb}\)?%
\end{question}
\begin{note}{}{g:note:idm204345201616}%
There exists an étale map%
\begin{equation*}
\mathcal M_{g,n} \to \mathcal M_{g,[n]}
\end{equation*}
by forgetting the ordering of the points.%
\end{note}
So the dimension 1 case of the conjecture is Belyi's theorem, by%
\begin{equation*}
X\smallsetminus \phi\inv (B(\phi)) \to \PP^1 \smallsetminus \{0,1,\infty\} \simeq \mathcal M_{0,4} \to\mathcal M_{0,[4]}\text{.}
\end{equation*}
%
\par
In dimension 2 we have \(\mathcal M_{1,\lb 2 \rb}\) and \(\mathcal M_{0,\lb 5 \rb}\), the only 2-d spaces of interest. We also  have an étale map%
\begin{equation*}
\mathcal M_{1,[2]} \xrightarrow\alpha \mathcal M_{0,[5]}
\end{equation*}
as follows:%
\begin{equation*}
\eta = (E; \{q_1,q_2\}) \in \mathcal M_{1,[2]}
\end{equation*}
with%
\begin{equation*}
\alpha(\eta) = (\PP^1; \{r_1,r_2,r_3,r_4,r_5\})
\end{equation*}
where the \(r_i\) come from constructing a projection \(\phi\) from \(E\) to \(\PP^1\) situated perpendicularly to the line joining \(q_1,q_2\). This then has 4 ramification points%
\begin{equation*}
B(\phi) = \{r_1,r_2,r_3,r_4\}
\end{equation*}
and \(r_5 = \phi(q_1) = \phi(q_2)\). So Braungardt for surfaces \((X/\overline \QQ)\)? Does there exist \(\phi \colon X \to \mathcal M_{0,\lb 5 \rb}\) which is étale?%
\begin{theorem}{Braungardt.}{}{g:theorem:idm204345193280}%
For \(X/\overline \QQ\) an abelian surface \(X\) is birational to an étale cover of \(\mathcal M_{0,\lb 5 \rb}\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204345191184}
Sketch.%
\par
For an abelian surface over \(\overline \QQ\) there exists another isogenous to it which is principally polarized. Such surfaces come in two flavours%
\begin{equation*}
E_1 \times E_2
\end{equation*}
or \(J(C)\) for \(C\) of genus 2.%
\par
Case 1:%
\par
Let \(\phi_i \colon E_i \to \PP^1\smallsetminus \{0,1,\infty\}\) be Belyi maps. Then we have \(\alpha \colon A \xrightarrow{\phi_1,\phi_2} \PP^1 \times \PP^1\). Then \(\alpha\) restricts to a finite unramified cover%
\begin{equation*}
\alpha\inv (S) \xrightarrow \alpha S
\end{equation*}
where%
\begin{equation*}
S = (\PP^1 \smallsetminus \{0,1,\infty\} \times \PP^1 \smallsetminus \{0,1,\infty\}) \smallsetminus \Delta\text{.}
\end{equation*}
Note that \(S \simeq \mathcal M_{0,5}\) by%
\begin{equation*}
(a,b ) \mapsto (\PP^1; \{0,1,\infty, a,b\})\text{.}
\end{equation*}
So \(A\) is birational to \(\alpha\inv (S)\) which is an étale cover of \(\mathcal M_{0,\lb 5 \rb}\).%
\par
Case 2%
\par
If \(A = J(C)\) then use \(\phi \colon C \to \PP^1\) and a relation between \(A\) and \(\Sym^2(C)\).%
\end{proofptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.12 Dessins in Physics (Jim)}
\typeout{************************************************}
%
\begin{sectionptx}{Dessins in Physics (Jim)}{}{Dessins in Physics (Jim)}{}{}{x:section:sec-dessins-physics}
\begin{paragraphs}{Physics.}{g:paragraphs:idm204345180560}%
Let  \(M\)  be a manifold with  a metric \(g\). We call the pair \((M,g)\) a ``spacetime manifold''. Let \(\mathcal E\) be  a ``space of fields'', either \(\cinf (M)\), sections of some \(E\to M\), connections, or similar.%
\begin{equation*}
S(\phi) = \int_M \mathcal    L (\phi)
\end{equation*}
for \(\phi\in \mathcal E\) and \(\mathcal L\) the Lagrangian. ``Physically realisable states'' are then fields \(\phi\) that minimise \(S(\phi)\). \(W\) is a superpotential, this is a term in \(\mathcal L\) that satisfies some special symmetries. E.g. we could also have%
\begin{equation*}
S(\phi_1, \phi_2) = \int_M \mathcal L(\phi_1,\phi_2)
\end{equation*}
the \(W\) might satisfy \(W(\phi_1, \phi_2) = W(\phi_2, \phi_1)\).%
\begin{definition}{Gauge transformations.}{x:definition:def-gauge-transformations}%
Let \(G \acts E \xrightarrow p M\) be an action s.t. each fibre \(E_x = p \inv(x)\) is a representation of \(G\). A \terminology{gauge} is a section \(s(x)\) of \(E \to M\). A \terminology{gauge transformation} is a map \(g\colon M \to G\) s.t.%
\begin{equation*}
g(x) s(x)
\end{equation*}
is another section, call \(G\) the \terminology{gauge group}. The important gauge transformations are the ones that fix the set of physically realisable states (i.e. fixes the subset of \(\mathcal E\) that minimise \(S\)).%
\end{definition}
\end{paragraphs}%
\begin{paragraphs}{Quivers and dessins.}{g:paragraphs:idm204345165056}%
Let's now study the relationship between quivers and dessins.%
\begin{example}{}{g:example:idm204345164320}%
\(\mathcal N = 4\) SYM (supersymmetric Yang-Mills) (Gauge symmetries given by some product of \(\specialunitary (N)\)) .%
\end{example}
A quiver is a directed graph, possibly with self-loops. Here we think of the nodes as corresponding to factors of the gauge group. And the arrows as fields, so in a bouquet with 3 petals we have three fields, and only \(G = \specialunitary (N)\).%
\par
There is also the notion of a periodic quiver (a tiling of the plane). We can take the triangular lattice and consider its dual, this is a hexagonal tiling with a bicolouring corresponding to the fact we had upwards pointing and downwards pointing triangles. This is a Dimer model.%
\par
Relating the Dimer model back to physics: We have hexagonal faces in correspondence with factors of the Gauge group, and edges fields, with vertices terms in \(W\).%
\par
So one distinct face gives one factor in the gauge group so \(G = \specialunitary (N)\). 3 distinct edges give 3 fields \(X_1, X_2, X_3\). To recover \(W\) consider the permutation arising from reading the edges around the vertices counterclockwise. A black vertex \((1,2,3)\) gives \(\sigma_B\) corresponding to a positive term in \(W\). A white vertex \((1,2,3)\) gives \(\sigma_W\) corresponding to a negative term in \(W\). Then \(\sigma_\infty = (\sigma_B\sigma_W)\inv = (123)\) \(\sigma_i\) gives a term for each cycle. Each cycle in \(\sigma_B\) gives a product of fields indexed by the cycle, e.g. in this example \(\sigma_B\) gives \(X_1X_2X_3\). Each cycle in \(\sigma_W\inv\) gives a product of fields indexed by the cycle, e.g. in this example \(\sigma_W\) gives \(X_1X_3X_2\). Then%
\begin{equation*}
W = \trace((\text{sim of }\sigma_B\text{ terms}) - (\text{sim of }\sigma_W\text{ terms}))
\end{equation*}
%
\begin{equation*}
= \trace(X_1X_2X_3 - X_1X_3X_2)\text{.}
\end{equation*}
%
\par
%
\begin{equation*}
\Aut( \{\sigma_B,\sigma_W,\sigma_\infty\}) = \{ \gamma\in S_3: \gamma\sigma_i \gamma\inv = \sigma_i)
\end{equation*}
%
\begin{equation*}
= \{1,(123), (132)\}
\end{equation*}
%
\begin{equation*}
= \ZZ/3\ZZ\text{.}
\end{equation*}
%
\par
The fundamental domain of the Dimer gives a dessin on the torus with two vertices of degree 3. This corresponds to the Belyi pair \((\Sigma, \beta)\) where%
\begin{equation*}
\Sigma \colon y^2 = x^3 + 1
\end{equation*}
%
\begin{equation*}
\beta \colon \Sigma  \to \PP^1
\end{equation*}
%
\begin{equation*}
(x,y) \mapsto \frac{y+1}{2}\text{.}
\end{equation*}
%
\begin{equation*}
\Aut(\Sigma, \beta) \simeq \Aut(\{\sigma_B,\sigma_W, \sigma_\infty\})
\end{equation*}
\(\Aut(\Sigma, \beta)\) is generated by%
\begin{equation*}
(x,y) \mapsto (w^3 x,y)
\end{equation*}
where \(w^3 = 1\).%
\begin{example}{}{g:example:idm204345147632}%
Take the quiver with two vertices and two edges in each direction connecting them. This has 4 fields and two factors of \(G\) (i.e. \(G = \specialunitary (N) \times \specialunitary (N)\)). The dimer is a square lattice alternately coloured, with \(\sigma_B = \sigma_W = (1234), \sigma_\infty = (13)(24)\).%
\begin{equation*}
W = \trace (X_1X_2X_3X_4 - X_1 X_4 X_3 X_2)\text{.}
\end{equation*}
In this case the Belyi pair is%
\begin{equation*}
\Sigma \colon y^2= x(x-1)(x-\frac12)
\end{equation*}
%
\begin{equation*}
\beta = \frac{x^2}{2x-1}\text{.}
\end{equation*}
%
\begin{equation*}
\Aut(\{\sigma_B,\sigma_W, \sigma_\infty\}) = \langle (1234) \rangle \simeq \ZZ/4\ZZ
\end{equation*}
%
\begin{equation*}
\phi_\pm \colon (x,y) \mapsto \left(\frac{x}{2x -1},\frac{\pm i}{(2x-1)^2} \right)
\end{equation*}
%
\begin{equation*}
\phi_+^2 = \phi_-^2 \colon (x,y) \mapsto (x,-y)
\end{equation*}
%
\begin{equation*}
\phi_+^3 = \phi_+\inv = \phi_-
\end{equation*}
%
\begin{equation*}
\phi_+^4 = 1
\end{equation*}
so%
\begin{equation*}
\Aut(\Sigma, \beta) \simeq \ZZ/4\ZZ
\end{equation*}
%
\begin{equation*}
\beta\inv(0)= \{(0,0)\}
\end{equation*}
%
\begin{equation*}
\beta\inv(1)= \{(1,0)\}
\end{equation*}
%
\begin{equation*}
\beta\inv(\infty)= \{(\frac 12,0), (\infty,\infty)\}
\end{equation*}
on the Dimer we have the square lattice so taking a fundamental domain containing  of the vertices we see the torus as a topology.%
\end{example}
\begin{example}{Final example.}{g:example:idm204345141264}%
Let's jump straight to the Dimer the hexagonal lattice with fundamental domain containing 6 vertices. We have 9 fields and three factors in the gauge group \(G = \specialunitary (N)^2\).%
\begin{equation*}
\sigma_B = (147)(258)(369)
\end{equation*}
%
\begin{equation*}
\sigma_W = (123)(456)(789)
\end{equation*}
%
\begin{equation*}
\sigma_\infty = (195)(276)(384)
\end{equation*}
so%
\begin{equation*}
W = \trace \sum_{i,j,k} X_{12}^iX_{23}^j X_{31}^k \epsilon_{ijk}
\end{equation*}
where%
\begin{equation*}
\epsilon_{ijk} = \begin{cases} \sgn(ijk) \amp\text{if }i,j,k \text{ distinct}\\ 0 \amp\text{otw}\end{cases}
\end{equation*}
\(X_{12}^i\) acts on the \(i\)th field by \(N, \bar N, 1\) where \(N\) is the canonical representation, \(\bar N\) the anticanonical and \(1\) is trivial.%
\begin{equation*}
\Aut(\{\sigma_B,\sigma_W, \sigma_\infty\})  \simeq \ZZ/3\ZZ\times \ZZ/3\ZZ
\end{equation*}
now the Belyi pair%
\begin{equation*}
\Sigma = \text{projective closure of } F = \{(x,y) : x^3+ y^3 =1\}
\end{equation*}
%
\begin{equation*}
\beta(x,y) = x^3
\end{equation*}
%
\begin{equation*}
\gamma_1(x,y) = (w_1 x, y)
\end{equation*}
%
\begin{equation*}
\gamma_2(x,y) = (x,w_2  y)
\end{equation*}
%
\begin{equation*}
w_i^3 = 1\text{.}
\end{equation*}
%
\end{example}
\end{paragraphs}%
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 3 Supersingular isogeny graphs and Quaternion Algebras}
\typeout{************************************************}
%
\begin{chapterptx}{Supersingular isogeny graphs and Quaternion Algebras}{}{Supersingular isogeny graphs and Quaternion Algebras}{}{}{x:chapter:chapter-supersing-isog}
\begin{introduction}{}%
These are notes for BUNTES Fall 2018, the topic is Supersingular isogeny graphs and Quaternion Algebras.%
\par
\url{http://math.bu.edu/people/midff/buntes/fall2018.html}.%
\par
Outline:%
\begin{enumerate}
\item{}Background, isogeny graphs, applications.%
\item{}Supersingular isogeny graph cryptography (candidate for post-quantum cryptography).%
\item{}Introduction to Quaternion algebras.%
\item{}The Deuring correspondence:%
\begin{equation*}
\left\{ \text{maximal orders }\ints \subseteq B_{p,\infty}\right\}/\sim \leftrightarrow \left\{ j \text{ s.s. }\in \FF_{p^2}\right\}/\Gal{\FF_{p^2}}{\FF_p}\text{.}
\end{equation*}
%
\end{enumerate}
%
\par
References: [\hyperlink{x:biblio:bib-sutherland}{95}, \hyperlink{x:biblio:bib-voight-quat}{101}, \hyperlink{x:biblio:bib-velu}{100}]%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 3.1 Isogeny graphs: background and motivation (Maria Ines)}
\typeout{************************************************}
%
\begin{sectionptx}{Isogeny graphs: background and motivation (Maria Ines)}{}{Isogeny graphs: background and motivation (Maria Ines)}{}{}{x:section:sec-supersing-isog-graphs}
%
%
\typeout{************************************************}
\typeout{Subsection 3.1.1 Background}
\typeout{************************************************}
%
\begin{subsectionptx}{Background}{}{Background}{}{}{x:subsection:subsec-supersing-isog-background}
Let \(k = \FF_q\), \(\characteristic (k) = p \ne 2,3\).%
\begin{definition}{Elliptic curves.}{x:definition:def-supersing-isog-ec}%
An \terminology{elliptic curve} \(E/k\) is a smooth projective curve of genus 1 together with a point \(\infty \in E(k)\).%
\end{definition}
We can always write such a curve using a Weierstrass equation%
\begin{equation*}
E\colon y^2=  x^3  + ax  +b,\,a,b    \in k
\end{equation*}
\(E\) is really the projective closure of this affine equation.%
\begin{definition}{\(j\)-invariants.}{x:definition:def-supersing-isog-j-inv}%
The \(j\)-invariant of an elliptic curve \(E\) is%
\begin{equation*}
j(E) = j(a,b) = 1728 \frac{4a^3}{4a^3 + 27b^2}
\end{equation*}
doesn't depend on the choice of Weierstrass equation.%
\end{definition}
\begin{fact}{}{}{g:fact:idm204345119280}%
%
\begin{enumerate}
\item{}\(E,E'\) are isomorphic over \(\overline k \iff j(E)  = j(E')\).%
\item{}There is a 1-1 correspondence%
\begin{equation*}
k \leftrightarrow \overline k \text{-isomorphism classes of EC's }/k\text{.}
\end{equation*}
%
\end{enumerate}
%
\end{fact}
\begin{definition}{Isogenies.}{x:definition:def-supersing-isog-isog}%
Let \(E,E'/k\) be elliptic curves. An \terminology{isogeny}, \(\phi \colon E\to E'\) is a non-constant morphism of pointed curves. The degree \(\deg \phi \) is the degree as a morphism. \(E,E'\) are said to be \(n\)-isogenous if there exists \(\phi\colon E\to E'\) of degree \(n\). \(j,j'\in k\) are \(n\)-isogenous if the corresponding elliptic curves are.%
\end{definition}
\begin{fact}{}{}{g:fact:idm204345111632}%
%
\begin{enumerate}
\item{}If \(p \nmid n = \deg \phi\) then the kernel of \(\phi\) has size \(n\) (\(\phi\) is separable).%
\item{}every finite subgoup of \(E(\overline k )\) is the kernel of a separable isogeny from \(E\), unique up to isomorphism.%
\item{}Every \(n\)-isogeny \(\phi\colon E \to E'\) has  a dual isogeny \(\hat \phi \colon E' \to E\) such that%
\begin{equation*}
\phi\circ \hat\phi = \hat\phi \circ \phi = \lb n \rb\text{,}
\end{equation*}
the multiplication-by-\(n \) map.%
\item{}The \(n\)-torsion subgroup%
\begin{equation*}
E\lb n \rb = \left\{ P \in E(\overline k) : nP = \infty\right\}
\end{equation*}
is isomorphic to \((\ZZ/n)^2\) if \(p\nmid n\).%
\end{enumerate}
%
\end{fact}
\begin{lemma}{}{}{g:lemma:idm204345103632}%
Let \(E/k\) be an elliptic curve with \(j(E) \not\in\{0,1728\}\) and let \(l\ne p\) be prime, up to isomorphism the number of \(l\)-isogenies from \(E\) defined over \(k\) is 0,1,2 or \(l+1\).%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204345100176}
In Maria's notes.%
\end{proofptx}
\begin{paragraphs}{The modular equation.}{g:paragraphs:idm204345099600}%
Let \(j(\tau)\) be the modular \(j\)-function. For each prime \(l\) the minimal polynomial \(\phi_l\) of \(j(l\tau)\) over \(\CC (j(\tau))\) is the modular polynomial%
\begin{equation*}
\phi_l \in \ZZ[j(\tau)][y] \simeq \ZZ[x,y]\text{.}
\end{equation*}
%
\begin{fact}{}{}{g:fact:idm204345095968}%
%
\begin{enumerate}
\item{}\(\phi_l\) is symmetric in \(x,y\) and has a degree \(l+1\) in both variables.%
\item{}The modular equation%
\begin{equation*}
\phi_l (x,y) = 0
\end{equation*}
is a canonical model for%
\begin{equation*}
Y_0(l) = \Gamma_0(l) \backslash \HH
\end{equation*}
it parameterises pairs of elliptic curves related by an \(l\)-isogeny. This moduli interpretation is still valid when we use any field \(F\) with \(\characteristic(F) \ne l\).%
\item{}Let \(m_l(j,j') = \ord_{t = j'} \phi_l(j,t)\), whenever \(j,j' \ne 0,1728\),%
\begin{equation*}
m_l(j,j') = m_l(j',j)\text{.}
\end{equation*}
%
\end{enumerate}
%
\end{fact}
\end{paragraphs}%
\begin{paragraphs}{The endomorphism ring.}{g:paragraphs:idm204345090016}%
\begin{definition}{Endomorphisms of elliptic curves.}{x:definition:def-supersing-isog-endo}%
An \terminology{endomorphism} of an elliptic curve \(E\) is either the zero map or an isogeny from \(E\) to itself. They form a ring \(\End(E)\).%
\end{definition}
For \(n \in ZZ\) we ahve \(\lb n \rb \in \End(E)\) so \(\ZZ \subseteq \End(E)\) over a finite field \(k\), \(\End(E)\) is always larger than \(\ZZ\). It is either an order in an imaginary quadratic field, in which case we say \(E\) is ordinary. Or an order in an quaternion algebra, in which case we say \(E\) is supersingular. We say \(E\) has complex multiplication by \(\ints\).%
\begin{proposition}{}{}{g:proposition:idm204345082224}%
Let \(E/k = \FF_{p^n}\) be an elliptic curve, TFAE%
\begin{enumerate}
\item{}\(E\) is supersingular.%
\item{}\(E\lb p\rb\) is trivial.%
\item{}The map \(\lb p\rb \colon E\to E\) is purely inseparable and \(j(E) \in \FF_{p^2}\).%
\end{enumerate}
%
\end{proposition}
\begin{note}{}{g:note:idm204345078912}%
If \(E,E'\) are isogenous elliptic curves then \(\End(E) \otimes_\ZZ \QQ \simeq \End(E')\otimes_\ZZ \QQ\). So supersingularity is preserved by isogenies.%
\end{note}
\end{paragraphs}%
\begin{paragraphs}{Isogeny graphs of elliptic curves.}{g:paragraphs:idm204345077568}%
Let \(k = \FF_q\) with \(\characteristic(k) = p\) and \(l \ne p \) be prime.%
\begin{definition}{Isogeny graphs.}{x:definition:def-supersing-isog-graph}%
The \(l\)-isogeny graph \(G_l(k)\) is the directed graph with vertex set \(k\) and edges \((j,j')\) present with multiplicity%
\begin{equation*}
m_j(l,l') = \ord_{t=j} \phi_l(j,t)
\end{equation*}
vertices are \(\overline k\) isomorphism classes of  elliptic curves \(/k\), edges are isomorphism classes of \(l\)-isogenies defined over \(k\).%
\end{definition}
Since \(m_l(j,j') =  m(j',j)\) whenever \(j,j' \ne  0,1728\) the subgraph of \(G_l(k)\) supported on \(k\smallsetminus \{0,1728\}\) can be thought of as undirected. By the last note \(G_l(k)\) consists of ordinary and supersingular components.%
\end{paragraphs}%
\begin{paragraphs}{Supersingular isogeny graphs.}{g:paragraphs:idm204345068112}%
Since every supersingular \(j\)-invariant lives in \(\FF_{p^2}\) if \(E\) is supersingular all roots of \(\phi_l(j(E), y)\) live in \(\FF_{p^2}\). Every vertex in a supersingular component has out-degree \(l+1\).%
\par
Moreover by a result of Kohel \(G_l(\FF_{p^2})\) has only one supersingular component.%
\par
By the above if \(p \equiv 1 \pmod {12}\) then the supersingular component of \(G_l(\FF_{p^2})\) is an undirected \((l+1)\)-regular graph with around \(p/12\) vertices.%
\begin{theorem}{Pizer.}{}{g:theorem:idm204345062128}%
The supersingular component of \(G_l(\FF_{p^2})\) is a Ramanujan graph.%
\end{theorem}
\begin{definition}{Ramanujan graphs.}{x:definition:def-supersing-isog-ramanujan}%
A connected \(d\)-regular graph is a \terminology{Ramanujan graph} if \(\lambda_2 \le \sqrt{d-1}\) where \(\lambda_2\) is the second largest eigenvalue of its adjacent matrix. (The largest one is always \(d\), by \(d\)-regularity.)%
\end{definition}
\end{paragraphs}%
\begin{paragraphs}{Ordinary isogeny graphs.}{g:paragraphs:idm204345057088}%
Let \(E/\FF_q\) be an ordinary elliptic curve, then \(\End(E) \simeq \ints\) is an order in an imaginary quadratic field \(K\) with \(\ZZ\lb \pi \rb \subseteq \ints \subseteq \ints_K\) where \(\pi\) is Frobenius and%
\begin{equation*}
K = \QQ(\sqrt{(\trace \pi)^2 - 4q})
\end{equation*}
by Tate, isogenous elliptic curves have the same \(\trace \pi\).%
\par
We can separate the vertices in the component \(V\) of \(G_l(k)\) containing \(j(E)\) into levels \(V_0, \ldots, V_d\) so that \(j(E') \in V_i\) if \(i = v_l(\lb \ints_K : \ints'\rb)\). We'll see that \(\bigcup_{i=0}^d V_i\) is connected.%
\par
Let \(\phi\colon E\to E'\) be an \(l\)-isogeny between two elliptic curves with CM by \(\ints = \ZZ+\tau\ZZ\), \(\ints ' = \ZZ+\tau'\ZZ\). Then \(\hat\phi \tau' \phi \in \End(E) \implies l\tau ' \in \ints\). Similarly \(l\tau \in \ints'\). There are 3 cases%
\begin{enumerate}
\item{}\(\ints = \ints'\) (\(\phi\) is horizontal).%
\item{}\(\lb\ints : \ints' \rb = l\) (\(\phi\) is descending).%
\item{}\(\lb\ints' : \ints \rb = l\) (\(\phi\) is ascending).%
\end{enumerate}
In the last two cases we say \(\phi\) is critical.%
\end{paragraphs}%
\begin{paragraphs}{Horizontal isogenies.}{g:paragraphs:idm204345043520}%
\(E/k\) with CM by \(\ints \subseteq K\) imaginary quadratic. Let \(\ideal a\) be an invertible ideal.%
\begin{equation*}
E\lb \ideal a \rb = \{ P \in E(\overline k) : \alpha (P)  = 0\, \forall \alpha \in \ideal a\}
\end{equation*}
this is a finite group so it is the kernel of a separable isogeny \(\phi_{\ideal a }\). If \(p \nmid N(\ideal a)\) then \(\deg(\phi_{\ideal a}) = N(\ideal a)\) with \(\ideal a\) invertible implying \(\phi_{\ideal a} \) is horizontal.%
\par
Each horizontal \(l\)-isogeny \(\phi\) arises from some invertible ideal \(\ideal a\) of norm \(l\).%
\par
If \(l | \lb \ints_K : \ints \rb \) no such ideals exist, otherwise the number of invertible ideals of norm \(l\) is%
\begin{equation*}
1+ \left(\frac {\disc(K)}{l}\right) = \begin{cases}0\amp\text{ if }l \text{ inert }\\ 1\amp\text{ if }l \text{ ramified }\\ 2\amp\text{ if }l \text{ splits}\end{cases}
\end{equation*}
%
\end{paragraphs}%
\begin{paragraphs}{Vertical isogenies.}{g:paragraphs:idm204345035456}%
Let \(\ints\) be an order in an imaginary quadratic field \(K \) of discriminant \(D \lt -4\) and let \(\ints' = \ZZ+l\ints\).%
\begin{lemma}{}{}{g:lemma:idm204345033072}%
Let \(E' / k\)  be an elliptic curve with CM by \(\ints '\) then there is a  unique ascending \(l\)-isogeny \(E'\to E\) with \(E/k\) an elliptic curve with CM by \(\ints\).%
\end{lemma}
\begin{definition}{}{g:definition:idm204345030016}%
An \(l\)-volcano \(V\) is a connected undirected graph whose vertices are partitioned into levels \(V_0, \ldots, V_d\).%
\begin{enumerate}
\item{}The subgraph \(V_0\) is regular of degree \(\le 2\).%
\item{}For each \(i \gt 0\) each vertex in \(V_i\) has exactly one neighbour in level \(V_{i-1}\), and this accounts for all edges outside of \(V_0\).%
\item{}For \(i \lt d\) each vertex has degree \(l+1\).%
\end{enumerate}
The number \(d\) is the depth.%
\end{definition}
\begin{figureptx}{A \(3\)-volcano}{g:figure:idm204345023408}{}%
\begin{image}{0}{1}{0}%
\resizebox{\linewidth}{!}{%
\begin{tikzpicture}
\definecolor{cv0}{rgb}{0.0,0.0,0.0}
\definecolor{cfv0}{rgb}{1.0,1.0,1.0}
\definecolor{clv0}{rgb}{0.0,0.0,0.0}
\definecolor{cv1}{rgb}{0.0,0.0,0.0}
\definecolor{cfv1}{rgb}{1.0,1.0,1.0}
\definecolor{clv1}{rgb}{0.0,0.0,0.0}
\definecolor{cv2}{rgb}{0.0,0.0,0.0}
\definecolor{cfv2}{rgb}{1.0,1.0,1.0}
\definecolor{clv2}{rgb}{0.0,0.0,0.0}
\definecolor{cv3}{rgb}{0.0,0.0,0.0}
\definecolor{cfv3}{rgb}{1.0,1.0,1.0}
\definecolor{clv3}{rgb}{0.0,0.0,0.0}
\definecolor{cv4}{rgb}{0.0,0.0,0.0}
\definecolor{cfv4}{rgb}{1.0,1.0,1.0}
\definecolor{clv4}{rgb}{0.0,0.0,0.0}
\definecolor{cv5}{rgb}{0.0,0.0,0.0}
\definecolor{cfv5}{rgb}{1.0,1.0,1.0}
\definecolor{clv5}{rgb}{0.0,0.0,0.0}
\definecolor{cv6}{rgb}{0.0,0.0,0.0}
\definecolor{cfv6}{rgb}{1.0,1.0,1.0}
\definecolor{clv6}{rgb}{0.0,0.0,0.0}
\definecolor{cv7}{rgb}{0.0,0.0,0.0}
\definecolor{cfv7}{rgb}{1.0,1.0,1.0}
\definecolor{clv7}{rgb}{0.0,0.0,0.0}
\definecolor{cv8}{rgb}{0.0,0.0,0.0}
\definecolor{cfv8}{rgb}{1.0,1.0,1.0}
\definecolor{clv8}{rgb}{0.0,0.0,0.0}
\definecolor{cv9}{rgb}{0.0,0.0,0.0}
\definecolor{cfv9}{rgb}{1.0,1.0,1.0}
\definecolor{clv9}{rgb}{0.0,0.0,0.0}
\definecolor{cv10}{rgb}{0.0,0.0,0.0}
\definecolor{cfv10}{rgb}{1.0,1.0,1.0}
\definecolor{clv10}{rgb}{0.0,0.0,0.0}
\definecolor{cv11}{rgb}{0.0,0.0,0.0}
\definecolor{cfv11}{rgb}{1.0,1.0,1.0}
\definecolor{clv11}{rgb}{0.0,0.0,0.0}
\definecolor{cv12}{rgb}{0.0,0.0,0.0}
\definecolor{cfv12}{rgb}{1.0,1.0,1.0}
\definecolor{clv12}{rgb}{0.0,0.0,0.0}
\definecolor{cv13}{rgb}{0.0,0.0,0.0}
\definecolor{cfv13}{rgb}{1.0,1.0,1.0}
\definecolor{clv13}{rgb}{0.0,0.0,0.0}
\definecolor{cv14}{rgb}{0.0,0.0,0.0}
\definecolor{cfv14}{rgb}{1.0,1.0,1.0}
\definecolor{clv14}{rgb}{0.0,0.0,0.0}
\definecolor{cv15}{rgb}{0.0,0.0,0.0}
\definecolor{cfv15}{rgb}{1.0,1.0,1.0}
\definecolor{clv15}{rgb}{0.0,0.0,0.0}
\definecolor{cv16}{rgb}{0.0,0.0,0.0}
\definecolor{cfv16}{rgb}{1.0,1.0,1.0}
\definecolor{clv16}{rgb}{0.0,0.0,0.0}
\definecolor{cv17}{rgb}{0.0,0.0,0.0}
\definecolor{cfv17}{rgb}{1.0,1.0,1.0}
\definecolor{clv17}{rgb}{0.0,0.0,0.0}
\definecolor{cv18}{rgb}{0.0,0.0,0.0}
\definecolor{cfv18}{rgb}{1.0,1.0,1.0}
\definecolor{clv18}{rgb}{0.0,0.0,0.0}
\definecolor{cv19}{rgb}{0.0,0.0,0.0}
\definecolor{cfv19}{rgb}{1.0,1.0,1.0}
\definecolor{clv19}{rgb}{0.0,0.0,0.0}
\definecolor{cv20}{rgb}{0.0,0.0,0.0}
\definecolor{cfv20}{rgb}{1.0,1.0,1.0}
\definecolor{clv20}{rgb}{0.0,0.0,0.0}
\definecolor{cv21}{rgb}{0.0,0.0,0.0}
\definecolor{cfv21}{rgb}{1.0,1.0,1.0}
\definecolor{clv21}{rgb}{0.0,0.0,0.0}
\definecolor{cv22}{rgb}{0.0,0.0,0.0}
\definecolor{cfv22}{rgb}{1.0,1.0,1.0}
\definecolor{clv22}{rgb}{0.0,0.0,0.0}
\definecolor{cv23}{rgb}{0.0,0.0,0.0}
\definecolor{cfv23}{rgb}{1.0,1.0,1.0}
\definecolor{clv23}{rgb}{0.0,0.0,0.0}
\definecolor{cv24}{rgb}{0.0,0.0,0.0}
\definecolor{cfv24}{rgb}{1.0,1.0,1.0}
\definecolor{clv24}{rgb}{0.0,0.0,0.0}
\definecolor{cv25}{rgb}{0.0,0.0,0.0}
\definecolor{cfv25}{rgb}{1.0,1.0,1.0}
\definecolor{clv25}{rgb}{0.0,0.0,0.0}
\definecolor{cv26}{rgb}{0.0,0.0,0.0}
\definecolor{cfv26}{rgb}{1.0,1.0,1.0}
\definecolor{clv26}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v1}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v2}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v9}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v18}{rgb}{0.0,0.0,0.0}
\definecolor{cv1v3}{rgb}{0.0,0.0,0.0}
\definecolor{cv1v4}{rgb}{0.0,0.0,0.0}
\definecolor{cv1v5}{rgb}{0.0,0.0,0.0}
\definecolor{cv2v6}{rgb}{0.0,0.0,0.0}
\definecolor{cv2v7}{rgb}{0.0,0.0,0.0}
\definecolor{cv2v8}{rgb}{0.0,0.0,0.0}
\definecolor{cv9v10}{rgb}{0.0,0.0,0.0}
\definecolor{cv9v11}{rgb}{0.0,0.0,0.0}
\definecolor{cv9v18}{rgb}{0.0,0.0,0.0}
\definecolor{cv10v12}{rgb}{0.0,0.0,0.0}
\definecolor{cv10v13}{rgb}{0.0,0.0,0.0}
\definecolor{cv10v14}{rgb}{0.0,0.0,0.0}
\definecolor{cv11v15}{rgb}{0.0,0.0,0.0}
\definecolor{cv11v16}{rgb}{0.0,0.0,0.0}
\definecolor{cv11v17}{rgb}{0.0,0.0,0.0}
\definecolor{cv18v19}{rgb}{0.0,0.0,0.0}
\definecolor{cv18v20}{rgb}{0.0,0.0,0.0}
\definecolor{cv19v21}{rgb}{0.0,0.0,0.0}
\definecolor{cv19v22}{rgb}{0.0,0.0,0.0}
\definecolor{cv19v23}{rgb}{0.0,0.0,0.0}
\definecolor{cv20v24}{rgb}{0.0,0.0,0.0}
\definecolor{cv20v25}{rgb}{0.0,0.0,0.0}
\definecolor{cv20v26}{rgb}{0.0,0.0,0.0}
%
\Vertex[style={minimum size=1.0cm,draw=cv0,fill=cfv0,text=clv0,shape=circle},LabelOut=false,L=\hbox{$0$},x=2.0163cm,y=2.0254cm]{v0}
\Vertex[style={minimum size=1.0cm,draw=cv1,fill=cfv1,text=clv1,shape=circle},LabelOut=false,L=\hbox{$1$},x=1.203cm,y=0.8898cm]{v1}
\Vertex[style={minimum size=1.0cm,draw=cv2,fill=cfv2,text=clv2,shape=circle},LabelOut=false,L=\hbox{$2$},x=0.7768cm,y=2.2131cm]{v2}
\Vertex[style={minimum size=1.0cm,draw=cv3,fill=cfv3,text=clv3,shape=circle},LabelOut=false,L=\hbox{$3$},x=1.0954cm,y=0.0cm]{v3}
\Vertex[style={minimum size=1.0cm,draw=cv4,fill=cfv4,text=clv4,shape=circle},LabelOut=false,L=\hbox{$4$},x=0.8216cm,y=0.3343cm]{v4}
\Vertex[style={minimum size=1.0cm,draw=cv5,fill=cfv5,text=clv5,shape=circle},LabelOut=false,L=\hbox{$5$},x=0.4512cm,y=0.4732cm]{v5}
\Vertex[style={minimum size=1.0cm,draw=cv6,fill=cfv6,text=clv6,shape=circle},LabelOut=false,L=\hbox{$6$},x=0.1621cm,y=1.8553cm]{v6}
\Vertex[style={minimum size=1.0cm,draw=cv7,fill=cfv7,text=clv7,shape=circle},LabelOut=false,L=\hbox{$7$},x=0.3018cm,y=2.7372cm]{v7}
\Vertex[style={minimum size=1.0cm,draw=cv8,fill=cfv8,text=clv8,shape=circle},LabelOut=false,L=\hbox{$8$},x=0.0cm,y=2.3107cm]{v8}
\Vertex[style={minimum size=1.0cm,draw=cv9,fill=cfv9,text=clv9,shape=circle},LabelOut=false,L=\hbox{$9$},x=2.8719cm,y=3.0805cm]{v9}
\Vertex[style={minimum size=1.0cm,draw=cv10,fill=cfv10,text=clv10,shape=circle},LabelOut=false,L=\hbox{$10$},x=2.3761cm,y=4.0591cm]{v10}
\Vertex[style={minimum size=1.0cm,draw=cv11,fill=cfv11,text=clv11,shape=circle},LabelOut=false,L=\hbox{$11$},x=3.7123cm,y=4.2098cm]{v11}
\Vertex[style={minimum size=1.0cm,draw=cv12,fill=cfv12,text=clv12,shape=circle},LabelOut=false,L=\hbox{$12$},x=1.7658cm,y=4.2209cm]{v12}
\Vertex[style={minimum size=1.0cm,draw=cv13,fill=cfv13,text=clv13,shape=circle},LabelOut=false,L=\hbox{$13$},x=2.4794cm,y=4.7695cm]{v13}
\Vertex[style={minimum size=1.0cm,draw=cv14,fill=cfv14,text=clv14,shape=circle},LabelOut=false,L=\hbox{$14$},x=1.987cm,y=4.7202cm]{v14}
\Vertex[style={minimum size=1.0cm,draw=cv15,fill=cfv15,text=clv15,shape=circle},LabelOut=false,L=\hbox{$15$},x=4.4167cm,y=4.5571cm]{v15}
\Vertex[style={minimum size=1.0cm,draw=cv16,fill=cfv16,text=clv16,shape=circle},LabelOut=false,L=\hbox{$16$},x=4.1369cm,y=4.9378cm]{v16}
\Vertex[style={minimum size=1.0cm,draw=cv17,fill=cfv17,text=clv17,shape=circle},LabelOut=false,L=\hbox{$17$},x=3.7145cm,y=5.0cm]{v17}
\Vertex[style={minimum size=1.0cm,draw=cv18,fill=cfv18,text=clv18,shape=circle},LabelOut=false,L=\hbox{$18$},x=3.272cm,y=2.0393cm]{v18}
\Vertex[style={minimum size=1.0cm,draw=cv19,fill=cfv19,text=clv19,shape=circle},LabelOut=false,L=\hbox{$19$},x=4.2945cm,y=2.4624cm]{v19}
\Vertex[style={minimum size=1.0cm,draw=cv20,fill=cfv20,text=clv20,shape=circle},LabelOut=false,L=\hbox{$20$},x=3.9454cm,y=0.8813cm]{v20}
\Vertex[style={minimum size=1.0cm,draw=cv21,fill=cfv21,text=clv21,shape=circle},LabelOut=false,L=\hbox{$21$},x=4.7397cm,y=3.0333cm]{v21}
\Vertex[style={minimum size=1.0cm,draw=cv22,fill=cfv22,text=clv22,shape=circle},LabelOut=false,L=\hbox{$22$},x=5.0cm,y=2.6024cm]{v22}
\Vertex[style={minimum size=1.0cm,draw=cv23,fill=cfv23,text=clv23,shape=circle},LabelOut=false,L=\hbox{$23$},x=4.9265cm,y=2.1023cm]{v23}
\Vertex[style={minimum size=1.0cm,draw=cv24,fill=cfv24,text=clv24,shape=circle},LabelOut=false,L=\hbox{$24$},x=3.8508cm,y=0.1215cm]{v24}
\Vertex[style={minimum size=1.0cm,draw=cv25,fill=cfv25,text=clv25,shape=circle},LabelOut=false,L=\hbox{$25$},x=4.3552cm,y=0.2074cm]{v25}
\Vertex[style={minimum size=1.0cm,draw=cv26,fill=cfv26,text=clv26,shape=circle},LabelOut=false,L=\hbox{$26$},x=4.6084cm,y=0.613cm]{v26}
%
\Edge[lw=0.1cm,style={color=cv0v1,},](v0)(v1)
\Edge[lw=0.1cm,style={color=cv0v2,},](v0)(v2)
\Edge[lw=0.1cm,style={color=cv0v9,},](v0)(v9)
\Edge[lw=0.1cm,style={color=cv0v18,},](v0)(v18)
\Edge[lw=0.1cm,style={color=cv1v3,},](v1)(v3)
\Edge[lw=0.1cm,style={color=cv1v4,},](v1)(v4)
\Edge[lw=0.1cm,style={color=cv1v5,},](v1)(v5)
\Edge[lw=0.1cm,style={color=cv2v6,},](v2)(v6)
\Edge[lw=0.1cm,style={color=cv2v7,},](v2)(v7)
\Edge[lw=0.1cm,style={color=cv2v8,},](v2)(v8)
\Edge[lw=0.1cm,style={color=cv9v10,},](v9)(v10)
\Edge[lw=0.1cm,style={color=cv9v11,},](v9)(v11)
\Edge[lw=0.1cm,style={color=cv9v18,},](v9)(v18)
\Edge[lw=0.1cm,style={color=cv10v12,},](v10)(v12)
\Edge[lw=0.1cm,style={color=cv10v13,},](v10)(v13)
\Edge[lw=0.1cm,style={color=cv10v14,},](v10)(v14)
\Edge[lw=0.1cm,style={color=cv11v15,},](v11)(v15)
\Edge[lw=0.1cm,style={color=cv11v16,},](v11)(v16)
\Edge[lw=0.1cm,style={color=cv11v17,},](v11)(v17)
\Edge[lw=0.1cm,style={color=cv18v19,},](v18)(v19)
\Edge[lw=0.1cm,style={color=cv18v20,},](v18)(v20)
\Edge[lw=0.1cm,style={color=cv19v21,},](v19)(v21)
\Edge[lw=0.1cm,style={color=cv19v22,},](v19)(v22)
\Edge[lw=0.1cm,style={color=cv19v23,},](v19)(v23)
\Edge[lw=0.1cm,style={color=cv20v24,},](v20)(v24)
\Edge[lw=0.1cm,style={color=cv20v25,},](v20)(v25)
\Edge[lw=0.1cm,style={color=cv20v26,},](v20)(v26)
%
\end{tikzpicture}
}%
\end{image}%
\tcblower
\end{figureptx}%
The Sage code used to make this picture was:%
\begin{sageinput}
N = 3 # number of flows
p = 3
d = 2
G = graphs.BalancedTree(p,d) # a (p+1)-regular tree of depth d
G.delete_edge(G.edges()[0])
F = G.subgraph(G.connected_component_containing_vertex(0)) # A single 'flow'
H = N*F
H.add_cycle([len(F.vertices())*i for i in range(N)])
show(H)
#latex(H) # for the code
\end{sageinput}
\begin{theorem}{Kohel.}{}{g:theorem:idm204345020848}%
Let \(V\) be an ordinary component of \(G_l(\FF_q)\) that doesn't contain \(0\) or \(1728\) then \(V\) is an \(l\)-volcano s.t.%
\begin{enumerate}
\item{}All vertices in \(V_i\) have the same endomorphism ring \(\ints_i\).%
\item{}The subgraph on \(V_0\) has degree%
\begin{equation*}
1+ \left(\frac {\disc(K)}{l}\right)
\end{equation*}
where \(K = \Frac(\ints_0)\)%
\item{}If%
\begin{equation*}
\left(\frac {\disc(K)}{l}\right) \ge 0
\end{equation*}
then \(\#V_0\) is the order \(\lb l \rb\) in \(\Cl (\ints_0)\) else \(\#V_0 = 1\).%
\item{}The depth of \(V\) is \(d = v_l (\lb \ints_K : \ZZ\lb\pi \rb\rb)\) where \(\pi\) is the Frobenius morphism on any \(E\) with \(j(E) \in V\).%
\item{}\(l \nmid \lb \ints_K : \ints_0 \rb\), \(\lb \ints_i : \ints_{i+1}\rb = l\) for \(0\le i \lt d\).%
\end{enumerate}
%
\end{theorem}
\end{paragraphs}%
\begin{paragraphs}{Application: Identifying supersingular elliptic curves.}{g:paragraphs:idm204345008624}%
\begin{algorithm}{Sutherland.}{}{g:algorithm:idm204345008176}%
Input: Elliptic curve \(E/k\), \(\characteristic k = p\).%
\par
Output: Ordinary or supersingular.%
\par
%
\begin{enumerate}
\item{}If \(j(E) \not \in \FF_{p^2}\) then ordinary.%
\item{}If \(p  =2,3\) return supersingular if \(j(E) = 0\) or ordinary otherwise.%
\item{}Find 3 roots of \(\phi_2(j(E), 4)\) over \(\FF_{p^2}\) if not possible return ordinary.%
\item{}Walk 3 paths in parallel for up to \(\lceil \log_2 p \rceil + 1 \) steps. If any of these paths get to \(V_d\), return ordinary.%
\item{}Otherwise supersingular.%
\end{enumerate}
%
\end{algorithm}
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 3.2 Supersingular isogeny graph cryptography (Asra)}
\typeout{************************************************}
%
\begin{sectionptx}{Supersingular isogeny graph cryptography (Asra)}{}{Supersingular isogeny graph cryptography (Asra)}{}{}{x:section:sec-supersing-isog-crypto}
\begin{introduction}{}%
Supersingular isogeny graph crypto is a candidate for post-quantum crypto, not based on factoring etc.%
\par
Recall last time we defined Ramanujan graphs, graphs with very good connectivity properties, a type of expander.%
\begin{proposition}{}{}{g:proposition:idm204345000016}%
If \(G\) is a Ramanujan graph, \(x\in V, S\subseteq V\). For a sufficiently large path beginning at \(x\), the probability that the path ends in \(S\) is at least \(|S|/2|V|\).%
\end{proposition}
Upshot: supersingular isogeny graphs are \((l +1)\)-regular, undirected, Ramanujan, connected (technically, Ramanujan means connected already, but its worth emphasising).%
\par
Some of our algorithms are only dependent on having a graph with this property, not so much the interpretation in terms of isogenies.%
\par
Supersingular isogeny graphs first appeared in crypto as potential hash functions.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.1 Hash functions}
\typeout{************************************************}
%
\begin{subsectionptx}{Hash functions}{}{Hash functions}{}{}{g:subsection:idm204344995872}
(2010) (Charles, Goren, Lauter) proposed a cryptographically secure hash function based on the hardness of computing paths in a supersingular isogeny graphs.%
\begin{definition}{Hash functions.}{x:definition:def-hash-function}%
A \terminology{hash function} is a deterministic function \(h\colon \{0,1\}^* \to \{0,1\}^n\).%
\end{definition}
\begin{definition}{Collision resistance.}{x:definition:def-collision-resistance}%
A hash function \(h\) is \terminology{collision resistant} if its hard to find \(x_1,x_2\) with \(x_1\ne x_2 \) s.t. \(h(x_1) = h(x_2)\).%
\end{definition}
\begin{definition}{Preimage resistance.}{x:definition:def-preimage-resistance}%
A hash function \(h\) is \terminology{preimage resistant} if given \(y\in \{0,1\}^n\) its hard to find \(x\) s.t. \(h(x) = y\).%
\end{definition}
Cool example, private set intersection, say two groups, Starbucks and BU want to find a list of common customers (students who bought something at Starbucks) but don't want to reveal anything to each other about the students or customers not in the intersection. Compute hashes of the names of customers and share the hashes, can compute the size of, and the intersection itself.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.2 Supersingular isogeny hash functions}
\typeout{************************************************}
%
\begin{subsectionptx}{Supersingular isogeny hash functions}{}{Supersingular isogeny hash functions}{}{}{g:subsection:idm204344986192}
\begin{paragraphs}{Parameters.}{g:paragraphs:idm204344984976}%
\(G_l(\FF_{p^2})\), \(p \equiv 1 \pmod{12}\), \(l\) to be small, fix an ordering on the edges, fix an initial vertex \(j_0\) and an incoming edge.%
\end{paragraphs}%
\begin{paragraphs}{Protocol.}{g:paragraphs:idm204344982768}%
\(m \in \{0,1\}^*\) write this as an \(l\)-bit string, \(m \in \{0,1,\ldots, l-1\}^*\), walk the graph based on \(m\) without backtracking.%
\par
Map the final \(j\) invariant to  \(\{0,1\}^{n\approx \log p}\).%
\end{paragraphs}%
\begin{paragraphs}{Properties.}{g:paragraphs:idm204344979456}%
Difficult means exponential in the size of the input normally.%
\begin{proposition}{}{}{g:proposition:idm204344978736}%
%
\begin{enumerate}
\item{}Preimage resistant iff when given \(j\) it is difficult to compute a positive integer \(e\) and an isogeny \(\phi\colon E_{j_0} \to E_j\) with degree \(l^e\).%
\item{}Collision resistant iff when given \(j\) it is difficult to compute \(e\) and  \(\phi \colon E_{j_0} \to E_{j_0}\) with degree \(l^e\).%
\end{enumerate}
%
\end{proposition}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.3 Diffie-Hellman Key Exchange (1976)}
\typeout{************************************************}
%
\begin{subsectionptx}{Diffie-Hellman Key Exchange (1976)}{}{Diffie-Hellman Key Exchange (1976)}{}{}{g:subsection:idm204344974288}
Choose \(p,\, \ZZ/p, g\) then Alice computes \(g^a\) send to Bob, he computes \(g^b\) and sends it back, they both compute \(g^{ab}\), which is their shared secret.%
\par
The security is based on the hardness of computing \(g^{ab}\) given \(g^a,g^b\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.4 Supersingular isogeny Diffie-Hellman (SIDH)}
\typeout{************************************************}
%
\begin{subsectionptx}{Supersingular isogeny Diffie-Hellman (SIDH)}{}{Supersingular isogeny Diffie-Hellman (SIDH)}{}{}{g:subsection:idm204344970704}
\begin{paragraphs}{Parameters.}{g:paragraphs:idm204344970272}%
Supersingular elliptic curve of smooth order: fix \(p\) to be big enough \(p = l_A^{e_A} l_B^{e_B} f  \pm 1\). \(l_A,l_B\) small primes, \(f\) is a number chosen such that \(p\) is big. Construct a supersingular elliptic curve \(E\) such that \(\# E(\FF_{p^2}) = (l_A^{e_A}l_B^{e_B} f)^2\), using Broker's algorithm.%
\par
Construct bases \((P_A, Q_A)\) for \(E\lb l_A^{e_A}\rb\), \((P_B, Q_B)\) for \(E\lb l_B^{e_B}\rb\).%
\end{paragraphs}%
\begin{paragraphs}{Protocol.}{g:paragraphs:idm204344964608}%
Alice takes \(m_A,n_A \in \ZZ/l_A^{e_A}\)%
\par
Bob takes \(m_B,n_B \in \ZZ/l_B^{e_B}\)%
\par
Alice finds \(R_A = m_AP_A + n_AQ_A\)%
\par
Bob finds \(R_B = m_BP_B + n_BQ_B\)%
\par
Alice finds \(\phi_A \colon E \to E/\langle R_A\rangle = E_A\)%
\par
Bob finds \(\phi_B \colon E \to E/\langle R_B\rangle = E_B\)%
\par
They send each other \(E_i, \phi_i(P_i),\phi_i(Q_i)\).%
\par
Both compute \(\phi'_A\colon E_B \to E_B/\langle m_A\phi_B(P_A) + n_A\phi_B(Q_A)\rangle\) or analogous.%
\par
Shared secret is \(j(E_{AB})\).%
\end{paragraphs}%
\begin{paragraphs}{Hardness.}{g:paragraphs:idm204344958672}%
%
\begin{enumerate}
\item{}(Decisional supersingular isogeny problem) Given \(E, (P_A,Q_A)\) a basis for \(l_A^{e_A}\) torsion, let \(E_A\) be another curve, is \(E_A\) \(l_A^{e_A}\) isogenous to \(E\)?%
\item{}(Computational supersingular isogeny problem) Let \(\phi_A \colon E \to E_A\) be an isogeny with a kernel of the form \(\langle m_AP_A + n_AQ_A \rangle\). Given \(E_A\) and \(\phi_A(P_B)\) \(\phi_A(Q_B)\), find \(R_A\). \(p^{1/4}\) classical, \(p^{1/6}\) quantum.%
\item{}Given \(E_A, E_B, \phi_A(P_B), \phi_A(Q_B), \phi_B(P_A), \phi_B(Q_A)\) find \(j\)-invariant of \(E_{AB}\).%
\end{enumerate}
%
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.5 Supersingular isogeny public key}
\typeout{************************************************}
%
\begin{subsectionptx}{Supersingular isogeny public key}{}{Supersingular isogeny public key}{}{}{g:subsection:idm204344950080}
Classically DH key-exchange \(\leadsto\) ElGamal encryption.%
\par
%
\begin{enumerate}
\item{}Key generation.%
\par
Alice: secret \(\phi_A \colon E \to E_A\), public \(E_A\) and \(\phi_A(P_B), \phi_A(Q_B)\).%
\item{}Encryption.%
\par
Bob: choose \(\phi_B \colon E \to E_B\), compute \(j(E_{AB})\).%
\par
Send Alice \(c = (E_B, \phi_B(P_A), \phi_B(Q_A), m\oplus j(E_{AB}))\)%
\item{}Decryption.%
\par
Alice use \((E_B, \phi_B(P_A), \phi_B(Q_A))\) to compute \(j(E_{AB})\). Computes \((m\oplus j(E_{AB})) \oplus j(E_{AB}) = m\).%
\end{enumerate}
%
\par
\(E(\FF_{p^2})\), \(p = l_A^{e_A} l_B^{e_B} f \pm 1\), for \(128\)-bit security use a \(512\)-bit key.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.6 Algorithmic aspects}
\typeout{************************************************}
%
\begin{subsectionptx}{Algorithmic aspects}{}{Algorithmic aspects}{}{}{g:subsection:idm204344940896}
%
\begin{enumerate}
\item{}(Choosing \(f\)) Prime number theorem for arithmetic progressions gives you a bound on the density of primes of the form \(l_A^{e_A} l_B^{e_B} f \pm 1\)%
\item{}Choosing a s.s. e.c. with the right group order, Broker's algorithm.%
\item{}Finding a basis for \(E\lb l_A^{e_A}\rb\).%
\begin{enumerate}
\item{}Find a random point in \(E(\FF_{p^2})\) say \(P\).%
\item{}Check the order of \((l_B^{e_B} f)^2 \cdot P\). If its \(l_A^{e_A}\) set \(P_A = P\). Otherwise repeat from 1.%
\item{}Do the same with \(Q_A = Q\).%
\item{}Check independence by seeing if \(e(P_A,Q_A) \) has the right order, so that it is in \(E\lb l_A^{e_A} \rb\) torsion.%
\end{enumerate}
%
\item{}Computing the kernels generated by \(R_A = m_A P_A + n_A Q_A\), \(m_A, n_A \in \ZZ/l_A^{e_A} \ZZ\). Analogue of double and add. Set \(R_A = P_A + \lb m_A\inv n_A\rb Q_A\). Use differential addition (when you compute \(A+B\) with side info \(A-B\)) and a Montgomery ladder%
\item{}(Computing smooth degree isogenies) Decompose the \(l_A^{e_A}\) isogeny into \(e_A\) different \(l_A\)-isogenies, \(\phi_i\colon E_i \to E_{i+1}\) the kernel of \(\phi_i\) is \(\langle l_A^{e_A - i - 1} R_A\rangle\). Vélu's formula runs in \(O(l)\) for \(l\)-isogeny.%
\end{enumerate}
%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 3.3 Quaternion Algebras (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Quaternion Algebras (Alex)}{}{Quaternion Algebras (Alex)}{}{}{x:section:sec-quaternion-algebras}
\begin{introduction}{}%
Q: Why study quaternion algebras?%
\par
A: They arise as the endomorphism algebras of \emph{supersingular} elliptic curves \(/\FF_{p^2}\).%
\par
I don't want to spoiler next week at all, but I cannot talk about quaternion algebras without a little bit of motivation first!%
\begin{example}{What are we doing again?}{g:example:idm204344924304}%
Lets take%
\begin{equation*}
K = \FF_9 = \FF_3[\alpha] = \FF_3[x]/(x^2- x - 1)
\end{equation*}
and%
\begin{equation*}
E/K\colon y^2 = x^3 + \alpha x = f(x)\text{,}
\end{equation*}
simple eh? It's supersingular as the \(j\)-invariant is 0 (and are in characteristic 3). Alternatively, count points or even compute the Hasse invariant, the coefficient of \(p -1 = 2\) in \(f(x)^{(p-1)/2 = 1}\), yep, it's 0.%
\par
We therefore have \(\#E(K) = 9 + 1 = 10\) so we have a \(2\)-torsion point (\(P = (0,0)\)) and any other point we can use to generate (will be \(5\) or \(10\) torsion). Let \(x = 1\) so \(y^2 = 1 + \alpha = \alpha^2\) so \(y = \pm\alpha\), say \(Q = (1,\alpha)\).%
\par
We have one endomorphism, \(p\)-power frobenius \(x\mapsto x^3\), \(y\mapsto y^3\). How to find another one?%
\par
Lets compute an isogenous curve and see what happens! We will compute \(\psi\colon  E \to E/\langle P \rangle = E'\). In general the formulae are  a little annoying \hyperlink{x:biblio:bib-velu}{[100]}, when you have a 2-torsion point at \((0,0)\), not as bad:%
\begin{equation*}
\psi = \left(x + \frac{f'(0)}{x}, y - \frac{yf'(0)}{x^2} \right)
\end{equation*}
%
\begin{equation*}
f'(0) = \alpha
\end{equation*}
so%
\begin{equation*}
\psi= \left(\frac{x^2 + \alpha}{x}, y\frac{x^2 - \alpha}{x^2} \right)
\end{equation*}
(aside: if \(g/h = (x^2+\alpha)/x\) then \((g/h)' = (g' h - g h')/h^2 = (2x^2 - (x^2 + \alpha))/x^2 = (x^2 - \alpha)/x^2\), sanity check\slash{}fast computation?). The curve is then%
\begin{equation*}
E'\colon y^2 = x^3 + 0x^2 + (\alpha - 5\alpha)x +0 = x^3  - \alpha x\text{.}
\end{equation*}
I think really here we're just recovering those classic formulae for 2-isogenies between curves with a rational 2 torsion point at \((0,0)\) (used in 2-descent).%
\begin{align*}
C\amp\colon y^2 = x(x^2+ax+b)\\
D\amp\colon v^2 = u(u^2+a_1u+b_1)\\
\phi\amp\colon C\to D\\
(x,y) \amp\mapsto ((y/x)^2 , y-by/x^2)\\
\hat\phi\amp\colon D\to C\\
(u,v) \amp\mapsto \left(\frac14\left(\frac vu\right)^2 ,\frac18( v-b_1 v/u^2)\right)
\end{align*}
%
\par
So far so good, our curve doesn't look exactly the same, but it's \(j\)-invariant is, so we are still in business. Is%
\begin{equation*}
E \simeq E'\text{?}
\end{equation*}
If we substitute \(x= \alpha^2 x\), \(y = \alpha ^3 y\) into \(E'\) we get%
\begin{equation*}
\alpha^6 y^2 = \alpha^6 x^3 - \alpha^3 x
\end{equation*}
%
\begin{equation*}
y^2 = x^3 - \alpha^{-3} x = x^3 +\alpha x\text{,}
\end{equation*}
call this map \(\iota\). Excellent, so to get \(\psi' \colon E\to E\) we compose \(\iota\circ \psi\).%
\begin{equation*}
\iota \circ\left( \frac{x^2  + \alpha}{x}, \frac{(x^2 - \alpha )y}{x^2}\right)  = \left( \alpha^2\frac{x^2  + \alpha}{x}, \alpha^3\frac{(x^2 - \alpha )y}{x^2}\right)
\end{equation*}
%
\begin{equation*}
= \left( (\alpha+  1)\frac{x^2  + \alpha}{x}, ( -\alpha  + 1)\frac{(x^2 - \alpha )y}{x^2}\right)\text{.}
\end{equation*}
%
\par
What happens to our other point \(Q\)? \(\psi'(Q) = (\alpha^2(1+\alpha), \alpha^4(1-\alpha)) =(-1, \alpha - 1)\)%
\begin{gather*}
(0 : 0 : 1) \mapsto (0 : 1 : 0),\, (0 : 1 : 0) \mapsto (0 : 1 : 0),\, (1 : \alpha : 1) \mapsto (-1 : \alpha -1 : 1),\\
(1 : -\alpha : 1) \mapsto (-1 : -\alpha + 1 : 1),\, (-1 : \alpha -1 : 1) \mapsto (1 : -\alpha : 1),\\
(-1 : -\alpha + 1 : 1) \mapsto (1 : \alpha : 1),\, (\alpha : \alpha + 1 : 1) \mapsto (-1 : -\alpha + 1 : 1),\\
(\alpha : -\alpha -1 : 1) \mapsto (-1 : \alpha -1 : 1),\, (-\alpha : 1 : 1) \mapsto (1 : \alpha : 1),\, (-\alpha : -1 : 1) \mapsto (1 : -\alpha : 1)
\end{gather*}
A word of caution: If you are very awake you may check and be led to believe that this is just the multiplication by \(-2\) isogeny on \(E\), its action on \(E(\FF_9)\) points is the same!!!!! It's not the same isogeny though so you can relax. Now we have an endomorphism ring with two elements, what are the relations between themselves, and each other?%
\par
As we quotiented by a rational \(2\)-torsion point we have computed a factor of \(\pi - 1\), the other factor comes from quotienting by \(5\)-torsion. In fact we find. The frobenius has characteristic polynomial \(t^2 + 9 = (t + 3i)(t-3i)\) \(\pi\) looks like \(3i\). \(\psi\) has characteristic polynomial \(t^2 - 2t + 2 = (t+1)^2 + 1\), so \(\psi + 1\) looks like \(\pm i\). \(?? \cdot \psi = \pi - 1\)  \(?? \cdot (i - 1) = 3i - 1\), so \(?? = 2 - i = 2 - (\psi + 1) = 1 - \psi\).%
\par
So what if we quotient by non-rational 2-torsion? Pass to the quadratic extension \(\FF_{3^4}\), which we get from adjoining the other roots of \(0 = x^3 + \alpha x\) i.e. \(\pm \sqrt{-\alpha}\). Denote this extension \(\FF_3 \lb \beta \rb\),  \((\beta^2 - 1)^2 = -\alpha\). We can use Vélu again, it's degree two still but a bit more ugh, you might need a computer from now on, actually I've been using one all along.%
\begin{equation*}
\phi = \left( \frac{\left(\alpha + 1\right) x^{2} + \left(- \beta^{3}  -  \beta - 1\right) x}{x -   (\beta^{2} - 1)},y \frac{\left(-\alpha + 1\right) x^{2} + \left(\beta^{3}  -  \beta^{2} + \beta - 1\right) x -  1}{(x -  ( \beta^{2} - 1))^2} \right)
\end{equation*}
doing a computation it looks like \(\phi\) satisfies \(\phi^2 -\phi + 2\).%
\par
What are the relations between these? Hopefully they generate the endomorphism ring by now but without relations we are screwed! Do they commute? Computing \(\tau = \phi \psi  - \psi \phi\) is relevant, if 0, commutative, otherwise not! Note that if they are algebraically dependant they must commute! In our example we can compute \(\tau^2 + 3 = 0\)%
\end{example}
Finish this example, compute the endomorphism ring as a recognisable quaternion order.%
Aside: I now believe Asra when she says not to use Vélu's formulae for large degree!%
\par
Aside 2: Frobenius can be weird for supersingular curves, e.g. for%
\begin{equation*}
y^2 = x^{3} + x/\FF_9
\end{equation*}
we have \(\pi = -3\). Or%
\begin{equation*}
y^2 = x^{3} + 1/\FF_{25}
\end{equation*}
we have \(\pi = -5\)%
\par
Indeed one can find on the internet claims like, all elliptic curves over finite fields have extra endomorphisms because frobenius exists!%
Show by hand that \(y^2 + y = x^3/\FF_4\) is supersingular and that frobenius is just the multiplication by \(-2\) map.%
PODASIP: this happens for all \(p^2\)?%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 3.3.1 Quaternion Algebras}
\typeout{************************************************}
%
\begin{subsectionptx}{Quaternion Algebras}{}{Quaternion Algebras}{}{}{g:subsection:idm204344879088}
\begin{introduction}{}%
Pretty much all of this material was ripped with the utmost love and affection from \hyperlink{x:biblio:bib-voight-quat}{[101]}, check it out.%
\begin{proposition}{}{}{g:proposition:idm204344877680}%
The theory of Quaternion algebras is very rich.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204344877120}
The above book is 800 pages long.%
\end{proofptx}
So now we have gone out into nature and observed a beautiful new species of algebra, time to catch it, pin it to a wall, dissect it to study it in detail. It might not look as pretty any more but it's the way the science is done.%
\begin{example}{Hamilton's quaternions.}{g:example:idm204344876192}%
Hamilton's quaternions \(\HH\) were the first quaternion algebra to be discovered (citation needed). The structure is like two copies of \(\CC\) tensored together in some non-commuting way over \(\RR\). We have a real algebra with two generators \(i,j\) s.t. \(i^2 = j^2  = (ij)^2 = -1\) we let \(k = ij\) for aesthetic reasons (note that these relations imply noncommutativity!). Like this we get a division algebra.%
\end{example}
Quaternion algebras are a generalisation of this to other fields.%
\begin{definition}{Quaternion algebras.}{x:definition:def-quaternion-algebra}%
Let \(F\) be a field (not characteristic 2), a quaternion algebra over \(F\) is an algebra \(B\) over \(F\) for which there exist \(a,b\in F^\times\) such that there is a basis%
\begin{equation*}
1,i,j,k \in B
\end{equation*}
such that%
\begin{equation*}
i^2 = a,j^2=b,k=ij=-ji\text{,}
\end{equation*}
it is automatic that \(k^2 = -ab\) from this.%
\par
We denote this particular quaternion algebra by \(\legendre{a,b}{F}\)%
\end{definition}
\begin{example}{}{g:example:idm204344867120}%
%
\begin{equation*}
\HH = \legendre{-1,-1}{\RR}\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204344866320}%
What is%
\begin{equation*}
\legendre{1,1}{F} \left( = \legendre{1,-1}{F}\right)\text{?}
\end{equation*}
We have another way to come up with \(4\)-dimensional non-commutative algebras over fields, matrices! Let%
\begin{equation*}
i=  \begin{pmatrix} 1\amp0\\0\amp -1\end{pmatrix}
\end{equation*}
%
\begin{equation*}
j =\begin{pmatrix} 0\amp1\\1\amp 0\end{pmatrix}
\end{equation*}
so%
\begin{equation*}
k = ij = \begin{pmatrix} 0\amp1\\-1\amp 0\end{pmatrix} = -ji
\end{equation*}
as required.%
\end{example}
Call this example \emph{split}, in analogy with quadratic theory,  If \(x^2 - N\) has a solution mod \(p\) then \(\legendre{N}{p} = 1 = \legendre{1}{p}\).%
\par
Note that if \(a\) or \(b \in (F^\times)^2\) then we can divide the corresponding basis element by \(\sqrt{a}\) or whatever and find that \(\legendre{a,b}{F} = \legendre{1,b}{F}\). This shows:%
\begin{proposition}{}{}{g:proposition:idm204344859584}%
After passing to the algebraic closure (or even the quadratic closure!) every quaternion algebra is split.%
\end{proposition}
This is helpful as it allows us to work with non-split quaternion algebras as matrix algebras over a quadratic extension.%
\begin{example}{}{g:example:idm204344858576}%
\(\HH/\RR\) can be seen as \(\Mat_{2\times 2}(\RR(i)) = \Mat_{2\times 2}(\CC)\), explicitly%
\begin{equation*}
i=  i\begin{pmatrix} 1\amp0\\0\amp -1\end{pmatrix} = \begin{pmatrix} i\amp0\\0\amp -i\end{pmatrix}
\end{equation*}
%
\begin{equation*}
j = i\begin{pmatrix} 0\amp1\\1\amp 0\end{pmatrix} = \begin{pmatrix} 0\amp i\\i\amp 0\end{pmatrix}
\end{equation*}
please excuse the unfortunate notational clash here, I hope you agree it's somewhat unavoidable.%
\end{example}
Here is a nice lemma I probably used implicitly already somewhere!%
\begin{lemma}{}{}{g:lemma:idm204344855984}%
An \(F\)-algebra \(B\) with \(F\)-algebra generators \(i,j\) satisfying \(i^2,j^2\in F^\times\), \(ij = -ji\) is automatically a quaternion algebra (i.e. dimension 4).%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204344852976}
Show linear independence of \(1,i,j,ij\) (exercise).%
\end{proofptx}
\begin{definition}{Conjugate, trace and norm.}{x:definition:def-quat-alg-conj-trace-norm}%
Given a quaternion algebra \(B/F\) there is a unique anti-involution \(\overline \cdot \colon B \to B\), called \terminology{conjugation}.%
\par
With basis \(1,i,j,ij\in \legendre{a,b}{F}\) as above it is given as%
\begin{equation*}
\overline {x + yi + zj + w ij} = x - yi - zj - w ij,\,x,y,z,w\in F\text{.}
\end{equation*}
%
\par
As normal (heh) we define the (reduced) norm and trace%
\begin{equation*}
\norm \alpha =  \alpha + \overline \alpha,\,\forall \alpha \in B
\end{equation*}
%
\begin{equation*}
\norm(x + yi + zj + w ij) = x^2 - ay^2 - b z^2 + ab w^2
\end{equation*}
and%
\begin{equation*}
\trace \alpha =  \alpha + \overline \alpha,\,\forall \alpha \in B
\end{equation*}
%
\begin{equation*}
\trace (x + yi + zj + w ij) = 2x\text{.}
\end{equation*}
%
\end{definition}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsubsection 3.3.1.1 Orders}
\typeout{************************************************}
%
\begin{subsubsectionptx}{Orders}{}{Orders}{}{}{g:subsubsection:idm204344846576}
In our example, while the endomorphism algebra \(\End(E)\otimes \QQ\) was of interest, the endomorphism ring \(\End(E)\) was the more fundamental object. What is this? A quaternion ring?%
\begin{definition}{Orders in quaternion algebras.}{x:definition:def-order-quaternion}%
Let \(B/\QQ\) be a quaternion algebra, an \terminology{order} in \(B\) is a full rank sub-\(\ZZ\)-module that is also a subring.%
\end{definition}
\begin{example}{The Lipschitz order.}{x:example:ex-lipshitz-order}%
\(B = \legendre{-1,-1}{\QQ}\) (Hamilton quaternions with \(\QQ\)-coefficients) then we have an order%
\begin{equation*}
\ZZ + \ZZ i + \ZZ j + \ZZ ij
\end{equation*}
the \terminology{Lipschitz order}.%
\end{example}
\begin{definition}{Maximality.}{x:definition:def-maximal-order}%
Orders are ordered (heh) with respect to inclusion, thus we get notions of maximality of orders etc.%
\end{definition}
Is the Lipschitz order maximal? NO! Whats going on? \(\ZZ\lb i\rb\) is maximal in \(\QQ(i)\) after all. Consider%
\begin{equation*}
i + j + k,\,(i+j + k)^2 = i^2 + j^2 + k^2 + \cancelto{0}{ij + ji} + \cancelto{0}{ik + ki} + \cancelto{0}{jk + kj} = -3
\end{equation*}
so we have a \(\ZZ\lb \sqrt{-3}\rb\) lurking inside \(\legendre{-1,-1}{\QQ}\), quaternion algebras are not everything they appear to be at first sight! \(\ZZ\lb \sqrt{-3}\rb\) is non-maximal and we must add \(\sqrt{-3}/2\) to make it so. Lets add this in the quaternion setting:%
\begin{example}{The Hurwitz order.}{x:example:ex-hurwitz-order}%
Let \(B = \legendre{-1,-1}{\QQ}\), then%
\begin{equation*}
\ZZ+  \ZZ i + \ZZ j + \ZZ \left(\frac{i + j + k}{2}\right)
\end{equation*}
is an index two suborder of the Lipschitz order, called the \terminology{Hurwitz order}, this \emph{is} maximal.%
\end{example}
Warning, just because \(\sqrt{-3} \in \legendre{-1,-1}{\QQ}\) we do not have \(\legendre{-1,-3}{\QQ} = \legendre{-1,-1}{\QQ}\)!%
\begin{example}{\slash{}Exercise.}{g:example:idm204344830496}%
Show that the elliptic curve from the exercise earlier%
\begin{equation*}
y^2 + y = x^3/\overline{\FF_2}
\end{equation*}
has endomorphism algebra the Hurwitz order.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{g:solution:idm204344829152}{}\quad{}Here is what me and Angus think, we have the 2-power frobenius \(\pi\) a degree 2 isogeny whose square is minus 2, we also have the isogeny \(\phi \colon x\mapsto \zeta_3 x, y\mapsto y\) which is in fact an automorphism (degree 1) and satisifies \(\phi^2 + \phi + 1 = 0\). The relation between these two isogenies is that \(\pi \phi  = \phi^2 \pi \colon x\mapsto \zeta_3^2 x^2, y\mapsto y^2\).%
\par
Inside the Huwitz order we have some candidates for an element whose square is \(-2\) there are a few, coming in two types \(a+ b\) for \(a \ne b \in \{i,j,k\}\) and \(a-b\) for \(a\ne b\in \{i,j,k\}\), we choose the second type (why? because it works and the other doesn't), let \(p = i + j\) for concreteness. We also have a cube root of unity in the Hurwitz order, it is \(f = (-1 + i + j + k)/2\).%
\par
We can calculate now what \(pf\) and \(f^2 p\) are, they both come out to be \(- i + k\), some other square root of minus 2, which makes sense because degree is multiplicative. Anyway this is consistent with the endomorphism ring but there is a slight problem, the order generated here has discriminant \(6\), so its non-maximal as we know its contained in the Hurwitz order but the discriminant is higher, Deuring tells us we have to get a maximal order so we need something extra.%
\end{example}
Warning, there is no such thing as \emph{the} maximal order of a quaternion algebra! Rather there are multiple maximal orders due to non-commutativity, e.g. if \(\ints\) is a maximal order then so is%
\begin{equation*}
\alpha \ints \alpha\inv \ne \ints\text{.}
\end{equation*}
%
\par
Normally when we have unique maximal things with a certain property, its because we can always take spans\slash{}unions and they still have that property.%
\par
This is no longer true here, the sum of two elements with integral trace and norm need not remain so, nor the product.%
\par
We can define discriminants of orders which like normal give a hint as to their maximality%
\begin{equation*}
\ints = \ZZ + \ZZ i + \ZZ j + \ZZ ij \subseteq \legendre{a,b}{\QQ}
\end{equation*}
%
\begin{equation*}
\disc \ints  = d(1,i,j,ij) = \left| \det\begin{pmatrix} 2 \amp 0 \amp 0\amp 0 \\ 0 \amp 2a \amp 0 \amp 0 \\ 0 \amp 0 \amp 2b \amp 0 \\ 0 \amp 0 \amp 0 \amp -2ab\end{pmatrix}\right| = (4ab)^2
\end{equation*}
%
\begin{inlineexercise}{}{g:exercise:idm204344817424}%
Find the discriminant of the Lipschitz order.%
\end{inlineexercise}
\end{subsubsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsubsection 3.3.1.2 Local theory}
\typeout{************************************************}
%
\begin{subsubsectionptx}{Local theory}{}{Local theory}{}{}{g:subsubsection:idm204344816864}
\begin{theorem}{}{}{g:theorem:idm204344816464}%
Over a local field \(F \ne \CC\) there is a unique division quaternion algebra \(B/F\) up to \(F\)-isomorphism.%
\par
If \(F = \QQ_p\), \(p\ne 2\) then this is%
\begin{equation*}
\legendre{e,p}{\QQ_p}
\end{equation*}
for \(e\) any quadratic non-residue mod \(p\).%
\par
This is saying that any quadratic extension of \(F\) embeds into \(B\)!%
\end{theorem}
\begin{definition}{Split and ramified quaternion algebras.}{x:definition:def-split-ram-quaternion-algs}%
Let \(B/\QQ_v\) be a quaternion algebra, we say that \(B\) is%
\begin{equation*}
\begin{cases}
\text{split} \amp \text{if } B\cong M_2(\QQ_v)  = \legendre{1,-1}{\QQ_v}\\
\text{ramified} \amp \text{otherwise}
\end{cases}
\end{equation*}
%
\par
Correspondingly we say that \(B/\QQ\) is split\slash{}ramified at a place \(v\) if the corresponding \(B\otimes \QQ_v\) has that property.%
\end{definition}
The terminology definite for quaternion algebras ramified at infinity is also used (i.e. for which \(B\otimes \RR = \HH\)).%
\begin{theorem}{Albert-Brauer-Hasse-Noether.}{}{g:theorem:idm204344806496}%
Let \(B/F\) be a quaternion algebra  over  a  number field \(F\) (or any central simple algebra), if \(B\) splits at every place \(v\) of \(F\) then \(B\) is a matrix algebra \(M_d (F)\).%
\end{theorem}
In fact:%
\begin{theorem}{}{}{g:theorem:idm204344802496}%
Two quaternion algebras are isomorphic if and only if they are isomorphic everywhere locally, i.e. if the set of places at which they ramify is the same.%
\end{theorem}
Warning: Quaternion algebras may not be ramified where you think they are?%
\par
Knowing the ramification of a quaternion algebra \(\QQ\) is enough to identify it uniquely, in fact we have the following theorem%
\begin{theorem}{Main Theorem [101,~14.1.3].}{}{g:theorem:idm204344800704}%
There is a sequence of bijections%
\begin{align*}
\left\{ \text{quaternion algebras }B/\QQ \right\}/\text{isom.}\\
S \mapsto \text{unique }B \text{ ramified at exactly }S\amp\updownarrow D\mapsto \{p : B \text{ is ramifies at } p\}\\
\left\{ S \subseteq \text{places of }\QQ,\,2|\#S \right\}\\
D \mapsto \{p|D\} \cup \{\infty\} \text{ if }2\nmid \omega(D)\amp\updownarrow S \mapsto \prod_{p\in S,p\ne \infty} p\\
\left\{ D\in \ZZ_{\gt 0 }\text{ squarefree}\right\}
\end{align*}
%
\end{theorem}
Sometimes however we want generators and relations not just ramification information: (As we will only care about discriminant \(p\) quaternion algebras) In our setting the relevant theorem is:%
\begin{theorem}{Pizer.}{}{g:theorem:idm204344796576}%
Let \(\QQ_{p,\infty}\) be the unique quaternion algebra ramified at \(p,\infty\), let \(q \equiv 3 \pmod 4\) be such that \(\legendre pq = -1\), then%
\begin{equation*}
\QQ_{p,\infty} \cong
\begin{cases}
\legendre{-1,-1}{\QQ} \amp \text{ if }p\equiv 2\pmod 4,\\
\legendre{-1,-p}{\QQ} \amp \text{ if }p\equiv 3\pmod 4,\\
\legendre{-2,-p}{\QQ} \amp \text{ if }p\equiv 1\pmod 8,\\
\legendre{-p,-q}{\QQ} \amp \text{ if }p\equiv 5\pmod 8.
\end{cases}
\end{equation*}
%
\end{theorem}
Ibukiyama has given a nice description of a maximal order in such.%
\par
Here are some nice references:%
\begin{enumerate}
\item{}Computational Problems in Supersingular Elliptic Curve Isogenies - Steven D. Galbraith and Frederik Vercauteren \url{https://www.esat.kuleuven.be/cosic/publications/article-2842.pdf}%
\item{}Computing Isogenies Between Abelian Varieties - David Lubicz Damien Robert \url{https://perso.univ-rennes1.fr/david.lubicz/articles/isogenies.pdf}%
\item{}Toric forms of elliptic curves and their arithmetic - Wouter Castryck and Frederik Vercauteren \url{https://homes.esat.kuleuven.be/\~fvercaut/papers/ec_forms.pdf}%
\item{}Isogenies of Elliptic Curves: A Computational Approach - Daniel Shumow \url{https://www.sagemath.org/files/thesis/shumow-thesis-2009.pdf}%
\item{}Hard and Easy Problems for Supersingular Isogeny Graphs - Christophe Petit and Kristin Lauter \url{https://eprint.iacr.org/2017/962.pdf}%
\item{}Perspectives on the Albert-Brauer-Hasse-Noether Theorem for Quaternion Algebras -  Thomas R. Shemanske \url{https://www.math.dartmouth.edu/\~trs/expository-papers/tex/ABHN.pdf}%
\item{}COMPUTING ISOGENIES BETWEEN SUPERSINGULAR ELLIPTIC CURVES OVER Fp CHRISTINA DELFS AND STEVEN D. GALBRAITH \url{http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.740.6509\&rep=rep1\&type=pdf}%
\end{enumerate}
%
\end{subsubsectionptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 3.4 The Deuring Correspondence (Maria Ines)}
\typeout{************************************************}
%
\begin{sectionptx}{The Deuring Correspondence (Maria Ines)}{}{The Deuring Correspondence (Maria Ines)}{}{}{x:section:sec-deuring}
\begin{introduction}{}%
References:%
\par
%
\begin{enumerate}
\item{}Voight ch. 16,17,42%
\item{}Hard and Easy Problems for Supersingular Isogeny Graphs - Christophe Petit and Kristin Lauter \url{https://eprint.iacr.org/2017/962.pdf}%
\end{enumerate}
%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 3.4.1 Background: Ideals and Ideal classes}
\typeout{************************************************}
%
\begin{subsectionptx}{Background: Ideals and Ideal classes}{}{Background: Ideals and Ideal classes}{}{}{g:subsection:idm204344784464}
Let \(B/\QQ\) be a quaternion algebra and  \(\ints \subseteq B\) be an order. If \(I \subseteq B \) is a  lattice, we can define \(\ints_L (I) = \{ \alpha\in  B :  \alpha I  \subseteq I \}\). This is an order , it's the left order of  \(I\) similarly can define \(\ints_R (I) \).%
\begin{definition}{}{g:definition:idm204344781136}%
A left (resp. right) fractional ideal is a lattice \(I \subseteq B\) s.t. \(\ints \subseteq       \ints_L (I) \) resp \(\ints \subseteq \ints_R (I) \)%
\end{definition}
\begin{definition}{Compatibility.}{x:definition:def-buntes-compat}%
For lattices \(I,J \subseteq B\) we say \(I\) is \terminology{compatible} with \(J\) if%
\begin{equation*}
\ints_R(I)= \ints_L(J)\text{.}
\end{equation*}
A lattice \(I \) is invertible if there is a lattice \(I' \subseteq B\) s.t.%
\begin{equation*}
II' = \ints_L(I) =  \ints_R(I')
\end{equation*}
%
\begin{equation*}
I'I = \ints_L(I') =  \ints_R(I)
\end{equation*}
with both products compatible%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204344774560}%
Let \(\ints \subseteq B\) be a maximal order then every left or right fractional \(\ints\)-ideal is invertible.%
\end{proposition}
\begin{definition}{Principal ideals.}{g:definition:idm204344773120}%
An ideal of the form%
\begin{equation*}
I =  \ints_L(I) \alpha =  \alpha\ints_R(I)
\end{equation*}
is a principal ideal.%
\end{definition}
\begin{fact}{}{}{g:fact:idm204344771824}%
\(I \) is invertible with \(I\inv = \alpha \inv \ints_L(I) =  \ints_R(I) \alpha \inv\).%
\end{fact}
\begin{definition}{Reduced norms.}{x:definition:def-nrd}%
Let \(I \subseteq B\) be a fractional ideal the \terminology{reduced norm} of \(I \) is the positive generator of the fractional ideal generated by%
\begin{equation*}
\{ \operatorname{nrd} (\alpha) :  \alpha \in I \}
\end{equation*}
in \(\QQ\). We denote it \(\operatorname{nrd}(I)\).%
\end{definition}
\begin{paragraphs}{Ideal classes.}{g:paragraphs:idm204344766912}%
\begin{definition}{Ideal classes.}{x:definition:def-ideal-class}%
Two left fractional ideals \(I,J \subseteq B\) are in the same left class%
\begin{equation*}
I\sim_L J
\end{equation*}
if \(\exists  \alpha \in B^\times\) s.t. \(I\alpha = J\). Equivalently if \(\ints_L(I)  = \ints_L(J)\) and \(I \sim J\) as left modules over this order. \(\sim_L\) is an equivalence relation \(\lb I \rb\) is the class of \(I\). If \(I \) is invertible then every \(J \in \lb I \rb_L\) is invertible, and then we say \(\lb I \rb_L \) is invertible.%
\end{definition}
\begin{definition}{Class sets.}{x:definition:def-class-set}%
Let \(\ints \subseteq B\) be an order. The \terminology{left class set} of \(\ints\) is%
\begin{equation*}
\operatorname{Cls}_L \ints   = \{ \lb I \rb_L : I \subseteq B \text{ is invertible  and } \ints_L(I) = \ints\}
\end{equation*}
its a pointed set with distinguished element \(\lb \ints \rb_L\).%
\end{definition}
\begin{theorem}{}{}{g:theorem:idm204344756912}%
Let \(\ints \subseteq B\) be an order. then \(\operatorname{Cls} _L \ints\) is finite. We call \(\# \operatorname{Cls}_L\ints \) the \terminology{left class number} of \(\ints\).%
\end{theorem}
\end{paragraphs}%
\begin{paragraphs}{Types of orders.}{g:paragraphs:idm204344754224}%
Let \(\ints ,\ints'  \subseteq B\) be orders.%
\begin{definition}{}{g:definition:idm204344753120}%
We say \(\ints,\ints' \) are of the same type if \(\exists \alpha \in B^\times\) s.t. \(\ints ' = \alpha \inv \ints \alpha\). \(\ints,\ints'\) are locally of the same type if \(\ints_p, \ints_p'\) are of the same type for all primes in \(\ZZ\cup\{\infty\}\). \(\ints\) is connected to  \(\ints'\) if there exists an invertible fractional \(\ints,\ints'\)-ideal \(J \subseteq B\) called a connecting ideal.%
\end{definition}
\begin{lemma}{}{}{g:lemma:idm204344748240}%
\(\ints,\ints'\) are of the same type iff they are isomorphic as \(\ZZ\)-algebras.%
\par
\(\ints,\ints'\) are connected iff they are locally of the same type.%
\end{lemma}
\begin{definition}{}{x:definition:def-genus-order}%
Let \(\ints \subseteq B\) be an order.%
\begin{enumerate}
\item{}The \terminology{genus} \(\operatorname{Gen}(\ints)\) of \(\ints \) is the set of orders in \(B \) connected to \(\ints\).%
\item{}The type set \(\operatorname{Typ}(\ints)\) of \(\ints\) is the set of \(\ZZ\)-algebra isomorphism classes of orders in \(\operatorname{Gen} (\ints)\).%
\end{enumerate}
%
\end{definition}
\begin{lemma}{}{}{g:lemma:idm204344740656}%
The set map \(\operatorname{Cls}_L(\ints) \to \operatorname{Typ}(\ints)\)%
\begin{equation*}
[ I]_L \mapsto \text{class of } \ints_R(I)
\end{equation*}
is surjective.%
\end{lemma}
\begin{remark}{}{g:remark:idm204344739360}%
%
\begin{enumerate}
\item{}Any two maximal orders in \(B\) are connected.%
\item{}In particular there are only finitely many conjugacy classes of maximal orders in \(B\).%
\end{enumerate}
%
\end{remark}
\begin{example}{Voight 17.6.3.}{g:example:idm204344737552}%
Let%
\begin{equation*}
B = \legendre{-1,-23}{\QQ}
\end{equation*}
Then \(\ints=  \ZZ +  \ZZ i + \ZZ \frac{i+j}{2} + \ZZ i \frac{i+j}{2}\) is a maximal order and%
\begin{equation*}
\operatorname{Typ}(\ints) =  \left\{ \lb \ints \rb , \lb \ints_2 \rb , \lb \ints_3 \rb \right\}\text{.}
\end{equation*}
%
\end{example}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.4.2 The Deuring Correspondence}
\typeout{************************************************}
%
\begin{subsectionptx}{The Deuring Correspondence}{}{The Deuring Correspondence}{}{}{g:subsection:idm204344735376}
Fix a prime \(p\), let \(E\) be an elliptic curve over \(\FF_q = \FF_{p^n}\).%
\begin{lemma}{}{}{g:lemma:idm204344733456}%
The endomorphism algebra  \(\End(E)_\QQ = \End(E) \otimes \QQ\) of \(E\) is either \(\QQ\) an imaginary quadratic field or a definite quaternion algebra \(/\QQ\).%
\end{lemma}
\begin{theorem}{Deuring, this proof by Lenstra.}{}{g:theorem:idm204344731040}%
Let \(E/\FF_q\) be a s.s. e.c. (i.e. assume \(\End(E) \otimes \QQ\) is a quaternion algebra). Then \(\operatorname{Ram}(B)  =    \{p, \infty\}\) and \(\ints = \End(E) \) is a maximal order in \(B\).%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204344728064}
Let \(n \gt 0\)  be prime to \(p \). Then%
\begin{equation*}
E \lb n \rb  \simeq \ZZ/ n \oplus \ZZ/n
\end{equation*}
as groups so \(\End(E\lb n\rb ) \simeq M_2(\ZZ/n)\).%
\par
Claim: The structure map \(\ints/n\ints  \to \End(E\lb n \rb)\) is an isomorphism.%
\par
Check: suppose \(\phi \in  \ints\) kills \(E\lb n \rb\), then since \(\phi\) is separable then \(\exists\) \(\psi \in \ints\) s.t. \(\phi = n \psi\). Hence \(\phi = 0 \in \ints/n\). This gives injectivity.%
\par
As both rings are finite with the same order \(n^4\) we have an isomorphism.%
\par
Since \(\ints\) is a free \(\ZZ\) module%
\begin{equation*}
\ints_l = \ints \otimes \QQ_l = \ints \otimes \varprojlim _n \ZZ/l^n
\end{equation*}
%
\begin{equation*}
\simeq \varprojlim_n \ints/l^n \simeq \varprojlim_n \End(E[l^n])
\end{equation*}
%
\begin{equation*}
\simeq \End_{\ZZ_l}  \simeq M_2( \ZZ_l)
\end{equation*}
for any \(l \ne p\) primes. This is an isomorphism as \(\ZZ\)-algebras.%
\par
In particular \(\ints_l\) is maximal in \(B_l \simeq M_2(\QQ_l)\) and \(B\) is split at \(l\) for all \(l\ne p\). Since \(B\) is definite, it follows from the classification theorem that \(\operatorname{Ram}(B)  = \left\{ p, \infty \right\}\).%
\par
Fact: \(\ints_p\) is maximal in \(B_p\) (thm 42.1.9 of voight).%
\par
\(\ints\) is maximal in \(B\) because it is locally maximal.%
\end{proofptx}
\begin{theorem}{Deuring correspondence.}{}{g:theorem:idm204344712896}%
%
\begin{equation*}
\left\{ \text{maximal orders }\ints \subseteq B_{p,\infty}\right\}/\sim \leftrightarrow \left\{ j \text{ s.s. }\in \FF_{p^2}\right\}/\Gal{\FF_{p^2}}{\FF_p}\text{.}
\end{equation*}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204344711680}
Voight 42.4.7.%
\end{proofptx}
\begin{definition}{}{g:definition:idm204344711280}%
Let \(I \subseteq \ints = \End(E)\) be an integral left \(\ints\)-ideal with \((\operatorname{nrd}(I), p) = 1\). Define%
\begin{equation*}
E\lb I \rb = \{ P \in E(\overline \FF_q) :  \alpha(P) = 0 \forall \alpha \in I\}
\end{equation*}
Then there is a separable isogeny%
\begin{equation*}
\Phi_I  \colon E \to E / E \lb I \rb
\end{equation*}
with \(\ker \Phi_I = E \lb I \rb\).%
\end{definition}
\begin{fact}{}{}{g:fact:idm204344708064}%
%
\begin{equation*}
\deg (\Phi_I)  = \operatorname{nrd}(I)
\end{equation*}
%
\end{fact}
\begin{proposition}{}{}{g:proposition:idm204344707376}%
The association \(I \mapsto \phi_I\) is a 1-1 correspondence provided that \((\deg \phi_I, p) = 1\).%
\end{proposition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.4.3 Applications to SIG crypto}
\typeout{************************************************}
%
\begin{subsectionptx}{Applications to SIG crypto}{}{Applications to SIG crypto}{}{}{g:subsection:idm204344705712}
\begin{problem}{Constructive Deuring correspondence.}{g:problem:idm204344705296}%
Given a maximal order \(\ints \subseteq B_{p,\infty}\) return a s.s. \(j\)-invariant \(j\) s.t. \(\ints \simeq \End(E_j)\).%
\end{problem}
\begin{problem}{Inverse Deuring correspondence.}{g:problem:idm204344702352}%
Given a supersingular \(j\) invariant \(j\), compute a maximal order \(\ints \subseteq B_{p,\infty}\)  s.t. \(\ints \simeq \End(E_j)\). \(\ints\) is described by a \(\ZZ\)-basis.%
\end{problem}
\begin{problem}{Endomorphism ring computation problem.}{g:problem:idm204344699088}%
Given a supersingular \(j\) invariant \(j\), \(\End(E_j)\). \(\End(E_j)\) should be returned as \(4\) or \(3\) rational maps that form a \(\ZZ\)-basis. Their representation should be efficient in storage and in evaluation time at points.%
\end{problem}
\begin{remark}{}{g:remark:idm204344695376}%
%
\begin{enumerate}
\item{}Problem 1 can be solved in polynomial time, (Prop. 14 in Petit-Lauter).%
\item{}P2 and P3 are polynomially equivalent but this isn't obvious (P-L sec.3.1 and 3.2)%
\item{}There is no known efficient algorithm to solve P3.%
\end{enumerate}
%
\end{remark}
Recall: the (Charles-Goren-Lauter) CGL hash function is preimage resistant iff given 2 s.s. \(j\)-invariants \(j_1,j_2\) its computationally hard to compute a  positive integer \(e\) and an isogeny \(\phi \colon E_{j_1} \to E_{j_2}\) of degree \(l^e\).%
\begin{proposition}{}{}{g:proposition:idm204344691536}%
Assume there's an efficient algorithm to solve P3. Then there is an efficient algorithm to solve the preimage problem for the CGL hash function%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204344690880}
Algorithm%
\par
Input: two s.s. \(j\)-invariants \(j_s,j_t \in \FF_{p^2}\).%
\par
Output: sequence of \(j\)-invariants%
\begin{equation*}
j_s,\ldots,j_0,\ldots, j_t\text{.}
\end{equation*}
%
\par
%
\begin{enumerate}
\item{}Compute \(\End(j_s),\End(j_t)\).%
\item{}Compute \(\ints_s \simeq \End(E_{j_s})\), \(\ints_t \simeq \End(E_{j_t})\)%
\item{}Compute ideals \(I_s\) and \(I_t\) connecting \(\ints_0 \) to \(\ints_s\), \(\ints_t\)%
\item{}Compute ideals \(J_s \in \lb I_s \rb\),\(J_t \in \lb I_t \rb\), with norms \(l^{e_s},l^{e_t}\).%
\item{}For \(J \in \{J_s,J_t\}\) and corresponding \(E \in \{E_s,E_t\}\) and \(e\in \{e_s, e_t\}\) compute \(J_i = \ints_0 p^2 + \ints_0 l^i\) for \(i = 0,\ldots, e\). For \(i = 0,\ldots, e\) compute \(K_i \in \lb J_i \rb_L\) with powersmooth norm. Translate \(K_i\) into an isogeny%
\begin{equation*}
\phi\colon E_0 \to E_i
\end{equation*}
Deduce a sequence \((j_0, j(E_1),\ldots,j(E) = j_e)\).%
\item{}Return \((j(E_s), \ldots,j_0, \ldots,j(E_t))\).%
\end{enumerate}
%
\par
Except for step 1 everything can be done efficiently.%
\end{proofptx}
\begin{remark}{}{g:remark:idm204344677024}%
The converse is also true.%
\end{remark}
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 4 \(p\)-divisible groups}
\typeout{************************************************}
%
\begin{chapterptx}{\(p\)-divisible groups}{}{\(p\)-divisible groups}{}{}{x:chapter:chapter-p-div}
\begin{introduction}{}%
These are notes for the short-lived BUNTES Fall 2018 part II, the topic is \(p\)-divisible groups.%
\par
\url{http://math.bu.edu/people/midff/buntes/fall2018.html}.%
\par
References:%
\begin{enumerate}
\item{}Tate%
\item{}Schatz%
\end{enumerate}
%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 4.1 \(p\)-divisible groups (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{\(p\)-divisible groups (Sachi)}{}{\(p\)-divisible groups (Sachi)}{}{}{x:section:sec-p-div-gps}
Why study  \(p\)-divisible groups (Jacob Stix).%
\begin{enumerate}
\item{}Analyse local \(p\)-adic galois action on \(p\)-torsion of elliptic curves, Serre's open image theorem.%
\begin{equation*}
\phi_l \colon G_K \to \Aut \lb l \rb
\end{equation*}
Surjective for almost all \(l\).%
\item{}Tool for representing \(p\)-adic cohomology, e.g \(p\)-adic hodge theory.%
\item{}Describe local properties of moduli spaces of abelian varieties which map to moduli spaces of \(p\)-divisible groups which can be described by semilinear algebra (Serre-Tate).%
\item{}Explicit local CFT via Lubin-Tate formal groups describing wildly ramified abelian extensions.%
\item{}The true fundamental group in characteristic \(p\) must include infinitesimal group schemes, \(p\)-divisible groups enter through their tate modules.%
\end{enumerate}
%
\begin{paragraphs}{Detour, schemes.}{g:paragraphs:idm204344665440}%
There is an (anti)-equivalence of categories%
\begin{equation*}
\{\text{ring}\} \leftrightarrow\{\text{affine schemes}\}\text{.}
\end{equation*}
%
\par
Moral whatever  a scheme is the data of a ring is enough to specify it + homs%
\begin{equation*}
\Hom_{Ring} (B,A) \leftrightarrow \Hom_{Aff}(\Spec A, \Spec B)
\end{equation*}
to specify a base field or base ring play a similar game with \(R\)-algebras and \(R\)-schemes.%
\par
Yoneda, schemes are functors: Let \(R\lb T_1,\ldots,T_n\rb \) be a polynomial ring over \(R\), we want solutions to%
\begin{equation*}
f_1=  f_2 = \cdots = f_m = 0
\end{equation*}
with coefficients in \(A\) this is asking for  a map%
\begin{equation*}
R\lb T_1, \ldots ,T_n] /(f_i) \to A
\end{equation*}
same as%
\begin{equation*}
\Hom_{R-alg} (R[T_1,\ldots, T_n] /(f_i), A)
\end{equation*}
functor \(A\) to this is a functor from \(R\)-algs to sets.%
\begin{definition}{}{g:definition:idm204344658896}%
For any affine scheme \(A = \Spec B\) we attach a functor \(h_X\) from \(\mathrm{Sch}^\op\) to sets, sending \(\Spec S \mapsto \Hom_{\mathrm{Sch}} (\Spec S, X) = \Hom_{Ring} (B,S) = h_X(\Spec S)\). spec S points of X%
\end{definition}
\begin{example}{}{g:example:idm204344656560}%
%
\begin{equation*}
\aff^n = \Spec \ZZ \lb T_1,\ldots, T_n\rb
\end{equation*}
%
\begin{equation*}
\aff^n(T) = \Hom_{\mathrm{Sch}} (T, \aff^n) = \Hom_{Ring}(\ZZ[T_1,\ldots, T_n], S)\cong S^n
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204344655520}%
%
\begin{equation*}
E \colon \Spec k[x,y] / (y^2 - (x^3 + ax +b)),\,k = \QQ
\end{equation*}
\(E(\QQ(i)) = \QQ(i)\) points, choosing \(x,y\) satisfying weierstrass equation.%
\end{example}
Suppose \(h_X \colon \mathrm{Sch}^\op \to R\) factors through \(\mathrm{Grp} \to \mathrm{Set}\) then this is a group scheme.%
\begin{example}{}{g:example:idm204344652752}%
%
\begin{equation*}
\mathbf G_a = \Spec k[t]
\end{equation*}
%
\begin{equation*}
S\mapsto \Hom(k[t], S) \cong (S,+)
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204344651776}%
%
\begin{equation*}
\mathbf G_m = \Spec k[t,t\inv]
\end{equation*}
%
\begin{equation*}
S\mapsto \Hom(k[t,t\inv], S) \cong (S^\times,\cdot)
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204344650784}%
%
\begin{equation*}
\mu_n = \Spec k[t]/(t^n -1)
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204344650112}%
%
\begin{equation*}
\alpha_{p^n} = \Spec k[t]/(t^{p^n})
\end{equation*}
char \(k = p\)%
\end{example}
Cartier Duality \(G\) is a finite group scheme \(/R\) there is a dual%
\begin{equation*}
G^* (T) = \Hom (G_T, \mathbf G_m)
\end{equation*}
\(R\)-scheme \(T\)%
\begin{equation*}
G \cong (G^*)^*
\end{equation*}
%
\begin{example}{}{g:example:idm204344646656}%
%
\begin{equation*}
\mu_{p^n} \leftrightarrow \ZZ/p^n
\end{equation*}
%
\end{example}
\begin{definition}{}{g:definition:idm204344645968}%
Let \(p\) be a prime and \(h\) a non-negative integer. A \(p\)-divisible group of height \(h\) is an inductive system%
\begin{equation*}
(G_v, i_v)
\end{equation*}
where each \(G_v\) is a group scheme \(/R\) of size \(p^{vh}\)%
\begin{equation*}
i_v \colon G_v \to G_{v+1}
\end{equation*}
identifies \(G_v\) with kernel of multiplication by \(p^v\).%
\begin{equation*}
0 \to G_v \xrightarrow{i_v} G_{v+1} \xrightarrow{[p^v]} G_{v+1}
\end{equation*}
%
\end{definition}
\begin{remark}{}{g:remark:idm204344640704}%
We can show that \(G_\mu,G_v\) are two levels then%
\begin{equation*}
0 \to G_\mu \xrightarrow{i_{\mu, v}} G_{\mu +v } \xrightarrow{[p^\mu]} G_{\mu,v}
\end{equation*}
so%
\begin{equation*}
0 \to G_\mu \to G_{\mu + v}  \to G_v \to 0\text{.}
\end{equation*}
%
\end{remark}
The connected etale sequence%
\par
A finite flat group scheme \(G\) over a henselian local ring \(R\) admitsa (functorial) decomposition%
\begin{equation*}
0  \to G^\circ \to G \to G^\et \to 0
\end{equation*}
connected and etale%
\par
There is an equivalence of categories between finite etale gp scheme \(/R\) and its continuous \(\absgal k\) modules when \(R = k\) is a field.%
\begin{definition}{}{g:definition:idm204344635472}%
An \(n\)-dimensional formal lie group \(/R\) is the formal power series ring%
\begin{equation*}
A = R\lb \lb x_1, \ldots, x_n \rb\rb
\end{equation*}
with a suitable co-multiplication structure.%
\begin{equation*}
m^* \colon A \to A\widehat \otimes A
\end{equation*}
%
\begin{equation*}
m^*(X_i) = (f_i(Y,Z))
\end{equation*}
require%
\begin{enumerate}
\item{}%
\begin{equation*}
F(X,0) = F(0,X) = X
\end{equation*}
%
\item{}%
\begin{equation*}
F(X,F(Y,Z)) = F(F(Y,Z),X) = X
\end{equation*}
%
\item{}%
\begin{equation*}
F(Y,Z) = F(Z,Y)
\end{equation*}
%
\end{enumerate}
%
\end{definition}
Let \(\psi\) denote multiplication by \(p\) in \(A\) then \(A\) is divisible if \(\psi\) is an isogeny (surj. with finite kernel). Alternatively \(A\) is a finite free \(\psi (A)\)-module.%
\begin{theorem}{}{}{g:theorem:idm204344628320}%
Let \(R\) be a complete noetherian local ring with residue characteristic \(p \gt 0\). We have an equiv of cats%
\begin{equation*}
\text{conn. p-div gps} \leftrightarrow \text{div. formal lie groups /R}
\end{equation*}
%
\end{theorem}
\begin{example}{}{g:example:idm204344626560}%
%
\begin{equation*}
\mathbf G_m(p) , \, F(X)= Y+Z+YZ
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204344625872}%
\(E\) ordinary elliptic curve \(/\overline{\FF}_p\)%
\par
%
\begin{equation*}
E[p] (\overline \FF_p)
\end{equation*}
is non-empty%
\begin{equation*}
E[p] = E[p]^\circ \times E[p]^\et\text{.}
\end{equation*}
%
\par
etale group schemes over alg. closed fields are constant%
\begin{equation*}
E = E[p]^\circ \times A
\end{equation*}
%
\par
It can't be entirely etale \(\lb p \rb\) would be etale but this induces the 0 map on tangent space so \(E\lb p \rb^\circ \ne 0\).%
\par
%
\begin{equation*}
|E\lb p \rb | =  p^2
\end{equation*}
so each order \(p\).%
\par
%
\begin{equation*}
A = \ZZ/p
\end{equation*}
%
\par
\(E\) is cartier self dual%
\begin{equation*}
A^* = \mu_p = E[p]^\circ
\end{equation*}
%
\par
Induct for \(E\lb p^n\rb \).%
\end{example}
\end{paragraphs}%
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 5 Shimura varieties}
\typeout{************************************************}
%
\begin{chapterptx}{Shimura varieties}{}{Shimura varieties}{}{}{x:chapter:chapter-buntes-shimura}
\begin{introduction}{}%
These are notes for BUNTES Fall 2018 part III, the topic is Shimura varieties%
\par
\url{http://math.bu.edu/people/midff/buntes/fall2018.html}.%
\par
Outline:%
\begin{enumerate}
\item{}Modular curves\slash{}forms%
\item{}Abelian varieties%
\item{}Hodge structures%
\item{}Definition\slash{}construction of Shimura varieties%
\end{enumerate}
%
\par
References:%
\begin{itemize}[label=\textbullet]
\item{}Weinstein, \href{http://math.bu.edu/people/jsweinst/Teaching/MA843Fall13/index.html}{Lecture Notes on Shimura varieties}%
\item{}Milne, \href{https://www.jmilne.org/math/xnotes/svi.pdf}{Introduction to Shimura Varieties}%
\end{itemize}
%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 5.1 Modular curves (Aash)}
\typeout{************************************************}
%
\begin{sectionptx}{Modular curves (Aash)}{}{Modular curves (Aash)}{}{}{x:section:sec-buntes-modular-curves}
\begin{definition}{Lattices.}{x:definition:def-buntes-lattice}%
A \terminology{lattice} is a free abelian group of rank 2%
\begin{equation*}
\Lambda \otimes \RR \to \CC
\end{equation*}
is an isomorphism%
\begin{equation*}
\Lambda = \ZZ\lb \alpha \rb  \oplus \ZZ\lb \beta \rb
\end{equation*}
if%
\begin{equation*}
\Lambda = \gamma \Lambda ',\,\gamma \in \CC
\end{equation*}
then we say the two lattices are \terminology{homothetic}.%
\end{definition}
Any lattice is homothetic to one of the form%
\begin{equation*}
\Lambda = \langle 1 , \tau \rangle
\end{equation*}
as we can take a positively oriented basis we have that all such are equivalent to%
\begin{equation*}
\tau \in \HH = \{ z\in \CC: \Im(z) \gt 0 \}\text{.}
\end{equation*}
So there is a bijection between \(\HH\) and ordered bases of lattices.%
\par
\(\SL_2(\ZZ)\) acts on \(\HH\) and the action corresponds to changing bases.%
\par
The action of \(\PSL_2(\ZZ)\) is faithful. \(i,\rho = e^{\pi i /3}\) have non-trivial stabilisers%
\begin{equation*}
\Stab_i =  \langle S\rangle = \begin{pmatrix} 0\amp1 \\ -1 \amp 0 \end{pmatrix}
\end{equation*}
%
\begin{equation*}
\Stab_\rho =  \langle TS\rangle,\,T = \begin{pmatrix} 1\amp1 \\ 0 \amp 1 \end{pmatrix}
\end{equation*}
%
\par
We can determine the order of elements by looking at the characteristic polynomials.%
\par
We then have%
\begin{equation*}
Y(1) =\SL_2(\ZZ) \backslash \HH
\end{equation*}
a complex manifold and%
\begin{equation*}
j\colon Y(1) \to \CC
\end{equation*}
is an isomorphism.%
\par
We have a fundamental domain for this action%
\begin{equation*}
D = \{ z\in \CC : |z|  \ge 1,\, |\Re(z)| \le \frac 12 \}
\end{equation*}
\(Y(1)\) is Hausdorff because the action is properly discontinuous.%
\par
Care must be taken around the elliptic points (those with larger stabiliser), to define the complex structure.%
\par
The extended upper half plane%
\begin{equation*}
\HH^* = \HH \cup \PP^1 (\QQ)
\end{equation*}
also has an \(\SL_2(\ZZ)\) action via fractional linear transformations, which is proper.%
\par
We can define a basis of neighbourhoods around the cusps by transforming them to the cusp \(\infty\) where we can use the basis of neighbourhoods given by%
\begin{equation*}
\HH_N = \{ z\in \HH : | \Im(z)| \gt N\}\text{.}
\end{equation*}
%
\par
The parameter \(q\) around \(\infty\) is defined as \(e^{2\pi i z/N}\) for some \(N\in \ZZ\), \(q\) is fixed by \(T\).%
\par
We can quotient by the action of \(\SL_2(\ZZ) \) on \(\HH^*\) to get%
\begin{equation*}
X(1) = \SL_2(\ZZ) \backslash \HH^*
\end{equation*}
which is now compact, genus 0, which matches up with \(Y(1)\) having \(\CC\) points \(\CC\) earlier.%
\par
If \(X\) is a projective curve then \(X(\CC)\) has the structure of a compact Riemann surface. If \(S\) is such a surface then there exists a unique up to isomorphism \(X\) with \(X(\CC) = S\).%
\par
The meromorphic functions on \(S\) are the function field of \(X\) and there is a correspondence%
\begin{equation*}
\text{Compact Riemann surfaces} \leftrightarrow \text{Smooth proj. curves}
\end{equation*}
%
\par
Given a finite index subgroup of \(\SL_2(\ZZ)\) we can do something similar to obtain%
\begin{equation*}
\Gamma\backslash \HH\text{.}
\end{equation*}
One of the most prominent examples of such a subgroup is%
\begin{equation*}
\Gamma(N) = \left\{ \gamma \in \SL_2(\ZZ) : \gamma \equiv \begin{pmatrix} 1\amp0 \\ 0 \amp 1 \end{pmatrix} \pmod N \right\}
\end{equation*}
along with%
\begin{equation*}
\Gamma_1(N) = \left\{ \gamma \in \SL_2(\ZZ) : \gamma \equiv \begin{pmatrix} 1\amp\ast \\ 0 \amp 1 \end{pmatrix} \pmod N \right\}
\end{equation*}
%
\begin{equation*}
\Gamma_0(N) = \left\{ \gamma \in \SL_2(\ZZ) : \gamma \equiv \begin{pmatrix} \ast\amp\ast \\ 0 \amp \ast \end{pmatrix} \pmod N \right\}\text{.}
\end{equation*}
%
\par
\(\Gamma(N)\) is normal inside \(\SL_2(\ZZ)\) and \(\Gamma_1(N)\) is normal inside \(\Gamma_0(N)\).%
\par
The aforementioned equivalence of categories gives us a smooth projective curve for each of these examples.%
\par
In fact one can find a smooth projective curve with \(\QQ\)-coefficients realising each of these Riemann surfaces.%
\par
For%
\begin{equation*}
\Gamma_0(N) \backslash \HH^*
\end{equation*}
we have the function \(j(z)\) from before, but also \(j(Nz)\) which is still a function on the quotient now as%
\begin{equation*}
j(N \gamma z) = j\left( N\frac{az + b}{cz+d} \right)
\end{equation*}
%
\begin{equation*}
= j\left( N\frac{az + b}{c'Nz+d} \right)
\end{equation*}
%
\begin{equation*}
= j\left( \frac{aNz + bN}{c'Nz+d} \right)
\end{equation*}
%
\begin{equation*}
= j\left( \gamma ' Nz\right)
\end{equation*}
%
\begin{equation*}
= j\left( Nz\right)
\end{equation*}
%
\par
We can therefore let%
\begin{equation*}
g = \prod_{\gamma} (Y - j(\gamma Nz))
\end{equation*}
the product over the cosets of \(\Gamma_0(N) \subseteq \SL_2(\ZZ)\).%
\par
The coefficients of \(g\) are meromorphic functions on \(X(1) = \CC\lb j \rb\). So we have%
\begin{equation*}
g(Y) = F(j(z), Y)
\end{equation*}
and%
\begin{equation*}
g (j(Nz)) = F(j(z), j(Nz)) = 0
\end{equation*}
then \(F(X,Y)\) is irreducible and  has integer coefficients.%
\par
Then the curve \(X_0(N)\) whose function field is%
\begin{equation*}
\QQ \lb X,Y\rb/ F(X,Y)
\end{equation*}
so \(U \subseteq X_0(N)\) is isomorphic to an affine variety defined by%
\begin{equation*}
F(X,Y) = 0 \smallsetminus \text{singular pts}
\end{equation*}
%
\par
%
\begin{equation*}
\Gamma_0(N) \backslash \HH \to U(\CC)
\end{equation*}
%
\begin{equation*}
z \mapsto (j(z), j(Nz))
\end{equation*}
\(j(\gamma z) = z\,\forall z\) iff \(\gamma \in \SL_2(\ZZ)\).%
\par
If for \(z= z_1,z_2\) have \((j(z),j(Nz))\) equal then \(z_1,z_2\) are in the same \(\Gamma_0(N)\) orbit.%
\par
We can do similar for \(\Gamma_1\) but only over \(\QQ(\zeta_N)\).%
\begin{paragraphs}{Elliptic curves.}{g:paragraphs:idm204357347712}%
Several definitions:%
\begin{enumerate}
\item{}Smooth proj. curve genus 1 with a rational point.%
\item{}smooth curve given by Weierstrass eqn.%
\begin{equation*}
y^2 + a_1xy + a_3 y =  x^3 + a_2x^2 + a_4 x + a_6\text{.}
\end{equation*}
%
\item{}Complex torus of  dimension 1.%
\end{enumerate}
%
\par
Over \(\CC\) at least all are equivalent.%
\par
To get the weierstrass equation from the curve we use Riemann-Roch to see that%
\begin{equation*}
H(1[0]) = 1,\, H(2[0]) = 2,\,H(3[0]) =3
\end{equation*}
So we call a generator of \(H(2\lb 0 \rb) \smallsetminus H(\lb 0 \rb)\) the function \(x\) same for \(y\) and \(H(3\lb 0 \rb)\), now in \(H(6 \lb 0 \rb)\) we have%
\begin{equation*}
1,x,y,x^2 ,xy,y^2,x^3
\end{equation*}
so there is a linear relation among these, giving the Weierstrass equation.%
\par
To get the equation for a torus we use the Weierstrass \(\wp\) function.%
\end{paragraphs}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.2 Modular forms (Asra)}
\typeout{************************************************}
%
\begin{sectionptx}{Modular forms (Asra)}{}{Modular forms (Asra)}{}{}{x:section:sec-buntes-modular-forms}
Last time we saw the \(j\)-function, which was \(\SL_2(\ZZ)\)-invariant, this is quite a strong condition, and in fact \(j\) is pretty much all we get under this condition. So instead we weaken this somewhat to some other variance property.%
\par
If \(w = f(z) \diff z\) on \(\HH\) and \(f(z)\) is meromorphic. \(\gamma \in \Gamma\) then%
\begin{equation*}
f(\gamma z) d(\gamma z) = f(\gamma z) d\left( \frac{az+b}{cz+d} \right)
\end{equation*}
%
\begin{equation*}
= f(\gamma z) \left( \frac{\cdots \diff }{(cz+d)^2} \right)
\end{equation*}
so we get a condition%
\begin{equation*}
f(\gamma z) = (cz+d)^2 f(z)
\end{equation*}
this is how we come to:%
\begin{definition}{}{x:definition:def-buntes-weak-modular}%
A holomorphic function \(f\colon \HH \to \CC\) is a \terminology{weakly modular} function for \(\Gamma\) of weight \(k\) if%
\begin{equation*}
f(\gamma z) = (cz+d)^k f(z) \forall \gamma  = \begin{pmatrix} a\amp b \\ c \amp d    \end{pmatrix} \in \Gamma\text{.}
\end{equation*}
%
\end{definition}
\begin{remark}{}{g:remark:idm204357489184}%
If \(-I \in \Gamma\) and \(k\) odd%
\begin{equation*}
f(-z)  = - f(-z)
\end{equation*}
so in this setting we only have interesting behaviour for even \(k\).%
\par
If \(\Gamma\) is a congruence subgroup of level \(N\) we have%
\begin{equation*}
\begin{pmatrix} 1\amp N \\ 0 \amp 1 \end{pmatrix} \in \Gamma
\end{equation*}
gives you a \(q\)-expansion%
\begin{equation*}
q=  e^{2\pi i z}
\end{equation*}
%
\begin{equation*}
f(z) = \sum_{m\in \ZZ} a_m  q^{m/N}\text{.}
\end{equation*}
%
\par
\(f\) is holomorphic at \(\infty\) if \(a_m  = 0\) for \(m \lt 0\).%
\par
\(f\) is holomorphic at all cusps if \(f(\gamma z)(cz+d)^k\) is holomorphic at \(\infty\) for all \(\gamma \in \SL_2(\ZZ)\).%
\end{remark}
\begin{example}{}{g:example:idm204357558704}%
Cusps for \(\Gamma_0(p)\), we know we have \(\infty\), what is the orbit of this?%
\begin{equation*}
\gamma\in \Gamma_0(p),\, \gamma  =  \begin{pmatrix} a\amp b \\ cp \amp d    \end{pmatrix}
\end{equation*}
%
\begin{equation*}
\gamma \infty  = \frac{a}{cp}
\end{equation*}
so anything with  a \(p\) in the denominator is equivalent to \(\infty\), what about the rest?%
\begin{equation*}
\gamma 0  = \frac{b}{d}, \, \gcd(b,d)  =1\text{,}
\end{equation*}
so we have two cusps.%
\end{example}
\begin{definition}{Modular forms.}{x:definition:def-buntes-mfs}%
A \terminology{modular form} is  a weakly modular function that is holomorphic at all the cusps.%
\end{definition}
\begin{example}{}{g:example:idm204357593968}%
Eisenstein series%
\begin{equation*}
G_k(z) = \sum'_{m,n\in \ZZ} \frac{1}{(mz+n)^k}
\end{equation*}
is a modular form of weight \(k \gt 2\) for \(\SL_2(\ZZ)\).%
\begin{equation*}
\lim_{\im z\to \infty} G_k(z) = \lim_{\im z\to \infty} \sum'_{m,n\in \ZZ} \frac{1}{(mz+n)^k} = \sum'_{n\in \ZZ} \frac{1}{n^k} = 2\zeta(k)\text{.}
\end{equation*}
%
\par
So here the function does not vanish at 0.%
\end{example}
\begin{definition}{Cusp forms.}{x:definition:def-buntes-cusp-forms}%
A \terminology{cusp form} is a modular form that vanishes at all cusps.%
\end{definition}
Given a cusp it will be stabilised by some%
\begin{equation*}
\begin{pmatrix} 1\amp h \\ 0 \amp 1 \end{pmatrix}
\end{equation*}
call the smallest such \(h\) for a given cusp the \terminology{width} of the cusp.%
\begin{example}{}{g:example:idm204357654192}%
Let's find the width of a cusp in \(\Gamma_0(qp)\) we have%
\begin{equation*}
\begin{pmatrix} 1\amp 1 \\ 0 \amp 1 \end{pmatrix}
\end{equation*}
so the width of \(\infty\) is 1.%
\par
What about \(\alpha = 1/p\)?%
\begin{enumerate}
\item{}Find an element \(\gamma \in \SL_2(\ZZ)\) s.t. \(\gamma(\infty) = \alpha\).%
\item{}Compute%
\begin{equation*}
\delta(x) = \gamma \begin{pmatrix} 1\amp x \\ 0 \amp 1 \end{pmatrix} \gamma\inv
\end{equation*}
%
\item{}Find the smallest \(x\) such that \(\delta(x) = \Gamma_0(pq)\)%
\end{enumerate}
%
\begin{equation*}
\gamma = \begin{pmatrix} 1\amp 0 \\ p \amp 1 \end{pmatrix},\, \gamma(\infty) = \frac 1p
\end{equation*}
%
\begin{equation*}
\begin{pmatrix} 1\amp 0 \\ p \amp 1 \end{pmatrix} \begin{pmatrix} 1\amp x \\ 0 \amp 1 \end{pmatrix} \begin{pmatrix} 1\amp 0 \\ -p \amp 1 \end{pmatrix}  = \begin{pmatrix} 1 - px \amp x  \\ -p^2 \amp px+ 1 \end{pmatrix}
\end{equation*}
%
\end{example}
\begin{example}{A cusp form.}{g:example:idm204357686576}%
Let \(\Delta(\tau) = g_2(\tau)^3 - 27g_3(\tau)^2,\,g_2(\tau) = 60G_4(\tau),\,g_3(\tau) =140G_6(\tau)\) \(\Delta(\tau)\) has weight 12 for \(\SL_2(\ZZ)\). This vanishes at \(\infty\) because%
\begin{equation*}
\zeta(4) = \frac{\pi^4}{90}
\end{equation*}
%
\begin{equation*}
\zeta(6) = \frac{\pi^6}{945}
\end{equation*}
also%
\begin{equation*}
j(z) = \frac{g_2(\tau)^3}{\Delta(\tau)}
\end{equation*}
so \(\Delta(\tau)\) vanishes at \(\infty\) because \(g_2(\tau)\) doesn't  and \(j(z)\) has a  simple pole at \(\infty\).%
\end{example}
\(M_k(\Gamma)\) as the space of modular forms of weight \(k\) for \(\Gamma\) is a \(\CC\) -v.s. \(S_k(\Gamma)\) as the space of cusp forms of weight \(k\) for \(\Gamma\) is a \(\CC\) -v.s.%
\begin{theorem}{}{}{g:theorem:idm204357819488}%
\(M_k(\Gamma)\) and \(S_k(\Gamma)\) are finite dimensional%
\begin{equation*}
\dim(M_k(\Gamma)) =
\begin{cases}
0 \amp \text{ if } k \le -1\\
1 \amp \text{ if } k = 0\\
(k-1)(g-1) + v_\infty \frac k2 + \sum_p [\frac k2 (1- \frac{1}{e_p})] \amp \text{ if } k \ge 2
\end{cases}
\end{equation*}
where \(g\) is the genus of \(X(\Gamma)\) \(v_\infty\) is the number of inequivalent cusps \(P\) are the elliptic points \(\lb \cdot \rb\) is the integer part%
\begin{equation*}
\dim(S_k(\Gamma)) =
\begin{cases}
0 \amp \text{ if } k \le 0 \\
(k-1)(g-1) + v_\infty (\frac k2 - 1) + \sum_p [\frac k2 (1- \frac{1}{e_p})] \amp \text{ if } k \ge 2
\end{cases}
\end{equation*}
%
\end{theorem}
%
\begin{equation*}
\dim(S_2(\Gamma)) = g(X(\Gamma))
\end{equation*}
%
\begin{proposition}{}{}{g:proposition:idm204357861360}%
If \(f \in S_2(\Gamma)\) then \(f(z) \diff z\) is a holomorphic differential.%
\end{proposition}
Given an elliptic curve%
\begin{equation*}
E/  \CC = \CC/\Lambda
\end{equation*}
%
\begin{equation*}
E \to E'
\end{equation*}
%
\begin{equation*}
\CC/\Lambda \to \CC/\Lambda'\text{,}
\end{equation*}
studying degree \(n\) isogenies, is like studying index  \(n \) sublattices%
\begin{definition}{Hecke operators.}{x:definition:def-buntes-hecke-ops}%
\(n \ge 1\) then \(T(n)\) is the  \(n\)th \terminology{Hecke operator} acting on%
\begin{equation*}
\divisors (\mathcal L)
\end{equation*}
by%
\begin{equation*}
T(n) \Lambda = \sum_{\Lambda' \subseteq \Lambda,\,[\Lambda : \Lambda'] = n} (\Lambda')
\end{equation*}
%
\end{definition}
\begin{definition}{}{g:definition:idm204357913264}%
Let \(\lambda \in \CC^\times\) the homothety operator \(R_\lambda\) is \(R_\lambda \Lambda = \lambda\Lambda\).%
\end{definition}
\begin{theorem}{}{}{g:theorem:idm204357930128}%
%
\begin{enumerate}
\item{}%
\begin{equation*}
R_\lambda R_\mu = R_{\lambda\mu}
\end{equation*}
%
\item{}%
\begin{equation*}
R_\lambda T(n) = T(n) R_{\lambda}
\end{equation*}
%
\item{}%
\begin{equation*}
T(nm) = T(n) T(m),\,\gcd(n,m) =1
\end{equation*}
%
\item{}%
\begin{equation*}
T(p^e)T(p) = T(p^{e+1 }) + p T(p^{e-1}) R_p
\end{equation*}
%
\end{enumerate}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204357944464}
Of 4.%
\par
\(\Lambda \in \mathcal L\) for \(\Lambda' \subseteq \Lambda \) index \(p^{e+1}\) have%
\begin{equation*}
a(\Lambda')  = \# \{ \Gamma : \Lambda'  \subseteq \Lambda \subseteq_p \Lambda \}
\end{equation*}
%
\begin{equation*}
b(\Lambda')  = 1 \text{ if } \Lambda' \subseteq p\Lambda
\end{equation*}
now%
\begin{equation*}
T(p^e)T(p) \Lambda = T(p^e) \sum_{\Gamma \subseteq_p \Lambda } (\Gamma) = \sum_{\Gamma \subseteq_p \Lambda } \sum_{\Lambda' \subseteq_{p^e} \Gamma} (\Lambda') =\sum_{\Lambda' \subseteq_{p^e} \Gamma}  a(\Lambda') (\Lambda')
\end{equation*}
%
\begin{equation*}
T(p^{e+1} ) \Lambda  =  \sum_{\Lambda'\subseteq_{p^{e+1}} \Lambda} (\Lambda')
\end{equation*}
%
\begin{equation*}
T(p^{e-1} )R_p \Lambda  =  T(p^{e-1}) (p \Lambda) = \sum_{\Lambda'' \subseteq_{p^{e-1}} p\Lambda } (\Lambda'') = \sum_{\Lambda' \subseteq_{p^{e+1}} \Lambda} b(\Lambda') (\Lambda')
\end{equation*}
Split into cases, do some maths..%
\end{proofptx}
Hecke operators on lattices Given \(\Lambda' \subseteq_n \Lambda\) there is an integer matrix of determinant  \(n\) taking one basis to the other. Have a correspondence%
\begin{equation*}
\{ \alpha \in M_2(\ZZ) : \det(\alpha) = n \}  \leftrightarrow \{ \Lambda ' : \Lambda ' \subseteq_n \Lambda\}
\end{equation*}
representatives in Hermite normal form%
\begin{equation*}
S_n = \{\begin{pmatrix} a\amp b \\ 0 \amp d\end{pmatrix} : ad= n,\, a,d\gt 0\, 0\le b \lt d\}
\end{equation*}
%
\begin{corollary}{}{}{g:corollary:idm204344590400}%
Let \(\Lambda \in \mathcal L\), \(\Lambda = \ZZ w_1 + \ZZ w_2\) then  \(T(n)\) acts as follows%
\begin{equation*}
T(n) \Lambda =  \sum_{ ad= n,\, a,d\gt 0\, 0\le b \lt d} \ZZ(aw_1 + bw_2) + \ZZ dw_2 = \sum_{\alpha \in S_n} \alpha \Lambda
\end{equation*}
%
\end{corollary}
\begin{corollary}{}{}{g:corollary:idm204344588208}%
For \(p \) prime \(T(p)\):%
\begin{equation*}
T(p) \Lambda = \ZZ pw_1 + \ZZ w_2 +\sum_{0 \le b \lt p} \ZZ(w_1 + bw_2) + \ZZ pw_2\text{.}
\end{equation*}
%
\end{corollary}
The Hecke operators act on modular forms \(f(\tau)\) by reinterpreting weakly modular functions of weight \(k\) as functions on lattices that have  a weight \(k\) action under homothety.%
\par
This boils down to%
\begin{equation*}
(T_k(n) f)(\tau) = n^{k-1}  \sum_{ ad= n,\, a,d\gt 0\, 0\le b \lt d} d^{-k} f\left( \frac{ a\tau +b}{d}\right)
\end{equation*}
%
\begin{corollary}{}{}{g:corollary:idm204344584128}%
For \(p \) prime%
\begin{equation*}
(T_k(p) f)(\tau) = p^{k-1}f(pz) +\frac 1p \sum_{0 \le b  \lt p} f\left( \frac {z + b}{p} \right)\text{.}
\end{equation*}
%
\end{corollary}
We have an action on fourier expansions%
\begin{equation*}
f(\psi) = \sum_{m\in \ZZ} a_m q^m
\end{equation*}
%
\begin{equation*}
T_k(p)f(\tau) = p^{k-1} \sum_{m\in \ZZ} a_m q^{pm} + \frac{1}{p} \sum_{b=0}^{p-1}  \left( \sum_{m\in \ZZ} a_m e^{2\pi i m (z+b)/p}\right)
\end{equation*}
%
\begin{equation*}
= p^{k-1} \sum_{m\in \ZZ} a_m q^{pm} + \frac{1}{p}  \sum_{m\in \ZZ} a_me^{2\pi i m z/p} \sum_{b=0}^{p-1} \underbrace{e^{2\pi i m b/p}}_{p\text{ if }p|m,0\text{ otw}}
\end{equation*}
%
\begin{equation*}
= p^{k-1} \sum_{m\in \ZZ} a_m q^{pm} +\sum_{m\in \ZZ} a_{pm}q^m
\end{equation*}
%
\begin{corollary}{}{}{g:corollary:idm204344580912}%
%
\begin{equation*}
a_1(T_p(f)) = a_p(f)
\end{equation*}
%
\end{corollary}
If \(f\in S_k(\Gamma_0(1))\) is an eigenfunction for these operators we can normalise so that \(a_1(f) = 1\).%
\par
%
\begin{equation*}
T(m)T(n) = T(mn)
\end{equation*}
%
\begin{equation*}
a_ma_n = a_{mn}
\end{equation*}
%
\begin{equation*}
a_{p^r} = a_p a_{p^{r-1}} + p^{k-1} a_{p^{r+1}}
\end{equation*}
%
\begin{definition}{Petersson inner product.}{x:definition:def-pet}%
The \terminology{Petersson inner product} of two cusp forms \(f,g\in S_k(\SL_2(\ZZ))\) is defined to be%
\begin{equation*}
\pair{f}{g} = \int_{\mathcal D} f \bar g y^{k-2} \diff x \diff y
\end{equation*}
where \(\mathcal D\) is a fundamental domain for \(\SL_2(\ZZ)\).%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204344574720}%
Let \(f,g\in S_k(\SL_2(\ZZ))\), \(n\in \NN\) then%
\begin{equation*}
\pair{T(n) f}{g} = \pair{f}{T(n)g}\text{.}
\end{equation*}
%
\end{proposition}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.3 Abelian varieties and Jacobians (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Abelian varieties and Jacobians (Angus)}{}{Abelian varieties and Jacobians (Angus)}{}{}{x:section:sec-buntes-av-jac}
%
%
\typeout{************************************************}
\typeout{Subsection 5.3.1 Background}
\typeout{************************************************}
%
\begin{subsectionptx}{Background}{}{Background}{}{}{g:subsection:idm204344572048}
\begin{definition}{}{g:definition:idm204344571648}%
An elliptic curve is any one of the following%
\begin{enumerate}
\item{}Smooth projective curve of genus 1 with  a marked rational point.%
\item{}A smooth projective curve with a group law%
\item{}if \(k \subseteq \CC\) we have%
\begin{equation*}
E(\CC) = \CC/ \Lambda
\end{equation*}
%
\begin{equation*}
\Lambda = \ZZ \omega_1 \oplus \ZZ \omega_2,\, \omega_1/\omega_2 \not\in \RR
\end{equation*}
%
\item{}if \(\characteristic k \ne 2,3\) A smooth projective curve specified by%
\begin{equation*}
y^2=  x^3+ ax + b\text{.}
\end{equation*}
%
\end{enumerate}
%
\end{definition}
Aash showed that 1 implies 4 and 3 implies 1.%
\par
One can view the group law on \(E\) either via the chord-tangent method (Bezout's theorem). Or via the isomorphism%
\begin{equation*}
E \to \Pic^0(E)
\end{equation*}
%
\begin{equation*}
P \mapsto [P] - [0]\text{.}
\end{equation*}
%
\begin{definition}{}{g:definition:idm204344566176}%
An abelian variety is a proper irreducible variety with a group law given by regular functions.%
\end{definition}
\begin{remark}{}{g:remark:idm204344565568}%
%
\begin{enumerate}
\item{}In this definition proper is equivalent to projective.%
\item{}The rigidity theorem tells us:%
\begin{enumerate}
\item{}Any morphism of abelian varieties that preserves the identity is a homomorphism.%
\item{}Abelian varieties are abelian%
\end{enumerate}
%
\end{enumerate}
%
\end{remark}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.3.2 Ablelian varieties over \(\CC\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Ablelian varieties over \(\CC\)}{}{Ablelian varieties over \(\CC\)}{}{}{g:subsection:idm204344563680}
\begin{proposition}{}{}{g:proposition:idm204392633936}%
Let \(A/k\subseteq \CC\) then%
\begin{equation*}
A(\CC) = \CC^g/\Lambda
\end{equation*}
where \(g = \dim A\) and \(\Lambda \subseteq \CC^g\) is a rank \(2g\) lattice.%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204392661664}
The lie algebra \(\Lie(A(\CC))\) is a complex vector space of dimension \(g\). We have the exponential%
\begin{equation*}
\exp \colon \Lie(A(\CC)) \to A(\CC)
\end{equation*}
which is surjective onto the connected component of the identity, and locally at \(0\) a diffeomorphism. So \(\exp\) surjects. Since its locally isomorphic at \(0\) we have \(\ker(\exp)\) discrete and hence a lattice. \(A \) proper means \(A(\CC)\) is compact so%
\begin{equation*}
\rank \ker (\exp) = 2g\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
We have a map%
\begin{equation*}
\{\text{AVs}/\CC\} \to \{\text{complex tori}\}
\end{equation*}
but this is not surjective. Which lattices give AVs?%
\begin{definition}{Hermitian forms.}{x:definition:def-herm-form}%
Let \(V\) be a \(\CC\)-vector space and \(\Lambda \subseteq V\) be a full lattice. A \terminology{Hermitian form} on \(V\) is a function%
\begin{equation*}
H \colon V\times V \to \CC
\end{equation*}
which is \(\CC\)-linear in the first component, \(\CC\)-antilinear in the second (i.e. a sesquilinear form). And satisfies%
\begin{equation*}
H(u,v) = \overline{H(v,u)}
\end{equation*}
A Riemann form on \((V,\Lambda)\) is a positive definite Hermitian form on \(V\) s.t. \(\im(H|_V) \colon \Lambda \to \ZZ\).%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204392727808}%
We have a bijection%
\begin{equation*}
\{\text{AVs}/\CC\} \leftrightarrow \{(V,\Lambda)\text{ s.t. there is a Riemann form on } (V, \Lambda)\}\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204392739184}
Swinnerton-Dyer analytic theory of AVs ch.2.%
\end{proofptx}
\begin{example}{}{g:example:idm204392740800}%
For an elliptic curve \(E(\CC) = \CC/ \ZZ \omega_1 + \ZZ \omega_2\)%
\begin{equation*}
H(u,v) = u\bar v/ \im(\omega_1 \bar \omega_2)\text{.}
\end{equation*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.3.3 Jacobian varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Jacobian varieties}{}{Jacobian varieties}{}{}{g:subsection:idm204392748256}
\begin{definition}{}{g:definition:idm204392751536}%
Given \(X\) a curve%
\begin{equation*}
\Pic^0(X) = \divisors^0(X)/\{(f) : f \in K(X)\}
\end{equation*}
this is some abelian group.%
\end{definition}
\begin{theorem}{}{}{g:theorem:idm204392757216}%
Let \(X\) be a genus \(g\) curve \(/k\). Then there exists an abelian variety \(\Jac(X)/k\) of \(\dim = g\) s.t.%
\begin{equation*}
\Jac(X)(L) = \Pic^0(X\otimes L)
\end{equation*}
%
\end{theorem}
\begin{remark}{}{g:remark:idm204392772128}%
This is false as stated unless \(X(k) \ne \emptyset\).%
\end{remark}
\begin{proofptx}{}{g:proof:idm204392776272}
Idea: Pick \(P_0 \in X(k)\) we have a bijection%
\begin{equation*}
\divisors^0(X) \to \divisors^r(X)
\end{equation*}
%
\begin{equation*}
D \mapsto D + r[P_0]
\end{equation*}
we have  a map%
\begin{equation*}
X^r \to X^r/ S_r = X^{(r)} \to \divisors^r(X)
\end{equation*}
we can construct \(\Jac(X)\) as a quotient of \(X^{(r)}\) full details Milne AVs ch. 2.%
\end{proofptx}
\begin{paragraphs}{Jacobians over \(\CC\).}{g:paragraphs:idm204392792320}%
Given \(X\) a compact Riemann surface of genus \(g\) then%
\begin{equation*}
H^0(X, \Omega_X^1) \simeq \CC^g
\end{equation*}
one might wish to consider, for \(P,Q \in X\), \(\omega\in H^0(X, \Omega_X^1)\)%
\begin{equation*}
\int_P^Q \omega
\end{equation*}
this is not well defined as there are choices of path \(P\to Q\).%
\begin{equation*}
H_1(X,\ZZ) = \ZZ^{2g}
\end{equation*}
have  a map%
\begin{equation*}
H_1(X,\ZZ) \to H^0(X, \Omega_X^1) ^\vee
\end{equation*}
%
\begin{equation*}
\gamma \mapsto (\omega \mapsto \int_\gamma \omega)
\end{equation*}
Let%
\begin{equation*}
J(X) = H^0(X, \Omega_X^1) ^\vee/H_1(X,\ZZ)
\end{equation*}
%
\begin{theorem}{}{}{g:theorem:idm204392817056}%
\(J(X) \) is the \(\CC\) points of an abelian variety over \(\CC\). Further the map%
\begin{equation*}
\Pic^0(X) \to J(X)
\end{equation*}
%
\begin{equation*}
[P] - [Q] \mapsto (\omega \mapsto \int^P_Q \omega)
\end{equation*}
is an isomorphism of abelian groups.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204392829968}
For the first claim we need a Riemann form on%
\begin{equation*}
(H^0(X, \Omega_X^1)^\vee , H_1(X,\ZZ))
\end{equation*}
we have%
\begin{equation*}
H_1(X, \ZZ) \times H_1(X, \ZZ) \to \ZZ
\end{equation*}
%
\begin{equation*}
(\gamma_1, \gamma_2) \mapsto -(\gamma_1\cap \gamma_2)\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
\begin{remark}{}{g:remark:idm204392838192}%
In this case we see%
\begin{equation*}
\Lie(\Jac(X)) = H^0(X, \Omega_X^1)
\end{equation*}
this is true in general.%
\end{remark}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.3.4 Some constructions\slash{}properties of AVs}
\typeout{************************************************}
%
\begin{subsectionptx}{Some constructions\slash{}properties of AVs}{}{Some constructions\slash{}properties of AVs}{}{}{g:subsection:idm204392843376}
Let \(A,B\) be AVs\(/k\). Any identity preserving morphism \(\phi \colon A \to B\) is a homomorphism. Such a homomorphism is called an isogeny if it surjective with finite kernel. i.e. \(\lb n \rb \colon A \to A\) is an isogeny and for \(\characteristic(k) \nmid n\).%
\begin{equation*}
A[n] \simeq (\ZZ/n)^{2g}
\end{equation*}
then we have the Tate module for \(l\) prime%
\begin{equation*}
T_lA = \varprojlim_n A[l^n] \simeq \ZZ_l^{2g}
\end{equation*}
in fact%
\begin{equation*}
H^1_{\et} (A, \ZZ_l) \simeq T_lA ^\vee
\end{equation*}
we can also consider \(\Pic^0(A)\). There exists an abelian variety%
\begin{equation*}
\hat A/l
\end{equation*}
s.t.%
\begin{equation*}
\hat A (L) = \Pic^0(A \otimes L)
\end{equation*}
this is called the dual abelian variety. So earlier we saw \(\hat E \simeq E\). in general \(\hat A \not \simeq  A\).%
\par
However for an ample divisor \(D\) we get an isog%
\begin{equation*}
\phi_D \colon A \to \hat A
\end{equation*}
%
\begin{equation*}
P \mapsto t_P^* D -D
\end{equation*}
an isogeny \(\phi\colon A\to \hat A\) is a polarization if%
\begin{equation*}
\phi =  \phi_D /\bar k
\end{equation*}
over \(\CC\)  a polarization is equivalent to a choice of Riemann form.%
\par
A principal polarization is a polarization which is an isomorphism. e.g.%
\begin{equation*}
\phi_{[0]} \colon E \to \hat E
\end{equation*}
%
\begin{equation*}
P \mapsto [P] - [0]
\end{equation*}
%
\begin{remark}{}{g:remark:idm204392899520}%
Jacobian varieties always admit principal polarizations.%
\end{remark}
On \(T_lA \) we have  a Weil pairing%
\begin{equation*}
T_lA \times T_lA^\vee \to \ZZ_l
\end{equation*}
%
\begin{paragraphs}{Maps between Jacobians.}{g:paragraphs:idm204392916128}%
Let \(X,Y/k\) be curves and \(f\colon X \to Y\) a morphism.%
\begin{definition}{}{g:definition:idm204392946288}%
We have a pushforward map%
\begin{equation*}
f_*\colon \Pic^0(X) \to \Pic^0(Y)
\end{equation*}
%
\begin{equation*}
\sum n_x [x] \mapsto \sum n_x[f(x)]
\end{equation*}
if \(f\) is finite then we have  a pullback%
\begin{equation*}
f^* \colon \Pic^0(Y) \to \Pic^0(X)
\end{equation*}
%
\begin{equation*}
\sum n_y[y] \mapsto \sum n_y [f\inv (y)]
\end{equation*}
(with multiplicity).%
\end{definition}
We want further maps between jacobians%
\begin{definition}{}{g:definition:idm204392967248}%
A correspondence between \(X,Y\) is a curve \(Z\) and a pair of finite morphisms.%
\begin{equation*}
X \leftarrow Z \to Y
\end{equation*}
then we get induced maps%
\begin{equation*}
T_* = g_* f^* \colon \Pic^0(X) \to \Pic^0(Y)
\end{equation*}
%
\begin{equation*}
T^* = f_* g^* \colon \Pic^0(Y) \to \Pic^0(X)
\end{equation*}
%
\end{definition}
\end{paragraphs}%
\begin{paragraphs}{Modular jacobians and Hecke correspondences.}{g:paragraphs:idm204392987216}%
Consider \(p\nmid N\) we have%
\begin{equation*}
X_0(N) = \{ (E,C_N) : E\text{ e.c. }, C_N \text{ cyclic sub order } N\}
\end{equation*}
%
\begin{equation*}
X_0(pN) = \{(E,C_{pN})\} = \{(E,C_N,C_p)\}
\end{equation*}
so we have%
\begin{definition}{}{g:definition:idm204393012864}%
the Hecke correspondence \(T_p\) on \(X_0(N)\) is%
\begin{equation*}
X_0(N) \mapsfrom X_0(pN) \to X_0(N)
\end{equation*}
%
\begin{equation*}
(E,C_N)\mapsfrom (E,C_N,C_p)\to (E/C_p, C_p + C_N)\text{.}
\end{equation*}
%
\end{definition}
We have the modular jacobian \(J_0(N)\) and the induced map%
\begin{equation*}
T_p \colon J_0(N) \to J_0(N)
\end{equation*}
%
\begin{equation*}
[E] \mapsto \sum_{C_p \subseteq E} [E/C_p]
\end{equation*}
%
\par
One can consider \(J_0(N)_{\FF_p}\)%
\begin{theorem}{Eichler-Shimura.}{}{g:theorem:idm204393105152}%
\(T_{p*} = \Frob_p + p \Frob_p\inv \in \End(J_0(N)_{\FF_p})\).%
\end{theorem}
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.4 Ricky Show}
\typeout{************************************************}
%
\begin{sectionptx}{Ricky Show}{}{Ricky Show}{}{}{x:section:sec-buntes-hs}
%
%
\typeout{************************************************}
\typeout{Subsection 5.4.1 Moduli of PPAVs}
\typeout{************************************************}
%
\begin{subsectionptx}{Moduli of PPAVs}{}{Moduli of PPAVs}{}{}{g:subsection:idm204393135056}
Recall if \(A/ \CC\) is an abelian variety,  then%
\begin{equation*}
A = A(\CC) =  \CC^g/ \Lambda, \,g = \dim (A)
\end{equation*}
%
\begin{equation*}
\Lambda \cong H_1(A,\ZZ)
\end{equation*}
Also a polarization \(\lambda \colon A \to A^\vee\) is equivalent to choosing a Riemann form%
\begin{equation*}
E \colon \Lambda \times \Lambda \to \ZZ
\end{equation*}
s.t.%
\begin{enumerate}
\item{}\(E\) is bilinear alternating%
\item{}\(E_\RR \colon V\times V \to \RR\) has \(E_\RR(iv,iw)  = E_\RR( v,w)\).%
\item{}%
\begin{equation*}
H(v,w) = E_\RR(iv, w) + i E_\RR(v,w)
\end{equation*}
is a positive definite Hermitian form on \(V\).%
\end{enumerate}
A principal polarization corresponds to \(E\) being a perfect pairing.%
\begin{definition}{}{x:definition:def-princ-pol-av}%
A \terminology{PPAV} (\terminology{principally polarized abelian variety}) is a pair \((A,\lambda)\).%
\end{definition}
If \((\ZZ^{2g}, \Psi)\) is the standard \(2g\)-dim symplectic form \(\Psi\) then by linear algebra there is a symplectic isomorphism%
\begin{equation*}
\alpha \colon \ZZ^{2g} \xrightarrow\sim \Lambda
\end{equation*}
with \(\Psi(v,w) = E(\alpha(v), \alpha(w))\).%
\par
Recall the standard \(\Psi\) is%
\begin{equation*}
\Psi (v,w) = v^\transpose J w, J = \begin{pmatrix} 0 \amp I_g \\ -I_g \amp 0\end{pmatrix}
\end{equation*}
%
\begin{definition}{}{x:definition:def-siegel-space}%
The \terminology{Siegel upper half space} is%
\begin{equation*}
\mathscr H_g = \{ Z = X+iY \in M_g(\CC) : Z^\transpose  = Z ; \, X,Y \in M_g(\RR); \, Y \gt 0\}
\end{equation*}
i.e. \(Y\) is pos. def.%
\end{definition}
Check: \(\mathscr H_1\) is the usual upper half plane.%
\begin{proposition}{}{}{g:proposition:idm204393319600}%
\(\mathscr H_g \cong \Sp_{2g}(\RR)/U(g)\) where \(\Sp_{2g} (R) = \{ M \in \GL_{2g}(R) : M^\transpose J M = J\}\)%
\begin{equation*}
U(g) = O(2g) \cap \Sp_{2g}(\RR) \cap \GL_{g}(\CC)\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204393340144}
(Sketch) First one can show that \(\Sp_{2g}(\RR)\) acts transitively on \(\mathscr H_g\) via linear fractional transformations:%
\begin{equation*}
M = \begin{pmatrix} A\amp B\\ C\amp D\end{pmatrix} \in \Sp_{2g}(\RR),\, Z\in \mathscr H_g
\end{equation*}
%
\begin{equation*}
M\cdot Z = (AZ+B)(CZ+D)\inv \in \mathscr H_g
\end{equation*}
second one computes \(\Stab J = U(g)\)%
\par
For \(g= 1\), \(\Sp_2(\RR) = \SL_2(\RR)\) acts transitively on \(\mathscr H_1\), \(\Stab(i) = \specialorthogonal (2) = U(1)\).%
\begin{equation*}
\begin{pmatrix} \cos \theta\amp \sin \theta \\ - \sin \theta \amp \cos \theta \end{pmatrix} i = i
\end{equation*}
and if%
\begin{equation*}
\begin{pmatrix} a \amp b \\ c \amp d\end{pmatrix} i = i
\end{equation*}
then \(ai + b = -c + di\) so \(M= \begin{pmatrix} a\amp b\\ -b \amp a \end{pmatrix}\in \specialorthogonal(2)\).%
\end{proofptx}
\begin{proposition}{}{}{g:proposition:idm204393429648}%
There is a natural bijection between%
\begin{equation*}
\{(A,\lambda, \alpha) : (A,\lambda)= PPAV,\,\alpha\colon \ZZ^{2g} \xrightarrow \sim \Lambda\} \xrightarrow\sim \mathscr H_g
\end{equation*}
this induces a  bijection%
\begin{equation*}
\{(A,\lambda) \} \xrightarrow \sim \Sp_{2g}(\ZZ) \backslash \mathscr H_g = \Sp_{2g}(\ZZ) \backslash \Sp_{2g} (\RR) / U(g)\text{.}
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204357608144}
We will construct a map%
\begin{equation*}
\{(A,\lambda ,\alpha)\} \xrightarrow\sim\Sp_{2g} (\RR)/U(g)
\end{equation*}
first we construct  a bijection between%
\begin{equation*}
\{(A,\lambda, \alpha)\}
\end{equation*}
and some linear data on a fixed space , so given \((A, \lambda, \alpha)\) use \(\alpha\) to identify%
\begin{equation*}
\alpha\colon \ZZ^{2g} \xrightarrow \sim \Lambda = H_1(A,\ZZ)
\end{equation*}
then  tensor with \(\RR\) to get%
\begin{equation*}
\alpha_\RR \colon \RR^{2g} \xrightarrow\sim \Lambda\otimes \RR \cong \Lie(A) (= \CC^g)
\end{equation*}
the action of \(i\) on the right induces \(J\) on the left with \(J^2 = -I\).%
\par
From \(E_\RR(iv,iw) = E_\RR(v,w)\) we get \(J \) symplectic%
\begin{equation*}
\Psi_\RR(Jv, Jw) = \Psi_\RR( v,w)
\end{equation*}
from \(E_\RR(iv,v) \gt 0\) we get \(J\) is positive%
\begin{equation*}
\Psi_\RR(Jv,v) \gt 0
\end{equation*}
conversely given \(J\) symplectic positive \(J^2 = -I\) on \(\RR^{2g}\) we can construct \((A,\lambda) = (V/\ZZ^{2g}, E)\) This comes with an \(\alpha\) for free since \(H_1(A, \ZZ) \cong \ZZ^{2g}\).%
\par
Suppose \(J\) and \(J_0\) are two complex structures, symplectic positive matrices on \(\RR^{2g}\). Then a lemma from linear algebra tells us that there exists a \(S \in \Sp_{2g}(\RR)\). s.t. \(J_0  = S J S \inv\). We see that this \(S\) is well defined up to an element of \(G = Z(J) \cap \Sp_{2g}(\RR)\). But if \(\gamma \in G \) then \(\gamma\) preserves the associated \(\CC\)-str. on \(\RR^{2g}\). then since \(\gamma\) is symplectic, it preserves%
\begin{equation*}
H(v,w) = E_\RR(iv,w) + iE_\RR(v,w)
\end{equation*}
implies%
\begin{equation*}
\gamma \in U(g)\text{.}\qedhere
\end{equation*}
%
\end{proofptx}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.4.2 Hodge structures}
\typeout{************************************************}
%
\begin{subsectionptx}{Hodge structures}{}{Hodge structures}{}{}{g:subsection:idm204357278912}
Let \(M\) be a \(\cinf\) compact \(\RR\)-manifold. Then \(H^i_{\mathrm{sing}}(M, \RR)  \cong H^i_\dR(M)\). What about for compact \(\CC\)-manifolds \(X\)? For \(M\) have \(H^i_\dR(M)  = H^i(\Omega^\bullet (M))\). This won't give de Rham isomorphism for \(X\):%
\begin{equation*}
H^i_{\mathrm{sing}}(X)
\end{equation*}
supported up to \(i = 2d\) with \(d = \dim_\CC(X)\). but \(H^i(\Omega^\bullet_{\mathrm{hol}}(C))\) is supported up to \(i = d\).%
\par
For \(M\)%
\begin{equation*}
0 \to \underline \RR \to \Omega^0 \to \Omega^1 \to \cdots \to \Omega^d \to 0
\end{equation*}
is a resolution of \(\underline \RR\) by acyclic sheaves, by the existence of \(\cinf\) bump functions.%
\begin{equation*}
H^i_\dR(M) \cong H^i(M, \underline \RR) \cong H^i_{\mathrm{sing}}(M, \RR)\text{.}
\end{equation*}
For \(X\) this doesn't work with \(\Omega_{\mathrm{hol}}^\bullet\) as there are no holomorphic bump functions.%
\begin{equation*}
0 \to \underline \CC \to \Omega^0_{\mathrm{hol}} \to \Omega^1_{\mathrm{hol}} \to \cdots \to \Omega_{\mathrm{hol}}^\bullet \to 0
\end{equation*}
is still a resolution but not acyclic. Instead we use hypercohomology which takes as input any resolution and outputs a cohomology group. This has the property that%
\begin{equation*}
H^i(X, \underline \CC) \cong \mathbf H ^i(\Omega_X^\bullet)
\end{equation*}
so we define \(H^i_\dR(X) = \mathbf H^i(\Omega_X^\bullet)\). so that%
\begin{equation*}
H^i_\dR(X) \cong H^i(X, \underline \CC) \cong H^i_{\mathrm{sing}}(X, \CC)
\end{equation*}
%
\par
On \(X\) we have the sheaf of \((p,q)\) forms \(\Omega^{p,q}\) These are locally given by%
\begin{equation*}
\sum_{|I| = p, |J| = q} f_{I,J} \diff z_I \diff \bar z_J\text{.}
\end{equation*}
We have%
\begin{equation*}
\bar \partial \colon \Omega^{p,q} \to \Omega^{p,q+1}
\end{equation*}
satisfying \(\bar \partial ^2 = 0\). So we can define \(H^{p,q}(X) = \ker \bar \partial/ \im \bar \partial\) (Dolbeaut cohomology).%
\begin{theorem}{Hodge decomposition.}{}{g:theorem:idm204392984480}%
For a compact Kahler manifold (e.g. \(X\) a projective variety) we have%
\begin{equation*}
H^n_\dR(X) \cong \bigoplus _{p+q =n} H^{p,q}(X)\text{.}
\end{equation*}
%
\end{theorem}
\begin{remark}{}{g:remark:idm204393008000}%
%
\begin{equation*}
H^{p,q} (X) \cong H^q( X, \Omega^p)
\end{equation*}
using \(\bar \partial\) Poincaré lemma%
\end{remark}
\begin{example}{}{g:example:idm204393014816}%
\(E/\CC\) elliptic curve.%
\begin{equation*}
H^0_\dR = H^{0,0}
\end{equation*}
%
\begin{equation*}
H^1_\dR = H^{1,0} \oplus H^{0,1}
\end{equation*}
%
\begin{equation*}
H^2_\dR = H^{2,0} \oplus H^{1,1} \oplus H^{0,2}
\end{equation*}
outer terms 0, diamond is  1 , 1 , 1, 1.%
\end{example}
\begin{definition}{Hodge structures.}{x:definition:def-hodge-str}%
A \terminology{Hodge structure} on \(V/\RR\) is a \(\ZZ\)-bigrading on \(V_\CC = V \otimes \CC\) such that%
\begin{equation*}
\overline V^{p,q}  = V^{q,p}
\end{equation*}
its of \terminology{Hodge type} \(S\subseteq \ZZ^2\) if \(V^{pq} \ne 0 \) iff \((p,q) \in S\),%
\end{definition}
\begin{example}{}{g:example:idm204393140736}%
the Hodge decomposition gives a hodge structure on \(H^n_{\mathrm{sing}}(X, \RR)\).%
\end{example}
If \(V\) has a hodge structure of weight \(n\) (i.e. \(V^{pq} \ne 0\) iff \(p,q = n\)). Then we can recover the hodge structure from the associated hodge filtration%
\begin{equation*}
\Fil^p V_\CC = \bigoplus_{p' \ge p} V^{p' q}
\end{equation*}
%
\begin{example}{}{g:example:idm204393167824}%
%
\begin{equation*}
\Fil^0(H^1(E)) = H^{1,0} \oplus H^{0,1}
\end{equation*}
%
\begin{equation*}
\Fil^1(H^1(E)) = H^{1,0}
\end{equation*}
%
\begin{equation*}
\Fil^2(H^1(E)) = 0
\end{equation*}
%
\end{example}
\begin{inlineexercise}{}{g:exercise:idm204393180464}%
%
\begin{equation*}
V^{p,q} = \Fil^p V \cap \overline {\Fil^q V}
\end{equation*}
in weight \(n\).%
\end{inlineexercise}
\begin{paragraphs}{Alternative definition.}{g:paragraphs:idm204393192384}%
%
\begin{equation*}
\mathbf S = \Res_\RR^\CC \mathbf G_m
\end{equation*}
%
\begin{equation*}
\mathbf S(A) = \{ (a,b) \in A^2 : a^2+  b^2 \ne 0\}
\end{equation*}
%
\begin{equation*}
\mathbf S(\RR) = \CC^\times
\end{equation*}
%
\begin{proposition}{}{}{g:proposition:idm204393207968}%
There is  a natural bijection between morphisms of algebraic groups%
\begin{equation*}
\mathbf S \to \GL(V)
\end{equation*}
and Hodge structures on \(V\).%
\end{proposition}
Hence for any lie group \(G\) we can define a hodge structure on \(G\) as a morphism of algebraic groups%
\begin{equation*}
\mathbf S \to G
\end{equation*}
If \(G \to \GL(V)\) is a faithful rep this induces a hodge structure on \(V\).%
\begin{definition}{}{g:definition:idm204393248816}%
A polarization of a HS \(h\colon \mathbf S \to \GL(v)\) is an alternating bilinear form%
\begin{equation*}
\Psi \colon V\times V \to \RR
\end{equation*}
with%
\begin{enumerate}
\item{}%
\begin{equation*}
\Psi (Jv,Jw) =  \Psi(v,w) \text{ for } J = h(i)
\end{equation*}
%
\item{}%
\begin{equation*}
\Psi(v,Jw) \text{ is pos. def.}
\end{equation*}
%
\end{enumerate}
%
\end{definition}
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.5 Variations of Hodge Structures (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{Variations of Hodge Structures (Sachi)}{}{Variations of Hodge Structures (Sachi)}{}{}{x:section:sec-buntes-vhs}
%
%
\typeout{************************************************}
\typeout{Subsection 5.5.1 Review of Hodge Theory}
\typeout{************************************************}
%
\begin{subsectionptx}{Review of Hodge Theory}{}{Review of Hodge Theory}{}{}{g:subsection:idm204393264288}
\(X\) complex manifold \(X\subseteq \PP^N\) which is \(m\)-dimensional. For each \(n\) associate to \(X\)%
\begin{equation*}
H_\ZZ = H^n_{\mathrm{sing}}(X, \ZZ) / \tors
\end{equation*}
%
\begin{equation*}
H_\CC = H_\ZZ \otimes \CC = H^n_\dR(X)
\end{equation*}
we have a bilinear pairing%
\begin{equation*}
Q\colon H_\ZZ \times H_\ZZ \to \ZZ
\end{equation*}
%
\begin{equation*}
Q(\alpha,\beta) = \int_X \alpha \cup \beta \cup \omega^{m-n}
\end{equation*}
where \(\omega\) is a generator of \(H^2( \PP^N , \ZZ)\) restricted to \(X\). This gives us the set-up of \(X\) as a differentiable manifold. Now say something about complex structure. We have a decomposition of differential forms on \(X\)%
\begin{equation*}
A^n(X) = \bigoplus_{p+q  =n} A^{p,q}
\end{equation*}
degree \(n\) forms decomposing as a combination of type \(p,q\) forms.%
\par
Hodge theorem descends to a decomposition on cohomology%
\begin{equation*}
H^n_\dR(X) = \bigoplus_{p+q = n} H^{p,q}
\end{equation*}
%
\begin{equation*}
H^{p,q} = \overline{H^{q,p}}
\end{equation*}
%
\begin{equation*}
Q(H^{p,q}, H^{p',q'}) = 0
\end{equation*}
unless \(p+p' = q+q' = n\).%
\par
A hodge structure of weight \(n\) is the data \((H_\ZZ, Q)\) satisfying the Hodge decomposition, Bilinearity%
\par
Questions:%
\begin{enumerate}
\item{}To what extent does the HS of \(X\) determine \(X\)? (Torelli problem)%
\item{}To what extent can we read off the geometric data of \(X\) from its Hodge structure.%
\end{enumerate}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.5.2 Variations of Hodge structures:}
\typeout{************************************************}
%
\begin{subsectionptx}{Variations of Hodge structures:}{}{Variations of Hodge structures:}{}{}{g:subsection:idm204393354880}
\begin{introduction}{}%
Let \(Y \subseteq X\) be codimension \(k\), this gives a class in%
\begin{equation*}
H^{k,k}(X) \subseteq H^{2k}(X,\CC)
\end{equation*}
what about the converse?%
\par
For each cohomology class \(\gamma\)  in \(H^{2k} (X,\CC)\) is \(\gamma\) a rational linear combination of classes of subvarieties. (Hodge conjecture).%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsubsection 5.5.2.1 Hodge theory for curves}
\typeout{************************************************}
%
\begin{subsubsectionptx}{Hodge theory for curves}{}{Hodge theory for curves}{}{}{g:subsubsection:idm204393368816}
\((H_\ZZ, Q)\), \(H^{1,0} \oplus H^{0,1}\) have the period matrix%
\begin{equation*}
H^{0,1}/\Lambda \cong \Jac(C)
\end{equation*}
%
\par
%
\begin{equation*}
y^2 = x(x-1)(x-\lambda)
\end{equation*}
%
\begin{equation*}
\lambda \in \PP^1 - \{0,1,\infty\}
\end{equation*}
each \(E_\lambda \leftrightarrow H^{1,0} \oplus H^{0,1}\) so can ask as \(\lambda\) varies we can ask how \(H^{1,0}\) is situated inside of \(H^{1,0} \oplus H^{0,1}\).%
\par
%
\begin{equation*}
\omega = \frac{\diff x}{y} \in H^0(X,\Omega_X)
\end{equation*}
pairing with \(H_1(X)\)%
\begin{equation*}
\int_\gamma \omega\text{.}
\end{equation*}
%
\par
For \(B\) a variety \(\{X_b\}\) are varieties with Hodge structures for each \(b\in B\). Locally we can identify%
\begin{equation*}
H_\ZZ = H^n(X_b , \ZZ)/\tors
\end{equation*}
and \(H_\CC \) with that of \(X_{b_0}\).%
\par
Then consider%
\begin{equation*}
H^{n-k, k}(X_b)
\end{equation*}
or the associated%
\begin{equation*}
F^k = \bigoplus_{l=0}^k H^{n-l,l}(X_b)
\end{equation*}
subspaces of \(H_\CC\).%
\par
Question: What is a moduli space of linear subspaces?%
\par
Answer: The grassmanian!%
\begin{equation*}
{\mathrm{Gr}}(k,V)
\end{equation*}
of \(k\)-dimensional subspaces of a fixed vector space \(V\). What is the tangent space to the Grassmanian at a point \(W\subseteq V\)?%
\begin{equation*}
\Hom(W, V/W)
\end{equation*}
if we take the complementary subspace \(W  \oplus C = V\) given another subspace%
\begin{equation*}
W' \cap C =  \{ 0 \}
\end{equation*}
have \(\pi_{W'}, \pi_C\)%
\begin{equation*}
{\mathrm{Gr}}(k,V) = \{\text{all\,}W'\}
\end{equation*}
%
\begin{equation*}
\cong \Hom(W,C)
\end{equation*}
by \(\pi_C \circ (\pi_W|_{W'})\inv\).%
\begin{fact}{}{}{g:fact:idm204357739744}%
%
\begin{enumerate}
\item{}\(\phi\colon B\to {\mathrm{Gr}}\) mapping \(b \mapsto F^k(X_b) \subseteq H_\CC\) is holomorphic.%
\item{}In terms of identifying the tangent space of the grassmanian to the hom set, the image under%
\begin{equation*}
\diff \phi_k = \delta_k
\end{equation*}
of any tangent vector of \(B\) at \(b_0\) carries \(F^{k} \) to \(F^{k+1}/F^k\) so we have maps%
\begin{equation*}
\delta_k \colon T_{b_0} B \to \Hom(H^{n-k,k} (X), H^{n-k-1, k+1}(X))
\end{equation*}
satisfying%
\begin{equation*}
\delta_{k+1} (V) \circ \delta_k(W) =  \delta_{k+1}(W) \circ \delta_k(W)
\end{equation*}
for all \(v,w\in T\).%
\end{enumerate}
%
\end{fact}
Since \(F^k(X_b)\) satisfy%
\begin{equation*}
Q(F^k, F^{n- k - 1} ) = 0
\end{equation*}
for all \(b\).%
\begin{equation*}
Q(\delta_v(v)(\alpha), \beta) + Q(\alpha, \delta_{n-k-1}(v)(\beta)) = 0
\end{equation*}
for all \(\alpha\in H^{n-k, k}(X)\), \(\beta \in H^{k+1, n-k - 1}(X)\) for \(v \in T\)%
\begin{definition}{Infinitesimal variation of Hodge structures.}{x:definition:def-ivhs}%
An \terminology{infinitesimal variation of Hodge structures} is%
\begin{equation*}
(H_\ZZ, Q, H^{p,q}, T, \delta_q\colon T \to \Hom(H^{p,q}, H^{p-1, q+1}))
\end{equation*}
%
\end{definition}
Two observations:%
\begin{remark}{}{g:remark:idm204392782496}%
Variations of hodge structures are often computable, e.g. for hypersurfaces in \(\PP^N\).%
\end{remark}
%
\begin{equation*}
X\subseteq \PP^{n+1}
\end{equation*}
let \(X = \{ f = 0 \}\) of \(\deg d\).%
\par
Lefschetz implies the only interesting cohomology is in the middle dimension.%
\begin{equation*}
H^n(X)
\end{equation*}
%
\begin{equation*}
H^{n,0}(X)
\end{equation*}
Poincaré residues of \(n+1\) forms of \(\PP^{n+1}\) with poles along \(X\)%
\begin{equation*}
\frac{  \Res_\omega g(z_0, \ldots, z_{n+1}) \Omega} f = \frac{g \widetilde \Omega}{\sum \partder[f]{z_i}}\text{.}
\end{equation*}
%
\par
%
\begin{equation*}
\CC[z_0, \ldots, z_{n+1}]/\text{Jacobian ideal}
\end{equation*}
graded parts \(H^{p,q}(X)\)%
\begin{problem}{}{g:problem:idm204392811552}%
Identify \(H_\ZZ\) inside of \(H^n\)%
\end{problem}
Solution: VHS \(\delta_k\) maps turn out to be polynomial multiplication \(d\ge n+1\).%
\begin{theorem}{Noether-Lefschetz.}{}{g:theorem:idm204393372864}%
A surface \(S \subseteq \PP^4\) of degree \(d \ge 4\) having general moduli contains no curves other than complete intersections \(S \cap T\) with other surfaces \(T\).%
\end{theorem}
\end{subsubsectionptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.6 Moduli of linearized \(\CC\)-structures (RICKY)}
\typeout{************************************************}
%
\begin{sectionptx}{Moduli of linearized \(\CC\)-structures (RICKY)}{}{Moduli of linearized \(\CC\)-structures (RICKY)}{}{}{x:section:sec-buntes-ricky2}
%
%
\typeout{************************************************}
\typeout{Subsection 5.6.1 Motivation: Period morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Motivation: Period morphisms}{}{Motivation: Period morphisms}{}{}{g:subsection:idm204393042736}
Recall for  \(A\) a  polarized AV we get a lattice \(H_1(A,\ZZ)\) with some structure. To keep track of the \(\CC\)-structure  we record the Hodge structure induced on \(H_1(A,\RR)\) via the Hodge decomposition theorem. If we want to say construct a moduli space of Elliptic Curves we might try to create a moduli space of \(\CC\)-structures on a fixed torus \(T\).%
\par
The linearized version of this is to fix \(H^1(T, \RR)\) and consider possible Hodge structures on it.%
\begin{example}{}{g:example:idm204392785488}%
%
\begin{equation*}
E_\lambda \colon y^2 = x(x-1) (x-\lambda)
\end{equation*}
%
\begin{equation*}
\mathcal E \xrightarrow f S = \PP^1 \smallsetminus \{0,1,\infty\}
\end{equation*}
then we can identify%
\begin{equation*}
V_\lambda = H^1_\sing(E_\lambda, \RR)
\end{equation*}
for nearby \(\lambda \in S\). Then the Hodge structure looks like:%
\begin{equation*}
F^1 V_{\lambda, \CC} = \langle \frac{\diff x}{y} \rangle \hookrightarrow V_{\lambda, \CC}
\end{equation*}
this induces a period map%
\begin{equation*}
S\supseteq U \to \PP^1
\end{equation*}
sending \(s \mapsto F^1V_{s, \CC}\).%
\end{example}
Today generalise the role of \(\PP^1\) in this.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.6.2 Moduli of Hodge structures}
\typeout{************************************************}
%
\begin{subsectionptx}{Moduli of Hodge structures}{}{Moduli of Hodge structures}{}{}{g:subsection:idm204347868224}
Recall: a Hodge structure on a real vector space \(V\) is equivalent to a morphism \(h \colon \mathbf S \to \GL(V)\) where \(\mathbf S  = \Res_\RR^\CC \mathbf G_m\) Given \(h\), let%
\begin{equation*}
V^{p,q} = \{ v \in V_\CC : h(z) v= z^{-p} \bar z ^{-q} v\}
\end{equation*}
(the characters of \(\mathbf S\) are of the form \(\chi_{p,q} = z^{-p} \bar z ^{-q}\) for \((p,q)\in \ZZ^2\). So a general Hodge structure on a Lie group  \(G\) is defined to be a map \(\mathbf S \to G\).%
\begin{lemma}{}{}{g:lemma:idm204347863376}%
The combinatorial data of two Hodge structures are the same iff they are conjugate (i.e. the maps \(\mathbf S \to \GL(V)\) are conjugate).%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204347862480}
If \(h\) and \(h'\) are conjugate by \(g\) then conjugation by \(g\) takes \(V^{p,q}\) of one into the other (b\slash{}c it preserves the character spaces of \(\mathbf S\)). Conversely if \(\{V_1^{p,q}, V_2^{p,q}\}\) are two HS with the same combinatorial data then we can take \(g \colon V_{\CC} \to V_{\CC}\). Taking \(V_1^{p,q} \cong V_2^{p,q}\) and satisfying \(g(\bar v) = \overline{g(v)}\) (using Hodge symmetry) since \(g\) commutes with \(\bar \cdot\), it descends to a  map on \(V\).%
\end{proofptx}
Let  \(X\) be a conjugacy class of morphisms \(h\colon \mathbf S \to G\).%
\par
Impose the condition that:%
\begin{equation}
h(\RR^\times) \text{ lies in the center of }G(\RR) \forall h\label{g:men:idm204347855824}
\end{equation}
(If the HS on \(V\) is of weight \(k\) then \(h(t) = t^k I\), the converse is also true.)%
\par
\(G\) acts transitively on \(X\) (via conjugation). So%
\begin{equation*}
X=  G/K
\end{equation*}
for \(K = \Stab(h) \) for some \(h\) in \(X\). This gives \(X\) the structure of a \(C^\infty\)-manifold.%
\begin{paragraphs}{The \(\CC\)-structure on \(X\).}{g:paragraphs:idm204347851088}%
We give \(T_hX = \Lie G / \Lie K\) a \(\CC\)-v.s. structure let \(\psi_g (x)  = g x g \inv\) gives%
\begin{equation*}
G\to \Aut(G)
\end{equation*}
and its derivative is the adjoint map \(\ad\). If we compose with \(h \colon \mathbf S\to G\) we get a hodge structure on \(L=  \Lie G\).%
\par
As \(h(\RR^\times)\) is in the center of \(G(\RR)\), have \(\ad h(\RR^\times)\) is the identity on \(L\). Hence the hodge structure on \(L\) is of weight 0. By above remark.%
\par
Let \(L^{0,0} = L_\CC^{0,0} \cap L\) be the real \((0,0)\) part of the HS on \(L\).%
\begin{lemma}{}{}{g:lemma:idm204347843536}%
%
\begin{equation*}
L^{0,0} = \Lie K
\end{equation*}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204347842896}
By the definition of \(K\), \(\psi_h(k) = k\) for all \(k \in K\). Differentiating gives%
\begin{equation*}
(\ad h) (v) = v
\end{equation*}
for all \(v \in \Lie K\) So \(\Lie K  \subseteq L^{0,0}\). Conversely if \(v \in L^{0,0}\) then \((\ad h) (v)=v\) implies%
\begin{equation*}
(\ad h)(\exp v) = \exp v
\end{equation*}
so \(\exp v \in K\) i.e. \(v \in \Lie K\).%
\end{proofptx}
\begin{lemma}{}{}{g:lemma:idm204347838288}%
The inclusion \(L \hookrightarrow L_\CC\) induces an isomorphism of \(\RR\)-v.s.%
\begin{equation*}
L/L^{0,0} \xrightarrow\sim L_\CC / F^0 L_\CC\text{.}
\end{equation*}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204347836624}
see notes.%
\end{proofptx}
These lemmas combined give \(T_h X\) a  \(\CC\)-structure.%
\par
To get a \(\CC\)-manifold structure on \(X\) we embed \(X\) into a \(\CC\) manifold in a way that respects the \(\CC\)-structures on the tangent spaces.%
\par
Pick a faithful representation \(G \hookrightarrow \GL(V)\). Then \(h \in X\) we get a Hodge structure on \(V\) via%
\begin{equation*}
\mathbf S \xrightarrow h G \xrightarrow \rho \GL(V)
\end{equation*}
all other \(h' \in X\) have the same combinatorial data.%
\par
Let \(\mathbf F\) be the flag variety parameterises filtrations of the type associated to \(h \in X\).%
\par
To be safe assume \(V\) of weight \(k\).%
\par
We have an injective map%
\begin{equation*}
X \hookrightarrow \phi \mathcal F
\end{equation*}
this induces a complex structure on \(X\), see notes for deets.%
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.6.3 Geometric conditions and chill (on VHS)}
\typeout{************************************************}
%
\begin{subsectionptx}{Geometric conditions and chill (on VHS)}{}{Geometric conditions and chill (on VHS)}{}{}{g:subsection:idm204347827792}
Recall that a VHS parameterised by a space \(S\) must satisfy ``Griffiths transversality'', this translates to the condition%
\begin{theorem}{}{}{g:theorem:idm204347826384}%
A VHS on \(V\) satisfies Griffiths transversality iff%
\begin{equation}
\text{the HS  on } L = \Lie(G) \text{ of type }\{(-1,1),(0,0),(1,-1)\}\text{.}\label{g:men:idm204347825488}
\end{equation}
%
\end{theorem}
\begin{paragraphs}{Background on Cartan involutions.}{g:paragraphs:idm204347824976}%
Let \(G\) be a real algebraic group with involution \(\sigma\). Then a real form of \(G\)  associated to \(\sigma\) is%
\begin{equation*}
G^\sigma (A) = \{ g \in G(A \otimes \CC) : \sigma(g) = \bar g\}
\end{equation*}
for all \(\RR\)-algebras \(A\).%
\begin{example}{}{g:example:idm204347821648}%
\(G = \GL_n\), \(\sigma(g) = (g^\perp)\inv\) then%
\begin{equation*}
G^\sigma = U(n)
\end{equation*}
observe that this is compact!%
\end{example}
\begin{definition}{Cartan involutions.}{x:definition:def-cartan-inv}%
\(\sigma\) is called a \terminology{Cartan involution} if \(G^\sigma\) is compact, i.e. \(G^\sigma(\RR)\) is compact and meets every connected component of \(G^\sigma(\CC)\).%
\end{definition}
\begin{theorem}{}{}{g:theorem:idm204347817424}%
Let \(G\) be connected, then \(G\) is reductive iff \(G\) admits a Cartan involution.%
\end{theorem}
\begin{lemma}{for next time.}{}{g:lemma:idm204347815760}%
If \(K\) is a compact lie group then any \(\CC\)-representation \(V\) of it admits a \(K\)-invariant pos. def. Hermitian form%
\par
Conversely if \(K\) has a faithful representation admitting a \(K\)-inv pos. def. Herm. form. then \(K\) is compact.%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204347812048}
\(K\) compact, take any \(H_0(u,v)\) a pos. def. herm. form on \(V\). Then%
\begin{equation*}
H(u,v) = \int_K H_0(Ku, Kv) \diff K
\end{equation*}
is \(K\)-invariant with some properties. For the converse statement the conditions imply \(K \hookrightarrow U(K)\) hence \(K\) is compact.%
\end{proofptx}
\begin{remark}{}{g:remark:idm204347809104}%
One source of involutions on \(G\) come from \(C\in G\smallsetminus Z\) s.t. \(C^2 \in Z\) then%
\begin{equation*}
g   \mapsto C g C\inv
\end{equation*}
is such an involution. e.g. \(J\)!!%
\end{remark}
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.7 What is ... a Shimura Variety? (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{What is ... a Shimura Variety? (Angus)}{}{What is ... a Shimura Variety? (Angus)}{}{}{x:section:sec-buntes-whats-a-shimura-var}
\begin{paragraphs}{Motivation.}{g:paragraphs:idm204347806288}%
We began by studying modular curves e.g. \(Y_0(N) =  \Gamma_0(N)\backslash \mathcal H\) Aash proved%
\begin{equation*}
Y_0(N) = \Gamma_0(N) \backslash \SL_2(\RR) / \specialorthogonal_2(\RR)\text{.}
\end{equation*}
%
\par
Consider \(\adeles =  \prod'_v \QQ_v\) the adele ring of \(\QQ\). Let%
\begin{equation*}
K_0(N) = \{ \begin{pmatrix} a\amp b \\ c \amp d \end{pmatrix} \in \GL_2(\widehat \ZZ) : c \equiv 0  p\mod N \}\text{.}
\end{equation*}
%
\begin{theorem}{Strong approximation.}{}{g:theorem:idm204347803472}%
%
\begin{equation*}
\GL_2(\adeles) = \GL_2(\QQ) \GL_2(\RR)^+ K_0(N)\text{.}
\end{equation*}
%
\end{theorem}
\begin{corollary}{}{}{g:corollary:idm204347802448}%
%
\begin{equation*}
Y_0(N) = \GL_2(\QQ)Z(\GL_2(\adeles)) \backslash \GL_2(\adeles) / K_0(N) \specialorthogonal_2(\RR)
\end{equation*}
%
\end{corollary}
We will generalise this final viewpoint for general \(G\).%
\end{paragraphs}%
\par
Last time \(X = \) conjugacy class of morphisms%
\begin{equation*}
h \colon \mathbf S \to G\text{ for } G/\RR
\end{equation*}
an algebraic group s.t.%
\begin{enumerate}
\item{}%
\begin{equation*}
h(\RR^\times)  \subseteq Z(G(\RR))
\end{equation*}
%
\item{}The hodge structure on \(\Lie(G)\) induced by \(\ad \circ h\) is of type \(\{(-1,1), (0,0), (1,-1)\}\).%
\end{enumerate}
%
\par
We also began studying Cartan involutions. Take an involution \(\sigma\) of \(G\) and define%
\begin{equation*}
G^\sigma(A) = \{ g\in G(A \otimes \CC : \sigma(g) = \bar g\}
\end{equation*}
this \(G^\sigma\) is another algebraic group \(/\RR\).%
\begin{remark}{}{g:remark:idm204347796048}%
\(G^\sigma\) is a real form of \(G\), i.e. \(G^\sigma \otimes \CC \simeq G \otimes \CC\).%
\end{remark}
\begin{example}{}{g:example:idm204347794640}%
\(G  =\GL_n\), \(\sigma(g) = (g^\transpose)\inv\) then \(G^\sigma =  U(n)\).%
\end{example}
Recall the definition of a Cartan involution.%
\par
For \(C \in G(\RR)\) s.t. \(C^2 \in Z(G(\RR))\) then%
\begin{equation*}
\sigma \colon g \mapsto CgC\inv
\end{equation*}
is an involution.%
\par
When is it Cartan?%
\begin{definition}{}{x:definition:def-c-pol}%
An \(\RR\)-representation \(V\) of \(G\) is \(C\)-polarizable if there exists a \(G\)-invariant bilinear form%
\begin{equation*}
\Psi \colon V \times V \to \RR
\end{equation*}
s.t.%
\begin{equation*}
\Psi(x,Cy)
\end{equation*}
is symmetric and positive definite.%
\end{definition}
\begin{theorem}{}{}{g:theorem:idm204347787856}%
Let \(G/\RR\) be an algebraic group. Let \(C  \in G(\RR)\) s.t. \(C^2 \in Z(G(\RR))\). Let \(\sigma \colon g\mapsto Cg C\inv\)  then \(\sigma\) is a Cartan involution iff \(G\) admits a faithful \(C\)-polarizable representation.%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204347784656}
\(\Rightarrow\). Assume \(G^\sigma \) is compact. Let \(V\) be a faithful \(\RR\)-representation of \(G^\sigma (\RR)\). From last time, there exists a \(G^\sigma(\RR)\)-invariant positive definite symmetric form%
\begin{equation*}
\Psi\colon V\times V\to \RR
\end{equation*}
consider \(\Phi(u,v) = \Psi(u, C\inv v)\). Then \(\Phi(x,Cy)\) is positive definite and symmetric so \(\Phi\) is a \(C\)-polarization.%
\par
\(\Leftarrow\). Let \(V\) be \(C\)-polarizable so we have \(\Psi \colon V\times V \to  \RR\). Then \(\Psi_\CC \colon V_\CC \times V_\CC \to \CC\) is symmetric bilinear \(G\)-invariant. Let \(H(u,v) = \Psi_\CC(u,\bar v)\) consider \(H^\sigma(u,v) = H(u,Cv)\).%
\par
\(H^\sigma\) is \(G^\sigma(\RR)\)-invariant positive definite, Hermitian. From last time \(G^\sigma\) is compact.%
\end{proofptx}
Now introduce polarizations on Hodge structures.%
\begin{definition}{}{g:definition:idm204347775440}%
A \terminology{polarization} on a weight \(k\) Hodge structure%
\begin{equation*}
h\colon \mathbf S \to \GL(V)
\end{equation*}
%
\begin{equation*}
V_\CC = \bigoplus_{p+q = k} V^{p,q}
\end{equation*}
is a bilinear form \(\Psi\colon V\times V \to \RR\) s.t.%
\begin{enumerate}
\item{}\(\Psi\) is (symmetric\slash{}alternating) if \(k\) is even \slash{} odd.%
\item{}Letting%
\begin{equation*}
H\colon V_\CC \times V_\CC \to \CC
\end{equation*}
be given by%
\begin{equation*}
H(u,v) = i^k \Psi(u, \bar v)
\end{equation*}
then the%
\begin{equation*}
V^{p,q}
\end{equation*}
are orthogonal with respect to \(H\) and \(H|_{V^{p,q}}\) has sign \(i^{p-q- k}\).%
\end{enumerate}
%
\end{definition}
Why polarize?%
\par
Recall: the set of polarized Hodge structures on \(\RR^{2g}\) of type \(\{(-1,0), (0,-1)\}\) is the Siegel upper half space \(\mathcal H_g\).%
\begin{lemma}{}{}{g:lemma:idm204347767888}%
Let \(\RR(n) \) be the vector space \(\RR\) with Hodge structure \(z\mapsto |z|^n\). A bilinear form \(\Psi\) on \(V\) (of weight \(k\)) is a polarization iff%
\begin{enumerate}
\item{}\(\Psi\colon V\times V \to \RR(-k)\) is a morphism of  Hodge structures.%
\item{}\(\Psi(v, h(i) w)\) is symmetric and positive definite.%
\end{enumerate}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204347763920}
\(\Leftarrow\) in Jared's notes.%
\par
\(\Rightarrow\), we want to show%
\begin{equation*}
\Psi(h(z) v, h(z) w) = |z|^{-k} \Psi(v,w)
\end{equation*}
%
\begin{equation*}
\Psi(h(z) v, h(z) w) = i^{-k} H(h(z) v, \overline{h(z) w})
\end{equation*}
%
\begin{equation*}
=  i^{-k} H(h(z) \sum v_{p,q}, \overline { \sum h(z) w_{pq}})
\end{equation*}
%
\begin{equation*}
= \cdots
\end{equation*}
%
\begin{equation*}
= |z|^{-k} \Psi(v,w)
\end{equation*}
using orthogonality.%
\end{proofptx}
Let \(V \) be a faithful representation of \(G \) s.t. for all \(h\in X\) we get  a Hodge structure on \(V\).%
\par
Call \(V\) polarizable if in the weight decomposition%
\begin{equation*}
V = \bigoplus_k V_k
\end{equation*}
each \(V_k\) admits a bilinear form \(\Psi_k\) s.t. \(h \in X\) gives a polarized Hodge structure on \(V_k\).%
\par
To define the adjoint group, take the adjoint representation%
\begin{equation*}
\ad \colon G_1^{\ad} = \ad(G_1)
\end{equation*}
if \(G_1\) is connected then \(G_1^{\ad} = G_1 /Z(G_1)\).%
\begin{theorem}{}{}{g:theorem:idm204347755600}%
Let \(G_1\) be the smallest subgroup of \(G\) through  which all the \(h \in X\) factor. A faithful representation \(V\) is polarizable iff%
\begin{enumerate}
\item{}\(G_1\) is reductive.%
\item{}For some \(h \in X\) (equivalently for all \(h \in X\)) conjugation by \(h(i)\) is a Cartan involution on the adjoint group \(G_1^{\ad}\).%
\end{enumerate}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204347751120}
\(\Rightarrow\) Let \(G_2 \subseteq G_1\) be the smallest subgroup containing \(h(U^1)\) for all \(h \in X\) where \(U^1 = \{|z| = 1\} \subseteq \CC^\times\). Then \(G_1\) is generated by \(G_2\) and \(h(t)\) for all \(t \in \RR^\times, h \in X\). Since \(h(t)\) is always central have \(G_1^{\ad}=  G_2^{\ad}\). By the previous lemma, \(\forall z  \in U^1\)%
\begin{equation*}
\Psi(h(z), v, h(z) w) = \Psi(v,w)
\end{equation*}
so \(\Psi\) is \(G_2\) invariant. Father \(\Psi(v, h(i) w)\) is symmetric positive definite for all \(h \in X\). So conjugation by \(h(i)\) is a Cartan involution on \(G_2\) so on \(G_2^{\ad} = G_1^{\ad}\).%
\end{proofptx}
\begin{definition}{Shimura data.}{x:definition:def-buntes-shimura-datum}%
A \terminology{Shimura datum} is a pair \((G,X)\) where%
\begin{enumerate}
\item{}\(G/\QQ\) is a reductive algebraic group.%
\item{}\(X\) is a \(G(\RR)\)-conjugacy class of morphisms \(h\colon \mathbf  S \to  G_\RR\) s.t.%
\begin{enumerate}
\item{}\(\forall h \in X\) the Hodge structure on \(\Lie (G_\RR)\) induced by \(\ad \circ h\) is of type \(\{(-1,1), (0,0), (1,-1)\}\).%
\item{}The involution \(\ad h(i)\) (i.e. conjugation by \(h(i)\)) is a Cartan involution on \(G^{\ad}\).%
\item{}\(G\) has no \(\QQ\)-factor on which the projection of \(h\) is trivial.%
\end{enumerate}
%
\end{enumerate}
%
\end{definition}
\begin{definition}{}{g:definition:idm204347735120}%
Let \(\adeles^\infty = \prod_{p\ne \infty}' \QQ_p\) be the ring of finite adeles of \(\QQ\). Let \(K \subseteq G(\adeles^\infty)\) be a compact open subgroup. The shimura variety of level \(K\) then \({\operatorname{Sh}}_K(G,X)\) is given by%
\begin{equation*}
{\operatorname{Sh}}_K(G,X) = G(\QQ)  \backslash X\times G(\adeles^\infty) / K
\end{equation*}
The shimura variety at infinite level is%
\begin{equation*}
{\operatorname{Sh}}(G,X) = \varprojlim_K G(\QQ) \backslash  X \times G(\adeles^\infty) / K = G(\QQ) \backslash X \times G(\adeles^\infty)
\end{equation*}
%
\end{definition}
\begin{example}{\(\GL_2\).}{g:example:idm204347731904}%
\(X = \) conj. class containing \(h \colon (a+bi) \mapsto \begin{pmatrix} a\amp b \\ -b \amp a\end{pmatrix}\) \(\leftrightarrow \CC \smallsetminus \RR\) \(\leftrightarrow \{\) complex structures on \(V = \QQ^2\}\).%
\begin{equation*}
h \mapsto i
\end{equation*}
Let \(E/\CC\) be an elliptic curve. We have the full Tate module%
\begin{equation*}
TE = \varprojlim_N E[N]  \simeq \widehat\ZZ^2
\end{equation*}
We have the full rational Tate module%
\begin{equation*}
V^\infty E = TE \otimes \adeles^\infty \simeq (\adeles^\infty)^2
\end{equation*}
%
\begin{equation*}
\simeq H^1(E,\QQ) \otimes_\QQ \adeles^\infty
\end{equation*}
%
\end{example}
\begin{proposition}{}{}{g:proposition:idm204347727552}%
\({\operatorname{Sh}}(\GL_2, X)\) classifies isogeny classes of pairs \((E, \eta)\) where%
\begin{equation*}
E/\CC \text{ an elliptic curve}
\end{equation*}
%
\begin{equation*}
\eta \colon \adeles^\infty \times \adeles^\infty\xrightarrow{\sim} V^\infty(E)
\end{equation*}
an \(\adeles^\infty\) linear isomorphism.%
\end{proposition}
\begin{remark}{}{g:remark:idm204347725376}%
An isogeny is \(f \in \Hom(E, E') \otimes \QQ\) sending \(\eta \mapsto \eta'\) \({\operatorname{Sh}}(\GL_2, X)\) has components indexed by \(\widehat \ZZ^\times\).%
\end{remark}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.8 Canonical models (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Canonical models (Alex)}{}{Canonical models (Alex)}{}{}{x:section:sec-buntes-canonical-models}
\begin{introduction}{}%
Recall we defined Shimura varieties given a Shimura datum \((G,X)\) and a compact open \(K \subseteq G(\adeles^\infty)\) as%
\begin{equation*}
{\operatorname{Sh}}_K (G,X) = G(\QQ) \backslash (X \times G(\adeles^\infty)) / K
\end{equation*}
a quasi-projective variety, and more generally the infinite level version%
\begin{equation*}
{\operatorname{Sh}}_K (G,X) = \varprojlim_K {\operatorname{Sh}}_K(G,X) = G(\QQ) \backslash (X\times G(\adeles^\infty))
\end{equation*}
which is a pro-variety and in fact a scheme.%
\par
These are varieties over \(\CC\), we might hope to define them over a \emph{number field} or even a \emph{ring of integers}, so that we can do number theoretic things (look locally prime by prime for instance, or identify special rational points).%
\par
In the case where our Shimura variety is a natural moduli space (modular curves) might expect that this is indeed possible.%
\par
There will be two words in this talk, special and canonical that already have a vague meaning, we will be giving them a precise meaning in this talk for once!%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 5.8.1 Galois descent}
\typeout{************************************************}
%
\begin{subsectionptx}{Galois descent}{}{Galois descent}{}{}{g:subsection:idm204347718560}
Say you have a variety over \(\CC\). Is it really a \(\CC\)-variety, or is it a \(k\) variety for \(k \subseteq \CC\) that has been base-changed to \(\CC\)?%
\begin{question}{}{g:question:idm204347716000}%
Given \(X/\CC\) a variety, is there a subfield \(k \subseteq \CC\) and an \(X_0/k\) with%
\begin{equation*}
X \simeq X_0 \times_k \CC
\end{equation*}
we then say \(X\) descends to \(k\), and that \(X_0\) is a model of \(X\) over \(k\).%
\end{question}
\begin{paragraphs}{Preview: some examples of curves.}{g:paragraphs:idm204347712032}%
\begin{example}{}{g:example:idm204347711648}%
Let%
\begin{equation*}
C \colon x^2+ y^2 = \pi/\CC
\end{equation*}
is there \(C_0/\QQ\) s.t. \(C_0\times_\QQ \CC \simeq C\). Yes, we have%
\begin{equation*}
C \simeq x^2 + y^2 = 1/\CC \simeq (x^2 + y^2 = 1/\QQ )\times_{\QQ} \CC\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204347709600}%
Let now%
\begin{equation*}
E \colon y^2 = x^3 + ix + 1/\CC
\end{equation*}
is there some \(E_0/\QQ\) such that%
\begin{equation*}
E_0\times_{\QQ} \CC  \simeq E\text ?
\end{equation*}
If there was such the following would be true: For any \(\sigma\in \Gal{\CC}{\QQ}\) we have%
\begin{equation*}
\underbrace{E^\sigma}_{y^2 = x^3 + \sigma(i)x + 1} \xleftarrow{f^\sigma, \sim} E_0 \times_\QQ \CC \xrightarrow{f,\sim} E
\end{equation*}
but two elliptic curves are isomorphic (over \(\CC\)) if and only if they have the same \(j\)-invariant.%
\begin{equation*}
j(E) = 1728 \frac{4i^3}{4i^3 + 27\cdot 1^2} = 1728\left(1+ \frac{ - 27}{-4i + 27}\right)
\end{equation*}
%
\begin{equation*}
j(E^\sigma) = 1728 \frac{4\sigma(i)^3}{4\sigma(i)^3 + 27\cdot 1^2} = \sigma(j(E))
\end{equation*}
so these curves are not isomorphic over \(\QQ\), no way does it come from a \(\QQ\)-curve.%
\end{example}
This example suggests another interesting behaviour, the curve over \(\CC\) could come from  a \(k\)-curve in multiple ways, which are non-isomorphic over the base.%
\begin{example}{}{g:example:idm204347703840}%
Let now%
\begin{equation*}
E \colon y^2 = x^3 + x + 1/\CC
\end{equation*}
we have%
\begin{equation*}
E_0 \colon y^2 = x^3 + x + 1/\QQ
\end{equation*}
duh... but also%
\begin{equation*}
E_0' \colon 2 y^2 = x^3 + x + 1 \simeq y^2 = x^3 + 4 x + 8/\QQ\text{,}
\end{equation*}
both are isomorphic to \(E\) over \(\CC\) but are not isomorphic to each other over \(\QQ\).%
\end{example}
Coming back to our necessary condition:%
\begin{question}{}{g:question:idm204347700768}%
If for all \(\sigma \in \Gal{\CC}{k}\) we have some%
\begin{equation*}
f_\sigma \colon X\xrightarrow{\sim} X^\sigma
\end{equation*}
does \(X\) descend to \(k\)?%
\end{question}
For elliptic curves we have \(j(E^\sigma) = \sigma(j(E))\) so \(E \simeq E^\sigma\) for all \(\sigma\) implies \(j(E) \in k\) and hence there is an elliptic curve \(E_0/ k\) with \(j(E_0) = j(E)\) hence they are isomorphic over \(\CC\), explicitly:%
\begin{equation*}
y^2 + xy = x^3 - \frac{36}{j(E) - 1728} x - \frac{1}{j(E) - 1728}
\end{equation*}
when \(j\ne 0,1728\).%
\par
So our necessary condition is sufficient for genus 1 (exercise: genus 0).%
\end{paragraphs}%
\par
Now I will subtly switch to quasiprojective-variety-land.%
\par
Notice however that given%
\begin{equation*}
X_0/k
\end{equation*}
so that we have natural%
\begin{equation*}
(X_0 \times_k \CC) \xrightarrow{f_\sigma,\sim} (X_0 \times_k \CC)^\sigma
\end{equation*}
various isomorphic curves, we have the relation%
\begin{equation*}
f_\sigma^\tau f_\tau = f_{\sigma\tau}\text{.}
\end{equation*}
%
\begin{theorem}{Weil 1956.}{}{x:theorem:thm-weil-descent}%
\(X/\CC\) descends to \(k\) if and only if we can find \(f_\sigma\) as above satisfying a cocycle condition%
\begin{equation*}
f_{\sigma\tau} = (f_\tau)^\sigma f_\sigma\colon X \to X^\sigma \to X^{\sigma\tau}\text{,}
\end{equation*}
such a system is called a \terminology{Weil descent datum}.%
\end{theorem}
This condition sounds like it could be irritating to check, fortunately we have the following:%
\begin{remark}{}{g:remark:idm204347690016}%
If \(X/\CC\) has no automorphisms (i.e. a generic genus \(g \ge 3\) curve) then the cocycle condition is trivial and we just need the isomorphisms as in our first necessary condition. This is as \(f_{\sigma\tau}\inv f_\tau ^\sigma f_\sigma\) is just some automorphism, we want it to be the identity.%
\par
Unfortunately many curves of interest have a lot of automorphisms however. Like superelliptic curves\slash{}cyclic covers.%
\end{remark}
This motivates the following definition:%
\begin{definition}{Field of moduli.}{x:definition:def-field-of-mod}%
The \terminology{field of moduli} of \(X/\CC\) is the fixed field of%
\begin{equation*}
\{\sigma \in \Gal{\CC}{\QQ} : X^\sigma \simeq X\}\text{.}
\end{equation*}
%
\end{definition}
It would be great if every curve could be defined over its field of moduli.%
\par
``You can't always get what you want, but if you try sometimes, you might find, you get what you need'' - The philosopher Jagger.%
\begin{example}{Shimura.}{g:example:idm204347684880}%
Let \(m\) be odd and define a hyperelliptic curve of genus \(m - 1\) (which is even) as%
\begin{equation*}
X\colon y^2 = a_0 x^m + \sum_{r= 1}^m (a_r x^{m+r} + (-1)^r a_r^\rho x^{m-r}),\,a_i \in \CC,\,a_m = 1,\,a_0 \in \RR
\end{equation*}
\(\rho\) is complex conjugation, then we have an isomorphism%
\begin{equation*}
\mu\colon X \to X^\rho,\,\mu(x,y) = (-x\inv, i x^{-m} y)
\end{equation*}
%
\begin{equation*}
\mu^\rho \mu \colon (x,y)\mapsto (x,-y)
\end{equation*}
so the field of moduli is contained in \(\RR\). As long as we pick all \(a_i,a_i^\rho\) algebraically independent over \(\QQ\) there are no automorphisms except \(\pm 1\). Exercise, in this case \(X\) has no model over \(\RR\).%
\end{example}
Warning even though trivial automorphism group is best, it is not really the case that more automorphisms is worse for you.%
\par
What does help is points%
\begin{theorem}{Weil 1956, Milne 14.6.}{}{g:theorem:idm204347678992}%
\(X/\CC\) descends to \(k\) if all \(X^\sigma \simeq X\) and there exists a set of points \(P_1,\ldots, P_n\in  X(\CC)\) s.t.%
\begin{enumerate}
\item{}The only automorphism of \(X\) fixing each \(P_i\) is the identity.%
\item{}There exists a subfield \(L \subseteq \CC\) finitely generated \(/k\) s.t. \(\sigma P_i = P_i\) for all \(\sigma\) fixing \(L\).%
\end{enumerate}
%
\end{theorem}
\begin{paragraphs}{Goal.}{g:paragraphs:idm204347673488}%
Identify a special set of points, and some field \(L\) as above where we ``know'' the galois action.%
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.8.2 Reflex fields}
\typeout{************************************************}
%
\begin{subsectionptx}{Reflex fields}{}{Reflex fields}{}{}{g:subsection:idm204347672080}
First we define a field based on a Shimura datum, this will (eventually) be the field we hope to descend the associated Shimura variety to.%
\begin{definition}{Algebraic tori.}{x:definition:def-alg-torus}%
An \terminology{algebraic torus} over a field  \(k \) is an algebraic group \(T\) such that \(T_{\bar k} \simeq (\mathbf G_m)^n\).%
\end{definition}
Let \(G/\QQ\) be reductive, \(k \subseteq \CC\) and let%
\begin{equation*}
C(k) = G(K) \backslash \Hom(\mathbf G_m, G_k)
\end{equation*}
be the set of conj. classes of cocharacters \(/k\).%
\par
For \((G,X)\) a Shimura datum we can take%
\begin{equation*}
X \ni x \mapsto \mu_x(z) = h_{x\CC} (z,1) \in C(\QQ^\alg) \subseteq C(\CC)\text{.}
\end{equation*}
%
\par
So think of \(c(X) \in C(\QQ^\alg)\)%
\begin{definition}{Reflex fields.}{x:definition:def-reflex-field}%
The \terminology{reflex field}, denoted \(E(G,X)\) is the field of definition of \(c(X)\) inside \(\QQ^\alg\).%
\end{definition}
\begin{fact}{}{}{g:fact:idm204347663104}%
Any field of definition of \(G\) contained in \(\QQ^\alg\) is contained in \(E(G,X)\).%
\end{fact}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.8.3 Special points}
\typeout{************************************************}
%
\begin{subsectionptx}{Special points}{}{Special points}{}{}{g:subsection:idm204347661440}
In the theory of modular curves and the upper half plane there are certain points that play an important role, imaginary quadratic integers in \(\mathbf H\).%
\par
Why are these points special? They are fixed points: if we try and solve for \(z \in \mathbf H\)%
\begin{equation*}
z=  \overbrace{\begin{pmatrix} a\amp b \\ c \amp d\end{pmatrix}}^{\in \SL_2(\ZZ)} z = \frac{az + b}{cz+d}
\end{equation*}
we get%
\begin{equation*}
cz^2 + (d - a) z - b = 0
\end{equation*}
which has discriminant \((d-a)^2 + 4cb = d^2 - 2ad + a^2 + 4bc =  (a+d)^2 - 4(ad - bc) = \trace^2 - 4\det\) so \(z\) is an eigenvalue of this matrix. (note that a matrix must be elliptic to have fixed points in the upper half plane).%
\par
In fact this is a general phenomenon:%
\begin{definition}{Special points.}{x:definition:def-special-pt}%
\(x \in X\) is a \terminology{special point} if there is a \(\QQ\)-torus \(T \subseteq G\) s.t.%
\begin{equation*}
h_x(\CC^\times) \subseteq T(\RR)
\end{equation*}
we also say \((T,x)\) is a special pair.%
\end{definition}
\begin{remark}{}{g:remark:idm204347654768}%
\((T,x)\) special means \(T(\RR)\) fixes \(x\).%
\par
Conversely if \(T\) is a maximal torus of \(G\) with \(T(\RR)\) fixing \(x\) then \(h_x(\CC^\times)\) is in the centraliser of \(T(\RR)\) inside \(G(\RR)\) which is itself \(\implies (T,x)\) is special.%
\end{remark}
I said this generalises CM points, how?%
\begin{example}{}{g:example:idm204347649776}%
Let \(G = \GL_2\) and \(\mathbf H_1^\pm = \CC \smallsetminus \RR\) then we have our old friend the \(G(\RR)\) action%
\begin{equation*}
\begin{pmatrix} a\amp b \\ c \amp d\end{pmatrix} z = \frac{az + b}{cz+d}
\end{equation*}
so if \(z \in \CC \smallsetminus \RR\) generates an imaginary quadratic field \(E/\QQ\) (which is a 2-d \(\QQ\)-vector space) we can embed%
\begin{equation*}
E \hookrightarrow \Mat_2(\QQ)
\end{equation*}
using basis \(\langle 1, -z\rangle\) for \(E\).%
\par
So we get a maximal subtorus \(T = \Res_{E/\QQ}(\mathbf G_m) \subseteq G\).%
\par
Now%
\begin{equation*}
E\otimes \CC = \langle 1\otimes 1, 1 \otimes (-z)\rangle
\end{equation*}
and we can map%
\begin{equation*}
E\otimes \CC \to \CC
\end{equation*}
%
\begin{equation*}
e\otimes z \mapsto ez
\end{equation*}
we have a kernel of dimension 1%
\begin{equation*}
\langle z \otimes 1 + 1\otimes (-z) \rangle = \langle \begin{pmatrix} z \\ 1 \end{pmatrix}\rangle
\end{equation*}
exercise check \(\Res_{E/\QQ}(\mathbf G_m)(\RR)\).%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.8.4 Canonical models}
\typeout{************************************************}
%
\begin{subsectionptx}{Canonical models}{}{Canonical models}{}{}{g:subsection:idm204347642736}
Given a special pair \((T,x) \subset (G,X)\) we have a cocharacter \(\mu_x\) of \(T\) defined over \(E(x)\) we can form the map%
\begin{equation*}
r_x \colon \adeles^\times_{E(x)} \xrightarrow{ P \mapsto \prod_{\rho \colon E(x) \to \QQ^\alg} \rho(\mu_x(P)) } T(\adeles_\QQ) \to T(\adeles_f)
\end{equation*}
the last map just forgets the infinite components.%
\par
We have the artin map from CFT%
\begin{equation*}
{\operatorname{art}}_{E(x)} \colon \adeles^\times_{E(x)} \twoheadrightarrow \Gal{E(x)^\ab}{E(x)}
\end{equation*}
%
\begin{equation*}
r_x \colon \adeles^\times_{E(x)} \to T(\adeles_f)\text{.}
\end{equation*}
%
\par
Call \(\lb x,a\rb_K\) the point of \({\operatorname{Sh}}_K(G,X)\) represented by \((x,a)\).%
\begin{definition}{Milne 12.8.}{x:definition:def-canonical-model}%
Let \((G,X)\) be a Shimura datum, and let \(K\) be a compact open subgroup of \(G(\adeles_f)\). A model \(M_K(G,X)\) of \({\operatorname{Sh}}_K(G,X)\) over \(E(G,X)\) is a \terminology{canonical model} if, for every special pair \((T, x) \subseteq (G,X)\) and \(a \in G(\adeles_f)\), \(\lb x,a\rb _K\) has coordinates in \(E(x)^\ab\) and%
\begin{equation*}
\sigma [x,a]_K = [x, r_x(s) a]_K
\end{equation*}
for all%
\begin{equation*}
\sigma \in \Gal{E(x)^\ab}{E(x)}
\end{equation*}
%
\begin{equation*}
s\in \adeles^\times_{E(x)}
\end{equation*}
%
\begin{equation*}
{\operatorname{art}}_{E(x)}(s) = \sigma
\end{equation*}
In other words, \(M_K(G,X)\) is canonical if every automorphism \(\sigma\) of C fixing \(E(x)\) acts on \(\lb x,a\rb_K\) according to the above rule, where \(s\) is any idele such that%
\begin{equation*}
{\operatorname{art}}_{E(x)}(s) = \sigma| E(x)^{\ab}\text{.}
\end{equation*}
%
\end{definition}
\begin{example}{}{g:example:idm204347629024}%
\(T \) an algebraic torus over \(\QQ\) and%
\begin{equation*}
h \colon \mathbf S \to T_\RR
\end{equation*}
then  \((T,h)\) is a Shimura datum \(E = E(T,h)\) is the field of definition \(\mu_h\) in this case%
\begin{equation*}
{\operatorname{Sh}}_K(T,h) = T(\QQ) \backslash \{h\}  \times T(\adeles_f) / K
\end{equation*}
is a finite set, defines a continuous action of%
\begin{equation*}
\Gal{E^\ab}{E} \acts {\operatorname{Sh}}_K(T,h)\text{,}
\end{equation*}
this action defines a model of \({\operatorname{Sh}}_K(T, h)\) over \(E\) which by definition is canonical.%
\end{example}
\begin{theorem}{Langlands conjecture, Milne 1983.}{}{g:theorem:idm204347624800}%
Let \((G,X)\) be a shimura datum, \(\sigma\) an automorphism of \(\CC\). Langlands defined%
\begin{equation*}
(G^\sigma, X^\sigma)
\end{equation*}
and conjectured a unique isomorphism%
\begin{equation*}
f_\sigma \colon {\operatorname{Sh}}(G^\sigma, X^\sigma) \to {\operatorname{Sh}}(G,X)
\end{equation*}
satisfying some conditions. Then the \(f_\sigma\) for \(\sigma\in \Gal{\CC}{E(G,X)}\) are a descent datum, and the model is canonical.%
\end{theorem}
\begin{theorem}{}{}{g:theorem:idm204344562096}%
For any Shimura datum \((G,X)\), \({\operatorname{Sh}}_K(G,X)\) has a canonical model (defined to be a compatible system of canonical models for \({\operatorname{Sh}}_K\)). The canonical model is unique up to unique isomorphism.%
\end{theorem}
Some references:%
\begin{enumerate}
\item{}Weil’s Galois Descent Theorem; A Computational Point Of View - Ruben A. Hidalgo And Sebastian Reyes-carocca%
\item{}On the field of moduli of superelliptic curves - Ruben Hidalgo and Tony Shaska%
\item{}Varieties Without Extra Automorphisms I: Curves - Bjorn Poonen%
\item{}Lecture On Shimura Curves 6: Special Points And Canonical Models Pete L. Clark \url{http://math.uga.edu/\~pete/SC7-CMpoints.pdf} (Shimura curves only but still)%
\item{}Shimura Varieties and Canonical models (slides) - Brian Smithling \url{http://www.math.mcgill.ca/goren/Montreal-Toronto/Brian.pdf}.%
\item{}\url{https://tlovering.wordpress.com/2014/09/03/galois-descent-for-transcendental-extensions/}.%
\item{}Canonical models of Shimura curves -  J.S. Milne (a great article I found after the talk...)%
\end{enumerate}
%
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 6 Gross-Zagier}
\typeout{************************************************}
%
\begin{chapterptx}{Gross-Zagier}{}{Gross-Zagier}{}{}{x:chapter:chapter-buntes-gz}
\begin{introduction}{}%
These are notes for BUNTES Fall 2019, the topic is Gross-Zagier, they were last updated January 29, 2020. For more details see \href{http://math.bu.edu/people/svh/GrossZagier.html}{the webpage}. These notes are by Alex, feel free to email me at \href{mailto:alex.j.best@gmail.com}{\nolinkurl{alex.j.best@gmail.com}} to report typos\slash{}suggest improvements, I'll be forever grateful.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 6.1 An Overview of Gross-Zagier and Related Objects \slash{} Formulas of interest (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{An Overview of Gross-Zagier and Related Objects \slash{} Formulas of interest (Sachi)}{}{An Overview of Gross-Zagier and Related Objects \slash{} Formulas of interest (Sachi)}{}{}{x:section:sec-gz-overview}
\begin{introduction}{}%
Goal today is to motivate and give some high level overview of the objects in Gross-Zagier. It involves many things \(L\)-functions, elliptic curves, modular forms.%
\par
Main reference: \hyperlink{x:biblio:bib-zagier-modular}{[106]}.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 6.1.1 A big example}
\typeout{************************************************}
%
\begin{subsectionptx}{A big example}{}{A big example}{}{}{g:subsection:idm204344550416}
Today we will study%
\begin{equation*}
E\colon y^2 + y=  x^3 + x^2
\end{equation*}
LMFDB label 43.a1, \url{http://lmfdb.xyz/EllipticCurve/Q/43.a1/}.%
\begin{figureptx}{}{g:figure:idm204344548768}{}%
\begin{image}{0}{1}{0}%
\resizebox{\linewidth}{!}{%
\begin{tikzpicture}
    \begin{axis}[hide axis]
    \addplot +[no markers,
      raw gnuplot,
      thick,
      empty line = jump, % not strictly necessary, as this is the default behaviour in the development version of PGFPlots
      id = 43a1,
      ] gnuplot {
      set contour base;
      set cntrparam levels discrete 0.002;
      unset surface;
      unset border;
      unset xtics;
      unset ytics;
      set view map;
      set samples 900;
      set isosamples 900;
      splot y^2  + y - x^3 - x^2;
    };
  \end{axis}
\end{tikzpicture}
}%
\end{image}%
\tcblower
\end{figureptx}%
One fundamental invariant we can compute is the conductor, in this case 43, we only have bad reduction at 43 and no other prime.%
\par
To compute the real period we can transform to short Weierstrass form.%
\begin{equation*}
y^2 = x^3 - 432 x + 15120
\end{equation*}
then we have invariant differential%
\begin{equation*}
\frac{\diff x}{2y } = \frac{\diff x}{2\sqrt{x^3 - 432 x + 15120}}\text{.}
\end{equation*}
%
\par
Real period is then%
\begin{equation*}
\omega _1 = \int_{E(\RR)} \frac{\diff x}{2y} \approx 5.4687\ldots\text{.}
\end{equation*}
%
\par
For \(E/\CC\) fix a complex conjugate root of \(E\), \(\alpha \), and \(\beta  =\) real root.%
\begin{equation*}
\omega _2 = \int_\alpha ^\beta  \frac{\diff x}{2y}
\end{equation*}
%
\begin{equation*}
= 2.73434476498379 + 1.36318241817043i
\end{equation*}
%
\par
We can look at \(E/\FF_p\) for various \(p\). Obtained by looking at the equation \(y^2 + y =x^3 +x^2 \pmod p\) for various \(p\).%
\par
At 43 we have non-split  multiplicative reduction, which means that we have a singular curve with tangent slopes not defined over \(\FF_{43}\).%
\begin{figureptx}{}{g:figure:idm204347619664}{}%
\begin{image}{0}{1}{0}%
\resizebox{\linewidth}{!}{%
\begin{tikzpicture}
    \begin{axis}[hide axis]
    \addplot +[no markers,
      raw gnuplot,
      thick,
      empty line = jump, % not strictly necessary, as this is the default behaviour in the development version of PGFPlots
      id = singularec,
      ] gnuplot {
      set contour base;
      set cntrparam levels discrete 0.002;
      unset surface;
      unset border;
      unset xtics;
      unset ytics;
      set view map;
      set samples 900;
      set isosamples 900;
      splot y^2 - x^3 - x^2;
    };
  \end{axis}
\end{tikzpicture}
}%
\end{image}%
\tcblower
\end{figureptx}%
%
\begin{equation*}
N_p = \# E(\FF_p)
\end{equation*}
%
\begin{equation*}
L_E = \left(\frac 1 {1+43^{-s}} \right)\prod_{p\ne 43} \frac{1}{1- (N_p - p - 1)p^{-s} + p p^{-2s}}
\end{equation*}
%
\begin{equation*}
= \sum_{n\ge 1} \frac{a_n}{n^{s}}
\end{equation*}
%
\par
We can tabulate the \(a_n\)%
\begin{tableptx}{\textbf{\(a_n\)s}}{g:table:idm204347617056}{}%
\centering
{\tabularfont%
\begin{tabular}{llllllllll}
\(n\)&1&2&3&4&5&6&7&8&9\tabularnewline[0pt]
\(a_n\)&1&-2&-2&2&-4&4&0&0&1
\end{tabular}
}%
\end{tableptx}%
As we have \(E/\QQ\) we can determine that%
\begin{equation*}
E(\QQ) \simeq \ZZ \cdot \underbrace{P}_{=(0,0)}\text{.}
\end{equation*}
%
\par
Next up the Néron-Tate canonical height:%
\begin{equation*}
\hat h(P) = \lim_{n\to \infty } \frac{\log(h_{\text{naive}}(2^nP))}{4^n}
\end{equation*}
naive height is the max of the absolute values of the numerator and denominator of the \(x\)-coordinate. In our case this is%
\begin{equation*}
\hat h(P) \approx 0.0628165070875\text{.}
\end{equation*}
%
\par
We have the Hasse-Weil bound:%
\begin{equation*}
| N_p - p  + 1 | \lt 2 \sqrt p
\end{equation*}
so the \(L\)-function converges for \(\Re (s ) \gt 3/2\). So modularity implies that \(L_E(s)\) extends to an entire function \(\widetilde L_E\) satisfying a functional equation%
\begin{equation*}
\widetilde L_E(s) = - \widetilde L_E(2-s)
\end{equation*}
in particular \(\widetilde L_E(s)\) vanishes at \(s=1\).%
\par
BSD for rank 1 then says:%
\begin{enumerate}
\item{}%
\begin{equation*}
\ord_{s=1} \widetilde L_E(s) = \rank E(\QQ) = 1
\end{equation*}
%
\item{}%
\begin{equation*}
\frac{\diff}{\diff s} \widetilde L_E(s)|_{s=1} = \underbrace{\hat h ( P) \omega _1}_{\approx 0.34352397} |\Sha|
\end{equation*}
\(|\Sha|\) is predicted to be finite (in which case the order is a square). the LHS can be computed using%
\begin{equation*}
2\sum_{n=1}^\infty  a_n \int_1^\infty  \log t \exp\left(- \frac{-2 n  \pi  t  }{\sqrt{43}}\right) \diff t\text{.}
\end{equation*}
%
\end{enumerate}
%
\begin{paragraphs}{Modularity.}{g:paragraphs:idm204347600672}%
Goal: Verify \(E\) is modular. Two definitions today:%
\begin{enumerate}
\item{}There exists a newform \(f \in S_2(\Gamma _0(N))\) with fourier coefficients the same as the \(L\)-series:%
\begin{equation*}
a_p(f) = a_p(E)
\end{equation*}
for all \(p\nmid N\).%
\item{}There exists \(X_0(N) \to E\) finite defined over \(\QQ\).%
\end{enumerate}
%
\par
Consider%
\begin{equation*}
X_0(43)
\end{equation*}
the modular curve for the congruence subgroup generated by \(\Gamma _0(43) = \begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix}\) with \(c \equiv  0 \pmod{43}\).%
\begin{equation*}
w_{43} =  \begin{pmatrix} 0 \amp \frac{-1}{\sqrt{43}} \\ \sqrt{43} \amp 0\end{pmatrix}
\end{equation*}
%
\begin{equation*}
\Gamma _0(43)^+ \backslash \HH \simeq \text{genus 1 curve}
\end{equation*}
which is potentially equal to \(E\).%
\par
Strategy: Find \(\eta ,\xi \) s.t.%
\begin{equation*}
\eta(\tau )^2 + \eta(\tau ) = \xi (\tau )^3 + \xi (\tau )^2
\end{equation*}
and%
\begin{equation*}
\frac{\diff \eta}{2\xi  + 1} = f(q) \frac{\diff q}{q}
\end{equation*}
%
\begin{equation*}
\xi f^2, \eta f^3
\end{equation*}
should be holomorphic modular forms in \(M_4(\Gamma _0(43))\) and \(M_6(\Gamma _0(43))\). we can compute \(q\)-series expansions and use modular symbols to prove they exist.%
\end{paragraphs}%
\begin{paragraphs}{Quadratic twists of \(E\).}{g:paragraphs:idm204347591456}%
Let \(\Delta \lt  0\) be a fundamental discriminant.%
\begin{equation*}
E\colon y^2 = f(x)
\end{equation*}
then%
\begin{equation*}
E_{\Delta }\colon \Delta y^2 = f(x)
\end{equation*}
these are not isomorphic over \(\QQ\).%
\par
The \(L\)-function of \(E_\Delta \). For any \(\Delta \) coprime to 43%
\begin{equation*}
L_{E_\Delta } (s) = \sum_{n\ge 1} \legendre \Delta  n \frac{a_n}{n^s}
\end{equation*}
can prove that for \(p\nmid 6\cdot 43 \cdot \Delta \).%
\begin{equation*}
a_p(E) \leftrightarrow a_p(E_\Delta )
\end{equation*}
are related by considering%
\begin{equation*}
E\colon  y^2 = f(x)
\end{equation*}
%
\begin{equation*}
E_\Delta \colon  \Delta y^2= f(x)
\end{equation*}
mod \(p\), so if \(\Delta \) is a square we have isomorphisms locally and the \(a_p\) are equal, otherwise all non-square and squares are swapped.%
\par
BSD says%
\begin{equation*}
L_{E,\Delta } (1) = \Omega _{E,\Delta }^+  \prod_p c_p A_\Delta
\end{equation*}
if \(\rank = 0\).%
\par
Waldspurger's implies that \(A_\Delta \) is a square.%
\end{paragraphs}%
\begin{theorem}{Gross-Zagier.}{}{x:theorem:thm-gross-zagier-1}%
If \(\Delta \lt  0 \) is a fundamental discriminant which is a square mod 43, then%
\begin{equation*}
\hat h(P_\Delta ) = \frac{\sqrt{|\Delta |}}{8\pi ^2 \| f\|} L_E'(1) L_{E_\Delta }(1)\text{,}
\end{equation*}
where \(P_\Delta \) is the Heegner point on \(E\) associated to the discriminant \(\Delta \).%
\end{theorem}
Adding in Waldspurger we get%
\begin{equation*}
A(\Delta ) = c_\Delta ^2
\end{equation*}
%
\begin{equation*}
\hat h(P_\Delta )= \hat h(b_\Delta  P) = b_\Delta ^2\hat h(P)
\end{equation*}
but also%
\begin{equation*}
\hat h(P_\Delta ) = \frac{\sqrt{|\Delta |}}{8\pi ^2 \| f\|} L_E'(1) \Omega _{E,\Delta }^+ \prod_p c_p c_\Delta^2
\end{equation*}
as \(\Omega _{E,\Delta }^+ = \Omega _E^-  / \sqrt \Delta \) we have cancellation and \(c_\Delta ^2 = b_\Delta ^2\) for all \(\Delta \).%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.2 Modular Curves Background I (John)}
\typeout{************************************************}
%
\begin{sectionptx}{Modular Curves Background I (John)}{}{Modular Curves Background I (John)}{}{}{x:section:sec-gz-mfs}
Main references are lecture notes by Darmon and Weinstein ``introduction to modular forms''.%
\begin{definition}{}{g:definition:idm204347575472}%
Let%
\begin{equation*}
\Gamma (N) = \left\{\begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix}\in \SL_2(\ZZ) : \begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix} \equiv \begin{pmatrix} 1 \amp 0 \\ 0 \amp 1 \end{pmatrix} \pmod N\right\}\text{.}
\end{equation*}
\(\Gamma\subseteq \SL_2(\ZZ)\) is a  congruence subgroup if it contains \(\Gamma (N)\) for some \(N\). Some important examples are%
\begin{equation*}
\Gamma_1 (N) = \left\{\begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix}\in \SL_2(\ZZ) : \begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix} \equiv \begin{pmatrix} 1 \amp \ast \\ 0 \amp 1 \end{pmatrix} \pmod N\right\}
\end{equation*}
%
\begin{equation*}
\Gamma_0 (N) = \left\{\begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix}\in \SL_2(\ZZ) : \begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix} \equiv \begin{pmatrix} \ast \amp \ast \\ 0 \amp \ast \end{pmatrix} \pmod N\right\}
\end{equation*}
%
\end{definition}
\begin{definition}{}{g:definition:idm204347572192}%
%
\begin{equation*}
f\colon \HH \to \CC
\end{equation*}
is a modular form of weight \(2k\) for \(\Gamma \) (with character \(\epsilon \)) if%
\begin{enumerate}
\item{}\(f\) is holomorphic on \(\HH\).%
\item{}\(f\) is holomorphic at infinity.%
\item{}%
\begin{equation*}
f|_{2k} \gamma (z) = f(z)\,\forall\gamma \in \Gamma 
\end{equation*}
where%
\begin{equation*}
f|_{2k} \gamma (z) = (cz+d)^{-2k}f(\gamma z)\epsilon (d)
\end{equation*}
%
\end{enumerate}
%
\end{definition}
\begin{example}{}{g:example:idm204347567840}%
For \(\Gamma =  \SL_2(\ZZ)\) from now on.%
\begin{equation*}
f(z+1) = f(z)
\end{equation*}
%
\begin{equation*}
f\left(-\frac 1z\right) = z^{2k}f(z)
\end{equation*}
%
\end{example}
Using this we can write%
\begin{equation*}
f(z) = f(q),\,q= e^{2\pi  i z}\text{,}
\end{equation*}
where \(q\) is a parameter at infinity.%
\begin{equation*}
f(q) = \sum_{n=0}^\infty a_n q^n\text{.}
\end{equation*}
%
\begin{definition}{}{g:definition:idm204347564928}%
A modular form is a cusp form if \(a_0 = 0\).%
\end{definition}
\begin{definition}{}{g:definition:idm204347563984}%
\(M_k(\Gamma )\) is the space of weight \(k\) modular forms. \(S_k(\Gamma )\) is the space of weight \(k\) cusp forms.%
\end{definition}
\begin{example}{}{g:example:idm204347562048}%
%
\begin{equation*}
G_{2k}(z) = \sum_{m,n\in \ZZ}' \frac{1}{(mz+n)^{2k}}
\end{equation*}
%
\begin{equation*}
g_{2} = G_4(z)/2\zeta (4)
\end{equation*}
%
\begin{equation*}
g_{3} = G_6(z)/2\zeta (6)
\end{equation*}
then%
\begin{equation*}
\Delta  = \frac{g_2^3 - g_3^2}{1728}
\end{equation*}
is a cusp form of weight 12.%
\end{example}
\begin{theorem}{}{}{g:theorem:idm204347560160}%
%
\begin{equation*}
D\colon M_k \to S_{k+12}
\end{equation*}
%
\begin{equation*}
f\mapsto \Delta f
\end{equation*}
is an isomorphism of vector spaces.%
\begin{equation*}
\forall k \lt  0,\, M_k = 0
\end{equation*}
%
\begin{equation*}
k=2,\, M_k = 0
\end{equation*}
\(k\) odd, \(M_k = 0\).%
\begin{equation*}
M_k = S_k + G_k \CC,\,\forall k \in 2\ZZ^+
\end{equation*}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204347557360}
%
\begin{equation*}
(f\Delta) (-1/z) = (cz+d)^{-k}f(z) (cz+d)^{-12} \Delta (z)
\end{equation*}
%
\begin{equation*}
= (cz+d)^{-(k+12)}(f\Delta ) (z)\text{.}
\end{equation*}
If \(k \lt  0\) , \(f \in M_k\) have \(f^{12}\Delta ^k \in S_0 = 0\). \(M_0 =\CC\) corresponds to holomorphic functions on \(\SL_2(\ZZ) \backslash \HH\).%
\begin{equation*}
M_k \to \CC
\end{equation*}
%
\begin{equation*}
f(q) = a_0  + a_1 q + \cdots \mapsto a_0
\end{equation*}
%
\begin{equation*}
\dim(M_k / \ker) \le 1
\end{equation*}
%
\begin{equation*}
M_k = S_k + G_k \CC
\end{equation*}
we get%
\begin{tableptx}{\textbf{dimensions}}{g:table:idm204347552944}{}%
\centering
{\tabularfont%
\begin{tabular}{lll}
\(n\)&\(\dim M_k\)&\(\dim S_k\)\tabularnewline[0pt]
\(\lt 0\)&\(0\)&\(0\)\tabularnewline[0pt]
\(0\)&\(1\)&\(0\)\tabularnewline[0pt]
\(2\)&\(0\)&\(0\)\tabularnewline[0pt]
\(4\)&\(1\)&\(0\)\tabularnewline[0pt]
\(6\)&\(1\)&\(0\)\tabularnewline[0pt]
\(8\)&\(1\)&\(0\)\tabularnewline[0pt]
\(10\)&\(1\)&\(0\)\tabularnewline[0pt]
\(12\)&\(2\)&\(1\)\tabularnewline[0pt]
\(14\)&\(1\)&\(0\)\tabularnewline[0pt]
\(16\)&\(2\)&\(1\)\tabularnewline[0pt]
\(18\)&\(2\)&\(1\)\tabularnewline[0pt]
\(20\)&\(2\)&\(1\)\tabularnewline[0pt]
\(22\)&\(2\)&\(1\)
\end{tabular}
}%
\end{tableptx}%
\end{proofptx}
\begin{paragraphs}{Hecke operators.}{g:paragraphs:idm204347530768}%
\begin{definition}{}{g:definition:idm204347530368}%
\(\Lambda \) is a lattice if it is a rank 2 \(\ZZ\)-module in \(\CC\) s.t. \(\CC/\Lambda \) is compact.%
\begin{equation*}
\Lambda = \tau _1\ZZ + \tau _2 \ZZ
\end{equation*}
%
\begin{equation*}
\dim_\RR(\tau _1 \RR + \tau _2\RR) = 2
\end{equation*}
%
\begin{equation*}
\Im (\tau _2 / \tau _1 ) \gt 0
\end{equation*}
\(F\) is a homogeneous lattice function of weight \(k\) if it is%
\begin{equation*}
F\colon R \to \CC
\end{equation*}
where \(R\) is the set of lattices, such that%
\begin{equation*}
F(\lambda \Lambda ) = \lambda ^{-k}F(\Lambda )
\end{equation*}
\(F\) is holomorphic if \(f\colon  \HH \to \CC\)%
\begin{equation*}
f(\tau ) = F(\ZZ + \tau \ZZ)
\end{equation*}
is holomorphic on \(\HH\).%
\begin{equation*}
\{\text{holo. homog. wt. }k\text{ lattice fns.}\}\leftrightarrow \{\text{wt. }k\text{ mod. fms.}\}
\end{equation*}
%
\begin{equation*}
F\mapsto f_F\colon \tau  \mapsto F(\ZZ+ \tau \ZZ)
\end{equation*}
%
\begin{equation*}
F_f \mapsfrom f
\end{equation*}
%
\begin{equation*}
F_f (\tau _1 \ZZ+ \tau _2 \ZZ) = f(\tau _2/\tau _1)\text{.}
\end{equation*}
%
\end{definition}
\begin{definition}{}{g:definition:idm204347522480}%
\(F\) is a homogeneous holomorphic weight \(k\) lattice function then%
\begin{equation*}
T_{n,k} F(\Delta ) = n^{k-1} \sum_{\Lambda ' \subseteq \Lambda ,\,[\Lambda : \Lambda '] = n} F(\Lambda ')
\end{equation*}
%
\begin{equation*}
T_{n,k}f = f_{T_{n,k}(F_f)}
\end{equation*}
%
\begin{equation*}
T_{n,k} f(z) = n^{k-1} \sum_{\gamma \in \SL_2(\ZZ)\backslash  M_n } f(\gamma  z)(cz+d)^{-k}
\end{equation*}
where \(M_n \subseteq  M_2(\ZZ)\) is the set of integer matrices of determinant \(n\).%
\begin{equation*}
f|\alpha \beta = (f|\alpha )|\beta \text{.}
\end{equation*}
The fourier expansions of these are given by%
\begin{equation*}
f(q) = a_0 + a_1 q + \cdots
\end{equation*}
%
\begin{equation*}
T_{n,k}f(q) = \sum_{m = 0}^\infty \sum_{d|(m,n)} d^{k-1} a_{nm/d^2} q^m
\end{equation*}
fixing \(k\) we have if \((a,b) = 1\)%
\begin{equation*}
T_aT_b = T_{ab}
\end{equation*}
for \(p \) prime%
\begin{equation*}
T_p T_{p^t} = T_{p^{k+1}} + p^{k-1} T_{p^{t-1}}\text{.}
\end{equation*}
%
\end{definition}
\begin{figureptx}{The fundamental domain}{g:figure:idm204347516064}{}%
\begin{image}{0}{1}{0}%
\resizebox{\linewidth}{!}{%
\pgfdeclarelayer{background}

\pgfmathsetmacro{\myxlow}{-2}
\pgfmathsetmacro{\myxhigh}{2}
\pgfmathsetmacro{\myiterations}{8}

\begin{tikzpicture}[scale=2]
    \draw[-latex](\myxlow-0.1,0) -- (\myxhigh+0.2,0);
    \pgfmathsetmacro{\succofmyxlow}{\myxlow+0.5}
    \foreach \x in {\myxlow,\succofmyxlow,...,\myxhigh}
    {   \draw (\x,0) -- (\x,-0.05) node[below,font=\tiny] {\x};
    }
    \foreach \y  in {0.2,0.4,...,1.4}
    {   \draw (0,\y) -- (-0.05,\y) node[left,font=\tiny] {\pgfmathprintnumber{\y}};
    }
    \draw[-latex](0,-0.1) -- (0,1.6);
    \begin{scope}
        \clip (\myxlow,0) rectangle (\myxhigh,1.1);
        \foreach \i in {1,...,\myiterations}
        {   \pgfmathsetmacro{\mysecondelement}{\myxlow+1/pow(2,floor(\i/3))}
            \pgfmathsetmacro{\myradius}{pow(1/3,\i-1}
            \foreach \x in {-2,\mysecondelement,...,2}
            {   \draw[very thin, blue] (\x,0) arc(0:180:\myradius);
                \draw[very thin, blue] (\x,0) arc(180:0:\myradius);
            }
        }
    \end{scope}
    \begin{scope}
        \begin{pgfonlayer}{background}
            \clip (-0.5,0) rectangle (0.5,1.7);
            \clip   (1,1.7) -| (-1,0) arc (180:0:1) -- cycle;
            \fill[gray,opacity=0.8] (-1,-1) rectangle (1,2);
        \end{pgfonlayer}
    \end{scope}
\end{tikzpicture}
}%
\end{image}%
\tcblower
\end{figureptx}%
These \(T_{n,k}\) operate on \(M_k(\SL_2(\ZZ))\) and we can define:%
\begin{definition}{}{g:definition:idm204347514144}%
Let \(f\in M_k(\SL_2(\ZZ))\) is an eigenform if it is a simultaneous eigenvector for \(\{T_n\}_{n=1}^\infty \). We have%
\begin{equation*}
\pair - - \colon  S_k \times S_k\to \CC
\end{equation*}
%
\begin{equation*}
\pair fg = \int_F f(z) \overline{g(z)} y^k \frac{\diff x \diff y}{y^2}\text{.}
\end{equation*}
%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204347511936}%
\(T_n\) is self-adjoint in \(S_k\)%
\begin{equation*}
\pair{T_n f}{g}=  \pair {f}{T_ng} 
\end{equation*}
%
\begin{equation*}
S_k = \bigoplus f_i \CC
\end{equation*}
an orthogonal basis of eigenforms. \(G_k\) is an eigenform and%
\begin{equation*}
M_k = G_k \CC + \bigoplus f_i \CC\text{.}
\end{equation*}
%
\end{proposition}
\begin{definition}{}{g:definition:idm204347509264}%
\(f\) is a  normalized eigenform if%
\begin{equation*}
a_1(f)  =1
\end{equation*}
%
\begin{equation*}
a_n(f) = a_1(T_nf) = a_1(\lambda _n f) = \lambda _na_1(f) = \lambda _n \text{.}
\end{equation*}
%
\end{definition}
\begin{proposition}{}{}{g:proposition:idm204347507728}%
If \(f\in S_k\) is a normalized eigenform then%
\begin{equation*}
\QQ(a_1(f), a_2(f) , \ldots)
\end{equation*}
is a finite totally real extension of \(\QQ\) with degree \(\le \dim S_k = d\).%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204347505504}
\(G_k/\zeta (k)\) and \(\Delta \) have rational coefficients.%
\begin{equation*}
M_k(\QQ) = f_1 \QQ+ \cdots + f_d \QQ
\end{equation*}
\(T_n\) operates on \(M_k(\QQ)\) so%
\begin{equation*}
T_n \hookrightarrow \Mat_d(\QQ)
\end{equation*}
%
\begin{equation*}
\mathbf T_k =\QQ[T_1,T_2, \ldots] \hookrightarrow \Mat_d(\QQ)
\end{equation*}
\(\forall \phi  \in \Hom(\mathbf T_{k}, \overline \QQ)\) have \(\im (\phi )\) lies in a degree \(\le d\) extension. this is totally real because \(T_n\) are self adjoint w.r.t. a Hermitian inner product.%
\end{proofptx}
\end{paragraphs}%
\begin{paragraphs}{Generalisation.}{g:paragraphs:idm204347500896}%
If \(\Gamma \) is any congruence subgroup%
\begin{equation*}
M_k(\Gamma ) = \operatorname{Eis}_k(\Gamma ) + S_k(\Gamma )
\end{equation*}
%
\begin{equation*}
M_k(\SL_2(\ZZ)) \subseteq M_k(\Gamma )
\end{equation*}
%
\par
Given \(d|N\) we have%
\begin{equation*}
f \in M_k(\Gamma (d))
\end{equation*}
can define dilation%
\begin{equation*}
g(z) = f(N/d z) \in M_k(\Gamma )
\end{equation*}
for large enough \(k\) we can find a basis of \(M_k(\Gamma (N))\) by taking dilations of products of \(M_a(\Gamma (N))\) for \(a \lt k\) and Hecke operators.%
\par
For \((n,N) = 1\), \(f\in M_k(\Gamma (N))\).%
\begin{equation*}
T_{n,k} f = n^{k-1} \sum_{\gamma \in \Gamma (N) \backslash M_n} (f|\gamma )(z)
\end{equation*}
\(M_n\) is integer upper triangular with determinant \(n\). For primes \(l\)%
\begin{equation*}
l\nmid N,\, T_l f(q) = \sum a_n l q^n + l^{k-1} \sum a_n \langle l \rangle f q^{nl}
\end{equation*}
%
\begin{equation*}
l | N,\, T_lf(q) = \sum a_{nl} q^n
\end{equation*}
%
\begin{equation*}
\langle l \rangle f(z) = \left(f|_k \begin{pmatrix} l \amp 0 \\ 0 \amp l\inv \end{pmatrix}\right) (z)\text{.}
\end{equation*}
%
\begin{definition}{}{g:definition:idm204347492160}%
%
\begin{equation*}
g \in S_k(\Gamma (N))
\end{equation*}
s.t.%
\begin{equation*}
g(z) = f(d z)
\end{equation*}
for some \(f \in S_k(\Gamma (N/d))\) is called an oldform. Newforms are \(f\in S_k(\Gamma (N))\) s.t.%
\begin{equation*}
\pair fg = 0
\end{equation*}
for all \(g\in S_k(\Gamma (N))^{old}\).%
\end{definition}
\end{paragraphs}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.3 Modular Curves and Heegner Points (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Modular Curves and Heegner Points (Ricky)}{}{Modular Curves and Heegner Points (Ricky)}{}{}{x:section:sec-gz-mf-heeg}
%
%
\typeout{************************************************}
\typeout{Subsection 6.3.1 CM theory}
\typeout{************************************************}
%
\begin{subsectionptx}{CM theory}{}{CM theory}{}{}{x:subsection:subsec-cm-theory}
Let \(E/\CC\) be an elliptic curve so \(E(\CC) = \CC/\Lambda_\tau  \), where \(\Lambda  = \ZZ + \ZZ\tau \), writing \(E = E+\tau \), \(\tau  \in \HH\).%
\par
Recall that%
\begin{equation*}
\End(E) = \begin{cases} \ZZ \\ \ints \subseteq K ,\,K/\QQ \text{ im. quad.}\end{cases}
\end{equation*}
%
\begin{lemma}{}{}{g:lemma:idm204347484624}%
%
\begin{equation*}
\Hom(\CC/\Lambda ,\CC/\Lambda')= \{\alpha \in \CC : \alpha  \Lambda  \subseteq \Lambda '\}
\end{equation*}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204344321904}
Lift \(\phi  \colon \CC/\Lambda  \to \CC/\Lambda '\) to%
\begin{equation*}
\phi  \colon \CC  \to \CC
\end{equation*}
to see \(\phi (z) = \alpha  z\) for some \(\alpha  \in \CC^\times\).%
\end{proofptx}
So \(\End(E_\tau ) = \{\alpha \in \CC : \alpha  \Lambda _\tau  \subseteq \Lambda _\tau \}\). If \(\alpha  \cdot 1 = m_1 + m_2 \tau \) and%
\begin{equation*}
\alpha \cdot \tau  = n_1 + n_2 \tau 
\end{equation*}
then%
\begin{equation*}
m_2 \tau ^2 + (m_1 - n_1) \tau  - n_1 = 0
\end{equation*}
call these coefficients \(A,B,C \in \ZZ\). And \(\Delta = B^2 - 4AC\), so \(\Delta  = -f^2 d \lt 0\) where \(f\) is the \terminology{conductor} of \(\tau \) and \(d\) is the discriminant of \(\tau \).%
\par
Then if \(\End(E_\tau ) \ne \ZZ\) we have%
\begin{equation*}
\End(E_\tau ) = \ZZ \oplus f \ZZ \left\lb \frac {-d + \sqrt{-d}}{2} \right \rb = \ints_\Delta  \subseteq \ints_{\QQ(\sqrt{-d})}
\end{equation*}
We say \(E\) has \terminology{CM} by \(\ints_\Delta \).%
\begin{remark}{}{g:remark:idm204344311888}%
We can create elliptic curves with CM by \(\ints\) by creating \(\CC/\ints\). In fact, all elliptic curves with  CM by \(\ints\) are isomorphic to \(\CC/\ideal a\) for \(\ideal a\) a fractional ideal of \(\ints\).%
\end{remark}
\begin{theorem}{}{}{g:theorem:idm204344308912}%
Let \(E/\CC\) be an elliptic curve with CM by \(\ints_K\) for \(K/\QQ\) imaginary quadratic. Then \(j(E) \in \ints_{H_K}\). Where \(H_K\) is the hilbert class field of \(K\), so \(E\) admits a model over a number field.%
\end{theorem}
\begin{theorem}{}{}{g:theorem:idm204344305376}%
Let \(G = \Gal{H_K}{K}\) then we have an isomorphism%
\begin{equation*}
s\colon  \Pic(\ints_K) \to G
\end{equation*}
%
\begin{equation*}
\ideal b\mapsto s(\ideal b)
\end{equation*}
%
\begin{equation*}
j(\ideal a)^{s(\ideal b)} = j(\ideal b \inv \ideal a)\text{.}
\end{equation*}
(The \(j\)-invariants generate \(\ints_H\), this characterises \(G\) as a Galois group).%
\end{theorem}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.3.2 Modular curves}
\typeout{************************************************}
%
\begin{subsectionptx}{Modular curves}{}{Modular curves}{}{}{x:subsection:subsec-mod-curves}
Let%
\begin{equation*}
\Gamma_0 (N) = \left\{\begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix}\in \SL_2(\ZZ) : \begin{pmatrix} a \amp b \\ c \amp d \end{pmatrix} \equiv \begin{pmatrix} \ast \amp \ast \\ 0 \amp \ast \end{pmatrix} \pmod N\right\}
\end{equation*}
degine \(Y_0(N) = \Gamma _0(N)\backslash \HH\) , \(X_0(N) = \Gamma _0(N)\backslash \overline \HH\). Then \(X_0(N)\) can be given the structure of a projective algebraic variety \(/\QQ\).%
\par
The for \(L/\QQ\) a field we have the modular interpretation,%
\begin{equation*}
Y_0(N)(L) = \{ (E,E',\phi ) : E,E' / L\text{ ell. curves},\, \phi \colon E \to E' / L\text{ cyclic isog. degree } N\}
\end{equation*}
i.e. \(\phi \) for which \(\ker \phi  \simeq \ZZ/N\).%
\begin{paragraphs}{Atkin-Lehner involutions.}{g:paragraphs:idm204344296608}%
Let \(d|N\), \((d, N/d) = 1\). We get an involution%
\begin{equation*}
w_d  \colon X_0(N) \to X_0(N)
\end{equation*}
such that%
\begin{equation*}
w_N(\epsilon  \colon E \to E') = (\hat \phi \colon E' \to E)
\end{equation*}
(and it swaps the two cusps.????????????)%
\par
These generate a group \(W \subseteq \Aut(X_0(N))\) with the relation%
\begin{equation*}
w_{d}w_{d'} = w_{dd'/(d,d')^2}\text{.}
\end{equation*}
So \(W \simeq (\ZZ/2)^s\) where \(s\) is the number of primes dividing \(N\).%
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.4 Archimedean Local Heights I (Aash)}
\typeout{************************************************}
%
\begin{sectionptx}{Archimedean Local Heights I (Aash)}{}{Archimedean Local Heights I (Aash)}{}{}{x:section:sec-gz-arch-I}
\begin{introduction}{}%
Breuil-Conrad-Diamond-Taylor proved modularity of elliptic curves over \(\QQ\). Gross-Zagier assume this so we can now state results unconditionally.%
\begin{theorem}{}{}{g:theorem:idm204344290048}%
%
\begin{equation*}
g_A(z) = \sum_{m\ge 1} \pair c {T_m c^\sigma } e^{2\pi  i m z}
\end{equation*}
is a cusp form of weight 2 on \(\Gamma _0(N)\) and satisfies%
\begin{equation*}
(f,g_A) = \frac{u^2 |D|^{\frac 12} L'_A(f,1)}{8\pi ^2}
\end{equation*}
for all \(f\) in the space of newforms of weight 2 in \(\Gamma _0(N)\).%
\end{theorem}
%
\begin{equation*}
Cl_K \leftrightarrow \Gal HK
\end{equation*}
%
\begin{equation*}
A \leftrightarrow \sigma 
\end{equation*}
the artin map.%
\begin{equation*}
c = (x) - (\infty ) \in J(H)
\end{equation*}
\(x\) a Heegner point and \(\pair \cdot\cdot\) is the global height pairing on \(J(H) \otimes \CC\).%
\par
\(J\) is the Jacobian of \(X_0(N)\), \(K = \QQ(\sqrt{D})\), class  number \(h\).%
\par
\(H/K\) is the hilbert class field and \(2u\) is the number of roots of unity in \(K\).%
\par
Where \(L_A\) is a twisted \(L\)-function related to a component theta function, i.e.%
\begin{equation*}
r_A(n) =\# \text{integral ideals in } A \text{ of norm }n\text{.}
\end{equation*}
%
\par
Also%
\begin{theorem}{}{}{g:theorem:idm204344280032}%
%
\begin{equation*}
L'(f,\chi ,1) = \frac{8\pi ^2 (f, f) \hat h(c_{x,f})}{hu^2 |D|^{\frac12}}\text{.}
\end{equation*}
%
\begin{equation*}
c_x = \sum_{\sigma \in \Gal HK} x\inv(\sigma ) c^\sigma 
\end{equation*}
\(x\) a character of \(\Gal HK\). \(c_{x,f}\) is the projection to the \(f\)-isotypical component.%
\end{theorem}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 6.4.1 Height Pairings}
\typeout{************************************************}
%
\begin{subsectionptx}{Height Pairings}{}{Height Pairings}{}{}{g:subsection:idm204344277200}
%
\begin{equation*}
| \cdot |_v \colon  H_v^\times \to \RR_+^\times
\end{equation*}
%
\begin{equation*}
|\alpha |_v = \alpha \bar \alpha
\end{equation*}
if \(H_v \cong \CC\) or \(q_v^{-v(\alpha )}\) if \(v\) is non-archimidean.%
\par
Neron's theory gives us a unique symbol on relatively primes divisors (divisors whose supports are disjoint). This pairing when defined splits up as%
\begin{equation*}
\pair ab = \sum_v \pair ab_v
\end{equation*}
%
\begin{equation*}
g_A(z) = \sum_{m\ge1} \pair c{ T_m c^\sigma } e^{2\pi  i m z}
\end{equation*}
%
\begin{equation*}
c=(x) - (\infty )
\end{equation*}
%
\begin{equation*}
d = (x) - (0)
\end{equation*}
\((0)-(\infty )\) is of finite order in \(J(\QQ)\).%
\par
%
\begin{equation*}
\pair c{T_m c^\sigma } = \pair c {T_m d^\sigma }
\end{equation*}
%
\begin{remark}{}{g:remark:idm204344271808}%
%
\begin{equation*}
r_A(m) = 0,\, N \gt1
\end{equation*}
implies \(c,T_m d^\sigma\)  are relatively prime.%
\end{remark}
If \(S\) is a compact Riemann surface then there exists a partially defined%
\begin{equation*}
\pair \cdot \cdot \colon  \Div^0(S) \times \Div^0(S) \to \RR
\end{equation*}
which satisfies%
\begin{enumerate}
\item{}\(\pair ab\) is defined when \(a,b\) have disjoint support.%
\item{}\(\pair \cdot\cdot\) is bi-additive and symmetric whenever it is defined.%
\item{}If \(f\) is meromorphic on \(S\) and%
\begin{equation*}
a= \sum_i n_i x_i
\end{equation*}
%
\begin{equation*}
\pair{\divisor (f)} a = \sum n_i \log|f(x_i)|^2
\end{equation*}
%
\item{}%
\begin{equation*}
\pair a {\sum_j m_j (y_j)}
\end{equation*}
is continuous on \(S\smallsetminus |a|\) w.r.t each \(y_j\). Where%
\begin{equation*}
|a|
\end{equation*}
is the support of \(a\).%
\end{enumerate}
%
\begin{paragraphs}{Uniqueness.}{g:paragraphs:idm204344263888}%
Considering the difference of two symbols satisfying this then then it descends to the Jacobian as the values on \(\divisor(f)\) cancel.%
\par
Therefore%
\begin{equation*}
J\to \RR
\end{equation*}
%
\begin{equation*}
b\mapsto \pair b a
\end{equation*}
is a continuous homorphism. Therefore the image is 0 (as 0 is the only compact function).%
\end{paragraphs}%
\begin{paragraphs}{Existence.}{g:paragraphs:idm204344261632}%
Fix \(x_0, y_0 \in S\)%
\begin{equation*}
G(x,y)  = \pair{(x)  - (x_0)}{ (y) - (y_0)}
\end{equation*}
where \(x\ne y,y\ne x_0,x\ne y_0\), \(G\) is a Green's function%
\par
Biadditivity%
\begin{equation*}
\implies \pair ab = \sum_{i,j} n_i m_j G(x_i, y_j)
\end{equation*}
\(a = \sum n_i(x_i)\), \(b = \sum m_j(y_j)\), \(y_0 \not \in |a|,x_0 \not \in |b|\).%
\par
Conversely given \(G(x,y)\) we can define a symbol \(\pair \cdot \cdot\) if for fixed \(x \ne y_0\) the function%
\begin{equation*}
y \mapsto G(x,y)
\end{equation*}
on \(S\smallsetminus\{x,x_0\}\) is:%
\begin{enumerate}
\item{}continuous%
\item{}harmonic, i.e.%
\begin{equation*}
\Delta _y^2 G(x,y) = 0\text{.}
\end{equation*}
%
\item{}has logarithmic singularities of residue \(+1,-1\) at \(y=x,y=x_0, x=y_0\).%
\end{enumerate}
%
\begin{remark}{}{g:remark:idm204344252912}%
\(f\) has logarithmic singularities at \(z_0\) if%
\begin{equation*}
f(z) - \alpha \log|\rho (z)|^2
\end{equation*}
is continuous near \(z_0\), \(\rho \) is holomorphic near \(z_0\) and vanishing to order \(1\) at \(z_0\).%
\par
\(\alpha \) is called the residue of this singularity. \(\rho \) is the uniformizing parameter near \(z_0\). Same symmetric condition on \(x\).%
\end{remark}
So this is well defined, continuous and bi-additive if%
\begin{equation*}
(|a| \cup\{x_0\}) \cap (|b| \cup \{y+0\} ) = \emptyset
\end{equation*}
we want to extend to \(|a|\cap |b| = \emptyset\).%
\par
Sufficient to show%
\begin{equation*}
G(x_1,y) -G(x_2,y)
\end{equation*}
makes sense as \(y\to y_0\), \(x_1, x_2 \not \subset |b| \cup\{y_0\}\).%
\begin{equation*}
G(x_i, y) = - \log|\rho |^2 + c_i + O(\rho (y))
\end{equation*}
therefore%
\begin{equation*}
G(x_1,y) - G(x_2,y) \to c_1  - c_2
\end{equation*}
as \(y \to x_0\). Therefore this is well defined and continuous by hypothesis 3. on \(G(x,y)\).%
\par
\(\pair\cdot\cdot\) is defined and continuous and bi-additive now, consider%
\begin{equation*}
(f) = \sum_{j=1}^ k m_j (y_j)
\end{equation*}
a principal divisor, \(x_0 \not \in |(f)|\)%
\begin{equation*}
\delta \colon x\mapsto \pair {(x) - (x_0) }{f} - \left(\log|f(x)|^2 - \log|f(x_0)|^2\right)
\end{equation*}
%
\begin{equation*}
= \sum m_j G(x,y_j) - \left( \log|f(x)| ^2 - \log|f(x_0)|^2\right)
\end{equation*}
is harmonic for \(x \in S - \{u_0, y_k\}\) and continuous everywhere so the difference is constant.%
\par
%
\begin{equation*}
\pair {\sum n_i(x_i)}{(f)} - \sum n_i \log|f(x_i)|^2
\end{equation*}
%
\begin{equation*}
=\sum n_i \delta (x_i) = \sum n_i C = 0\text{.}
\end{equation*}
%
\par
If we take \(G\) with the given hypothesis as \(\pair\cdot\cdot\). \(S  = X_0(N)(\CC)\), \(x_0 = \infty \), \(y_0 = 0\). Conditions on \(G\) needed:%
\begin{itemize}[label=\textbullet]
\item{}G1 , \(G\) is a real valued continuous harmonic function on%
\begin{equation*}
E = \{ (z,z') \in \HH^2 : z\not \in \Gamma _0(N) z'\}
\end{equation*}
such that \(G(\gamma  z, \gamma 'z') = G(z,z')\) for all%
\begin{equation*}
(z,z')\in E, \gamma ,\gamma '\in \Gamma _0(N)\text{.}
\end{equation*}
%
\item{}G2 , Fix \(z\in \HH\)%
\begin{equation*}
G(z,z') = e_z\log|z- z'|^2 + O(1)
\end{equation*}
as \(z'\to z\), where \(e_z\) is the order of the stabilizer in \(\Gamma _0(N)\).%
\item{}G3 , For \(z\in \HH\) fixed%
\begin{equation*}
G(z,z') = 4\pi  y' + O(1)
\end{equation*}
as \(z' = x' + iy' \to \infty \) and \(G(z,z') = O(1)\) at other cusps.%
\item{}G4 , For \(z'\in \HH\) fixed%
\begin{equation*}
G(z,z') = 4\pi  y/N|z|^2 + O(1)
\end{equation*}
as \(z = x + iy \to 0 \) and \(G(z,z') = O(1)\) at other cusps.%
\end{itemize}
%
\par
G2,G3,G4 come from uniformizing parameters , at \(\infty \) \(e^{2\pi i z} \leftrightarrow \rho \), non-cusp : \(|z' -z|^{e_z} \leftrightarrow \rho \) , at 0 \(e^{-2\pi i z}/|z|^2\). applies the logarithmic singularity hypothesis on \(G\).%
\par
%
\begin{equation*}
G(z,z') = \lim_{s\to 1} \left( G_{N,s} (z,z') + 4 \pi  E_N(w_N z, s) + 4 \pi  E_N(z', s) + \frac{K_N}{s-1}\right) + c
\end{equation*}
%
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.5 Archimedean Local Heights II (Stevan)}
\typeout{************************************************}
%
\begin{sectionptx}{Archimedean Local Heights II (Stevan)}{}{Archimedean Local Heights II (Stevan)}{}{}{x:section:sec-gz-arch-II}
Last time: \(\pair \cdot\cdot \colon \Div^0(S) \times \Div^0(S) \to \RR\). It is bi-additive and symmetric%
\begin{equation*}
b   = \divisor(f),\,a = \sum n_i x_i
\end{equation*}
%
\begin{equation*}
\pair ab = \sum_j n_j \log|f(x_i)|^2
\end{equation*}
if \(x_0\ne y_0 \in S\)%
\begin{equation*}
G(x,y) = \pair{x-x_0}{y-y_0}
\end{equation*}
if%
\begin{equation*}
a =\sum n_ix_i,\,b = \sum m_j y_j
\end{equation*}
then%
\begin{equation*}
\pair a b = \sum n_im_j G(x_i,y_j)\text{.}
\end{equation*}
%
\par
\(G \) is continuous, harmonic, has residue \(+1\) at \(\), \(-1\) at \(x_0\). And has logarithmic singularities.%
\par
Now we pass to modular curves, \(S = X_0(N) = \HH^*/\Gamma _0(N)\).%
\begin{equation*}
G(\gamma z,\gamma z') = G(z,z') \,\forall \gamma ,\gamma ' \in \Gamma _0(N)\text{.}
\end{equation*}
%
\par
Continuous and harmonic when \(z \not \in \gamma  z',\,\gamma \in \Gamma _0(N)\).%
\par
%
\begin{equation*}
G(z,z')= e_z\log|z-z'|^2 + O(1)
\end{equation*}
%
\begin{equation*}
z'\to z,\,z\text{fixed }
\end{equation*}
%
\begin{equation*}
e_z =\#\Stab_z \Gamma _0(N)
\end{equation*}
%
\begin{equation*}
G(z,z') = 4 \pi  y +O(1) \text{ as } z\to \infty 
\end{equation*}
%
\begin{equation*}
G(z,z') = 4 \pi  y/N|z|^2 +O(1) \text{ as } z\to 0
\end{equation*}
%
\par
Want \(G\).%
\begin{equation*}
g(\gamma z,\gamma z') = g(z,z'),\,\gamma \in \SL_2(\ZZ)
\end{equation*}
with \(g(z,z')\) continuous and harmonic in \(z,z'\).%
\begin{equation*}
g(z,z' ) = \log|z-z'|^2 + O(1),\,z'\to z\text{.}
\end{equation*}
A natural guess is%
\begin{equation*}
g(z,z') = \log \left | \frac{z-z'}{\bar z- z'}\right |^2
\end{equation*}
%
\begin{equation*}
G(z,z') = \sum_{\gamma \in \Gamma _0(N)} g(z,\gamma z')
\end{equation*}
however this does not converge.%
\par
Instead of asking for harmonic \(\Delta ^2 g = 0\) we instead ask that \(\Delta ^2 g = \epsilon  g\) and let \(\epsilon \to 0\). This gives us a differential equation to solve.%
\par
\(g\) is a function only of the hyperbolic distance between the points,%
\begin{equation*}
t = 1 + \frac{|z-z'|^2}{2yy'}
\end{equation*}
%
\begin{equation*}
((1-t^2) \frac{\diff^2}{\diff t^2} - 2t \frac{\diff}{\diff t} + \epsilon )Q(t) = 0
\end{equation*}
%
\begin{equation*}
Q_{s-1}(t) = \frac{\Gamma (s)^2}{2\Gamma (2s)} \left(\frac{2}{1+t}\right)^2 F(s,s; 2s, \frac{2}{1+t}),\,t\gt 1,\,\epsilon  = s(s-1),\,s\gt1
\end{equation*}
where%
\begin{equation*}
F(a,b; c, z)= \sum_{n\ge 0} \frac{(a)_n (b)_n}{(c)_n} \frac{z^n}{n!}
\end{equation*}
where%
\begin{equation*}
(w)_n = \begin{cases} w(w+1)\cdots(w+n-1),\amp n\gt 0,\\1\\amp n=0\end{cases}\text{.}
\end{equation*}
%
\par
So%
\begin{equation*}
Q_{s-1}(t) = -\frac12 \log(t-1)  + O(1),\,t \to 1
\end{equation*}
%
\begin{equation*}
Q_{s-1}(t) = O(t^{-s}),\,t \to \infty 
\end{equation*}
and so we may now set%
\begin{equation*}
g_s(z,z') = -2Q_{s-1}(t) = -2 Q_{s-1}\left(1+ \frac{|z-z'|^2}{2yy'}\right)
\end{equation*}
%
\begin{equation*}
G_{N,s}(z,z') = \sum_{\gamma \in \Gamma _0(N)} g_s(z,\gamma z')
\end{equation*}
%
\par
And our final Green's function is%
\begin{equation*}
G(z,z') = \lim_{s\to 1} (G_{N,s}(z,z') + 4\pi  E_N(w_N z,s) + 2\pi  E_N(z', s)+\frac{K_N}{s-1}) +C
\end{equation*}
%
\begin{equation*}
E_N(z,s) = \sum_{\gamma \in \begin{pmatrix}\ast\amp\ast\\0\amp\ast\end{pmatrix}\backslash \Gamma _0(N)} \Im(\gamma z)^s,\,z\in \HH,\,\Re(s) \gt 1
\end{equation*}
%
\begin{equation*}
K_N = -\frac{12}{\lb \SL_2(\ZZ) : \Gamma _0(N)\rb } = \text{a residue of }G_{N,s} \text{ at } s=1,\,G_N(z) = -\frac{1}{N}
\end{equation*}
%
\begin{equation*}
=\kappa_{N}\left[\log N+2 \log 2-2 \gamma+2 \frac{\zeta^{\prime}}{\zeta}(2)-2 \sum_{p | N} \frac{p \log p}{p^{2}-1}\right]
\end{equation*}
%
\begin{equation*}
E_{N}(z, s)=N^{-s} \prod_{p | N}\left(1-p^{-2 s}\right)^{-1} \cdot \sum_{d | N} \frac{\mu(d)}{d^{s}} E\left(\frac{N}{d} z, s\right)
\end{equation*}
%
\par
Asymptotics%
\begin{equation*}
E(z, s)=y^{s}+\phi(s) y^{1-s}+O\left(e^{-y}\right) \quad(y=\operatorname{Im}(z) \rightarrow \infty)
\end{equation*}
where%
\begin{equation*}
\phi(s)=\frac{\Gamma\left(\frac{1}{2}\right) \Gamma\left(s-\frac{1}{2}\right)}{\Gamma(s)} \frac{\zeta(2 s-1)}{\zeta(2 s)}
\end{equation*}
and importantly%
\begin{equation*}
G\left(z, z^{\prime}\right)=G\left(w_{N} z^{\prime}, w_{N} z\right)\text{.}
\end{equation*}
%
\begin{proposition}{}{}{g:proposition:idm204344202608}%
Let \(x,x'\in X_0(N)\) be non-cuspidal%
\begin{equation*}
\begin{aligned}\langle(x)\amp\left.-(\infty),\left(x^{\prime}\right)-(0)\right\rangle_{\mathbb{C}} \\ \amp=\lim _{s \rightarrow 1}\left[G_{N, s}\left(z, z^{\prime}\right)+4 \pi E_{N}\left(w_{N} z, s\right)+4 \pi E_{N}\left(z^{\prime}, s\right)+\frac{\kappa_{N}}{s-1}\right]+C \end{aligned}\text{.}
\end{equation*}
This can be re-stated as%
\begin{equation*}
\begin{aligned}\amp\langle(x)-(\infty), T_{m}\left(\left(x^{\prime}\right)-(0)\right)\rangle_{\mathbb{C}} \\=\amp \lim _{s \rightarrow 1}\left[G_{N, s}^{m}\left(z, z^{\prime}\right)+4 \pi \sigma_{1}(m) E_{N}\left(w_{N} z, s\right)\right.\\ \amp\left.+4 \pi m^{s} \sigma_{1-2 s}(m) E_{N}\left(z^{\prime}, s\right)+\frac{\sigma_{1}(m) \kappa_{N}}{s-1}\right]-\sigma_{1}(m) \lambda_{N}+2 \sigma_{1}(m) \kappa_{N} \end{aligned}
\end{equation*}
%
\end{proposition}
Now let \(x\) be a Heegner point and take%
\begin{equation*}
c= (x)  - (\infty )
\end{equation*}
%
\begin{equation*}
d = (x)-(0)
\end{equation*}
then \(\sigma \in \Gal HK \leftrightarrow \mathscr A\in \Cl_K\). If \(\gcd(M,N) = 1\) then%
\begin{equation*}
r_{\mathscr A} (m ) = 0 \implies |c| \cap |T_m (d)| = \emptyset\text{.}
\end{equation*}
%
\par
What we want:%
\begin{equation*}
S = \pair c {T_md}_\infty  = \sum_{v|\infty } \pair c {T_md^\sigma }_v
\end{equation*}
sum goes over \(h_K\) archimidean places of \(K\).%
\begin{equation*}
S = \sum_{\mathscr{A}_{1}, \mathscr{A}_{2} \in \mathrm{Cl}_{K} , \mathscr{A}_{1} \mathscr{A}_{2}^{-1}=\mathscr{A}, \mathscr{A}_{1} \mathscr{A}_{2}[\mathfrak{n}]^{-1}=\mathscr{B}} G_{N . s}^{m}\left(\tau_{\mathscr{A}_{1}, \mathbf{n}}, \tau_{\mathscr{A}_{2}, \mathrm{n}}\right)
\end{equation*}
we will compute \(S\) using the above%
\begin{equation*}
\begin{aligned}\left\langle c, T_{m} d^{\sigma}\right\rangle_{\infty}=\amp \lim _{s \rightarrow 1}\left[\gamma_{N, s}^{m}(\mathscr{A})+4 \pi \sigma_{1}(m) \sum_{\mathscr{A}_{1} \in \mathrm{Cl}_{K}} E_{N}\left(w_{N} \tau_{\mathscr{A}_{1}, \mathbf{n}}, S\right)\right.\\ \amp\left.+4 \pi m^{s} \sigma_{1-2 s}(m) \sum_{\mathscr{A}_{2} \in \mathrm{Cl}_{K}} E_{N}\left(\tau_{\mathscr{A}_{2}, \mathbf{n}}, S\right)+\frac{h_{K} \sigma_{1}(m) \kappa_{N}}{S-1}\right] \\ \amp-h_{K} \sigma_{1}(m) \hat{\lambda}_{N}+2 h_{K} \sigma_{1}(m) \kappa_{N} \end{aligned}
\end{equation*}
and apply%
\begin{equation*}
\begin{aligned} \sum_{\mathscr{A} \in \mathrm{Cl}_{K}} E_{N}\left(w_{N} \tau_{\mathscr{A}, \mathfrak{w}}, s\right) \amp=\sum_{\mathscr{A} \in \mathrm{Cl}_{K_ { K }}} E_{N}\left(\tau_{\mathscr{A}, \mathfrak{n}}, s\right) \\ \amp=N^{-s} \prod_{p | N}\left(1-p^{-2 s}\right)^{-1} \sum_{d \backslash N} \frac{\mu(d)}{d^{s}} \sum_{\mathscr{A} \in \mathbb{Cl}_{K}} E\left(\frac{N}{d} \tau_{\mathscr{A}, \mathfrak{n}}, s\right) \end{aligned}
\end{equation*}
so we must only compute%
\begin{equation*}
\sum_{\mathscr{A} \in \mathrm{Cl}_{K}} E\left(\frac{N}{d} \tau_{\mathscr{A}, \mathrm{n}}, s\right)\text{.}
\end{equation*}
\(\tau _{\mathscr A, \mathfrak n}\) is a solution of%
\begin{equation*}
a\tau ^2 + b\tau  + c = 0
\end{equation*}
of discriminant \(D = b^2 -4ac\). So all other \(\frac Nd \tau _{\mathscr A, \mathfrak n}\) is a solution of some quadratic equation of discriminant \(D = b^2 -4ac\). From analytic number theory we have the formula%
\begin{equation*}
E\left(\tau_{\mathscr{A}}, s\right)=2^{-s}|D|^{s / 2} u \zeta(2 s)^{-1} \zeta_{K}(\mathscr{A}, s)
\end{equation*}
with \(u\) half the number of units in \(K\).%
\begin{equation*}
\zeta_{K}(\mathscr{A}, s)=\sum_{\mathfrak{a} \text { integral } ,\,[\mathfrak{a}]=\mathscr{A}} \frac{1}{N(\mathfrak{a})^{s}}
\end{equation*}
as we also have%
\begin{equation*}
\sum_{\mathscr{A}} \zeta_{K}(\mathscr{A}, s)=\zeta_{K}(s)\text{.}
\end{equation*}
%
\par
we then get%
\begin{equation*}
\begin{aligned}\left\langle c, T_{m} d^{\sigma}\right\rangle_{\infty}=\amp \lim _{s \rightarrow 1}\left[\gamma_{N, s}^{m}(\mathscr{A})+\frac{2^{2-s}|D|^{s / 2} \pi u}{N^{s} \prod_{p | N}\left(1+p^{-s}\right)}\left(\sigma_{1}(m)+m^{s} \sigma_{1-2 s}(m)\right) \frac{\zeta_{K}(s)}{\zeta(2 s)}\right.\\ \amp\left.+\frac{h_{K} \sigma_{1}(m) \kappa_{N}}{s-1}\right]-h_{K} \sigma_{1}(m) \lambda_{N}+2 h_{K} \sigma_{1}(m) \kappa_{N} \end{aligned}
\end{equation*}
where we may substitute%
\begin{equation*}
\begin{aligned} \zeta_{K}(s) \amp=\zeta(s) L(s, \varepsilon) \\ \amp=\left(\frac{1}{s-1}+\gamma+O(s-1)\right)\left(L(1, \varepsilon)+L^{\prime}(1, \varepsilon)(s-1)+O(s-1)^{2}\right) \end{aligned}
\end{equation*}
to finally obtain%
\begin{equation*}
\begin{aligned}\left\langle c, T_{m} d^{\sigma}\right\rangle_{\infty}=\amp \lim _{s \rightarrow 1}\left[\gamma_{N, s}^{m}(\mathscr{A})-\frac{h_{K} \sigma_{1}(m) \kappa_{N}}{s-1}\right] \\ \amp+h_{K} \kappa_{N}\left[\sigma_{1}(m)\left(\log \frac{N}{|D|}+2 \sum_{p | N} \frac{\log p}{p^{2}-1}+2+2 \frac{\zeta^{\prime}}{\zeta}(2)-2 \frac{L^{\prime}}{L}(1, \varepsilon)\right)\right.\\ \amp\left.+\sum_{d | m} d \log \frac{m}{d^{2}}\right] \end{aligned}\text{.}
\end{equation*}
%
\par
To compute the archimidean local height when the supports are not disjoint (i.e. \(r_{\mathscr A}(m) \ne 0\)) We consider the simplified case of%
\begin{equation*}
\{x\} = |a| \cap |b|
\end{equation*}
then%
\begin{equation*}
\pair a b_{v,g} = \lim_{y\to x} (\pair {a_y}{b} - \ord_x(a) \ord_x(b) \log |g(y)|_v)
\end{equation*}
where \(g\) is a uniformizer at \(x\) i.e. \(\ord_x(g) =1\). and \(a_y\) is the divisor \(a\) with \(y\) in place of \(x\).%
\begin{equation*}
a = n_x x + \cdots
\end{equation*}
%
\begin{equation*}
a_y = n_x y + \cdots
\end{equation*}
so \(|a_y | \cap |b| = \emptyset\). If \(g'\) is another uniformizer at \(x\) then%
\begin{equation*}
\sum_{v} \pair a b_{v,g}  -\pair ab_{v,g'} = \ord_x(a) \ord_x(b) \log|g'/g(x)|_v
\end{equation*}
so this gives a well defined global height by the product formula.%
\par
In our setting we have%
\begin{equation*}
c = (x) -(\infty ),\,d = (x) - (0)
\end{equation*}
and \(\ord_x(c)  = 1,\,\ord_x(T_m(d^\sigma )) = r_{\mathscr A}(m)\) so under this definition%
\begin{equation*}
\pair c {T_md^\sigma} = \lim_{y\to x} \pair {c_y}{T_md^\sigma } - r_{\mathscr A} (m)\log(|g(y)|_v)
\end{equation*}
%
\begin{equation*}
\omega=\eta^{4}(z) \frac{d q}{q}=2 \pi i \eta^{4}(z) d z
\end{equation*}
with%
\begin{equation*}
\eta(z)=q^{1/{24}} \prod_{n}\left(1-q^{n}\right)
\end{equation*}
the Dedekind eta-function.%
\par
So for \(v\)  a complex places%
\begin{equation*}
\log |g(y)|_{v}-u \log \left|2 \pi i \eta^{4}(z)(w-z)\right|_{v} \rightarrow 0
\end{equation*}
as \(y \to x\).%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.6 Deuring's theory of lifts (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Deuring's theory of lifts (Angus)}{}{Deuring's theory of lifts (Angus)}{}{}{x:section:sec-deuring-lift}
\begin{introduction}{}%
Notations: \(X = X_0(N)/\QQ\), \(x  = (E \to E')\) a heegner point of discriminant \(D\), with CM by \(\ints_K\). \(H\) the Hilbert class field of \(K\), \(v\) a place of \(p\).%
\begin{equation*}
c = (x) - (\infty ),\, d = (x) - (0)
\end{equation*}
%
\begin{equation*}
\operatorname{Art}_K \colon \Cl_K \to \Gal H K
\end{equation*}
%
\begin{equation*}
\mathscr A \to \sigma 
\end{equation*}
%
\begin{equation*}
r_{\mathscr A}(m) = \# \text{integral ideals of }\ints_K\text{ in the class of }\mathscr A \text{ of norm }m
\end{equation*}
%
\begin{equation*}
\Lambda _v = \text{ring of integers in the completion }H_v
\end{equation*}
%
\begin{equation*}
W = (\Lambda _v^{nr})^\wedge
\end{equation*}
%
\begin{equation*}
\pi _v, k_v, q_v
\end{equation*}
%
\begin{equation*}
\mathcal X/\Lambda _v
\end{equation*}
a model of \(X\) over \(\Lambda _v\).%
\par
Meta-Goal%
\par
Understand%
\begin{equation*}
g_{\mathscr A}(z) = \sum_{m=1}^\infty \pair c {T_m d^\sigma } e^{2\pi  i m z}
\end{equation*}
strategy is to decompose%
\begin{equation*}
\pair a b = \sum_v \pair ab_v
\end{equation*}
so far, seen the archimidean \(v\) case. Today, nonarchimidean.%
\par
Following GZ and Michigan seminar.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 6.6.1 Generalities on nonarchimidean local heights}
\typeout{************************************************}
%
\begin{subsectionptx}{Generalities on nonarchimidean local heights}{}{Generalities on nonarchimidean local heights}{}{}{g:subsection:idm204344164048}
\begin{theorem}{}{}{g:theorem:idm204344163616}%
Let \(a,b\in \Div^0(X \otimes H_v)\) be relatively prime divisors. Let \(A,B\) be extensions of these to divisors on \(\mathcal X\) such that%
\begin{equation*}
(A. \mathcal Y) = (B. \mathcal Y) = 0
\end{equation*}
for all irreducible components \(\mathcal Y\) of \(\mathcal X\otimes k_v\). Then%
\begin{equation*}
\pair ab_v = -(A.B) \log q_v\text{.}
\end{equation*}
%
\end{theorem}
\begin{remark}{}{g:remark:idm204344160048}%
\(\mathcal X\) is an arithmetic surface.%
\end{remark}
\begin{theorem}{G-Z III.3.3.}{}{g:theorem:idm204344159360}%
Let \(m \ge 1\) s.t. \((m,N) = 1\) and \(r_{\mathscr A}(m)= 0\). Then%
\begin{equation*}
\pair c{T_m d^\sigma }_v = -(\underline x. T_m \underline x^\sigma ) \log(q_v)
\end{equation*}
where \(\underline x \in \mathcal X(\Lambda _v)\) corresponding to \(x\).%
\end{theorem}
\begin{proposition}{G-Z III.4.4.}{}{g:proposition:idm204344155968}%
Assumptions as  above, then%
\begin{equation*}
(\underline x. T_m \underline x^\sigma ) = \frac12 \sum_{n=1}^\infty  \#\Hom_{W/\pi _v^n}(\underline x^\sigma , \underline x)_{\deg m}
\end{equation*}
where for \(\underline x = (E_1 \to E_1')\) and \(\underline y = (E_2 \to E_2')\). An element \((f,f') \in \Hom(\underline x,\underline y) \) is%
\begin{equation*}
\xymatrix{
E_1 \ar[r] \ar[d]_{f} & E_1' \ar[d]^{f'}\\
E_2 \ar[r] & E_2'}\text{.}
\end{equation*}
%
\end{proposition}
Today we will begin the proof of this proposition in the case that \(p\) is split in \(K\). In this case LHS and RHS are both 0.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.6.2 Deuring's theory of lifts}
\typeout{************************************************}
%
\begin{subsectionptx}{Deuring's theory of lifts}{}{Deuring's theory of lifts}{}{}{g:subsection:idm204344151568}
Let \(E/F\) be an elliptic curve over a number field with CM by \(K\), (\(\End (E) = \ints_K\)). We'll begin by studying the reductions \(\overline E \pmod p\).%
\begin{definition}{}{g:definition:idm204344149168}%
Let \(\overline E /\FF_q\) be an elliptic curve. We say \(\overline E\) is ordinary if \(\overline E\lb p\rb (\overline F_q) = \ZZ/p\), supersingular if this group is 0.%
\end{definition}
\begin{theorem}{}{}{g:theorem:idm204344147280}%
TFAE%
\begin{enumerate}
\item{}%
\begin{equation*}
\overline E \lb p\rb (\overline \FF_q) = 0
\end{equation*}
%
\item{}%
\begin{equation*}
\lb p\rb \colon \overline E \to \overline E
\end{equation*}
is purely inseparable and \(j(\overline E) \in \FF_{p^2}\).%
\item{}\(\End(\overline E)\) is an order in a quaternion algebra.%
\end{enumerate}
%
\end{theorem}
\begin{remark}{}{g:remark:idm204344144592}%
One criterion for \(\phi \colon C_1 \to C_2\) to be separable is that%
\begin{equation*}
\phi ^* \colon \Omega _{C_2} \to \Omega_{C_1}
\end{equation*}
is nonzero.%
\end{remark}
\begin{proposition}{}{}{g:proposition:idm204344143280}%
Let \(E/F\) be an elliptic curve over a number field with CM by \(K\) (\(\End (E) = \ints_K\)). let \(\wp| p\) be a prime of \(FK\) s.t. \(E\) has good reduction \(\overline E\) mod \(\wp \cap \ints_F\). Then%
\begin{equation*}
\overline E \text{ is ordinary} \iff p \text{ splits in }K
\end{equation*}
%
\end{proposition}
\begin{proofptx}{}{g:proof:idm204344139056}
\(p\ints K = \ideal p \ideal p'\), sat \(\wp / \ideal p\). Let \(m\) be the order of \(\ideal p\) in \(\Cl_K\), so that%
\begin{equation*}
\ideal p ^m  = (\mu ) , (\ideal p')^m = (\mu ')
\end{equation*}
change by units if necessary so that%
\begin{equation*}
\mu \mu ' = p^m
\end{equation*}
then%
\begin{equation*}
[\mu '] \in \End(E)
\end{equation*}
Let \(\omega  \in \Omega _E\) and note%
\begin{equation*}
[\mu ']^* \omega  = \mu '\omega 
\end{equation*}
since \(\mu ' \not \in \ideal p\), \(\lb \mu '\rb ^*\omega   \not \equiv 0 \pmod {\ideal p}\). So \(\lb \mu '\rb  \in \End(\overline E)\) is separable and of \(p\)-power degree. This implies%
\begin{equation*}
\lb p\rb 
\end{equation*}
is not purely inseparable so \(\overline E \) is ordinary.%
\par
Consider \(\overline E\) ordinary,%
\begin{equation*}
\ints_K \otimes \ZZ_p \simeq \End(\overline E) \otimes \ZZ_p \to \End_{\ZZ_p}(T_p(\overline E)) \simeq \ZZ_p
\end{equation*}
tensoring with \(\QQ\) gives,%
\begin{equation*}
K\otimes \QQ_p \to \QQ_p
\end{equation*}
the LHS is 2-dimensional over \(\QQ_p\), so this map cannot be an injection. So \(K\otimes \QQ_p\) cannot be a field so \(p\) splits in \(K\).%
\end{proofptx}
\begin{definition}{}{g:definition:idm204344128176}%
Let \(E/K\) be an ordinary elliptic curve over a perfect field of characteristic \(p\). A canonical lift is an elliptic curve%
\begin{equation*}
\mathscr E/W(K)
\end{equation*}
s.t. the connected-etale sequence%
\begin{equation*}
0\to\mathscr E [p^\infty ]^0 \to \mathscr E [p^\infty ] \to \mathscr E[p^\infty ]^{et} \to 0
\end{equation*}
splits.%
\end{definition}
\begin{theorem}{}{}{g:theorem:idm204344125808}%
Let%
\begin{equation*}
E_0 /\overline \FF_p
\end{equation*}
be an elliptic curve and \(\alpha _ 0 \in \End(E_0)\). Then there exists an elliptic \(E/F\) over a number field and \(\alpha \in \End(E)\) and \(\ideal p /p\) of \(\ints_F\) s.t.%
\begin{equation*}
(E,\alpha ) \equiv  (E_0, \alpha _0) \pmod {\ideal p}\text{.}
\end{equation*}
%
\end{theorem}
\begin{proofptx}{}{g:proof:idm204344122256}
First note that if we have a lift then we can trivially lift \(\alpha _0 = \lb n\rb \). So we can reduce to the case%
\begin{enumerate}
\item{}\(\ker (\alpha _0)\) is cyclic.%
\item{}\(p\nmid \deg(\alpha _0)\).%
\end{enumerate}
now let \(n = \deg(\alpha _0)\). Let \(j\) be transcendental over \(\QQ\) and%
\begin{equation*}
E(j)/\QQ(j)
\end{equation*}
and elliptic curve with that \(j\)-invariant. Let \(C_1, \ldots, C_{\psi (n)}\) be the cyclic order \(n\) subgroups of \(E(j)\) and consider the isogenies%
\begin{equation*}
E(j) \to E(j)/C_i = E(j_i)
\end{equation*}
(\(\psi\) is the Dedekind \(\psi\) function \(\psi(n) = n\prod_{p|n}(1+1/p)\)). Fact: Each \(j_i\) is integral over \(\ZZ\lb j\rb \)\slash{} Consider \(\ZZ\lb j,j_1,\ldots, j_n\rb \) and its integral closure \(R\) in \(\QQ(j,j_1, \ldots, j_n)\). We have a map%
\begin{equation*}
\ZZ[j] \to \overline \FF_p
\end{equation*}
%
\begin{equation*}
j \mapsto j(E_0)
\end{equation*}
which can be extended to%
\begin{equation*}
R \xrightarrow\phi \overline \FF_p
\end{equation*}
and let%
\begin{equation*}
\ideal m = \ker (\phi )
\end{equation*}
we have \(\overline {E(j)} \cong E_0 \pmod{\ideal m}\). Consider the reductions%
\begin{equation*}
\overline C_i,\overline{E(j_i)}\text{.}
\end{equation*}
Since \(p\nmid n\) the reduction is injective on \(n\)-torsion. So \(\overline C_i\) cover all the cyclic order \(n\) subgroups of \(E_0\). This for some \(i\) we have \(\ker(\alpha _0) = \overline C_i\), so%
\begin{equation*}
E(j) \to E(j_i)
\end{equation*}
reduces to \(\alpha _0\). Note:%
\begin{equation*}
\overline{E(j)} \cong \overline{E(j_i)} \implies (p, j-  j_i) \subseteq \ideal m\text{.}
\end{equation*}
Pick a minimal prime over \((j - j_i)\) in \(R\) and let \(\ideal q\) be an extension to \(\overline R\) (the integral closure of \(R\) in \(\overline{\QQ(j)}\).) Note \(\ideal q \cap \ZZ = 0\) else \(\ideal q | q\) and thus be height \(\ge 2\). So \(\overline E/ \ideal q\) is an integral extension of \(\ZZ\) and%
\begin{equation*}
E(j)_{\ideal q} \simeq E(j_i)_{\ideal q}
\end{equation*}
Let \(F = \Frac (\overline R/\ideal q)\), \(E = E(j)_{\ideal q}\), \(\ideal p = \ideal m /\ideal q\), let \(\alpha \) be the composition%
\begin{equation*}
\alpha  \colon E(j)_{\ideal q} \to E(j_i)_{\ideal q} \xrightarrow\sim E(j)_{\ideal q}\text{.}
\end{equation*}
So \(\alpha  \equiv  \alpha _0 \circ \sigma\) for \(\sigma  \in \Aut(E_0)\). We can lift automorphisms because \(\pm1 \) lift trivially and the only other possibilities are \(j(E_0) = 0,1728\) and these lift as \(E\colon y^2 = x^3 - 1,E\colon y^2 = x^3-x\) respectively.%
\end{proofptx}
If \(E_0\) is ordinary \(\End(E_0) = \ints_K = \ZZ+ \tau _0\ZZ\) then applying Deuring lifting to \((E_0, \tau _0)\) gives \((E, \tau )\) i.e.%
\begin{equation*}
\End(E) = \ZZ+ \tau  \ZZ \simeq \ints_K\text{.}
\end{equation*}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.6.3 Beginning of the proof of the Prop}
\typeout{************************************************}
%
\begin{subsectionptx}{Beginning of the proof of the Prop}{}{Beginning of the proof of the Prop}{}{}{g:subsection:idm204344094080}
\begin{proposition}{}{}{g:proposition:idm204344093648}%
%
\begin{equation*}
(\underline x. T_m \underline x^\sigma ) = \frac12 \sum_{n=1}^\infty  \#\Hom_{W/\pi _v^n}(\underline x^\sigma , \underline x)_{\deg m}
\end{equation*}
%
\end{proposition}
\begin{fact}{}{}{g:fact:idm204344092864}%
%
\begin{enumerate}
\item{}%
\begin{equation*}
\Hom_{W/\pi _v^{n+1}}(\underline x^\sigma , \underline x) \hookrightarrow \Hom_{W/\pi _v^n}(\underline x^\sigma , \underline x)
\end{equation*}
(4.5) in Gross-Zagier%
\item{}%
\begin{equation*}
\Hom_{W}(\underline x^\sigma , \underline x) = \bigcap_n \Hom_{W/\pi _v^n}(\underline x^\sigma , \underline x)
\end{equation*}
(4.5) in Gross-Zagier%
\item{}%
\begin{equation*}
\# \Hom_{W/\pi _v^n}(\underline x^\sigma , \underline x)_{\deg m} = r_{\mathscr A}(m)
\end{equation*}
%
\end{enumerate}
%
\end{fact}
Deuring lifting implies that \(\End_W(\underline x) \simeq \End_{W/\pi _v}(\underline x)\). Serre-Tate gives that Deuring lifting implies that \(\Hom_W(\underline x^\sigma , \underline x) \simeq \Hom_{W/\pi _v}(\underline x^\sigma , \underline x)\). The LHS is then zero via computing the intersection.%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.7 Serre-Tate theory (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Serre-Tate theory (Alex)}{}{Serre-Tate theory (Alex)}{}{}{x:section:sec-gz-serre-tate}
%
%
\typeout{************************************************}
\typeout{Subsection 6.7.1 Intro\slash{}background}
\typeout{************************************************}
%
\begin{subsectionptx}{Intro\slash{}background}{}{Intro\slash{}background}{}{}{g:subsection:idm204344088400}
We will work in generality following Katz's Serre-Tate Local Moduli \hyperlink{x:biblio:bib-katz-serre-tate}{[64]}. Note that Hida \hyperlink{x:biblio:bib-hida-geometric}{[61]} also has a modernized exposition of the same. The original ``source'' material is Woods hole notes, sketchy at best.%
\par
Recall that one thing we will try and do is to prove the following formula%
\begin{equation*}
(\underline x. T_m \underline x^\sigma ) = \frac12 \sum_{n=1}^\infty  \#\Hom_{W/\pi _v^n}(\underline x^\sigma , \underline x)_{\deg m}
\end{equation*}
%
\par
To do this we want to understand more about the special nature of Heegner points, representing pairs of CM elliptic curves. Angus told us last time about how to lift curves together with an endomorphism from \(\FF_q\) to a number field. The set of all lifts to positive characteristic of a given curve over a finite field, can be thought of as deformations of the given curve. The aim is to describe these deformations in terms of a simpler object.%
\par
We will work in generality, because it isn't really any harder, and makes it a bit clearer in some cases. That is we will work with \emph{abelian schemes} which are higher dimensional generalizations of elliptic curves (e.g. products of elliptic curves, weil restrictions, or jacobians of higher genus curves). You can replace abelian scheme with elliptic curve if you like and restrict to dimension \(g =1\). . We let \(R\) be a ring, and define the category%
\begin{equation*}
\mathrm{AbSch}(R) = \{\text{abelian schemes over} R\}\text{.}
\end{equation*}
%
\par
We will fix \(W\) a complete DVR with residue field \(\overline \FF_p\) (i.e. \(W\) could be the Witt vectors of \(\overline  \FF_p\)). Complete means that%
\begin{equation*}
W = W_\infty  =\varprojlim_{m} \underbrace{W/p^m}_{=W_m}
\end{equation*}
The for \(m =1,2,\ldots, \infty \) we let \(R\) be a base ring Given \(R\) ring we can reduce to the residue field, but this map is many to one, what is the smallest amount of data needed to recover \(A/R\) an abelian scheme from \(A_0/R_0\)?%
\par
Our rings today will probably all be complete local \(R\)-algebras.%
\par
Given any abelian scheme \(A/R\) over any ring we can form its \(p\)-divisible group, also known as a Barsotti-Tate group%
\begin{equation*}
A[p^\infty ]
\end{equation*}
this is ``p-divisible'' as given any \(p\)-power torsion point on \(A\) its division by \(p\) is also \(p\)-power torsion. Formally the definition is%
\begin{definition}{}{g:definition:idm204344072720}%
A \(p\)-divisible group \(G\) over \(R\) of height \(h\) is an inductive system%
\begin{equation*}
G = (G_v, i_v),\,v \ge 0
\end{equation*}
where each \(G\) is a finite group scheme over \(R\) of order \(p^{vh}\) and for each \(v\ge0\)%
\begin{equation*}
0 \to G_v \xrightarrow{i_v} G_{v+1} \xrightarrow{p^v} G_{v+1}
\end{equation*}
is exact, so \(i_v\) is the kernel of \(p^v\).%
\end{definition}
\begin{example}{}{g:example:idm204344067376}%
For normal abelian groups (i.e. constant group schemes) we must have%
\begin{equation*}
G_v = (\ZZ/p^v)^h
\end{equation*}
with%
\begin{equation*}
\lim G_v = (\QQ_p/\ZZ_p)^h\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{g:example:idm204344065936}%
For abelian varieties \(A\) of dimension \(d\) we have%
\begin{equation*}
(A[p^v], i_v\colon A[p^v] \hookrightarrow A[p^{v+1}])
\end{equation*}
of height \(h =2d\). Note this is true even in the supersingular case!%
\end{example}
Given a map of rings \(R \to R_0\) let the category of deformations be%
\begin{equation*}
\mathrm{Def}(R,R_0) =\{(A_0, G, \epsilon ) : A_0/R_0\text{ abelian scheme},\,G/R\text{ a }p\text{-divisible group},\,\epsilon \colon G_0 \to A_0 [p^\infty ]\}
\end{equation*}
\(\epsilon \) an isom of \(p\)-divisible groups ove \(R_0\). So these are abelian schemes over the ``small'' ring and a choice of compatible \(p\)-divisible group over the big ring.%
\par
With this setting we have a nice map as follows If \(R\) is a ring with \(p\) nilpotent, \(I \subseteq R\) a nilpotent ideal and \(R_0 = R/I\) then%
\begin{equation*}
\mathrm{AbSch}(R) \to \mathrm{Def}(R,R_0)
\end{equation*}
%
\begin{equation*}
A \mapsto (A_0, A[p^\infty ],A[p^\infty ]\otimes R_0 \simeq A_0 [p^\infty ])\text{.}
\end{equation*}
%
\begin{theorem}{Serre-Tate.}{}{g:theorem:idm204344057616}%
This functor is an equivalence of categories.%
\end{theorem}
Thus the set of deformations of a fixed \(A_0\) corresponds to deformations of \(A_0\lb p^\infty \rb \).%
\par
This is a kinda ridiculous theorem, it tells us that all the information in an abelian variety over \(R\) is contained in the reduction to \(R_0\) except the \(p^\infty\) torsion and the information of how this fits together.%
\par
Hence to study the abelian varieties over \(R\) reducing to a given \(A_{R_0}/R_0\) we can just study the \(p\)-divisible groups over \(R\) with an isomorphism to \(A_{R_0}\lb p^\infty\rb\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.7.2 Drinfeld's proof of Serre-Tate}
\typeout{************************************************}
%
\begin{subsectionptx}{Drinfeld's proof of Serre-Tate}{}{Drinfeld's proof of Serre-Tate}{}{}{g:subsection:idm204344051568}
Drinfeld's proof cleverly extracts the content common to both things we are lifting, the abelian scheme and the \(p\)-divisible group.%
\par
Let \(R\) be a local \(W_m\)-alg. \(I \subseteq R\) a nilpotent ideal with nilpotency index \(\nu + 1\), let \(R_0 = R/I\). \(N = p^t\) an integer s.t. \(N I = 0\). Given an \(R\)-algebra \(A\) we might consider%
\begin{equation*}
A/IA = A \otimes R_0
\end{equation*}
and also%
\begin{equation*}
A/\ideal m_A\text{.}
\end{equation*}
%
\par
So given a functor from \(R\)-algebras to an arbitrary abelian category%
\begin{equation*}
G \colon R\text{-alg}\to C
\end{equation*}
we have two natural \emph{subfunctors}%
\begin{equation*}
G_I \colon A \mapsto \ker( G(A) \to G(A\otimes R_0))
\end{equation*}
%
\begin{equation*}
\widehat G(A) \colon A \mapsto \ker(G(A) \to G(A/\ideal m_A))\text{,}
\end{equation*}
note that%
\begin{equation*}
G_I \subseteq \widehat G\text{.}
\end{equation*}
%
\par
What are formal groups?%
\begin{definition}{Formal groups.}{x:definition:def-gz-formal-gps}%
A \(n\)-dimensional \terminology{formal group} over a ring \(R\) is a power series%
\begin{equation*}
F(x,y) = (x_1, \ldots, x_n) + (y_1,\ldots,y_n) + O(\text{degree 2 terms}) \in (R[[x_1,\ldots, x_n,y_1,\ldots, y_n]])^n
\end{equation*}
that is associative in the sense that%
\begin{equation*}
F(F(x,y),z) = F(x,F(y,z))\text{.}
\end{equation*}
%
\par
The formal group is \terminology{commutative} if \(F(x,y) = F(y,x)\).%
\end{definition}
Given an abelian variety we can get a 1-dimensional formal group by completing at the origin. E.g. for an elliptic curve%
\begin{equation*}
y^2 = x^3 + ax +b
\end{equation*}
we can express \(x = x(t) =t^{-2} + \cdots\), \(y = -t^{-3} + \cdots\)%
\begin{equation*}
\frac{1}{t^{2}} - at^{2} - bt^{4} - a^{2}t^{6} - 3 a bt^{8} + \left(-2 a^{3} - 2 b^{2}\right)t^{10} - 10 a^{2} bt^{12} + \left(-5 a^{4} - 15 a b^{2}\right)t^{14} + \left(-35 a^{3} b - 7 b^{3}\right)t^{16} + \left(-14 a^{5} - 84 a^{2} b^{2}\right)t^{18} + O(t^{20})
\end{equation*}
%
\begin{equation*}
\frac{-1}{t^{3}} + at + bt^{3} + a^{2}t^{5} + 3 a bt^{7} + \left(2 a^{3} + 2 b^{2}\right)t^{9} + 10 a^{2} bt^{11} + \left(5 a^{4} + 15 a b^{2}\right)t^{13} + \left(35 a^{3} b + 7 b^{3}\right)t^{15} + \left(14 a^{5} + 84 a^{2} b^{2}\right)t^{17} + \left(126 a^{4} b + 84 a b^{3}\right)t^{19} + O(t^{20})
\end{equation*}
then the group law in terms of \(t\) is%
\begin{equation*}
t_{1} + t_{2} + \left(-2 a\right) t_{1}^{4} t_{2} + \left(-4 a\right) t_{1}^{3} t_{2}^{2} + \left(-4 a\right) t_{1}^{2} t_{2}^{3} + \left(-2 a\right) t_{1} t_{2}^{4} + \left(-3 b\right) t_{1}^{6} t_{2} + \left(-9 b\right) t_{1}^{5} t_{2}^{2} + \left(-15 b\right) t_{1}^{4} t_{2}^{3} + \left(-15 b\right) t_{1}^{3} t_{2}^{4} + \left(-9 b\right) t_{1}^{2} t_{2}^{5} + \left(-3 b\right) t_{1} t_{2}^{6} + \left(-2 a^{2}\right) t_{1}^{8} t_{2} + \left(8 a^{2}\right) t_{1}^{6} t_{2}^{3} + \left(16 a^{2}\right) t_{1}^{5} t_{2}^{4} + \left(16 a^{2}\right) t_{1}^{4} t_{2}^{5} + \left(8 a^{2}\right) t_{1}^{3} t_{2}^{6} + \left(-2 a^{2}\right) t_{1} t_{2}^{8} + O(t_{1}, t_{2})^{10}\text{.}
\end{equation*}
%
\par
In general an \(n\)-dimensional abelian variety gives an \(n\)-dimensional formal group.%
\par
Given a complete local ring \(R\) we can evaluate by substituting \(t\) for anything in the maximal ideal. So a formal group \(G\) defines a functor%
\begin{equation*}
G\colon \text{complete local }R\text{-algebras} \to \text{AbGrp}
\end{equation*}
%
\begin{equation*}
G(A) = (\ideal m_A)^n\text{with multiplication by }G\text{.}
\end{equation*}
%
\begin{lemma}{}{}{g:lemma:idm204344539808}%
Let \(G\) be a commutative formal group over \(R\), so  \(G_I,\widehat G\) are now sub-group functors. \(G_I\) is \(N^\nu\) torsion.%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204344537200}
We need to show that \(\lb N\rb a = 0\) for any \(a \in G_I(A) \subseteq G(A)\) for which \(a_i \in I\) for all \(i\). An element of \(G_I(A)\) has coordinates in \(IA\) and \(NR = 0\) so we have%
\begin{equation*}
(\lb N\rb a)_i = N a_i + \text{h.o.t.} \in N(IA) + (IA)^2 = (IA)^2
\end{equation*}
as \(R\) and hence \(A\) is \(N\) torsion, this gives inductively that%
\begin{equation*}
([N^\nu] a)_i \in (IA)^{2\nu}  =0
\end{equation*}
as \(I^{\nu + 1}   =0 \).%
\end{proofptx}
\begin{definition}{}{g:definition:idm204344531280}%
Given a covariant functor%
\begin{equation*}
G \colon \text{complete local} R-alg \to \text{AbGrp}
\end{equation*}
which for any faithfully flat finite type \(A \hookrightarrow C\) we have%
\begin{equation*}
G(A)\hookrightarrow G(C)
\end{equation*}
and ``the sheaf condition'' w.r.t \(A\hookrightarrow C\). Is called an fppf abelian sheaf.%
\end{definition}
\begin{example}{}{g:example:idm204344528480}%
%
\begin{equation*}
G(A) = E(A)
\end{equation*}
for \(E\) an abelian variety.%
\end{example}
\begin{lemma}{}{}{g:lemma:idm204344527264}%
Let \(G,H\) be fppf abelian sheaves. And set \(G_0, H_0\) the corresponding objects restricted to \(R_0\). Suppose%
\begin{enumerate}
\item{}\(G\) is \(p\)-divisible.%
\item{}\(\hat H\) is formal.%
\item{}\(H (R) \to H(R/J)\) surjective for any nilpotent \(J\) (this is known as formal smoothness of \(J\))%
\end{enumerate}
then%
\begin{enumerate}
\item{}Both%
\begin{equation*}
\Hom (G,H),\,\Hom(G_0,H_0)
\end{equation*}
are \(p\)-torsion free.%
\item{}The reduction mod \(I\)%
\begin{equation*}
\Hom(G, H) \to  \Hom(G_0, H_0)
\end{equation*}
is injective.%
\item{}For \(f_0 \in \Hom(G_0,H_0)\), there is a unique \(\Phi (G, H)\) with%
\begin{equation*}
\Phi \equiv  N^\nu f_0 \mod I
\end{equation*}
denote \(\Phi = \tilde N^\nu f \in \Hom(G,H) \otimes \QQ\)%
\item{}we get%
\begin{equation*}
f = \frac{\tilde N^\nu f}{N^\nu } \in \Hom (G,H)
\end{equation*}
%
\begin{equation*}
\iff
\end{equation*}
%
\begin{equation*}
\tilde N^\nu  (G[N^\nu  ] ) = 0
\end{equation*}
%
\end{enumerate}
%
\end{lemma}
\begin{proofptx}{}{g:proof:idm204344517088}
%
\begin{enumerate}
\item{}\(p\)-divisibility implies that if \(pf = 0\) so \(pf(x)=  0\) for all \(x\) then if \(py = x\) we have%
\begin{equation*}
f(x) = pf(y) =0
\end{equation*}
so \(f = 0\).%
\item{}We can write%
\begin{equation*}
0 \to H_I \to H \to H_0 \to 0
\end{equation*}
so that by left exactness of hom%
\begin{equation*}
0 \to \Hom(G, H_I) \to  \Hom(G, H) \to  \Hom(G, H_0) = \Hom(G_0, H_0)
\end{equation*}
so the second map is what we want so we want%
\begin{equation*}
\im(\Hom(G, H_I) \to \Hom(G,H)) = 0
\end{equation*}
rhs p-tors free, and \(H_I\) is killed by \(N^\nu \) (using formality of \(\hat H \) here and another lemma I didn't really state).%
\item{}Uniqueness follows from 2. so we just lift%
\begin{equation*}
f_0 \in \Hom(G_0, H_0)
\end{equation*}
to \(y \in H(A)\).%
\end{enumerate}
%
\end{proofptx}
Proof of serre tate:%
\par
As above \(N\) is a p-power killing \(I\), \(\nu \) an integer  such that \(I^{\nu + 1} = 0\). We can apply Drinfeld to each of \(A, A', A\lb p^\infty \rb, A'\lb p^\infty \rb , A_0\lb p^\infty \rb , A'_0 \lb p^\infty \rb \).%
\par
We show our functor is fully faithful ie.%
\begin{equation*}
\operatorname{Hom}_{\mathcal{A}}\left(A, A^{\prime}\right) \rightarrow \operatorname{Hom}_{D E F}\left(\left(A_{0}, A\left[p^{\infty}\right], \text { id }_{A_{0}}\right),\left(A_{0}^{\prime}, A^{\prime}\left[p^{\infty}\right], \text { id }_{A_{0}^{\prime}}\right)\right)
\end{equation*}
part 2. with \(G =A\), \(H = A'\) gives inj as an abvar is a p-div abelian fppf sheaf.%
\par
To show surjectivity apply part 3. of drinfeld with \(G = A\), \(H = A'\) to get a lift from each \(f_0\in \Hom(A_0, A_0')\) of \(N^\nu  f_0\) to%
\begin{equation*}
g = `` N^\nu f'' \in \Hom(A, A')
\end{equation*}
to satisfy part 4 we need that \(g\) kills \(A\lb N^\nu \rb \). We have \(N^\nu  f = g\) on \(A\lb p^\infty \rb \) and as  \(N\) is a \(p\)-power in fact \(A \lb  N^\nu \rb  \subseteq A\lb  p^\infty \rb \) is killed by \(N^\nu f\).%
\par
To prove essential surjectivity onto \((A_0, D, \phi )\), we lift \(A_0\) to \(X\) arbitrarily, and must match up the \(p\)-divisible group and iso. We have an isom \(\alpha _0 \lb p^\infty \rb  \to A_0 \lb p^\infty \rb \). And so a lift%
\begin{equation*}
g\colon  X[p^\infty ] \to D
\end{equation*}
\(N^\nu \alpha _0\) applying the lemma to \(G = X_0\lb p^\infty \rb \), \(H = D\). So we get an isogeny \(g\) and we quotient by the kernel.%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.8 Non-archimidean local heights and intersection theory (Oana)}
\typeout{************************************************}
%
\begin{sectionptx}{Non-archimidean local heights and intersection theory (Oana)}{}{Non-archimidean local heights and intersection theory (Oana)}{}{}{x:section:sec-gz-oana}
See Oana's notes%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.9 Wrap Up of Non-Archimedean Local Heights (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{Wrap Up of Non-Archimedean Local Heights (Sachi)}{}{Wrap Up of Non-Archimedean Local Heights (Sachi)}{}{}{x:section:sec-gz-sachi}
\begin{introduction}{}%
This will be a reminder \slash{} recap \slash{} overview of where we are at.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 6.9.1 Recap of Initial Motivation}
\typeout{************************************************}
%
\begin{subsectionptx}{Recap of Initial Motivation}{}{Recap of Initial Motivation}{}{}{g:subsection:idm204344492480}
Big motivation, finding infinite order points on elliptic curves, leads us to Gross-Zagier.%
\par
If \(J\) is the Jacobian of \(X_0(N)\), \(\Delta \lt  0\) a fundamental discriminant of an imaginary quadratic field \(K\).%
\begin{equation*}
s \colon \Cl_K \xrightarrow\sim \Gal HK\text{.}
\end{equation*}
%
\par
For any \(\mathcal A \in \Cl_K\), we define the partial theta series%
\begin{equation*}
\theta _{\mathcal A} (z) = \frac{1}{2u} + \sum _{a \subseteq \ints K,a\in \mathcal A} q^{\norm(a)} = \frac{1}{2u} + \sum_{n \ge 1} r_{\mathcal A}(n)q^n\text{.}
\end{equation*}
%
\begin{equation*}
r_{\mathcal A}(n) = \#\text{integral ideals in }\mathcal A\text{ of norm }n\text{.}
\end{equation*}
This series defines a modular form of weight 1 and level \(\Gamma _1(\Delta )\) with character%
\begin{equation*}
\epsilon (n) = \legendre{\Delta }{n} \colon  \ZZ \to \{\pm 1\}\text{.}
\end{equation*}
%
\par
For any \(f \in \sum a_n q^n \in S_2(\Gamma _0(N))^{\text{new}}\) we define%
\begin{equation*}
L_{\mathcal A} (f,s) = \sum_{n \ge 1, (n, \Delta  N_f) = 1} \legendre\Delta n^{1-2s} \sum_{n\ge 1}a_n r_{\mathcal A}(n)n^{-s}\text{.}
\end{equation*}
%
\begin{theorem}{Gross-Zagier.}{}{g:theorem:idm204344485408}%
The series%
\begin{equation*}
g_{\mathcal A} (z) = \sum_{m \ge 0} \pair c{T_m c^{s(A)}} q^m
\end{equation*}
is a modular form of weight 2 and level \(\Gamma _0(N)\) and%
\begin{equation*}
(f,g_{\mathcal A }) = \frac{u^2 \sqrt\Delta }{8\pi ^2} L'_{\mathcal A}(f,1)
\end{equation*}
where \(\pair \cdot \cdot \) is the Néron-Tate height pairing on%
\begin{equation*}
J(H)\times J(H) \to \RR\text{.}
\end{equation*}
%
\begin{equation*}
c = (x) - (\infty )
\end{equation*}
\(x\) a Heegner point over \(H\).%
\end{theorem}
Recall?: The Shimura correspondence%
\begin{theorem}{Kohnen-Shimura.}{}{g:theorem:idm204344480896}%
Let \(\epsilon \in \{\pm 1\}\)  then%
\begin{equation*}
\dim S_{k+\frac{1}{2}}^\epsilon  (\Gamma_0 (4N)) = \dim S_{2k}^\epsilon (\Gamma _0(N))
\end{equation*}
and for each Hecke eigenform%
\begin{equation*}
f = \sum_{n\ge 1} a_n q^n\in S^\epsilon _{2k} (\Gamma _0(N))
\end{equation*}
there is a 1-dimensional space of  forms \(g \in S_{k+1/2}^\epsilon (\Gamma _0(4N))\) whose fourier coefficients  \(c_m\) are related by%
\begin{equation*}
a_n c_m= \sum _{d|n} \legendre{-m}d d^{k-1}c_{mn^2/d^2}\text{.}
\end{equation*}
%
\end{theorem}
\begin{remark}{}{g:remark:idm204344477360}%
If \(f \) is a modular form attached to \(E\) an elliptic curve then \(g\) is weight \(3/2\).%
\end{remark}
Recall: To compute \(\pair ab\) compute as a sum of local height pairings. Néron-Tate local height for \(v\) a place of \(H\) has properties%
\begin{itemize}[label=\textbullet]
\item{}bi-additive, symmetric, continuous%
\item{}%
\begin{equation*}
a=\sum_P m_P P,\,b = \divisor f
\end{equation*}
with disjoint support then%
\begin{equation*}
\pair ab_v = \sum_P m_P |\log |f(P)||_v\text{.}
\end{equation*}
%
\end{itemize}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.9.2 Heights}
\typeout{************************************************}
%
\begin{subsectionptx}{Heights}{}{Heights}{}{}{g:subsection:idm204344472208}
Let \(v\) be a non-archimidean place, assume \(m\) is prime to \(N\). If \(v|p\) a place of \(H\) then \(H_v\) the completion \(\Lambda _v\) ring of integers and \(\pi \) uniformizer, \(\Lambda _v/\pi \) residue  field of cardinality \(q\). \(W\) the completion of the maximal unramified extension of \(\Lambda _v\).%
\begin{equation*}
\pair ab_v = -(A.B) _v \log q
\end{equation*}
where \(A,B\) are divisors on some regular model of \(X\) over  a DVR (like \(\Lambda _v\)) and \(A\) is fibral.%
\par
Working with \(c = (x)-(\infty )\) \(d = (x)-(0)\).%
\begin{equation*}
\pair c{T_m d^\sigma }_v = (\underline x. T_m \underline x^\sigma )\log q\text{.}
\end{equation*}
%
\par
So we need to compute a regular model for \(X_0(N)/\ZZ\). We need to identify components of \(T_m \underline x^\sigma \). Need to compute RHS explicitly to show%
\begin{equation*}
= \frac 12 \sum_{n\ge 1} \#\Hom _{W/\pi ^n} (\underline x ,\underline x^\sigma )_{\deg m}\text{.}
\end{equation*}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.9.3 Brief sketch of regular model}
\typeout{************************************************}
%
\begin{subsectionptx}{Brief sketch of regular model}{}{Brief sketch of regular model}{}{}{g:subsection:idm204344461200}
Recall pts on \(X_0(N)\) correspond to cyclic isogenies%
\begin{equation*}
\psi \colon E \to  E'
\end{equation*}
of degree \(N\). The Heegner points have \(\End(E) = \End(E') = \ints\) an order in \(K\). Similarly consider generalized elliptic curves and cyclic isogenies of degree \(N\).%
\par
These components are isomorphic to \(X_0(M) \otimes \ZZ/p\). They intersect at supersingular points \(E\xrightarrow \phi E'\) where both are supersingular. We have  a good understanding of where the cusps are.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.9.4 Homomorphsims}
\typeout{************************************************}
%
\begin{subsectionptx}{Homomorphsims}{}{Homomorphsims}{}{}{g:subsection:idm204344456656}
\(S\) complete local ring, \(k\) algebraically closed field%
\begin{equation*}
\underline x = (\phi  \colon E \to E')
\end{equation*}
%
\begin{equation*}
\underline y = (\psi  \colon F \to F')
\end{equation*}
points on \(X_0(N)(S)\) then homomorphisms \(\underline x \to \underline y\) are \(f\colon E\to F, f'\colon E'\to F'\) such that \(f' \phi = f \psi\). The set of such has a group structure inherited from \(F,F'\). This is a right module under \(\End_S(\underline x)\) by composition.%
\par
%
\begin{equation*}
\End_S(\underline x) = \ZZ, \text{ order in im quad }, \text{ order in indef. quat. alg.}
\end{equation*}
%
\begin{equation*}
\deg(f,f') = \deg f = \deg f'\text{.}
\end{equation*}
%
\par
To show above%
\begin{equation*}
(c.T_m d^\sigma ) = (\underline x. T_m \underline x^\sigma ) - (\underline x . T_m 0) - (\infty .T_m \underline x^\sigma ) + (\infty .T_m 0)
\end{equation*}
3 terms on right are 0.%
\par
Main difficulty. \(m\) prime to \(N\) and \(r_{\mathcal A} (m) = 0\).%
\begin{equation*}
(\underline x. T_m \underline x ^\sigma ) = \frac 12 \sum_{n\ge 1} \# \Hom _{W/\pi ^n}(\underline x ^\sigma , \underline x)_{\deg m}
\end{equation*}
%
\begin{remark}{}{g:remark:idm204344448240}%
This is a finite sum as \(x, T_mx^\sigma \) are relatively prime divisors there are no degree \(m\) isogenies from \(x^\sigma \) to \(x\). For large \(n\) therefore \(\Hom_{W/\pi ^n,\deg m} = \emptyset\).%
\end{remark}
we denote by \(h_n\) this RHS summand.%
\begin{proofptx}{}{g:proof:idm204344444576}
When \(p\)-splits Deuring lifting gives%
\begin{equation*}
\Hom_W (\underline x^\sigma ,\underline x) = \Hom_{W/\pi ^n}(\underline x^\sigma , \underline x)
\end{equation*}
for all \(n\). As \(r_{\mathcal A}(m)= 0\) we have no elements of degree \(m\).%
\par
If \(p\) is non-split%
\begin{equation*}
\End_W(\underline x) = \ints
\end{equation*}
an order in a quaternion algebra.%
\begin{equation*}
h_n(\underline x^\sigma , \underline x) _{\deg m} = \sum_{\underline y\in T_m \underline x} h_n(\underline y, \underline x)_{\deg 1}\qedhere
\end{equation*}
%
\end{proofptx}
Moral, can compute the fourier coefficients of \(g_{\mathcal A}\).%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.10 Rankin-Selberg (Aash)}
\typeout{************************************************}
%
\begin{sectionptx}{Rankin-Selberg (Aash)}{}{Rankin-Selberg (Aash)}{}{}{x:section:sec-gz-rankin-selberg}
\begin{introduction}{}%
Notation:%
\par
\(K\) imaginary quadratic field.%
\par
\(\mathscr A\) ideal class of \(K\)%
\par
\(D\) discriminant \(K\)%
\par
\(\epsilon (n) = \legendre{D}{n}\) associated Dirichlet character.%
\par
\(h = \#\Cl_K\).%
\par
\(w = 2u \) twice number of units.%
\par
\(f\in S_{2k}^{new}(\Gamma _0(N))\) for \(k\ge 1\). \((N,D) = 1\) write%
\begin{equation*}
f(z) = \sum_{n \ge 1} a(n) e^{2\pi i n z}
\end{equation*}
%
\begin{equation*}
L(f,s) = \sum a_n n^s
\end{equation*}
define%
\begin{equation*}
L_{\mathscr A } (f,s) = L^{(N}) (2s-2k +1 , \epsilon ) \cdot \sum_{n=1}^\infty  a(n) r_{\mathscr A} (n)n^{-s}
\end{equation*}
%
\begin{equation*}
L^{(N)}  = \sum _{(n,N) = 1} \epsilon (n) n^{-2s +2k -1}\text{.}
\end{equation*}
%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 6.10.1 Rankin's method}
\typeout{************************************************}
%
\begin{subsectionptx}{Rankin's method}{}{Rankin's method}{}{}{g:subsection:idm204344431856}
%
\begin{equation*}
\theta _{\mathscr A} (z) = \sum_{n=1}^\infty  r_{\mathscr A}(n) q^n \in S_1(|D|, \epsilon )
\end{equation*}
%
\begin{equation*}
\frac{\Gamma (s+2k -1)}{(4\pi )^{s+2k-1}} \cdot \sum_{n=1}^\infty \frac{a(n) r_{\mathscr A}(n)}{n^{s+2k-1}}
\end{equation*}
%
\begin{equation*}
= \int_0^\infty  \sum_{n=1}^\infty  a(n)r_{\mathscr A}(n) e^{-4\pi n y} y^{s+2k-2} \diff y
\end{equation*}
%
\begin{equation*}
= \int_0^\infty  \int_0^1 f(x+iy) \overline{\theta _{\mathscr A} (x+iy)} \diff x y^{s+2k -2 } \diff y
\end{equation*}
%
\begin{equation*}
= \int\int_{\Gamma _\infty \backslash \HH} f(z) \overline{\theta _{\mathscr A} (z)} \diff x \diff y/y^2
\end{equation*}
%
\begin{equation*}
= ?????
\end{equation*}
%
\par
Choose \(\mathcal F\) to be a  fundamental domain for \(\Gamma _0(M)\) where \(M = N|D|\) consider%
\begin{equation*}
\bigcup _{\gamma \in \Gamma _\infty \backslash \Gamma _0(M) } \gamma  \mathcal F
\end{equation*}
have%
\begin{equation*}
\sum_{\gamma \in \Gamma _\alpha \backslash \Gamma _0(M)} \int \in_{\gamma \mathcal F} f(z) \overline{\theta _{\mathscr A}(z)} y^{s+2k} \frac{\diff x\diff y}{y^2}
\end{equation*}
%
\begin{equation*}
= \int\int _{ \mathcal F} f(\gamma z) \overline{\theta _{\mathscr A}(\gamma z)} (\Im \gamma  z)^{s+2k} \frac{\diff x\diff y}{y^2}
\end{equation*}
%
\par
%
\begin{equation*}
\sum_{\gamma  =\pm \begin{pmatrix} \bullet \amp \bullet \\\ c \amp d \end{pmatrix} \in  \Gamma _\infty  \backslash \Gamma _0(M)} \int\int_{\mathcal F} f(z) \overline{\theta _{\mathscr A}(z)}
\end{equation*}
%
\begin{equation*}
More formulae
\end{equation*}
%
\par
%
\begin{equation*}
\frac{\Gamma (s+2k-1)}{(4\pi )^{s+2k-1}} L_{\mathscr A }(f, s+2k-1)
\end{equation*}
%
\begin{equation*}
= \int\int_{\mathcal F} f(z) \overline{\theta _{\mathscr A}(z) E_s(z)} y^{2k} \frac{\diff x\diff y}{y^2}
\end{equation*}
%
\begin{equation*}
= (f, \theta _{\mathscr A} f)_{\Gamma _0(N)}
\end{equation*}
%
\par
%
\begin{equation*}
E_s(z) = \frac 12 \sum_{c,d\in \ZZ,\,c \equiv  0 \pmod M} \frac{\epsilon (d)}{(cz+d)^{2k-1}} \frac{y^s}{|cz+d|^{2s}}
\end{equation*}
want to take \((d,M) =1\) to \((d, N)=1\) .%
\par
we resolve this by letting%
\begin{equation*}
\tr_N^M \colon \widetilde M_{2k}(\Gamma _0(M)) \hookrightarrow \widetilde M_{2k}(\Gamma _0(N))
\end{equation*}
%
\begin{equation*}
g \mapsto \sum _{\gamma \in \Gamma _0(M)\backslash \Gamma _0(N)} g|_{2k} \gamma 
\end{equation*}
%
\par
%
\begin{equation*}
(f,g)_{\Gamma _0(M)} = (f,\tr_N^M f)_{\Gamma _0(N)}
\end{equation*}
so%
\begin{equation*}
(4\pi )^{-s-2k +1} \Gamma (s+2k-1) L_{\mathscr A}(f, s+2k-1)= (f, \tr_N^M \theta _{\mathscr A}E_s)
\end{equation*}
%
\begin{proposition}{}{}{g:proposition:idm204344420944}%
\(D\) a fundamental discriminant%
\begin{equation*}
N \ge 1
\end{equation*}
prime to \(D\).%
\begin{equation*}
\tilde \phi _s(z) = \tr_N^{DN}
\end{equation*}
%
\end{proposition}
Then for \(f\in S_{2k}^{new}(\Gamma _0(N))\)%
\begin{equation*}
(4\pi )^{-s-2k +1} N^s\Gamma (s+2k-1) L_{\mathscr A}(f, s+2k-1)= (f, \tilde \phi _s)
\end{equation*}
%
\par
Computing the trace%
\begin{equation*}
\tilde \phi _s = \epsilon _s(Nz) \theta _{\mathscr A}(z) U_{|D|} ???
\end{equation*}
where%
\begin{equation*}
\epsilon _s= \frac{\sum_{D= D_1\cdot D_2} \epsilon _{D_1}(N) \chi _{D_1D_2}(\mathscr A) E_s ^{(D_1)} (|D_2|z)}{\kappa (D_1) |D_1|^{s+2k-1}}
\end{equation*}
\(D\) odd \(\equiv 1\pmod 4\) \(D_1,D_2\) fund disc. \(\chi _{D_1,D_2}\) genus character \(\chi_{(a)} = \epsilon _{D_1}(N(a) ) = \epsilon _{D_2}(N(a))\) for ideal prime to \(D\) with \(\kappa  = 1 , D_1\gt 0\), \(\kappa = i\) \(D_2 \lt 0\).%
\begin{equation*}
E_s^{(D_1)} (z) =\frac 12 \sum_{m,n \in \ZZ,\,D_2 |m} \frac{\epsilon _1(m)\epsilon _2(n) y^s}{(mz+n)^{2k-1}{|mz+n|}^{2s}}
\end{equation*}
%
\begin{equation*}
U_n \colon  f(z) \mapsto \frac 1n \sum_{j\pmod n} f\left(\frac{z+j}{n}\right)
\end{equation*}
on a function \(f\) of period 1.%
\par
Fourier coefficients. Consider%
\begin{equation*}
\epsilon _s(z) = \sum_{n\in \ZZ} e_s(n,y) e(nx)
\end{equation*}
%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.11 A gallimaufry of applications (of Gross-Zagier) I (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{A gallimaufry of applications (of Gross-Zagier) I (Alex)}{}{A gallimaufry of applications (of Gross-Zagier) I (Alex)}{}{}{x:section:sec-gz-applications-i}
%
%
\typeout{************************************************}
\typeout{Subsection 6.11.1 Heegner points on rank 1 curves}
\typeout{************************************************}
%
\begin{subsectionptx}{Heegner points on rank 1 curves}{}{Heegner points on rank 1 curves}{}{}{g:subsection:idm204344410480}
\begin{quote}%
The fun of the subject seems to me to be in the examples.%
\nopagebreak\par%
\hfill\textemdash{}{\setlength{\tabcolsep}{0pt}\begin{tabular}[t]{l@{}}
Gross - Letter to Birch 1982
\end{tabular}}\\\par
\end{quote}
So let's do some examples of Heegner point computations, and see how Gross-Zagier gives us important information in a few ways.%
\par
Following the algorithm in Cohen, Number theory part I.%
\par
Fix an elliptic curve \(E(\QQ)\) of conductor \(N\), we are interested in finding \(E(\QQ)\). All elliptic curves over \(\QQ\) are now known to be modular and hence we may make use of the parameterisation%
\begin{equation*}
\phi_N \colon X_0(N) \hookrightarrow J_0(N) \twoheadrightarrow E\text{.}
\end{equation*}
Over \(\CC\) the modular curve is classically%
\begin{equation*}
\mathcal H / \Gamma_0(N)
\end{equation*}
and if \(E = E_f\) for \(f=  \sum a_n q^n\) we have \(\Phi_w \colon \CC/\Lambda_E \to E(\CC)\). Then the modular parameterisation comes down to%
\begin{equation*}
\phi(\tau) = \phi_w(z_\tau) = \phi_w\underbrace{\left( c\int_{i\infty}^\tau 2\pi i f(z) \diff z\right)}_{c\sum_{n=1}^\infty \frac{a_n}{n} q^n}
\end{equation*}
%
\begin{equation*}
\phi \colon X_0(N) \to \CC/\Lambda \text{.}
\end{equation*}
%
\par
So integrating the \(q\)-expansion of a modular form and plugging in \(\tau\) gives us the corresponding point in the complex uniformization of the curve because the Abel-Jacobi map is defined by integration.%
\begin{definition}{}{g:definition:idm204344401664}%
We have \(\tau \in \HH\) \terminology{CM points} if they satisfy an equation%
\begin{equation*}
A \tau ^2 + B'\tau  + C  = 0
\end{equation*}
%
\begin{equation*}
A,B,C \in \ZZ
\end{equation*}
%
\begin{equation*}
\Delta (\tau ) = B^2 - 4AC \lt 0
\end{equation*}
when we choose%
\begin{equation*}
A \gt 0
\end{equation*}
%
\begin{equation*}
(A,B,C) = 1
\end{equation*}
then%
\begin{equation*}
Ax^2 + Bxy + Cy^2
\end{equation*}
is the associated quadratic form. A \terminology{Heegner point} of level \(N\) is one for which%
\begin{equation*}
\Delta (N\tau ) = \Delta (\tau )\text{.}
\end{equation*}
%
\end{definition}
Proposition \(8.6 .3 .\) Let \(\tau \in \mathcal{H}\) be a quadratic irrationality and let \((A, B, C)\) be the quadratic form with discriminant \(D\) associated with \(\tau\). Then \(\tau\) is a Heegner point of level \(N\) if and only if \(N | A\) and one of the following equivalent conditions is satisfied:%
\begin{enumerate}
\item{}%
\begin{equation*}
\operatorname{gcd}(A / N, B, C N)=1
\end{equation*}
%
\item{}%
\begin{equation*}
\operatorname{gcd}(N, B, A C / N)=1
\end{equation*}
%
\item{}There exists \(F \in \mathbb{Z}\) such that \(B^{2}-4 N F=D\) with \(\operatorname{gcd}(N, B, F)=1\)%
\end{enumerate}
%
\begin{corollary}{}{}{g:corollary:idm204344390608}%
If \(\tau \) is heegner level \(N\) disc \(D\) so is%
\begin{equation*}
W(\tau ) = -1/(N\tau )\text{.}
\end{equation*}
%
\end{corollary}
Proposition 8.6.6. There is a one-to-one correspondence between on the one hand classes modulo \(\Gamma_{0}(N)\) of Heegner points of discriminant \(D\) and level \(N,\) and on the other hand, pairs \((\beta,[\mathfrak{a}\))] where \(\beta \in \mathbb{Z} / 2 N \mathbb{Z}\) is such that \(b^{2} \equiv D(\bmod 4 N)\) for any lift \(b\) of \(\beta\) to \(\mathbb{Z}\), and \([\mathfrak{a}\) \textbackslash{}in \textbackslash{}Cl(K)] is an ideal class. The correspondence is as follows: if \((\beta,[\mathfrak{a}\))] is as above, there exists a primitive quadratic form \((A, B, C)\) whose class is equal to [a] and such that \(N | A\) and \(B \equiv \beta(\bmod 2 N),\) and the corresponding Heegner point is \(\tau=(-B+\sqrt{D}) /(2 A) .\) Conversely, if \((A, B, C)\) is the quadratic form associated with a Heegner point \(\tau\) we take \(\beta=B\) mod \(2 N\) and \(\mathfrak{a}=\mathbb{Z}+\tau \mathbb{Z}\).%
\par
The action of Galois (via the main theorem of CM) shows that the image \(\phi (\tau )\) is defined over \(H\) the hilbert class field of \(K\). To get back down to \(K\) we take traces%
\begin{equation*}
P=\sum_{\sigma \in \operatorname{Gal}(H / K)} \varphi((\beta,[\mathfrak{a}]))^{\sigma}=\sum_{[\mathfrak{b}] \in \Cl(K)} \varphi\left(\left(\beta,\left[\mathfrak{a} \mathfrak{b}^{-1}\right]\right)\right)=\sum_{[\mathfrak{b}] \in \Cl(K)} \varphi((\beta,[\mathfrak{b}]))
\end{equation*}
%
\par
Lemma 8.6.8. If \(\varepsilon=-1\), then in fact \(P \in E(\mathbb{Q})\) Proof. Indeed, it is easy to see that \(\varepsilon=-1\) is equivalent to saying that \(\varphi \circ W=\varphi,\) so that%
\begin{equation*}
\varphi((\beta,[\mathfrak{b}]))=\overline{\varphi(W(\beta,[\mathfrak{b}]))}=\overline{\varphi\left(\left(-\beta,\left[\ideal b \mathfrak{n}^{-1}\right]\right)\right)}=\varphi\left(\left(\beta,\left[\mathfrak{b}^{-1} \mathfrak{n}\right]\right)\right) \] hence \[ \begin{aligned} \bar{P}=\amp \sum_{[\mathfrak{b}] \in \Cl(K)} \varphi\left(\left(\beta,\left[\mathfrak{b}^{-1} \mathfrak{n}\right]\right)\right)=\sum_{[\mathfrak{b}] \in Cl(K)} \varphi((\beta,[\mathfrak{b}]))=P \end{aligned} 
\end{equation*}
so by Galois theory once again we deduce that \(P \in E(\mathbb{Q})\)%
\par
Similarly if \(\epsilon  =1\) then \(P+ \overline P\) is torsion.%
\par
We have the Gross-Zagier formula%
\begin{equation*}
\widehat{h}(P)=\frac{\sqrt{|D|}}{4 \operatorname{Vol}(E)} L^{\prime}(E, 1) L\left(E_{D}, 1\right)
\end{equation*}
which tells us the height of Heegner%
\par
In rank 1 \(P = \ell G\) for some generator \(G\) of mordell-weil then GZ + BSD%
\begin{equation*}
\frac{\ell^{2}}{|\operatorname{III}(E)|}=\omega_{1}(E) \frac{c(E) \sqrt{|D|}}{4 \operatorname{Vol}(E)\left|E_{t}(\mathbb{Q})\right|^{2}} L\left(E_{D}, 1\right)
\end{equation*}
%
\par
To compute we evaluations of \(\phi ((-B+ D)/(2A))\) for the \(|Cl(K)|\) classes of quadratic forms \((A, B, C)\).%
\par
the convergence of the series for \(\phi(\tau)\) is essentially that of a geometric series with ratio \(\exp (-2 \pi \Im(\tau))=\exp (-2 \pi \sqrt{|D|} /(2 A))\)%
\par
We can use%
\begin{equation*}
\overline{\varphi((\beta,[\mathfrak{a}]))}=\varphi\left(\left(\beta,\left[\mathfrak{a}^{-1} \mathfrak{n}\right]\right)\right)
\end{equation*}
to halve the work we do.%
\par
So the heegner point method is%
\begin{enumerate}
\item{}via BSD find%
\begin{equation*}
|\operatorname{III}(E)| R(E)=\frac{\left|E_{t}(\mathbb{Q})\right|^{2} L^{\prime}(E, 1)}{c(E) \omega_{1}(E)}
\end{equation*}
%
\item{}find \(HB\) the height difference bound between canonical and naive heights%
\begin{equation*}
HB = h(j(E)) / 12+\mu(E)+1.946
\end{equation*}
%
\item{}%
\begin{equation*}
d=2(|\operatorname{III}(E)| R(E)+H B)
\end{equation*}
%
\begin{equation*}
d d=\lceil d / \log (10)\rceil+10
\end{equation*}
this is the number of decimal digits we will work with%
\item{}Run through fundamental discs \(D\) for each. Check \(D\) square mod \(4N\) all primes split and%
\begin{equation*}
L\left(E_{D}, 1\right)=2 \sum_{n \geq 1} \frac{a_{n}}{n}\left(\frac{D}{n}\right) \exp \left(\frac{-2 \pi n}{\sqrt{N D^{2} / \operatorname{gcd}(D, N)}}\right)
\end{equation*}
not too close to zero if this is not satisfied, choose the next fundamental discriminant. Otherwise fix \(\beta \in\) \(\mathbb{Z} /(2 N) \mathbb{Z}\) such that \(D \equiv \beta^{2}(\bmod 4 N)\) and compute \(m>0\) such that%
\begin{equation*}
m^{2}=\omega_{1}(E) \frac{c(E) \sqrt{|D|}(w(D) / 2)^{2}}{4 \operatorname{Vol}(E)\left|E_{t}(\mathbb{Q})\right|^{2}} 2^{\omega(\operatorname{gcd}(D, N))} L\left(E_{D}, 1\right)
\end{equation*}
This m should be very close to an integer, or at least to a rational number with small denominator.%
\item{}Find List of Forms below, compute a list \(L\) of \(|\Cl(K)|\) representatives \((A, B, C)\) of classes of positive definite quadratic forms of discriminant \(D\), where \(A\) must be chosen divisible by \(N\) and minimal, and \(B \equiv \beta(\bmod 2 N)\) (this is always possible). Whenever possible pair elements \((A, B, C)\) and \(\left(A^{\prime}, B^{\prime}, C^{\prime}\right)\) of this list such that \(\left(A^{\prime}, B^{\prime}, C^{\prime}\right)\) is equivalent to \((C N, B, A / N)\) by computing the unique canonical reduced form equivalent to each.%
\item{}%
\begin{equation*}
z=\sum_{(A, B, C) \in \mathcal{L}} \phi\left(\frac{-B+\sqrt{D}}{2 A}\right) \in \mathbb{C}
\end{equation*}
taking a few more than \(A d /(\pi \sqrt{|D|})\) terms for \(\phi \).%
\item{}Find Rational Point Let \(e\) be the exponent of the group \(E_{t}(\mathbb{Q}),\) let \(\ell=\) \(\operatorname{gcd}\left(e, m^{\infty}\right)=\operatorname{gcd}\left(e, m^{3}\right),\) and \(m^{\prime}=m \ell .\) For each pair \((u, v) \in\left[0, m^{\prime}-\right.\) \(1\)\textasciicircum{}\textbraceleft{}2\textbraceright{},] set \(z_{u, v}=\left(\ell z+u \omega_{1}(E)+v \omega_{2}(E)\right) / m^{\prime}\). Compute \(x=\wp\left(z_{u, v}\right),\) where \(\left(\wp, \wp^{\prime}\right)\) is the isomorphism from \(\mathbb{C} / \Lambda\) to \(E(\mathbb{C})\). For each \((u, v)\) such that the corresponding point \((x, y) \in E(\mathbb{C})\) has real coordinates.%
\end{enumerate}
%
\par
Algorithm choice of D%
\par
Recall a congruent number is a number which appears as the area of a right triangle with rational side lengths. this reduces to finding non-torsion points on the congruent number curves%
\begin{equation*}
E_n \colon  y^2 = x^3 - n^2 x\text{.}
\end{equation*}
E.g. for \(n = 157\) BSD predicts rank 1, but how do we find the point? Using standard techniques can compute real period, period volume (\(0.209262974439979^2\)) and torsion order (4), conductor (788768 outside LMFDB range) and Tamagawa product (8). Together we get%
\begin{equation*}
|\Sha(E)|R(E) \approx 54.6
\end{equation*}
%
\begin{equation*}
HB = 10.6
\end{equation*}
%
\begin{equation*}
d \approx 130.4
\end{equation*}
need 67 decimal digits.%
\par
Up to \(D = -40\) we have \(D =-31,-39\) are squares modulo \(4N\).%
\par
For both of these  \(D \) we try to compute \(m^2(D)\). When we take \(-31\) we get a number close to 0. For \(-39\) we get \(\approx 16\) so fix \(D = -39\) and \(m=4\).%
\par
A square root \(b\) of \(D\) mod \(4N\) is%
\begin{equation*}
b = 1275547\text{.}
\end{equation*}
%
\par
The class group of%
\begin{equation*}
\QQ(\sqrt{-39})
\end{equation*}
is%
\begin{equation*}
\ZZ/4\text{.}
\end{equation*}
%
\begin{equation*}
z = 2\Re(\phi (x_1) + \phi (x_2))
\end{equation*}
for%
\begin{equation*}
x_i = (-b + \sqrt{-39})/(2j N)
\end{equation*}
So we have four classes of quadratic forms, of these the largest value of \(A\) is \(2N\). So we need%
\begin{equation*}
\approx 10 500 000
\end{equation*}
terms of the series%
\begin{equation*}
\phi (\tau ) = \sum_{n=1}^\infty  \frac{a_n}{n} q^n,\,q = \exp(2\pi i \tau )
\end{equation*}
applying this we get%
\begin{equation*}
z = -5.63911127500831766007696166307316036323562406574706\ldots
\end{equation*}
we can add multiples of the period lattice to make it smaller, as%
\begin{equation*}
z/\omega \approx -26.9469552131277
\end{equation*}
we find that%
\begin{equation*}
z' = z + 27 \omega  \approx 0.0111003098794358
\end{equation*}
so that%
\begin{equation*}
\wp(\Lambda , (2 z' + 2 \omega )/8) \approx 344.99665832468973990799841297983141563953148876481
\end{equation*}
this we can recognise as%
\begin{equation*}
\frac{95732359354501581258364453}{526771095761^2}
\end{equation*}
(using the fact we are looking for something with square denominator) and compute the point%
\begin{equation*}
\left(\frac{95732359354501581258364453}{526771095761^2} : \frac{834062764128948944072857085701103222940}{526771095761^3} : 1\right)
\end{equation*}
which is quite a big triangle. This is saturated and of height \(54.6008892940170\).%
\begin{remark}{}{g:remark:idm204343264192}%
Calling the sage function \mono{gens()} fails on this example!%
\end{remark}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.12 A gallimaufry of applications (of Gross-Zagier) II (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{A gallimaufry of applications (of Gross-Zagier) II (Alex)}{}{A gallimaufry of applications (of Gross-Zagier) II (Alex)}{}{}{x:section:sec-gz-applications-ii}
%
%
\typeout{************************************************}
\typeout{Subsection 6.12.1 More on computation}
\typeout{************************************************}
%
\begin{subsectionptx}{More on computation}{}{More on computation}{}{}{g:subsection:idm204343262496}
A more advanced trick: We have the standard Heegner point outlined above, there are several speedups possible:%
\begin{enumerate}
\item{}Use Atkin-Lehner involutions to reduce the size of \(A\) in \((A,B,C)\).%
\item{}Use faster algorithms for point counting, e.g. on CM curves we have a simpler expression for \(a_p\)'s which can be computed with Cornichias algorithm.%
\item{}Cremona-Silverman: Want to reduce the precision needed, how? What information do we know after running the method, an approximation of \(Q\approx P \in E(\RR)\). We also know by Gross-Zagier%
\begin{equation*}
\hat h(P)\text{.}
\end{equation*}
If%
\begin{equation*}
x(P) = \frac{n}{d^2}
\end{equation*}
then%
\begin{equation*}
2 \log (d)=\widehat{h}(P)-\widehat{h}_{\infty}(P)-\sum_{p | N \atop {p \nmid d \atop p^{2} | \operatorname{disc}(E)}} \widehat{h}_{p}(P)\text{.}
\end{equation*}
Using \(Q\) we can compute%
\begin{equation*}
\hat h_\infty (P)\text{.}
\end{equation*}
For each \(\hat h_p\) there are only finitely many possibilities, and so in total we have finitely many possible values of%
\begin{equation*}
\widehat{h}(P)-\widehat{h}_{\infty}(P)-\sum_{p | N \atop {p \nmid d \atop p^{2} | \operatorname{disc}(E)}} \widehat{h}_{p}(P)
\end{equation*}
giving finitely many possible \(d\) values, from which%
\begin{equation*}
numerator (x(P)) = round(x(P) d^2)
\end{equation*}
can be found. In all this allows us to work as we wanted, with an accuracy slightly more than half.%
\end{enumerate}
%
\par
These speed ups are in PARI\slash{}GP and Remarks. as \(E\) in last times example is a CM curve, the computation time of the above example can be reduced from a couple of minutes to 7 seconds (factor of 20).%
\par
Gotta get height:%
\begin{example}{A big example.}{g:example:idm204343253472}%
Let%
\begin{equation*}
E\colon y^2 = x^3 + \underbrace{2^{5} \cdot 3^{3} \cdot 5^{5} \cdot 7^{3} \cdot 11^{5} \cdot 13^{4}}_{=4259854045547100000}
\end{equation*}
be a Mordell curve. We can compute that the analytic rank is 1 and that%
\begin{equation*}
L(E,1) \approx 28.43512495
\end{equation*}
We need an imaginary number field in which \(2,3,5,7,11,13\) all split, the smallest such is%
\begin{equation*}
K = \QQ(\sqrt{-1559})\text{.}
\end{equation*}
So this \(D = D_K = -1559\) is the smallest possible Heegner discriminant followed by \(-2999,-3071,-5711,-6431,-6551,-8399,-8711,-9071,-9239\). We can also compute that the twist \(E_D\) has analytic rank 0 and%
\begin{equation*}
L(E_D,1) \approx 0.34784
\end{equation*}
We can ask Pari\slash{}GP for a Heegner point and we obtain%
\begin{equation*}
P=  (2673768366314301463225804132167786458743211296161665928714089443034915780624646102119694052638661139083614147052130407079631451208185292430763007319638022105825501399385761185566630883388394680375240310954529690758647194911112230527266639143771344809007916379476769393746579657952261851411688268671539912820072222763224027388823804772192104547803223898847305487037661307828748844799602593905135066916765339004127610241/14711766058713677663384943791747898516946843571332438782108054674511943585256352373257820891021633925632603928846607462754678923049647017632180676816464079929265454994902080754858496848491578669209122991110372607577751981118650453474461080043444438030297579085121835217242209089550661820106126782163015526489468149613211400477191028795214873959696995779238660836093943085146259968306971312571346641475392784100 : 138256584957437413549697979638187560540459292802582866047104251079871173001665466386110481033185180290975183359260945144859657131458366183036141245306630348292671101486345526463132664316934927829557544796041549654148869945306252397609306930530983551604764354393433405906021719607528424338682185259543058868693501829232087760637049066670461122157567207439393246729072214062375989571116431670132631712767339509965920423129094613543923419661857943413970492292794841174646487317425335124224816154049239888798416706708946385513743341645910420176133057435782209340663561195089350700342411480965751945453146090192411927796854564432961/56428332331562671615794363625451656023382470684636509020204202990180688177696621616970962649738545712542796767776584129330909917100366186924013354291641329738822701259890430806380424060475365542745244595324918343297529518263108027693527497847179482876257977247331950705161864795745543796461954042373098284699960118594562408063763160815610542420513488629513957169549566241725330887507912166227023322296844673603178204516200038314906488548391012692454233921581644355608983371337760875769764741031620675341450340457565846005848812354464193992153964872086150518588699778897808812845613993026309040085527357183723889000 : 1)
\end{equation*}
this has naïve height \(2.67 \times 10^{417}\) (numerator of the \(x\)-coord) and (logarithmic) canonical height \(\approx 956.282209515622\).%
\par
By saturating we find that in fact \(P  = 2\cdot Q\) where \(Q\) has canonical height%
\begin{equation*}
956.282209515622/4 \approx 239.070552378906\text{.}
\end{equation*}
And%
\begin{equation*}
Q =(8868405892624209482831543296890050376591681305386772268723757017948071928478387800757391866726575892769529/12199065318293186020638466216615329130692308979647554152111639302853625564281014711694611565598225 : 835157422328503915572710156100004478252440344488413901374204905998433900560826559924171903629096959304261439875564863428904842353573598701320904439166984417667/42607871079159903759545082718655204271158039869031410587066955866681866212965161047419746875287012910440605581735106219437475107311541956522410375 : 1)\text{.}
\end{equation*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.12.2 Gauss's class number problem}
\typeout{************************************************}
%
\begin{subsectionptx}{Gauss's class number problem}{}{Gauss's class number problem}{}{}{g:subsection:idm204343244640}
Gauss was interested in binary quadratic forms and did a lot of computations with them. He in particular conjectured that%
\begin{conjecture}{Gauss.}{}{g:conjecture:idm204343243840}%
As \(D \to- \infty \) runs through fundamental discriminants the class numbers of imaginary quadratic fields%
\begin{equation*}
h(D ) = h(\QQ(\sqrt{D})) \to \infty 
\end{equation*}
also. (i.e. there are only finitely many imaginary quadratic fields of any given class number).%
\end{conjecture}
%
\begin{equation*}
\begin{array}{|c|c|c|c|c|c|}
\hline
h(D)                   \amp {1} \amp {2} \amp {3} \amp {4} \amp {5} \\
\hline
\# \text { of fields } \amp {9} \amp {18} \amp {16} \amp {54} \amp {25} \\
\hline
\text { largest } {|D |}\amp{163} \amp {427} \amp {907} \amp {1555} \amp {2683} \\
\hline
\end{array}
\end{equation*}
%
\par
The most famous instance of this being the first column. The Gauss class number 1 problem (Section 303 of his Disquisitiones Arithmeticae (1798)) there are only 9 imaginary quadratic fields of class number 1. This was first proved by Heegner, where he introduced analytic techniques into the field of elliptic curves, hence the name  Heegner points. Warning: this is somewhat distinct and not exactly what we will mention now%
\par
The first instances of the small class number phenomenon go back to Euler who noted that%
\begin{equation*}
x^2 - x + 41
\end{equation*}
was prime for \(0 \le x \le 40\) (the maximum possible), Euler called such numbers lucky and could not find more.%
\par
We now know that this is due to \(\QQ(\sqrt{-163})\) having class number one, hence all small primes remaining inert. If a small prime split we would have an element of small prime norm, but the norm form shows this is not possible. Explicitly all primes less than%
\begin{equation*}
\frac{1 + |D_K|}4
\end{equation*}
are inert.%
\par
Even when \(h(D) \gt 1\) we still observe a similar phenomenon.%
\par
For \(\QQ(\sqrt{-427})\) as above we have of the primes up to \((1 + 427)/4 = 107\) only \(17,31,59,89,101\) are split (\(7,61\) ramified).%
\par
Why am I telling you this? Because it leads to the following theorem:%
\begin{theorem}{Goldfeld.}{}{g:theorem:idm204343234944}%
Let \(D\) be a fundamental discriminant of an imaginary quadratic field. If there exists a modular elliptic curve \(E\) (defined over \(\QQ\)) whose associated base change Hasse-Weil \(L\)-function%
\begin{equation*}
L_{E / \QQ(\sqrt{D})}(s)
\end{equation*}
has a zero of order \(\geq 4\) at \(s=1\) then for every \(\epsilon>0\), there exists an effective computable constant \(c_{\epsilon}(E)>0\), depending only on \(\epsilon, E\) such that%
\begin{equation*}
h(D)>c_{\epsilon}(E)(\log |D|)^{1-\epsilon}\text{.}
\end{equation*}
%
\end{theorem}
Here%
\begin{equation*}
L_{E / \QQ(\sqrt{D})}(s)
\end{equation*}
has \(L_E\) as a factor so Goldfeld needed an elliptic curve \(E/\QQ\) with%
\begin{equation*}
\ord_{s=1} L_E(s) = 3
\end{equation*}
that is analytic rank 3, to obtain the order 4 vanishing of%
\begin{equation*}
L_{E / \QQ(\sqrt{D})}(s)\text{.}
\end{equation*}
%
\par
The bounds in this proof can be completely explicit, leading to lists of all imaginary quadratic fields with class number below \(100\).%
\par
If \(\chi _D = \legendre{D}{\bullet}\) is the associated character to \(\QQ(\sqrt{D})\) of small class number we therefore have%
\begin{equation*}
L(s,\chi _D) = \prod_p \left(1-\frac{\chi _D(p)}{p^s}\right)^{-1}
\end{equation*}
%
\begin{equation*}
\sim \prod_p \left(1+\frac{1}{p^s}\right)^{-1} = \frac{\zeta (2s)}{\zeta (s)}\text{.}
\end{equation*}
%
\par
(mumble mumble approximate functional equation).%
\begin{paragraphs}{How to obtain an \(E\) with proven analytic rank 3.}{g:paragraphs:idm204343223712}%
Gross-Zagier showed that for%
\begin{equation*}
E = 37b3\colon y^2 = x^{3} + 10 x^{2} - 20 x + 8
\end{equation*}
of conductor 37 and rank 0, we can twist by \(d=-139\) to get a curve of conductor \(714877\).%
\begin{equation*}
E_{-139}\colon -139 y^2 = x^{3} + 10 x^{2} - 20 x + 8
\end{equation*}
where%
\begin{equation*}
L_E(s,\chi _d) = L_{E_{d}}(s)\text{.}
\end{equation*}
%
\par
Doing a single Heegner point computation we find that \(P_d\) is zero and hence \(h(2P_d)= 0\). Using Gross-Zagier we have%
\begin{equation*}
L_E(1)L'_{E_d}(1) = c \Omega_d  \Omega h_{E_d}(2P_d)
\end{equation*}
This implies that%
\begin{equation*}
L_{E_d}(1)L_E'(1) = 0
\end{equation*}
we have%
\begin{equation*}
L_{E_d}'(1) = 0
\end{equation*}
and as \(L_{E_d}(s)\) has odd functional equation we can calculate%
\begin{equation*}
L_{E_d}'''(1) \ne 0
\end{equation*}
hence the analytic rank is 3.%
\par
So \(E_{-139}\) can be used for Goldfeld's technique.%
\par
We now let \(E/\QQ\) be our twisted curve forgetting that it came from \(37b3\).%
\par
The \(L\)-function of this curve has functional equation%
\begin{equation*}
\left(\frac{\sqrt{N}}{2 \pi}\right)^{1+s} \Gamma(1+s) L_{E}(1+s)=-\left(\frac{\sqrt{N}}{2 \pi}\right)^{1-s} \Gamma(1-s) L_{E}(1-s)
\end{equation*}
if \(D\) is a fundamental discriminant of class number 1 with \(|D| \gt 163\) we can define%
\begin{equation*}
\Lambda_{D}(s)=\left(\frac{N|D|}{4 \pi^{2}}\right)^{s} \Gamma(1+s)^{2} L_{E}(s) L_{E}\left(s, \chi_{D}\right)
\end{equation*}
so that%
\begin{equation*}
\Lambda_{D}(1+s)=w \cdot \Lambda_{D}(1-s)
\end{equation*}
with \(w=\chi _D(-37\cdot 139^2) = 1\).%
\par
The function%
\begin{equation*}
L_{E / \QQ(\sqrt{D})}(s) = L_E(s)L_E(s,\chi _D)
\end{equation*}
therefore has a zero of even order at \(s=1\), given that \(L_{E}(s)\) has an order 3 zero by construction%
\begin{equation*}
L_{E / \QQ(\sqrt{D})}(s)
\end{equation*}
has an order 4 zero.%
\par
To give a flavour of the class number one problem assume \(D\) sufficiently large with \(h(D) = 1\) still, then consider%
\begin{equation*}
I_D = \frac{1}{2\pi i} \int_{2-i\infty }^{2+i\infty } \Lambda_D(1+s) \frac{\diff s}{s^3}\text{.}
\end{equation*}
%
\begin{equation*}
\begin{aligned} I_{D} \amp=\frac{1}{2 \pi i} \int_{-2-i \infty}^{-2+i \infty} \Lambda_{D}(1+s) \frac{d s}{s^{3}} \\ \amp=-\frac{1}{2 \pi i} \int_{2-i \infty}^{2+i \infty} \Lambda_{D}(1+s) \frac{d s}{s^{3}} \\ \amp=-I_{D} \end{aligned}\text{.}
\end{equation*}
%
\par
We now want to show that%
\begin{equation*}
I_D \ne 0
\end{equation*}
under the same assumptions on \(D\).%
\par
Have euler products%
\begin{equation*}
\begin{array}{c}{L_{E}(s)=\prod_{p}\left(1-\frac{\alpha_{p}}{p^{s}}\right)^{-1}\left(1-\frac{\beta_{p}}{p^{s}}\right)^{-1}} \\ {L_{E}\left(s, \chi_{D}\right)=\prod_{p}\left(1-\frac{\alpha_{p} \chi_{D}(p)}{p^{s}}\right)^{-1}\left(1-\frac{\beta_{p} \chi_{D}(p)}{p^{s}}\right)^{-1}}\end{array}
\end{equation*}
and once again many small primes splitting means that \(L_E(s)L_E(s,\chi _D)\) is analytically like%
\begin{equation*}
\phi(s):=\prod_{p}\left(1-\frac{\alpha_{p}^{2}}{p^{2 s}}\right)^{-1}\left(1-\frac{\beta_{p}^{2}}{p^{2 s}}\right)^{-1}
\end{equation*}
Goldfeld then uses%
\begin{equation*}
I_{D}^{*}=\frac{1}{2 \pi i} \int_{2-i \infty}^{2+i \infty}\left(\frac{37 \cdot 139^{2}|D|}{4 \pi^{2}}\right)^{1+s} \Gamma(1+s)^{2} \phi(1+s) \frac{d s}{s^{3}}
\end{equation*}
and%
\begin{equation*}
0=I_{D}=I_{D}^{*}+\text { Error }
\end{equation*}
to get the final contradiction.%
\begin{remark}{}{g:remark:idm204343203216}%
There is also work by Mestre and Buhler-Gross-Zagier on%
\begin{equation*}
y^{2}+y=x^{3}-7 x+6
\end{equation*}
the smallest conductor rank 3 curve 5077, where they verify BSD explicitly, giving one the first example in rank 3. (To this day, it is not possible, even in principle, to establish BSD for any curve of rank 4 or greater since there is no known method for rigorously establishing the value of the analytic rank when it is greater than 3.) Once again Gross-Zagier is used, if \(L'_E(1)\) is calculated to be small but possibly non-zero it must be a multiple of the height of a small point, but we can look and find no small points, hence we obtain vanishing of the derivative at \(s=1\). This implies, for parity reasons that \(L_E(s)\) has analytic rank 3 or more. The third derivative can then be calculated and seen to be non-zero.%
\par
This smaller curve gives better bounds in Goldfelds method.%
\par
Using work of Oesterle they obtain%
\begin{equation*}
h(D) \gt \frac{1}{55} \log|D|
\end{equation*}
for prime \(D\).%
\par
It's super effective?!%
\end{remark}
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 7 Abhyankar's conjecture}
\typeout{************************************************}
%
\begin{chapterptx}{Abhyankar's conjecture}{}{Abhyankar's conjecture}{}{}{x:chapter:chapter-buntes-abyhankar}
\begin{introduction}{}%
What is the goal of the seminar?%
\par
It's up to everyone, we can obviously be flexible as we go, but:%
\par
Understand: the meaning of Abhyankar's conjecture, get some insight on the geometric perspective on Galois groups, statements of some useful tools and theories that come up in the proof and are generally useful to know (smattering of rigid geometry, some theorems about etale maps, general stuff on char p geometry), and learn something of the proof, how can rigid geometry tell us about characteristic p geometry?%
\par
In particular we won't go into detail on proofs of fancy things like Rigid GAGA, but we will spend the last few lectures on various stages of the proof.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 7.1 What is Abhyankar's conjecture? (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{What is Abhyankar's conjecture? (Alex)}{}{What is Abhyankar's conjecture? (Alex)}{}{}{x:section:sec-abhyankar-what-is}
One reference is \href{https://arxiv.org/abs/1408.0859}{Abhyankar's Conjectures In Galois Theory: Current Status And Future Directions} by David Harbater, Andrew Obus, Rachel Pries, And Katherine Stevenson. Also: A survey of Galois theory of curves in characteristic \(p\) - Rachel Pries and Katherine Stevenson and Fundamental Groups in Characteristic \(p\) - Pete L. Clark.%
\par
Consider the humble line, \(\aff^1\), its \(\CC\) or \(\RR\) points with the ``classical''\slash{}analytic topology are simply connected. Therefore there are no nontrivial finite covers.%
\par
What happens in characteristic \(p\)?%
\par
First we need to make the question precise, we need to define ``covers'' in a way that makes sense and try to define ``topology'' in a way that is non-trivial.%
\par
It would be good to define a notion of topology that is defined algebraically, and recovers the usual fundamental group of the \(\CC\)-points for a curve over \(\CC\).%
\par
But first are there any ``topological'' covers of the affine line in characteristic \(p\). We can easily make covers, just take any curve \(C \subseteq \aff^2 \to \aff^1\).%
\par
In general though these will be ramified, i.e. there will be points where the tangent line is perpendicular to the projection, this messes things up as Bezouts theorem will give us less geometric points. So not topological, like a parabola:%
\begin{equation*}
V(y^2 - y = x - 1) \xrightarrow{x} \aff^1
\end{equation*}
%
\par
To see where a cover is ramified  algebraically we take the derivative%
\begin{equation*}
2y - 1 = 0
\end{equation*}
hence \(y = 1/2\) and so \(x= 3/4\) is a ramified point. So this is ramified at \((3/4,1/2)\) above \(3/4\). Not a topological cover!%
\par
Hence \(V( y = x^{3423} + 12x + 1) \xrightarrow{x} \aff^1\) is an unramified cover, but it is trivial.%
\par
In characteristic \(p\) though weirdness ensues, take characteristic \(2\). The derivative above%
\begin{equation*}
2y - 1 = 1
\end{equation*}
never vanishes! Hence there is no ramification locus.%
\par
This can of course be generalised, an \terminology{Artin-Schreier} cover in characteristic \(p\) is%
\begin{equation*}
y^p - y - x = 0
\end{equation*}
it is an unramified \(p\)-to-one cover.%
\par
Given a topological cover the group of deck transformations of the cover gives a quotient of the fundamental group of the base.%
\par
In the Artin-Schreier example we have a transformation of the cover given by%
\begin{equation*}
y \mapsto y + 1
\end{equation*}
as in characteristic \(p\) we have.%
\begin{equation*}
(y+1)^p - (y+1) - x = y^ p + 1 - 1 -y   -x = 0\text{.}
\end{equation*}
We can iterate this, giving a cyclic group of order \(p\) as the group of deck transformations.%
\par
This says that the ``fundamental group of the affine line in characteristic p contains the cyclic group of order p!'' The line has non-trivial fundamental group.%
\par
More generally note that%
\begin{equation*}
y^q - y - x = 0
\end{equation*}
for \(q = p^n\) has the same property, but now we can add any element of \(\FF_{q}\) to \(y\) so the group of deck transformations is%
\begin{equation*}
\FF_q \simeq (\ZZ/p)^n
\end{equation*}
we can do this for all \(n\). This shows that the fundamental group of the affine line in characteristic \(p\) is not even topologically finitely generated! So even the affine line in characteristic \(p\) is wilder than any punctured curve in characteristic \(0\).%
\par
Clearly there characteristic \(p\) gave us a \(p\)-group in the fundamental group. Can we ever get anything other than a \(p\)-group?%
\begin{example}{Abhyankar.}{g:example:idm204343168448}%
The curve%
\begin{equation*}
y^n - a x^s y^{t} + 1 = 0 \xrightarrow{x} \aff^1
\end{equation*}
with \(a \ne 0 \in k\), \(n = p + t\), \(t \not \equiv 0 \pmod p\). Is ramified where%
\begin{equation*}
n y ^{n-1} - a x^s ty^{t-1} =  0\text{,}
\end{equation*}
but%
\begin{equation*}
t y ^{n-1} - a x^s ty^{t-1} = 0
\end{equation*}
%
\begin{equation*}
y ^{n-1} - a x^s y^{t-1} = 0
\end{equation*}
but in that case%
\begin{equation*}
(y ^{n-1} - a x^s y^{t-1})y = 0
\end{equation*}
which gives \(0 = 1\)! For general values of \(t, p\) this cover has automorphism group \(A_n\).%
\end{example}
We will define our fundamental group using these coverings, . A topological covering map is one that locally looks like a homeomorphism. For instance we can define a topological cover of \(\CC \smallsetminus \{0\}\) by itself using the algebraic map%
\begin{equation*}
z\mapsto z^2
\end{equation*}
or even%
\begin{equation*}
z \mapsto z^n\text{.}
\end{equation*}
This works nicely as this map is locally a diffeomorphism.%
\begin{definition}{}{g:definition:idm204343161232}%
An \terminology{étale map} is one which is flat and unramified.%
\end{definition}
How is this number theoretic?%
\par
There is a strong analogy between curves over finite fields, and dedekind rings, such as rings of integers of number fields Both give examples of dedekind schemes, dimension 1,... PICTURE. Back to Weil.%
\par
On the side of function fields we have%
\begin{equation*}
\FF_p((t)) \leftrightarrow \QQ
\end{equation*}
the function field of \(\aff^1_{\FF_p}\) and the function field of \(\Spec \ZZ\).%
\par
Covers of curves give us extensions of function fields. E.g. the Artin-Schreier covers on the left%
\par
Spec of quadratic field like a hyperelliptic covering map.%
\par
So the question of what covers we can have is like what field extensions can we have.%
\par
More intriguingly the automorphisms of the cover, the covering group corresponds to galois automorphisms.%
\par
On a hyperelliptic curve \(y=\sqrt{x^3+ 1} \leftrightarrow -y\) and \(\sqrt{2}\leftrightarrow - \sqrt{2} \).%
\par
So what covering groups translates into what Galois groups. So the question, what are the galois groups of covers of \(\aff^1_{\FF_p}\) and how do they fit together is like what are the possible galois groups of Galois extensions \(K/\QQ\).%
\par
To get a handle on what Galois groups can occur, we might take inspiration from number theory where we add conditions to get a quotient group, i.e. it is known the Galois groups of abelian extensions of \(\QQ\).%
\begin{definition}{Decomposition and Inertia groups.}{g:definition:idm204343153232}%
Given a galois cover of curves%
\begin{equation*}
\phi \colon C \to C'
\end{equation*}
we can fix a%
\begin{equation*}
P \in C',\,Q\in \phi \inv (P)
\end{equation*}
then define the \terminology{decomposition group}%
\begin{equation*}
D_Q  = \{f \in \Gal C {C'} : f(Q) = Q\}\text{.}
\end{equation*}
We also define the \terminology{inertia group} to be the subgroup%
\begin{equation*}
I_Q \subseteq D_Q
\end{equation*}
that fixes the residue field. For now we work over an algebraically closed field and so these are equal.%
\end{definition}
\begin{example}{}{g:example:idm204343149792}%
Consider curves over \(\QQ\)%
\begin{equation*}
V(y^2 = x) \xrightarrow{x} \aff^1
\end{equation*}
this is a (ramified at 0) double cover, with Galois group \(C_2\) given by \(y \mapsto -y\). Given \(2 \in \aff^1\), the preimage is the set of closed point%
\begin{equation*}
\{ (y^2 - 2)\}
\end{equation*}
so there is only one preimage and the decomposition group is everything, however the morphism on the residue field%
\begin{equation*}
\QQ(\sqrt 2)
\end{equation*}
is nontrivial, so the inertia group is trivial.%
\end{example}
Note that our maps are etale covers of \(\aff^1\), but this allows the ramification to still be at infinity. We complete an affine curve to obtain a proper one with the same function field. In this case%
\begin{equation*}
\aff^1 \subseteq \PP^1\text{.}
\end{equation*}
In general denote this as%
\begin{equation*}
C \leadsto \overline C
\end{equation*}
and call the points of%
\begin{equation*}
\overline C \smallsetminus C
\end{equation*}
``at infinity''.%
\begin{definition}{}{g:definition:idm204343143776}%
When over a field of characteristic \(p\), ramification at a point \(P\) is called \terminology{tame} when%
\begin{equation*}
p\nmid |I_P|\text{,}
\end{equation*}
in characteristic \(0\) we say it is \(p\)-tame if the same holds.%
\end{definition}
We then define%
\begin{equation*}
\pi_1^{p-tame}(C) = \varprojlim_{C' \to C\text{tame ram. abv. } \overline C - C} \Gal {C'}{C}
\end{equation*}
and likewise%
\begin{equation*}
\pi _1^t\text{.}
\end{equation*}
%
\begin{theorem}{}{}{g:theorem:idm204343139568}%
Let \(X\) be curve over \(k\) and \(\mathcal X\) a lift to characteristic 0 then%
\begin{equation*}
\pi _1^{p-tame} (\mathcal X - \mathcal S) \twoheadrightarrow \pi _1^t(X-S)
\end{equation*}
and their quotients by the unions of their \(p\)-Sylows%
\begin{equation*}
\pi _1^{p-tame} (\mathcal X - \mathcal S)\simeq \pi _1^t(X-S)\text{.}
\end{equation*}
%
\end{theorem}
Seeing as we ``understand'' fundamental groups of curves in characteristic zero, punctured riemann surfaces so generated by%
\begin{equation*}
2g + |S| - 1
\end{equation*}
loops. This result implies that after we get rid of \(p\)-Sylow stuff we should end up with just those generators.%
\par
Then we have%
\par
From zbmath for serre's Let K be an algebraically closed field of characteristic \(p\gt 0\). In the paper Coverings of algebraic curves, Am. J. Math. 79, 825-856 (1957; Zbl 0087.036), S. Abhyankar proved that the automorphism group of an étale Galois cover of the affine line over K is generated by its \(p\)-Sylow subgroups and conjectures that the converse should be true, namely that if a finite group G is generated by its p-Sylow subgroups then there exists an étale Galois cover of the affine line over K with Galois group G. The author proves a weaker form of this conjecture, i.e. the following theorem: Let G be a finite group that is generated by its p-Sylow subgroups, let N be a normal subgroup of G and let G be the quotient group \(G/N\). Assume that N is solvable and that G is the Galois group of an étale cover of the affine line. - Under these assumptions there exists an étale Galois cover of the affine line over K with Galois group G. In particular, this result implies Abhyankar’s conjecture for a solvable group.%
\begin{theorem}{Abhyankar's conjecture for \(\aff^1\).}{}{x:theorem:thm-abhyankar-aff}%
Let \(G\) be  such that \(G/p(G)\) (the quotient by the subgroup generated by its Sylow subgroups) is trivial (a quasi-\(p\) group). Then there exists an etale cover of \(\aff^1\) with Galois group \(G\).%
\end{theorem}
What does it mean to be generated by \(p\)-Sylow? Its complicated, but for instance%
\begin{equation*}
S_n
\end{equation*}
is generated by transpositions and%
\begin{equation*}
A_n
\end{equation*}
is generated by 3-cycles.%
\par
Meanwhile \(S_n\) is not solvable for \(n \ge 5\) (hence the general quintic isn't, Abel-Ruffini).%
\par
More generally we can generate \(A_n\) for \(n\ge 5\) with the subgroup of \(p\)-cycles for any \(p\) as it is simple and the subgroup is normal.%
\par
Another example is \(\SL_n(\FF_p)\) which is quasi-\(p\) as it is generated by elementary matrices, \(\PSL_n(\FF_p)\) is simple for large enough parameters. What about swapping?%
\par
Even more generally any finite simple group for which \(p\) divides the order is a quasi-\(p\)-group.%
\par
For instance therefore we should be able to find a monster group cover of the affine line when%
\begin{equation*}
p\in\{ 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 41, 47, 59, 71\}\text{,}
\end{equation*}
(these are the super famous so called supersingular primes).%
\par
What can we not do then?%
\begin{example}{}{g:example:idm204343118784}%
The group%
\begin{equation*}
\ZZ/p \times \ZZ/q
\end{equation*}
for primes \(p\ne q\) is not quasi-\(p\) or quasi-\(q\), thus even though it is abelian, solvable and easy to make as a Galois group over \(\QQ\) we cannot obtain it here.%
\end{example}
\begin{theorem}{Abhyankar's conjecture.}{}{x:theorem:thm-abhyankar}%
Let \(G\) be a finite group such that \(G/p(G)\) (the quotient by the subgroup generated by its Sylow subgroups) is generated by \(t\) elements. Let \(X/\FF_p\) be a smooth projective curve of genus \(g\), \(S\subset X\) a finite set of points with%
\begin{equation*}
2g + |S| - 1 \ge t\text{.}
\end{equation*}
Then there exists an etale cover of \(X\smallsetminus S\) with Galois group \(G\).%
\end{theorem}
\begin{remark}{}{g:remark:idm204343111040}%
This conjecture implies the first, taking \(t = 0\) we have \(g = 0\), \(S = \{\infty \}\) and%
\begin{equation*}
0 + 1 -1 = 0\text{.}
\end{equation*}
%
\par
Note that it is tight also we cannot remove \(t \gt 0\) points.%
\end{remark}
\begin{example}{}{g:example:idm204343108256}%
Over a once-punctured affine line we can now make non-quasi-\(p\)-groups as long as they aren't too far. For instance we can make \(\ZZ/\ell\) for any \(\ell \ne p\) as%
\begin{equation*}
V(y^\ell  - x) \xrightarrow{x} \aff^1\text{.}
\end{equation*}
This has the right Galois  group and is ramified only at \(0, \infty \).%
\end{example}
\begin{example}{}{g:example:idm204343105504}%
But we can't get \(\ZZ/\ell \times \ZZ/\ell\) without adding another ramification point.%
\end{example}
\begin{example}{}{g:example:idm204343104496}%
We can stack an Artin-Schreier extension on a Kummer%
\begin{equation*}
x_1^\ell = x
\end{equation*}
%
\begin{equation*}
y^p - y = x_1^d
\end{equation*}
with \(\ell | (p-1)\), \(p\nmid d\), \(\ell\nmid d\). Giving a degree \(\ell p\) cover. We then have automorphisms%
\begin{equation*}
\tau  \colon  x_1\mapsto x_1,\, y \mapsto y + 1
\end{equation*}
%
\begin{equation*}
\sigma \colon  x_1\mapsto \zeta _\ell x_1,\, y \mapsto \zeta _\ell^d y
\end{equation*}
but%
\begin{equation*}
\sigma \tau \sigma^{-1}(y)=y+\zeta_{\ell}^{-d} \neq \tau(y)
\end{equation*}
so the Galois group is the semidirect product%
\begin{equation*}
\mathbb{Z} / p \rtimes \mathbb{Z} / \ell\text{.}
\end{equation*}
Above \(\infty \) this is totally ramified, so \(D_\infty  = G\). Is a non-cyclic decomposition group!%
\end{example}
Why might you care? Spiritual connection to (one of the) most important questions in number theory, what is%
\begin{equation*}
\absgal \QQ
\end{equation*}
conjectured that every finite group appears as a quotient, the inverse Galois problem.%
\par
This is proved for solvable groups by Shafarevich, and many other inst resting examples of simple groups.%
\par
Here the analogous question is what is%
\begin{equation*}
\varprojlim_{S} \pi _1(\PP^1\smallsetminus S) \simeq \operatorname{Gal}\left(k(\PP^1)^{\operatorname{sep}} / k(\PP^1)\right)\text{?}
\end{equation*}
Where we allow more and more ramification.%
\par
Or changing base for \(X\) a proper curve%
\begin{equation*}
\varprojlim_{S} \pi _1(X\smallsetminus S) \simeq \operatorname{Gal}\left(k(X)^{\operatorname{sep}} / k(X)\right)\text{?}
\end{equation*}
%
\par
That of what is%
\begin{equation*}
\pi _1^\et(\aff^1)
\end{equation*}
is more like what is%
\begin{equation*}
\Gal{\QQ_{\{2\}}}\QQ\text{.}
\end{equation*}
Where \(\QQ_{\{2\}}\) is the maximal extension of \(\QQ\) ramified at 2 only.%
\begin{conjecture}{Abhyankar's Inertia Conjecture.}{}{g:conjecture:idm204343093664}%
Let \(G\) be a finite quasi-\(p\) group. Let \(G_{0}\) be a subgroup of \(G\) which is an extension of a cyclic group of order prime-to-p by a p-group \(G_{1}\). Then \(G_{0}\) occurs as an inertia group for a \(G\) - Galois cover of the projective line branched only at \(\infty \)  if and only if the conjugates of \(G_1\) generate \(G\)%
\end{conjecture}
The motivation for this comes from the fact that in characteristic 0 the inertia groups generate the Galois  group.%
\par
If \(K\) is a finite field, then its algebraic closure \(\bar K\) is an infinite Galois extension of \(K\) whose finite subextensions all have cyclic Galois groups over \(K\). This suggests that replacing the algebraically closed field of constants \(k\) by a finite subfield \(K\) adds a generator to the fundamental group of an affine curve, somewhat like the effect of deleting a point. This perspective motivated:%
\begin{conjecture}{Abhyankar's Affine Arithmetical Conjecture.}{}{g:conjecture:idm204343085344}%
A finite group \(G\) occurs as the Galois group of an unramified cover of the affine line over \(\FF_{p}\) if and only if it occurs as the Galois group of an unramified cover of \(\aff_{k}^{1}-\{0\}\) (in other words, if and only if \(G / p(G)\) is cyclic).%
\end{conjecture}
Both of these last two conjectures remain open I believe.%
\end{sectionptx}
\end{chapterptx}
%
\backmatter
%
%
%% A lineskip in table of contents as transition to appendices, backmatter
\addtocontents{toc}{\vspace{\normalbaselineskip}}
%
%
%
\typeout{************************************************}
\typeout{References  References}
\typeout{************************************************}
%
\begin{references-chapter-numberless}{References}{}{References}{}{}{g:references:idm204343082208}
%% If this is a top-level references
%%   you can replace with "thebibliography" environment
\begin{thebibliography}{9}
\bibitem[25]{x:biblio:bib-borel-hopf}\hypertarget{x:biblio:bib-borel-hopf}{}Borel, Armand. \textit{Sur La Cohomologie Des Espaces Fibres Principaux Et Des Espaces Homogenes De Groupes De Lie Compacts}. Annals of Mathematics, Second Series, 57, no. 1 (1953): 115-207. doi:10.2307\slash{}1969728.
\bibitem[47]{x:biblio:bib-vandergeer-moonen}\hypertarget{x:biblio:bib-vandergeer-moonen}{}van der Geer, G., Moonen, B. \textit{Abelian Varieties}, from \url{https://www.math.ru.nl/\~bmoonen/research.html\#bookabvar}.
\bibitem[61]{x:biblio:bib-hida-geometric}\hypertarget{x:biblio:bib-hida-geometric}{}Hida, Haruzo. \textit{Geometric modular forms and elliptic curves}. World Scientific, 2012.
\bibitem[64]{x:biblio:bib-katz-serre-tate}\hypertarget{x:biblio:bib-katz-serre-tate}{}Katz, Nicholas. \textit{Serre-Tate local moduli}. In Surfaces algébriques, pp. 138-202. Springer, Berlin, Heidelberg, 1981.
\bibitem[77]{x:biblio:bib-milne-etale}\hypertarget{x:biblio:bib-milne-etale}{}Milne, James S. \textit{Etale cohomology} (PMS-33). Vol. 33. Princeton university press, 2016.
\bibitem[81]{x:biblio:bib-polishchuck}\hypertarget{x:biblio:bib-polishchuck}{}Polishchuk, Alexander. \textit{Abelian varieties, theta functions and the Fourier transform}. Vol. 153. Cambridge University Press, 2003.
\bibitem[95]{x:biblio:bib-sutherland}\hypertarget{x:biblio:bib-sutherland}{}Sutherland, Andrew. \textit{Isogeny volcanoes}. The Open Book Series 1, no. 1 (2013): 507-530. \url{https://msp.org/obs/2013/1-1/obs-v1-n1-p25-s.pdf}.
\bibitem[96]{x:biblio:bib-tamme}\hypertarget{x:biblio:bib-tamme}{}Tamme, Günter. \textit{Introduction to étale cohomology}. Springer Science \& Business Media, 2012.
\bibitem[100]{x:biblio:bib-velu}\hypertarget{x:biblio:bib-velu}{}Vélu, Jacques. \textit{Isogénies entre courbes elliptiques}. CR Acad. Sci. Paris, Séries A 273 (1971): 305-347.
\bibitem[101]{x:biblio:bib-voight-quat}\hypertarget{x:biblio:bib-voight-quat}{}Voight, John. \textit{Quaternion Algebras}. \url{http://quatalg.org}
\bibitem[106]{x:biblio:bib-zagier-modular}\hypertarget{x:biblio:bib-zagier-modular}{}Zagier, D. \textit{Modular Points, Modular Curves, Modular Surfaces and Modular Forms}. In Arbeitstagung Bonn 1984, edited by Friedrich Hirzebruch, Joachim Schwermer, and Silke Suter, 225–48. Lecture Notes in Mathematics. Springer Berlin Heidelberg, 1985.
\end{thebibliography}
\end{references-chapter-numberless}
\end{document}