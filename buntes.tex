%**************************************%
%*    Generated from PreTeXt source   *%
%*                                    *%
%*   http://mathbook.pugetsound.edu   *%
%*                                    *%
%**************************************%
\documentclass[10pt,]{book}
%% Custom Preamble Entries, early (use latex.preamble.early)
%% Default LaTeX packages
%%   1.  always employed (or nearly so) for some purpose, or
%%   2.  a stylewriter may assume their presence
\usepackage{geometry}
%% Some aspects of the preamble are conditional,
%% the LaTeX engine is one such determinant
\usepackage{ifthen}
%% etoolbox has a variety of modern conveniences
\usepackage{etoolbox}
\usepackage{ifxetex,ifluatex}
%% Raster graphics inclusion
\usepackage{graphicx}
%% Color support, xcolor package
%% Always loaded, for: add/delete text, author tools
%% Here, since tcolorbox loads tikz, and tikz loads xcolor
\PassOptionsToPackage{usenames,dvipsnames,svgnames,table}{xcolor}
\usepackage{xcolor}
%% Colored boxes, and much more, though mostly styling
%% skins library provides "enhanced" skin, employing tikzpicture
%% boxes may be configured as "breakable" or "unbreakable"
%% "raster" controls grids of boxes, aka side-by-side
\usepackage{tcolorbox}
\tcbuselibrary{skins}
\tcbuselibrary{breakable}
\tcbuselibrary{raster}
%% xparse allows the construction of more robust commands,
%% this is a necessity for isolating styling and behavior
%% The tcolorbox library of the same name loads the base library
\tcbuselibrary{xparse}
%% Hyperref should be here, but likes to be loaded late
%%
%% Inline math delimiters, \(, \), need to be robust
%% 2016-01-31:  latexrelease.sty  supersedes  fixltx2e.sty
%% If  latexrelease.sty  exists, bugfix is in kernel
%% If not, bugfix is in  fixltx2e.sty
%% See:  https://tug.org/TUGboat/tb36-3/tb114ltnews22.pdf
%% and read "Fewer fragile commands" in distribution's  latexchanges.pdf
\IfFileExists{latexrelease.sty}{}{\usepackage{fixltx2e}}
%% Text height identically 9 inches, text width varies on point size
%% See Bringhurst 2.1.1 on measure for recommendations
%% 75 characters per line (count spaces, punctuation) is target
%% which is the upper limit of Bringhurst's recommendations
\geometry{letterpaper,total={340pt,9.0in}}
%% Custom Page Layout Adjustments (use latex.geometry)
%% This LaTeX file may be compiled with pdflatex, xelatex, or lualatex
%% The following provides engine-specific capabilities
%% Generally, xelatex and lualatex will do better languages other than US English
%% You can pick from the conditional if you will only ever use one engine
\ifthenelse{\boolean{xetex} \or \boolean{luatex}}{%
%% begin: xelatex and lualatex-specific configuration
%% fontspec package will make Latin Modern (lmodern) the default font
\ifxetex\usepackage{xltxtra}\fi
\usepackage{fontspec}
%% realscripts is the only part of xltxtra relevant to lualatex 
\ifluatex\usepackage{realscripts}\fi
%% 
%% Extensive support for other languages
\usepackage{polyglossia}
%% Main document language is US English
\setdefaultlanguage{english}
%% Spanish
\setotherlanguage{spanish}
%% Vietnamese
\setotherlanguage{vietnamese}
%% end: xelatex and lualatex-specific configuration
}{%
%% begin: pdflatex-specific configuration
%% translate common Unicode to their LaTeX equivalents
%% Also, fontenc with T1 makes CM-Super the default font
%% (\input{ix-utf8enc.dfu} from the "inputenx" package is possible addition (broken?)
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
%% end: pdflatex-specific configuration
}
%% Monospace font: Inconsolata (zi4)
%% Sponsored by TUG: http://levien.com/type/myfonts/inconsolata.html
%% See package documentation for excellent instructions
%% One caveat, seem to need full file name to locate OTF files
%% Loads the "upquote" package as needed, so we don't have to
%% Upright quotes might come from the  textcomp  package, which we also use
%% We employ the shapely \ell to match Google Font version
%% pdflatex: "varqu" option produces best upright quotes
%% xelatex,lualatex: add StylisticSet 1 for shapely \ell
%% xelatex,lualatex: add StylisticSet 2 for plain zero
%% xelatex,lualatex: we add StylisticSet 3 for upright quotes
%% 
\ifthenelse{\boolean{xetex} \or \boolean{luatex}}{%
%% begin: xelatex and lualatex-specific monospace font
\usepackage{zi4}
\setmonofont[BoldFont=Inconsolatazi4-Bold.otf,StylisticSet={1,3}]{Inconsolatazi4-Regular.otf}
%% end: xelatex and lualatex-specific monospace font
}{%
%% begin: pdflatex-specific monospace font
%% "varqu" option provides textcomp \textquotedbl glyph
%% "varl"  option provides shapely "ell"
\usepackage[varqu,varl]{zi4}
%% end: pdflatex-specific monospace font
}
%% Symbols, align environment, bracket-matrix
\usepackage{amsmath}
\usepackage{amssymb}
%% allow page breaks within display mathematics anywhere
%% level 4 is maximally permissive
%% this is exactly the opposite of AMSmath package philosophy
%% there are per-display, and per-equation options to control this
%% split, aligned, gathered, and alignedat are not affected
\allowdisplaybreaks[4]
%% allow more columns to a matrix
%% can make this even bigger by overriding with  latex.preamble.late  processing option
\setcounter{MaxMatrixCols}{30}
%%
%% Division Titles, and Page Headers/Footers
%% titlesec package, loading "titleps" package cooperatively
%% See code comments about the necessity and purpose of "explicit" option
\usepackage[explicit, pagestyles]{titlesec}
%% Set global/default page style for document due
%% to potential re-definitions after documentclass
\pagestyle{headings}
%%
%% Create globally-available macros to be provided for style writers
%% These are redefined for each occurence of each division
\newcommand{\divisionnameptx}{\relax}%
\newcommand{\titleptx}{\relax}%
\newcommand{\subtitleptx}{\relax}%
\newcommand{\shortitleptx}{\relax}%
\newcommand{\authorsptx}{\relax}%
\newcommand{\epigraphptx}{\relax}%
%% Create environments for possible occurences of each division
%% Environment for a PTX "chapter" at the level of a LaTeX "chapter"
\NewDocumentEnvironment{chapterptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Chapter}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\chapter[#3]{#1}%
}{}%
%% Environment for a PTX "section" at the level of a LaTeX "section"
\NewDocumentEnvironment{sectionptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Section}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\section[#3]{#1}%
}{}%
%% Environment for a PTX "subsection" at the level of a LaTeX "subsection"
\NewDocumentEnvironment{subsectionptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Subsection}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\subsection[#3]{#1}%
}{}%
%% Environment for a PTX "subsubsection" at the level of a LaTeX "subsubsection"
\NewDocumentEnvironment{subsubsectionptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Subsubsection}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\subsubsection[#3]{#1}%
}{}%
%% Environment for a PTX "references" at the level of a LaTeX "chapter"
\NewDocumentEnvironment{references-chapter}{mmmmm}
{%
\renewcommand{\divisionnameptx}{References}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\chapter[#3]{#1}%
}{}%
%% Environment for a PTX "references" at the level of a LaTeX "chapter"
\NewDocumentEnvironment{references-chapter-numberless}{mmmmm}
{%
\renewcommand{\divisionnameptx}{References}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\chapter*{#1}%
\addcontentsline{toc}{chapter}{#3}
}{}%
%%
%% Styles for the traditional LaTeX divisions
\titleformat{\chapter}[display]
{\normalfont\huge\bfseries}{\divisionnameptx\space\thechapter}{20pt}{\Huge#1}
[{\Large\authorsptx}]
\titlespacing*{\chapter}{0pt}{50pt}{40pt}
\titleformat{\section}
{\normalfont\Large\bfseries}{\thesection\space\titleptx}{1em}{}
[{\large\authorsptx}]
\titleformat{name=\section,numberless}
{\normalfont\Large\bfseries}{}{0pt}{#1}
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titleformat{\subsection}
{\normalfont\large\bfseries}{\thesubsection\space\titleptx}{1em}{}
[{\normalsize\authorsptx}]
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titleformat{\subsubsection}
{\normalfont\normalsize\bfseries}{\thesubsubsection\space\titleptx}{1em}{}
[{\small\authorsptx}]
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
%%
%% Semantic Macros
%% To preserve meaning in a LaTeX file
%% Only defined here if required in this document
%% Used for inline definitions of terms
\newcommand{\terminology}[1]{\textbf{#1}}
%% Subdivision Numbering, Chapters, Sections, Subsections, etc
%% Subdivision numbers may be turned off at some level ("depth")
%% A section *always* has depth 1, contrary to us counting from the document root
%% The latex default is 3.  If a larger number is present here, then
%% removing this command may make some cross-references ambiguous
%% The precursor variable $numbering-maxlevel is checked for consistency in the common XSL file
\setcounter{secnumdepth}{3}
%% begin: General AMS environment setup
%% Environments built with amsthm package
\usepackage{amsthm}
%% Numbering for Theorems, Conjectures, Examples, Figures, etc
%% Controlled by  numbering.theorems.level  processing parameter
%% Numbering: all theorem-like numbered consecutively
%% i.e. Corollary 4.3 follows Theorem 4.2
%% Always need some theorem environment to set base numbering scheme
%% even if document has no theorems (but has other environments)
%% Create a never-used style first, always
%% simply to provide a global counter to use, namely "cthm"
\newtheorem{cthm}{BadTheoremStringName}[section]
%% end: General AMS environment setup
%% AMS proof environment is basically fine as-is and special treatment
%% would certainly interfere with the functioning of \qed, etc.
%% So we simply localize the default heading
%% Redefinition of the "proof" environment is to cause a long alternate
%% title to line-break appropriately.  Code is cut verbatim, by suggestion,
%% from "Using the amsthm Package" Version 2.20.3, September 2017
\renewcommand*{\proofname}{Proof}
\makeatletter
\renewenvironment{proof}[1][\proofname]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item\relax
    {\itshape
    #1\@addpunct{.}}\hspace\labelsep\ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}
\makeatother
%% And a filled-in Halmos, making hollow available for examples
\renewcommand{\qedsymbol}{\(\blacksquare\)}
%%
%% tcolorbox, with styles, for THEOREM-LIKE
%%
%% theorem: fairly simple numbered block/structure
\tcbset{ theoremstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{theorem}[3]{title={{Theorem~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, theoremstyle, }
%% proposition: fairly simple numbered block/structure
\tcbset{ propositionstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{proposition}[3]{title={{Proposition~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, propositionstyle, }
%% corollary: fairly simple numbered block/structure
\tcbset{ corollarystyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{corollary}[3]{title={{Corollary~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, corollarystyle, }
%% lemma: fairly simple numbered block/structure
\tcbset{ lemmastyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{lemma}[3]{title={{Lemma~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, lemmastyle, }
%% fact: fairly simple numbered block/structure
\tcbset{ factstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{fact}[3]{title={{Fact~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, factstyle, }
%% claim: fairly simple numbered block/structure
\tcbset{ claimstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{claim}[3]{title={{Claim~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, claimstyle, }
%% algorithm: fairly simple numbered block/structure
\tcbset{ algorithmstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{algorithm}[3]{title={{Algorithm~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, algorithmstyle, }
%%
%% tcolorbox, with styles, for AXIOM-LIKE
%%
%% conjecture: fairly simple numbered block/structure
\tcbset{ conjecturestyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{conjecture}[3]{title={{Conjecture~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, conjecturestyle, }
%%
%% tcolorbox, with styles, for DEFINITION-LIKE
%%
%% definition: fairly simple numbered block/structure
\tcbset{ definitionstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, after upper={\hfill{}\(\lozenge\)}, } }
\newtcolorbox[use counter=cthm, number within=section]{definition}[2]{title={{Definition~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, definitionstyle, }
%%
%% tcolorbox, with styles, for REMARK-LIKE
%%
%% note: fairly simple numbered block/structure
\tcbset{ notestyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{note}[2]{title={{Note~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, notestyle, }
%% remark: fairly simple numbered block/structure
\tcbset{ remarkstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{remark}[2]{title={{Remark~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, remarkstyle, }
%% observation: fairly simple numbered block/structure
\tcbset{ observationstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{observation}[2]{title={{Observation~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, observationstyle, }
%%
%% tcolorbox, with styles, for EXAMPLE-LIKE
%%
%% example: fairly simple numbered block/structure
\tcbset{ examplestyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, after upper={\hfill{}\(\square\)}, } }
\newtcolorbox[use counter=cthm, number within=section]{example}[2]{title={{Example~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, examplestyle, }
%% question: fairly simple numbered block/structure
\tcbset{ questionstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, after upper={\hfill{}\(\square\)}, } }
\newtcolorbox[use counter=cthm, number within=section]{question}[2]{title={{Question~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, questionstyle, }
%% problem: fairly simple numbered block/structure
\tcbset{ problemstyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, after upper={\hfill{}\(\square\)}, } }
\newtcolorbox[use counter=cthm, number within=section]{problem}[2]{title={{Problem~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, problemstyle, }
%%
%% tcolorbox, with styles, for inline exercises
%%
%% inlineexercise: fairly simple numbered block/structure
\tcbset{ inlineexercisestyle/.style={size=minimal, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\normalfont\bfseries, attach title to upper, after title={\space}, } }
\newtcolorbox[use counter=cthm, number within=section]{inlineexercise}[2]{title={{Exercise~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, inlineexercisestyle, }
%%
%% xparse environments for introductions and conclusions of divisions
%%
%% introduction: in a structured division
\NewDocumentEnvironment{introduction}{m}
{\notblank{#1}{\noindent\textbf{#1}\space}{}}{}
%%
%% tcolorbox, with styles, for miscellaneous environments
%%
%% paragraphs: the terminal, pseudo-division
%% We use the lowest LaTeX traditional division
\titleformat{\subparagraph}[runin]{\normalfont\normalsize\bfseries}{\thesubparagraph}{1em}{#1}
\titlespacing*{\subparagraph}{0pt}{3.25ex plus 1ex minus .2ex}{1em}
\NewDocumentEnvironment{paragraphs}{mm}
{\subparagraph*{#1}\hypertarget{#2}{}}{}
%% Localize LaTeX supplied names (possibly none)
\renewcommand*{\chaptername}{Chapter}
%% Equation Numbering
%% Controlled by  numbering.equations.level  processing parameter
\numberwithin{equation}{section}
%% Figures, Tables, Listings, Named Lists, Floats
%% The [H]ere option of the float package fixes floats in-place,
%% in deference to web usage, where floats are totally irrelevant
%% You can remove some of this setup, to restore standard LaTeX behavior
%% HOWEVER, numbering of figures/tables AND theorems/examples/remarks, etc
%% may de-synchronize with the numbering in the HTML version
%% You can remove the "placement={H}" option to allow flotation and
%% preserve numbering, BUT the numbering may then appear "out-of-order"
%% Floating environments: http://tex.stackexchange.com/questions/95631/
\usepackage{float}
\usepackage{newfloat}
\usepackage{caption}%% Adjust stock figure environment so that it no longer floats
\SetupFloatingEnvironment{figure}{fileext=lof,placement={H},within=section,name=Figure}
\captionsetup[figure]{labelfont=bf}
%% http://tex.stackexchange.com/questions/16195
\makeatletter
\let\c@figure\c@cthm
\makeatother
%% Program listing support: for listings, programs, and Sage code
\usepackage{listings}
%% We define the listings font style to be the default "ttfamily"
%% To fix hyphens/dashes rendered in PDF as fancy minus signs by listing
%% http://tex.stackexchange.com/questions/33185/listings-package-changes-hyphens-to-minus-signs
\makeatletter
\lst@CCPutMacro\lst@ProcessOther {"2D}{\lst@ttfamily{-{}}{-{}}}
\@empty\z@\@empty
\makeatother
\ifthenelse{\boolean{xetex}}{}{%
%% begin: pdflatex-specific listings configuration
%% translate U+0080 - U+00F0 to their textmode LaTeX equivalents
%% Data originally from https://www.w3.org/Math/characters/unicode.xml, 2016-07-23
%% Lines marked in XSL with "$" were converted from mathmode to textmode
\lstset{extendedchars=true}
\lstset{literate={ }{{~}}{1}{¡}{{\textexclamdown }}{1}{¢}{{\textcent }}{1}{£}{{\textsterling }}{1}{¤}{{\textcurrency }}{1}{¥}{{\textyen }}{1}{¦}{{\textbrokenbar }}{1}{§}{{\textsection }}{1}{¨}{{\textasciidieresis }}{1}{©}{{\textcopyright }}{1}{ª}{{\textordfeminine }}{1}{«}{{\guillemotleft }}{1}{¬}{{\textlnot }}{1}{­}{{\-}}{1}{®}{{\textregistered }}{1}{¯}{{\textasciimacron }}{1}{°}{{\textdegree }}{1}{±}{{\textpm }}{1}{²}{{\texttwosuperior }}{1}{³}{{\textthreesuperior }}{1}{´}{{\textasciiacute }}{1}{µ}{{\textmu }}{1}{¶}{{\textparagraph }}{1}{·}{{\textperiodcentered }}{1}{¸}{{\c{}}}{1}{¹}{{\textonesuperior }}{1}{º}{{\textordmasculine }}{1}{»}{{\guillemotright }}{1}{¼}{{\textonequarter }}{1}{½}{{\textonehalf }}{1}{¾}{{\textthreequarters }}{1}{¿}{{\textquestiondown }}{1}{À}{{\`{A}}}{1}{Á}{{\'{A}}}{1}{Â}{{\^{A}}}{1}{Ã}{{\~{A}}}{1}{Ä}{{\"{A}}}{1}{Å}{{\AA }}{1}{Æ}{{\AE }}{1}{Ç}{{\c{C}}}{1}{È}{{\`{E}}}{1}{É}{{\'{E}}}{1}{Ê}{{\^{E}}}{1}{Ë}{{\"{E}}}{1}{Ì}{{\`{I}}}{1}{Í}{{\'{I}}}{1}{Î}{{\^{I}}}{1}{Ï}{{\"{I}}}{1}{Ð}{{\DH }}{1}{Ñ}{{\~{N}}}{1}{Ò}{{\`{O}}}{1}{Ó}{{\'{O}}}{1}{Ô}{{\^{O}}}{1}{Õ}{{\~{O}}}{1}{Ö}{{\"{O}}}{1}{×}{{\texttimes }}{1}{Ø}{{\O }}{1}{Ù}{{\`{U}}}{1}{Ú}{{\'{U}}}{1}{Û}{{\^{U}}}{1}{Ü}{{\"{U}}}{1}{Ý}{{\'{Y}}}{1}{Þ}{{\TH }}{1}{ß}{{\ss }}{1}{à}{{\`{a}}}{1}{á}{{\'{a}}}{1}{â}{{\^{a}}}{1}{ã}{{\~{a}}}{1}{ä}{{\"{a}}}{1}{å}{{\aa }}{1}{æ}{{\ae }}{1}{ç}{{\c{c}}}{1}{è}{{\`{e}}}{1}{é}{{\'{e}}}{1}{ê}{{\^{e}}}{1}{ë}{{\"{e}}}{1}{ì}{{\`{\i}}}{1}{í}{{\'{\i}}}{1}{î}{{\^{\i}}}{1}{ï}{{\"{\i}}}{1}{ð}{{\dh }}{1}{ñ}{{\~{n}}}{1}{ò}{{\`{o}}}{1}{ó}{{\'{o}}}{1}{ô}{{\^{o}}}{1}{õ}{{\~{o}}}{1}{ö}{{\"{o}}}{1}{÷}{{\textdiv }}{1}{ø}{{\o }}{1}{ù}{{\`{u}}}{1}{ú}{{\'{u}}}{1}{û}{{\^{u}}}{1}{ü}{{\"{u}}}{1}{ý}{{\'{y}}}{1}{þ}{{\th }}{1}{ÿ}{{\"{y}}}{1}}
%% end: pdflatex-specific listings configuration
}
%% End of generic listing adjustments
%% Sage's blue is 50%, we go way lighter (blue!05 would work)
\definecolor{sageblue}{rgb}{0.95,0.95,1}
%% Sage input, listings package: Python syntax, boxed, colored, line breaking
%% To be flush with surrounding text's margins, set
%% xmargins to be sum of framerule, framesep, and epsilon (~0.25pt)
%% space between input/output comes from input style "belowskip",
%% by giving output an aboveskip of zero
\lstdefinestyle{sageinputstyle}{language=Python,breaklines=true,breakatwhitespace=true,%
basicstyle=\small\ttfamily,columns=fixed,frame=single,backgroundcolor=\color{sageblue},%
framerule=0.5pt,framesep=4pt,xleftmargin=4.75pt,xrightmargin=4.75pt}
%% Sage output, similar, but not boxed, not colored
\lstdefinestyle{sageoutputstyle}{language=Python,breaklines=true,%
breakatwhitespace=true,basicstyle=\small\ttfamily,columns=fixed,aboveskip=0pt}
%% The environments manufactured by the listings package
\lstnewenvironment{sageinput}
  {\lstset{style=sageinputstyle}}
  {}
\lstnewenvironment{sageoutput}
  {\lstset{style=sageoutputstyle}}
  {}
%% More flexible list management, esp. for references
%% But also for specifying labels (i.e. custom order) on nested lists
\usepackage{enumitem}
%% Lists of references in their own section, maximum depth 1
\newlist{referencelist}{description}{4}
\setlist[referencelist]{leftmargin=!,labelwidth=!,labelsep=0ex,itemsep=1.0ex,topsep=1.0ex,partopsep=0pt,parsep=0pt}
%% hyperref driver does not need to be specified, it will be detected
\usepackage{hyperref}
%% configure hyperref's  \url  to match listings' inline verbatim
\renewcommand\UrlFont{\small\ttfamily}
%% Hyperlinking active in PDFs, all links solid and blue
\hypersetup{colorlinks=true,linkcolor=blue,citecolor=blue,filecolor=blue,urlcolor=blue}
\hypersetup{pdftitle={BUNTES}}
%% If you manually remove hyperref, leave in this next command
\providecommand\phantomsection{}
%% Graphics Preamble Entries
\usepackage{tikz,tkz-graph,tkz-berge}
%% If tikz has been loaded, replace ampersand with \amp macro
\ifdefined\tikzset
    \tikzset{ampersand replacement = \amp}
\fi
%% extpfeil package for certain extensible arrows,
%% as also provided by MathJax extension of the same name
%% NB: this package loads mtools, which loads calc, which redefines
%%     \setlength, so it can be removed if it seems to be in the 
%%     way and your math does not use:
%%     
%%     \xtwoheadrightarrow, \xtwoheadleftarrow, \xmapsto, \xlongequal, \xtofrom
%%     
%%     we have had to be extra careful with variable thickness
%%     lines in tables, and so also load this package late
\usepackage{extpfeil}
%% Custom Preamble Entries, late (use latex.preamble.late)
\bibliographystyle{alpha}

%% Begin: Author-provided packages
%% (From  docinfo/latex-preamble/package  elements)
\usepackage{xypic}\usepackage{newpxtext}\usepackage{newpxmath}\usepackage{cancel}%% End: Author-provided packages
%% Begin: Author-provided macros
%% (From  docinfo/macros  element)
%% Plus three from MBX for XML characters
\newenvironment{smallermatrix}[1]
{\arraycolsep=0.5pt\def\arraystretch{0.5}\tiny
\array{#1}}
{\endarray}

\newcommand{\ideal}[1]{\mathfrak{#1}}
\newcommand{\lie}[1]{\operatorname{\mathfrak{#1}}}
\newcommand{\sheaf}[1]{\operatorname{\mathcal{#1}}}
\newcommand{\Lie}{\operatorname{Lie}}

\newcommand{\diff}{\mathop{}\!\mathrm{d}}
\newcommand{\cinf}{C^\infty}
\newcommand{\inv}{^{-1}}
\newcommand{\units}{^{\times}}

\newcommand{\legendre}[2]{\left(\frac{#1}{#2}\right)}
\newcommand{\pair}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\lb}{[}
\newcommand{\rb}{]}
\newcommand{\powerseries}[2]{#1[[#2]]}


\newcommand{\partder}[2][]{\frac{\partial #1}{\partial #2}}


\providecommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}
\DeclareMathOperator{\Sha}{III}


\newcommand{\NN}{\mathbf{N}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\HH}{\mathbf{H}}
\newcommand{\FF}{\mathbf{F}}
\newcommand{\GG}{\mathbf{G}}
\newcommand{\ints}{\mathcal{O}}
\newcommand{\adeles}{\mathbf{A}}

\newcommand{\alg}{\mathrm{alg}}

\newcommand{\subgroup}{\mathrel{\subseteq}}

\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\catname}[1]{{\mathrm\textbf{#1}}}
\newcommand{\Rings}{\mathrm{Rings}}

\newcommand{\Ar}{\mathrm{Ar}}
\newcommand{\dR}{\mathrm{dR}}
\newcommand{\crys}{\mathrm{crys}}
\newcommand{\et}{\mathrm{\acute{e}t}}
\newcommand{\Pet}{\mathrm{Pet}}

\newcommand{\pinf}{{1/p^\infty}}

\newcommand{\colim}{\operatornamewithlimits{\underset{\longrightarrow}{colim}}}
\newcommand{\acts}{\circlearrowright}
\newcommand\rightrightrightarrows{
    \mathrel{\substack{\textstyle\rightarrow\\[-0.6ex]
        \textstyle\rightarrow \\[-0.6ex]
        \textstyle\rightarrow}}
}

\newcommand{\ab}{\mathrm{ab}}
\newcommand{\alm}{\mathrm{a}}
\newcommand{\an}{\mathrm{an}}
\newcommand{\alt}{\mathrm{alt}}
\newcommand{\cyc}{\mathrm{cyc}}
\newcommand{\id}{\mathrm{id}}
\newcommand{\un}{\mathrm{un}}
\newcommand{\nr}{\mathrm{nr}}
\newcommand{\ns}{\mathrm{ns}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\pre}{\mathrm{pre}}
\newcommand{\reg}{\mathrm{reg}}
\newcommand{\spec}{\mathrm{spec}}
\newcommand{\Set}{\mathrm{Set}}
\newcommand{\sep}{\mathrm{sep}}
\newcommand{\St}{\mathrm{St}}
\newcommand{\tors}{\mathrm{tors}}
\newcommand{\transpose}{\mathrm{T}}


\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\Ass}{Ass}
\DeclareMathOperator{\Supp}{Supp}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Nat}{Nat}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\Tgt}{Tgt}
\DeclareMathOperator{\sprep}{sp}
\DeclareMathOperator{\vol}{Vol}

\DeclareMathOperator{\divisor}{div}
\DeclareMathOperator{\divisors}{Div}
\DeclareMathOperator{\Cl}{Cl}
\DeclareMathOperator{\Div}{Div}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\Jac}{Jac}
\DeclareMathOperator{\Princ}{Princ}
\DeclareMathOperator{\Cycles}{Cycles}
\DeclareMathOperator{\supp}{supp}

\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Tor}{Tor}

\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\Fil}{Fil}


\DeclareMathOperator{\polylog}{\mathcal{L}}

\DeclareMathOperator{\disc}{disc}

\DeclareMathOperator{\Tan}{Tan}
\DeclareMathOperator{\Cotan}{Cotan}
\DeclareMathOperator{\Sing}{Sing}

\DeclareMathOperator{\Sel}{Sel}
\DeclareMathOperator{\red}{red}
\DeclareMathOperator{\Reg}{Reg}
\DeclareMathOperator{\Rep}{Rep}

\DeclareMathOperator{\rk}{rk}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\image}{im}
\DeclareMathOperator{\coim}{coim}
\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\Span}{span}
\DeclareMathOperator{\characteristic}{char}
\DeclareMathOperator{\orient}{or}
\DeclareMathOperator{\leadterm}{lt}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Ad}{Ad}

\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Spf}{Spf}
\DeclareMathOperator{\Spv}{Spv}
\DeclareMathOperator{\Spa}{Spa}
\DeclareMathOperator{\Spm}{Spm}
\DeclareMathOperator{\specialisation}{sp}
\DeclareMathOperator{\Max}{Max}
\newcommand{\Gal}[2]{\operatorname{Gal}(#1/#2)}
\newcommand{\absgal}[1]{\operatorname{Gal}(\overline{#1}/#1)}
\newcommand{\sepgal}[1]{\operatorname{Gal}(#1^\sep/#1)}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\Res}{Res}


\DeclareMathOperator{\power}{\mathcal{P}}
\DeclareMathOperator{\aff}{\mathbf{A}}
\DeclareMathOperator{\PP}{\mathbf{P}}
\DeclareMathOperator{\norm}{Norm}
\DeclareMathOperator{\trace}{Tr}
\DeclareMathOperator{\Fr}{Fr}
\DeclareMathOperator{\Frob}{Frob}
\DeclareMathOperator{\NS}{NS}
\DeclareMathOperator{\Der}{Der}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Out}{Out}
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\vf}{\mathcal{V}}
\DeclareMathOperator{\krulldim}{krulldim}
\DeclareMathOperator{\trdeg}{trdeg}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\cl}{cl}
\DeclareMathOperator{\Prob}{Prob}

\DeclareMathOperator{\Mat}{Mat}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\PSL}{PSL}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\specialorthogonal}{SO}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\orth}{O}
\DeclareMathOperator{\unitary}{U}
\DeclareMathOperator{\specialunitary}{SU}
\DeclareMathOperator{\Sym}{Sym}
\newcommand{\lt}{<}
\newcommand{\gt}{>}
\newcommand{\amp}{&}
%% End: Author-provided macros
\begin{document}
\frontmatter
%% begin: half-title
\thispagestyle{empty}
{\centering
\vspace*{0.28\textheight}
{\Huge BUNTES}\\[2\baselineskip]
{\LARGE BU Number Theory Expository Seminar}\\
}
\clearpage
%% end:   half-title
%% begin: adcard
\thispagestyle{empty}
\null%
\clearpage
%% end:   adcard
%% begin: title page
%% Inspired by Peter Wilson's "titleDB" in "titlepages" CTAN package
\thispagestyle{empty}
{\centering
\vspace*{0.14\textheight}
%% Target for xref to top-level element is ToC
\addtocontents{toc}{\protect\hypertarget{buntes}{}}
{\Huge BUNTES}\\[\baselineskip]
{\LARGE BU Number Theory Expository Seminar}\\[3\baselineskip]
{\Large BUNTES Attendees (notes by Alex)}\\[3\baselineskip]
{\Large October 21, 2018}\\}
\clearpage
%% end:   title page
%% begin: copyright-page
\thispagestyle{empty}
\vspace*{\stretch{2}}
\vspace*{\stretch{1}}
\null\clearpage
%% end:   copyright-page
%% begin: table of contents
%% Adjust Table of Contents
\setcounter{tocdepth}{1}
\renewcommand*\contentsname{Contents}
\tableofcontents
%% end:   table of contents
\mainmatter
%
%
\typeout{************************************************}
\typeout{Chapter 1 Abelian Varieties}
\typeout{************************************************}
%
\begin{chapterptx}{Abelian Varieties}{}{Abelian Varieties}{}{}\label{chapter-abelian-varieties}
\begin{introduction}{}%
\hypertarget{p-1}{}%
These are notes for BUNTES Fall 2017, the topic is \hyperref[def-buntes-abvar]{Abelian varieties}, they were last updated October 21, 2018. We are using Milne's \hyperref[def-buntes-abvar]{abelian varieties} notes primarily, for more details see \href{http://math.bu.edu/people/angusmca/buntes/fall2017.html}{the webpage}. These notes are by Alex, feel free to email me at \href{mailto:alex.j.best@gmail.com}{\nolinkurl{alex.j.best@gmail.com}} to report typos/suggest improvements, I'll be forever grateful.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 1.2 Introduction (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Introduction (Angus)}{}{Introduction (Angus)}{}{}\label{sec-av-intro}
%
%
\typeout{************************************************}
\typeout{Subsection 1.2.1 Definitions}
\typeout{************************************************}
%
\begin{subsectionptx}{Definitions}{}{Definitions}{}{}\label{subsec-abvar-defs}
\begin{definition}{Abelian varieties.}{def-buntes-abvar}%
\hypertarget{p-5}{}%
An \terminology{abelian variety} is a \hyperref[def-abelian-complete-var]{complete} connected \hyperref[def-alg-gp]{algebraic group}.%
\end{definition}
\begin{definition}{Algebraic groups.}{def-alg-gp}%
\hypertarget{p-6}{}%
An \terminology{algebraic group} is an algebraic variety \(G\) along with regular maps \(m\colon G\times G\to G\), \(e \colon * \to G\),  \(\operatorname{inv}\colon G\to G\) such that the following diagrams commute.%
\par
\hypertarget{p-7}{}%
Identity%
\begin{equation*}
\xymatrix{
\ast\times G\ar[dr]_{\sim}\ar[r]^{e\times \id} & G\times G\ar[d]_m &G\times \ast\ar[l]^{\id\times e}\ar[dl]^\sim\\
& G &
}
\end{equation*}
%
\par
\hypertarget{p-8}{}%
Inverse%
\begin{equation*}
\xymatrix{
G\ar[d]\ar[r]^{\operatorname{inv}, \id} & G\times G\ar[d]_m &G\ar[l]^{\id, \operatorname{inv}}\ar[d]\\
\ast\ar[r]_e& G &\ast\ar[l]_e
}
\end{equation*}
%
\par
\hypertarget{p-9}{}%
Associativity%
\begin{equation*}
\xymatrix{
G \times G \times G \ar[d]_{m\times \id}\ar[r]^{\id\times m} & G\times G\ar[d]_m\\
G\times G\ar[r]_m & G
}
\end{equation*}
%
\end{definition}
\begin{definition}{Complete varieties.}{def-abelian-complete-var}%
\hypertarget{p-10}{}%
A variety \(X\) is \terminology{complete} if every projection map%
\begin{equation*}
X\times Y \to Y
\end{equation*}
is closed.%
\end{definition}
\begin{example}{Abelian varieties.}{example-1}%
\hypertarget{p-11}{}%
\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}Elliptic curves.%
\item{}Weil restriction \(\Res_{K/\QQ} E\) of an \hyperref[def-supersing-isog-ec]{elliptic curve} \(E\).%
\item{}Jacobian varieties of curves.%
\end{itemize}
%
\end{example}
\hypertarget{p-12}{}%
Plan:\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}Some motivation via \hyperref[def-supersing-isog-ec]{elliptic curves}.%
\item{}Gathering some material about ``completeness''.%
\item{}Prove that \hyperref[def-buntes-abvar]{abelian varieties} are abelian.%
\end{itemize}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.2.2 Elliptic curves (\(\characteristic(k) \ne 2,3\))}
\typeout{************************************************}
%
\begin{subsectionptx}{Elliptic curves (\(\characteristic(k) \ne 2,3\))}{}{Elliptic curves (\(\characteristic(k) \ne 2,3\))}{}{}\label{subsection-2}
\begin{theorem}{}{}{thm-equivalent-ec}%
\hypertarget{p-13}{}%
TFAE for a projective curve \(E\) over \(k\).\leavevmode%
\begin{enumerate}
\item\hypertarget{item-cubic-eq}{}\(E\) is given by \(Y^2Z = X^3 + aXZ^2 + bZ^3\), \(4a^3 + 27b^2 \ne 0\).%
\item\hypertarget{item-nonsing-pt}{}\(E\) is nonsingular of \hyperref[def-class-set]{genus} 1 with a distinguished point \(P_0\).%
\item\hypertarget{item-nonsing-gp}{}\(E\) is nonsingular with an \hyperref[def-alg-gp]{algebraic group} structure.%
\item\hypertarget{item-cmplx}{}(if \(k \subseteq \CC\)) such that \(E(\CC) = \CC/\Lambda\) for some \hyperref[def-buntes-lattice]{lattice} \(\Lambda \subseteq \CC\).%
\end{enumerate}
%
\end{theorem}
\begin{proof}\hypertarget{proof-1}{}
\hypertarget{p-14}{}%
Strategy: \hyperlink{item-cubic-eq}{Item~1} \(\iff\) \hyperlink{item-nonsing-pt}{Item~2} \(\iff\)\hyperlink{item-nonsing-gp}{Item~3} and \hyperlink{item-nonsing-pt}{Item~2} \(\implies\) \hyperlink{item-cmplx}{Item~4} \(\implies\) \hyperlink{item-cubic-eq}{Item~1}.%
\par
\hypertarget{p-15}{}%
\hyperlink{item-cubic-eq}{Item~1} \(\implies\) \hyperlink{item-nonsing-pt}{Item~2} is done.%
\par
\hypertarget{p-16}{}%
\hyperlink{item-nonsing-pt}{Item~2} \(\implies\)\hyperlink{item-cubic-eq}{Item~1}: Riemann-Roch states that \(l(D) = l(K-D) +  \deg(D) + 1 -g \) so here \(l(D) = l(K-D) + \deg (D)\) further is \(D\gt 0\) then \(l(K-D) = 0\) in which case \(l(D) = \deg(D)\). Consider \(L(nP_0)\) for \(n \gt 0\) Riemann-Roch implies that \(l(nP_0) = n\) then it always contains the constants.%
\begin{equation*}
L(P_0) = k
\end{equation*}
%
\begin{equation*}
L(2P_0) = k \oplus kx
\end{equation*}
%
\begin{equation*}
L(3P_0) = k \oplus kx \oplus ky
\end{equation*}
%
\begin{equation*}
\vdots
\end{equation*}
%
\begin{equation*}
L(6P_0) = k \oplus kx \oplus ky \oplus k x^2 \oplus ky^2 \oplus kxy \oplus kx^3/\sim
\end{equation*}
so we must have a relation which after manipulation is of the desired form. We get an embedding%
\begin{equation*}
E \hookrightarrow \PP^2
\end{equation*}
%
\begin{equation*}
P\mapsto (x(P):y(P): 1) \,(P\ne P_0)
\end{equation*}
%
\begin{equation*}
P_0 \mapsto (0:1 : 0)
\end{equation*}
and thus \(E\) is of the desired form.%
\end{proof}
\begin{definition}{Elliptic curves.}{def-abelian-elliptic-curve}%
\hypertarget{p-17}{}%
An \terminology{elliptic curve} over \(k\) is any/all of \hyperref[thm-equivalent-ec]{that~\ref{thm-equivalent-ec}}.%
\end{definition}
\hypertarget{p-18}{}%
Which of the above characterisations generalise to \hyperref[def-buntes-abvar]{abelian varieties}?\leavevmode%
\begin{enumerate}
\item\hypertarget{li-11}{}No, in general we don't know that the equations look like.%
\item\hypertarget{li-12}{}One could possibly replace ``genus'' with a condition on the dimension of cohomology groups.%
\item\hypertarget{li-13}{}Yes, this is essentially the definition.%
\item\hypertarget{li-14}{}Yes, stay tuned!%
\end{enumerate}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.2.3 Complete varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Complete varieties}{}{Complete varieties}{}{}\label{subsec-complete-vars}
\hypertarget{p-19}{}%
Idea: if \(X \times Y\) had product topology (instead of its Zariski topology) then \hyperref[def-abelian-complete-var]{complete} is equivalent to compact.%
\par
\hypertarget{p-20}{}%
We'd like to gather a few results about \hyperref[def-abelian-complete-var]{complete} varieties we can use to access properties of \hyperref[def-buntes-abvar]{abelian varieties} (like abelianness).%
\begin{proposition}{}{}{proposition-1}%
\hypertarget{p-21}{}%
Let \(V\) be a \hyperref[def-abelian-complete-var]{complete} variety. Given any morphism \(\phi\colon V \to W\) \(\phi (V) \) is closed.%
\end{proposition}
\begin{proof}\hypertarget{proof-2}{}
\hypertarget{p-22}{}%
Let \(\Gamma_\phi = \{(v, \phi(v))\} \subseteq V\times W\) be the graph of \(\phi\). Its a closed subvariety of \(V\times W\). Under the projection \(V\times W \to W\), the image of \(\Gamma_\phi\) is \(\phi(V)\) and thus closed.%
\end{proof}
\begin{corollary}{}{}{corollary-1}%
\hypertarget{p-23}{}%
If \(V\) is \hyperref[def-abelian-complete-var]{complete} and connected, any regular function on \(V\) is constant.%
\end{corollary}
\begin{proof}\hypertarget{proof-3}{}
\hypertarget{p-24}{}%
A regular function is a morphism \(f\colon V \to \aff^1\). By the above \(f(V) \subseteq \aff^1\) is closed, and this is a finite set of points. But connected implies we just have one point.%
\end{proof}
\begin{corollary}{}{}{corollary-2}%
\hypertarget{p-25}{}%
Let \(V \) be a \hyperref[def-abelian-complete-var]{complete} connected variety. Let \(W\) be an affine variety. Given \(\phi\colon V\to W\), then \(\phi (V)\) is a point.%
\end{corollary}
\begin{proof}\hypertarget{proof-4}{}
\hypertarget{p-26}{}%
We have an embedding \(W \hookrightarrow \aff^n\). On \(\aff^n\) we have the coordinate functions \(\aff^n \xrightarrow{x_i} \aff^1\). The composition%
\begin{equation*}
V \xrightarrow\phi W \hookrightarrow\aff^n \to \aff^1
\end{equation*}
be the above is constant. Thus the coordinates of \(\phi(V)\) are constant, so \(\phi(V) = \{\text{pt}\}\).%
\end{proof}
\hypertarget{p-27}{}%
A final result of interest that I won't prove today:%
\begin{theorem}{}{}{theorem-2}%
\hypertarget{p-28}{}%
Projective varieties are \hyperref[def-abelian-complete-var]{complete}.%
\end{theorem}
\hypertarget{p-29}{}%
The main goal of this section is to prove the following theorem:%
\begin{theorem}{Rigidity.}{}{thm-rigidity}%
\hypertarget{p-30}{}%
Let \(V,W\) be varieties such that \(V\) is \hyperref[def-abelian-complete-var]{complete} and  \(V\times W\) is geometrically irreducible. Let \(\alpha\colon V\times W \to U\) be a morphism such that \(\exists u_0\in U(k), v_0\in V(k), w_0\in W(k)\) with \(\alpha(V\times\{w_0\}) = \alpha (\{v_0\}\times W ) = \{u_0\}\). Then \(\alpha (V\times W) = \{u_0\}\).%
\end{theorem}
\begin{proof}\hypertarget{proof-5}{}
\hypertarget{p-31}{}%
Since \(V\times W\) is geometrically irreducible, \(V\) must be connected. Denote the projection \(q\colon V\times W \to W\). Let \(U_0 \ni u_0\) be an open neighborhood. We consider the set%
\begin{equation*}
Z = \{w\in W : \alpha((v,w)) \not\in U_0 \text{ for some } v\in V\} = q(\alpha^{-1}(U\smallsetminus U_0))
\end{equation*}
Since \(q\) is closed, \(Z\subseteq W\) is closed. Since \(w_0\in W\smallsetminus Z\), \(W\smallsetminus Z\) is a nonempty open subset of \(W\).%
\par
\hypertarget{p-32}{}%
Consider \(w \in W\smallsetminus Z\). Since \(V\times\{w\} \cong V\) it is \hyperref[def-abelian-complete-var]{complete} and connected. Thus%
\begin{equation*}
\alpha(V\times \{w\}) = \{\text{pt}\} = \alpha((v_0,w)) = \{u_0\}
\end{equation*}
which implies that%
\begin{equation*}
\alpha(V\times (W\smallsetminus Z)) = \{u_0\}
\end{equation*}
Since \(V\times (W\smallsetminus Z) \subseteq V\times W\) is open and \(V\times W\) is irreducible, it is dense. So \(\alpha(V\times W) = \{u_0\}\).%
\end{proof}
\begin{proposition}{}{}{proposition-2}%
\hypertarget{p-33}{}%
Let \(A,B\) be \hyperref[def-buntes-abvar]{abelian varieties}. Every morphism \(\alpha \colon A \to B \) is the composition of a homomorphism and a translation.%
\end{proposition}
\begin{proof}\hypertarget{proof-6}{}
\hypertarget{p-34}{}%
First compose by a translation on \(B\) such that \(\alpha(0) = 0\). Consider the map%
\begin{align*}
\phi \colon A\times A\amp\to B\\
(a,a')               \amp\mapsto \alpha(a+a') - \alpha(A) -\alpha(a')
\end{align*}
Then%
\begin{align*}
\phi(A\times\{0\}) \amp = \alpha(a+ 0) - \alpha(a) - \alpha(0) = 0\\
\phi(\{0\}\times A) \amp = \alpha(0+ a) - \alpha(0) - \alpha(a) = 0\text{.}
\end{align*}
By the \hyperref[thm-rigidity]{rigidity theorem~\ref{thm-rigidity}} \(\phi(A\times A) = \{0\}\) hence \(\alpha(a + a') = \alpha(a) + \alpha(a')\).%
\end{proof}
\begin{corollary}{}{}{corollary-3}%
\hypertarget{p-35}{}%
Abelian varieties are abelian.%
\end{corollary}
\begin{proof}\hypertarget{proof-7}{}
\hypertarget{p-36}{}%
The inversion map \(a \mapsto -a\) sends \(0\) to \(0\), thus is a homomorphism. Therefore%
\begin{equation*}
a+ b - a -b = a+b -(a+b) = 0
\end{equation*}
and so%
\begin{equation*}
a+b=b+a\text{.}\qedhere
\end{equation*}
%
\end{proof}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.3 Abelian varieties over \(\CC\) (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Abelian varieties over \(\CC\) (Alex)}{}{Abelian varieties over \(\CC\) (Alex)}{}{}\label{sec-av-complex}
\begin{introduction}{}%
\hypertarget{p-37}{}%
The goal of this talk is to understand what \hyperref[def-buntes-abvar]{abelian varieties} look like over \(\CC\). The goal for me is to understand what a (principal) polarisation is and why it is important.%
\par
\hypertarget{p-38}{}%
First immediate question: why study complex theory at all? The most classical field, algebraically closed, archimidean, characteristic 0.%
\par
\hypertarget{p-39}{}%
Recall/rapidly learn the picture for \hyperref[def-supersing-isog-ec]{elliptic curves}, given \(E\) an \hyperref[def-supersing-isog-ec]{elliptic curve} we have for some \(\Lambda\) a rank 2 \hyperref[def-buntes-lattice]{lattice} in \(\CC\)%
\begin{align*}
\CC/\Lambda \amp\xrightarrow{\sim} E(\CC) \subseteq \PP^2(\CC)\\
z\amp\mapsto (\wp(z) : \wp'(z) : 1)\\
0\amp\mapsto (0 : 1 : 0)
\end{align*}
where%
\begin{equation*}
\wp(z) = \frac{1}{z^2} + \sum_{\lambda \in \Lambda\smallsetminus\{0\}} \frac{1}{(z-\lambda)^2} - \frac{1}{\lambda^2}\text{.}
\end{equation*}
This is a \hyperref[def-morph-riem-surf]{meromorphic function} whose image lands in%
\begin{equation*}
y^2 = 4x^3 - g_2 x - g_3\text{.}
\end{equation*}
So the \(\CC\) points of an \hyperref[def-supersing-isog-ec]{elliptic curve} are topologically a torus.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.1 Abelian varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Abelian varieties}{}{Abelian varieties}{}{}\label{subsection-4}
\hypertarget{p-40}{}%
Naturally one asks: does this generalise? Let \(A\) be an \hyperref[def-buntes-abvar]{abelian variety} over \(\CC\), what does \(A(\CC)\) look like? Another torus?%
\begin{proposition}{}{}{proposition-3}%
\hypertarget{p-41}{}%
\(A(\CC)\) is a compact, connected, complex lie group.%
\end{proposition}
\begin{proposition}{}{}{proposition-4}%
\hypertarget{p-42}{}%
Let \(A\) be an \hyperref[def-buntes-abvar]{abelian variety} of dimension \(g\) over \(\CC\). Then we have%
\begin{equation*}
A(\CC) \cong V/\Lambda
\end{equation*}
where \(V\) is a \(g\) dimensional complex vector space and \(\Lambda\) is a full rank \hyperref[def-buntes-lattice]{lattice} of \(V\) (i.e \(\Lambda\) is a discrete subgroup of \(V\) s.t. \(\RR\otimes \Lambda  = V\)).%
\end{proposition}
\begin{proof}\hypertarget{proof-8}{}
\hypertarget{p-43}{}%
Differential geometry gives us a map of complex manifolds, the exponential map%
\begin{equation*}
\exp\colon\Tgt_0(A(\CC)) \to A(\CC)
\end{equation*}
this is holomorphic. And since \(A(\CC)\) is abelian, this is a homomorphism also. In general this is locally an isomorphism around 0.%
\par
\hypertarget{p-44}{}%
Claim: \(\exp\) is injective. There exists a neighborhood \(U\supseteq 0\) s.t. \(\exp(U) \cong U\). Consider the image \(\exp(\Tgt_0 A(\CC))\). For \(x\in \exp(\Tgt_0 A(\CC))\), \(\{U+x\}\) are all open and give a cover. Thus \(\exp(\Tgt_0A(\CC))\) is open. Since \(A(\CC)\) is connected we are thus reduced to showing \(\exp(\Tgt_0 A(\CC))\) is closed also. Since \(\exp\) is a homomorphism, the image is a subgroup. So its complement is the union of its non-trivial cosets, which is open. Thus \(\exp(\Tgt_0A(\CC))\) is closed. Giving \(\exp(\Tgt_0A(\CC)) = A(\CC)\), which proves the claim.%
\par
\hypertarget{p-45}{}%
\(\exp\) is a local isomorphism, which gives that \(\ker(\exp)\) is discrete, i.e. a \hyperref[def-buntes-lattice]{lattice}. We now have%
\begin{equation*}
A(\CC) \cong \Tgt_0A(\CC)/ \ker(\exp)
\end{equation*}
so as \(A(\CC)\) is compact we cannot have a kernel which is not full rank, as otherwise the quotient could not be compact.%
\end{proof}
\begin{definition}{}{def-complex-torus}%
\hypertarget{p-46}{}%
We call any such \(V/\Lambda\) a \terminology{complex torus}.%
\end{definition}
\hypertarget{p-47}{}%
From the above isomorphism we can now read off properties of \(A(\CC)\) as a group.%
\begin{proposition}{}{}{proposition-5}%
\hypertarget{p-48}{}%
\(A(\CC)\) is divisible, and \(A(\CC)\lb n\rb \cong (\ZZ/n\ZZ)^{2g}\).%
\end{proposition}
\begin{proof}\hypertarget{proof-9}{}
\hypertarget{p-49}{}%
%
\begin{equation*}
A(\CC)  \cong V/\Lambda \cong (\RR/\ZZ)^{2g}
\end{equation*}
isomorphisms as groups, thus \(A(\CC)\) is divisible. Further, \((\RR/\ZZ)\lb n \rb = (\frac 1n \ZZ)/\ZZ\).%
\end{proof}
\hypertarget{p-50}{}%
Question: Given a \hyperref[def-complex-torus]{complex torus} \(V/\Lambda\), does there exist an \hyperref[def-buntes-abvar]{abelian variety} \(A\) such that \(A(\CC) \cong V/\Lambda\)?%
\begin{example}{}{example-2}%
\hypertarget{p-51}{}%
\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}%
\begin{equation*}
\CC/\Lambda \cong E(\CC) \text{ always in dim 1}
\end{equation*}
%
\item{}%
\begin{equation*}
\CC^2/\Lambda^2 \cong (E\times E)(\CC) \text{ sometimes yes in higher dimension}
\end{equation*}
%
\item{}%
\begin{equation*}
\CC^2/\langle (i, 0), (i\sqrt p, i), (1, 0), (0, 1)\rangle_\ZZ
\end{equation*}
for \(p\) prime??? (I guess not, see Mumford)%
\end{itemize}
%
\end{example}
\begin{theorem}{Chow.}{}{theorem-4}%
\hypertarget{p-52}{}%
If \(X\) is an analytic submanifold of \(\PP^n(\CC)\) then \(X\) is an algebraic subvariety.%
\end{theorem}
\hypertarget{p-53}{}%
By this theorem it is enough to analytically imbed \(V/\Lambda \hookrightarrow \PP^m\). We can try and do this by mimicing the \hyperref[def-supersing-isog-ec]{elliptic curve} strategy, find enough functions \(\theta \colon V/\Lambda \to \CC\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.2 Cohomology}
\typeout{************************************************}
%
\begin{subsectionptx}{Cohomology}{}{Cohomology}{}{}\label{subsection-5}
\begin{proposition}{}{}{proposition-6}%
\hypertarget{p-54}{}%
Let \(X = V/\Lambda\). Then%
\begin{equation*}
H^r (X,\ZZ) \cong \{\text{alternating }r\text{-forms } \Lambda\times\cdots\times\Lambda\to \ZZ\}\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-10}{}
\hypertarget{p-55}{}%
\(\pi\colon V\to V/\Lambda\) is a universal covering map, so%
\begin{equation*}
\Lambda = \pi^{-1} (0 ) \cong \pi_1(X,0)\text{.}
\end{equation*}
Because all these spaces are nice%
\begin{equation*}
H^1 (X,\ZZ) \cong \Hom(\pi_1(X), \ZZ) \cong \Hom(\Lambda, \ZZ)\text{.}
\end{equation*}
To extend to \(r \ne 1\) use the Künneth formula:%
\begin{equation*}
\xymatrix{
\bigwedge^r(H^1(X_1\times X_2, \ZZ)) \ar@{=}[r]\ar@{=}[d]^{\text{Künneth}} & H^r(X_1\times X_2 , \ZZ)\ar@{=}[dd]^{\text{Künneth}}\\
\bigwedge^r(H^1(X_1, \ZZ)\otimes H^1(X_2, \ZZ)) \ar@{=}[d]& \\
\bigoplus_{p+q=r}(\bigwedge^p(H^1(X_1, \ZZ))\otimes\bigwedge^q(H^1(X_2, \ZZ))) \ar@{=}[r] & \bigoplus_{p+q=r}(H^p(X_1, \ZZ)\otimes H^q(X_2, \ZZ))
}
\end{equation*}
Since we know the proposition for \(S^1 = \RR/\ZZ\) by taking products and applying the above we get it for all complex tori \(V/\Lambda\).%
\end{proof}
\begin{proposition}{}{}{proposition-7}%
\hypertarget{p-56}{}%
There is a correspondence%
\begin{align*}
\{\text{Hermitian forms }H \text{ on } V\} \amp\leftrightarrow\{\text{Alternating forms }E\colon V\times V\to\RR,\,E(iu,iv) = E(u,v)\}\\
H\amp\mapsto \im H\\
E(iu,v)+ i E(u,v) \amp\mapsfrom E\text{.}
\end{align*}
%
\end{proposition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.3 Line bundles}
\typeout{************************************************}
%
\begin{subsectionptx}{Line bundles}{}{Line bundles}{}{}\label{subsection-6}
\hypertarget{p-57}{}%
Now we will consider \hyperref[def-line-bundle]{line bundles} on \(X = V/\Lambda\), that is%
\begin{equation*}
L\xrightarrow{\pi} X
\end{equation*}
such that for any \(x\in X\) there exists \(U\ni x\) with \(\pi^{-1} (U) \cong \CC \times U\). We can obtain these from hermitian forms and some auxilliary data as follows.%
\begin{definition}{}{definition-8}%
\hypertarget{p-58}{}%
If \(H\) is a hermitian form on \(V\) such that \(E(\Lambda\times\Lambda) \subseteq \ZZ\) there exists a map%
\begin{equation*}
\alpha \colon \Lambda \to \CC^*  = \{z\in \CC^* : |z| = 1\}
\end{equation*}
such that%
\begin{equation*}
\alpha(u + v) = e^{i\pi E(u,v)} \alpha(u) \alpha(v)\text{.}
\end{equation*}
%
\par
\hypertarget{p-59}{}%
Further, there is a \hyperref[def-line-bundle]{line bundle} \(L(H, \alpha)\) on \(X\) which is defined by quotienting \(\CC\times V\) by \(\Lambda\) which acts via%
\begin{equation*}
\phi_u(\lambda, v) = (\alpha(u)e^{\pi H(v,u) + \frac12 \pi H(u,u)}\lambda, v+u)\text{ for } u\in \Lambda\text{,}
\end{equation*}
we'll denote by \(e_u\) the factor \(\alpha(u)e^{\pi H(v,u) + \frac12 \pi H(u,u)}\) for brevity.%
\end{definition}
\begin{theorem}{Appell-Humbert.}{}{thm-appell-humbert}%
\hypertarget{p-60}{}%
Any \hyperref[def-line-bundle]{line bundle} on \(X\) is of the form \(L(H,\alpha)\) for some \(H\), \(\alpha\) as above. Further%
\begin{equation*}
L(H_1, \alpha_1) \otimes L(H_2, \alpha_2)  = L(H_1+ H_2, \alpha_1\alpha_2)\text{.}
\end{equation*}
In fact we have the following diagram%
\begin{equation*}
\xymatrix{
0 \ar[r] &
\Hom(\Lambda, \CC) \ar[r]\ar[d] &
\{\text{data } (H,\alpha)\} \ar[r]\ar[d] &
\{\text{gp. of Herm. } H \text{ w/ }E(\Lambda\times \Lambda) \subseteq \ZZ\} \ar[r]\ar[d] &
0 \\
0 \ar[r] &
\Pic^0(X) \ar[r] &
\Pic(X) \ar[r]_c &
\ker(H^2(X,\ZZ) \to H^2(X,\sheaf O_X)) \ar[r]&
0
}
\end{equation*}
where \(\Pic(X)\) is the group of all \hyperref[def-line-bundle]{line bundles} on \(X\) and \(\Pic^0\) is the subgroup of those which are topologically trivial.%
\end{theorem}
\hypertarget{p-61}{}%
We wanted functions \(X\to \CC\). Now we can instead consider sections \(s\) of \(L(H,\alpha) \xrightarrow{\pi} X\) i.e. maps \(s\colon X\to L(H,\alpha)\) with \(\pi\circ s = \id\). Denote the space of such sections \(H^0(X,L(H,\alpha))\).%
\begin{definition}{Theta functions.}{def-theta-function}%
\hypertarget{p-62}{}%
The sections of \(L(H, \alpha)\)  correspond to \hyperref[def-morph-riem-surf]{holomorphic functions}%
\begin{equation*}
\theta \colon V \to \CC
\end{equation*}
such that \(\theta(z+ u) = e_u \theta(z)\), we will call such a \(\theta\) a \terminology{theta function} for \((H,\alpha)\).%
\end{definition}
\hypertarget{p-63}{}%
If \(H\) is not positive definite the space of such functions is 0!%
\begin{proposition}{}{}{prop-dimension-sections-complex}%
\hypertarget{p-64}{}%
If \(H\) is positive definite, then the dimension of \(H^0(X, L(H,\alpha))\) is \(\sqrt{\det E}\) where we really mean the determinant of a matrix for \(E\) with respect to an integral basis.%
\end{proposition}
\begin{theorem}{Lefschetz.}{}{theorem-6}%
\hypertarget{p-65}{}%
Given a positive definite \(H\), there exists an imbedding \(X \hookrightarrow \PP^m\).%
\end{theorem}
\begin{proof}\hypertarget{proof-11}{}
\hypertarget{p-66}{}%
Sketch: Let \(L = L(H,\alpha)\), consider \(L(H,\alpha)^{\otimes 3} = L(3H, \alpha^3)\), take a basis of \(\theta_0,\ldots, \theta_d\) of \(H^0(X, L^{\otimes 3})\).%
\par
\hypertarget{p-67}{}%
Claim: \(\Theta\colon z\mapsto (\theta_0(z) :\cdots :\theta_d (z)) \subseteq \PP^d\) is an embedding.%
\par
\hypertarget{p-68}{}%
To see that this is well defined, we must give a section of \(L^{\otimes 3}\) not vanishing at \(z\) for all \(z\in X\). Let \(\theta \in H^0(X,L)\smallsetminus \{0\}\). Then pick \(a,b\) such that the section of \(L^{\otimes 3}\) given by%
\begin{equation*}
\theta(z-a)\theta(z-b) \theta(z+ a+b)
\end{equation*}
does not vanish. This is possible and thus we have a nonvanishing section of \(L^{\otimes 3}\).%
\par
\hypertarget{p-69}{}%
For injectivity, show that if the above section has the same values on \(z_1,z_2\) then it is a \hyperref[def-theta-function]{theta function} for some sublattice. Almost all sections aren't \hyperref[def-theta-function]{theta functions} for a sublattice (this uses \hyperref[prop-dimension-sections-complex]{Proposition~\ref{prop-dimension-sections-complex}}).%
\par
\hypertarget{p-70}{}%
Something similar must be done for tangent vectors.%
\end{proof}
\begin{definition}{Riemann forms.}{def-riemann-form}%
\hypertarget{p-71}{}%
A \terminology{Riemann form} is \(E\colon \Lambda \times \Lambda \to \ZZ\) alternating such that%
\begin{equation*}
E_\RR \colon V\times V\to \RR
\end{equation*}
has the property that \(E(iu,iv) = E(u,v)\) and  the corresponding Hermitian form is positive definite.%
\end{definition}
\begin{definition}{Polarizable tori.}{def-polarizable}%
\hypertarget{p-72}{}%
A \hyperref[def-complex-torus]{complex torus} \(X = V/\Lambda\) is \terminology{polarizable} if there exists a \hyperref[def-riemann-form]{Riemann form} \(E\) on \(\Lambda\).%
\end{definition}
\begin{example}{Proposition.}{example-3}%
\hypertarget{p-73}{}%
Every \(\CC/\Lambda\) where \(\Lambda = \langle 1,\tau\rangle_{\ZZ}\) is \hyperref[def-polarizable]{polarizable}.%
\par
\hypertarget{p-74}{}%
To see this take%
\begin{equation*}
E(u,v) = \frac{uv}{\im \tau}
\end{equation*}
as a \hyperref[def-riemann-form]{Riemann form}.%
\end{example}
\hypertarget{p-75}{}%
Putting everything together we have obtained an equivalence of categories%
\begin{equation*}
\{\text{abelian varieties over } \CC\} \leftrightarrow \{\text{polarizable complex tori}\}\text{.}
\end{equation*}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.4 Isogenies}
\typeout{************************************************}
%
\begin{subsectionptx}{Isogenies}{}{Isogenies}{}{}\label{subsection-7}
\begin{definition}{Isogenies of complex tori.}{def-isogeny-tori}%
\hypertarget{p-76}{}%
An \terminology{isogeny} of complex tori is a homomorphism \(V/\Lambda \to V'/\Lambda'\) with finite kernel.%
\end{definition}
\begin{definition}{Dual vector spaces.}{definition-13}%
\hypertarget{p-77}{}%
Given \(V\) a complex vector space, let%
\begin{equation*}
V^* = \{f\colon V\to \CC : f(u+v) = f(u)+f(v),\,f(\alpha v) = \bar \alpha f(v) \}
\end{equation*}
and given \(\Lambda \subset V\) a \hyperref[def-buntes-lattice]{lattice}, let%
\begin{equation*}
\Lambda^* = \{f\in V^* : f(\lambda) \in \ZZ\,\forall \lambda\in \Lambda\}\text{.}
\end{equation*}
%
\end{definition}
\begin{definition}{Dual tori.}{def-dual-torus}%
\hypertarget{p-78}{}%
If \(X = V/\Lambda\), \(X^\vee = V^*/ \Lambda^*\) is the \terminology{dual torus}.%
\end{definition}
\begin{proposition}{Existence of Weil pairing.}{}{prop-weil-pair}%
\hypertarget{p-79}{}%
%
\begin{equation*}
X\times X^\vee \to \CC
\end{equation*}
so%
\begin{equation*}
X[n] \times X^\vee[n] \to \left(\frac{1}{n^2} \ZZ/\frac{1}{n} \ZZ\right) \cong \ZZ/n\ZZ
\end{equation*}
this is called the \terminology{Weil pairing}.%
\end{proposition}
\hypertarget{p-80}{}%
Can a \hyperref[def-complex-torus]{complex torus} be isogenous to its own dual? If \(X\) is \hyperref[def-polarizable]{polarizable} then%
\begin{align*}
X \amp\to X^\vee\\
v\amp\mapsto H(v,-)
\end{align*}
is an \hyperref[def-supersing-isog-isog]{isogeny}.%
\begin{definition}{}{def-complex-pol}%
\hypertarget{p-81}{}%
A \terminology{polarization} is an \hyperref[def-supersing-isog-isog]{isogeny} \(X \to X^\vee\).%
\end{definition}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.4 Rational Maps into Abelian Varieties (Maria)}
\typeout{************************************************}
%
\begin{sectionptx}{Rational Maps into Abelian Varieties (Maria)}{}{Rational Maps into Abelian Varieties (Maria)}{}{}\label{sec-rational-maps-avs}
\begin{introduction}{}%
\hypertarget{p-82}{}%
Note all varieties are irreducible today.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.4.1 Rational maps}
\typeout{************************************************}
%
\begin{subsectionptx}{Rational maps}{}{Rational maps}{}{}\label{subsection-8}
\hypertarget{p-83}{}%
\(V,W\) varieties \(/K\). Consider pairs \((U,\phi_U)\), where \(\emptyset \ne  U \subset V\) an open subset so \(U\) is dense, and \(\phi_U \colon U \to W\) is a regular map.%
\begin{definition}{Rational maps.}{def-rational-map}%
\hypertarget{p-84}{}%
\((U,\phi_U)\), \((U',{\phi_{U'}})\) are equivalent if \(\phi_U\) and \(\phi_{U'}\) agree on \(U \cap U'\). An equivalence class \(\phi\) of \(\{(U, \phi_U)\}\) is a \terminology{rational map} \(\phi \colon V \dashrightarrow W\) If \(\phi\colon V \dashrightarrow W\) is defined at   \(v\in V\) if \(v\in U\) for some \((U,\phi_U) \in \phi\).%
\end{definition}
\begin{note}{}{note-1}%
\hypertarget{p-85}{}%
The set \(U_1 = \bigcup U\) where  \(\phi\) is defined is open and \((U_1,\phi_1) \in \phi\) where \(\phi_1 \colon U_1 \to W\) restricts to \(\phi_U\) on \(U\).%
\end{note}
\begin{example}{}{example-4}%
\hypertarget{p-86}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-18}{}Let \(\emptyset \ne W \subseteq V\) be open. Then the \hyperref[def-rational-map]{rational map} \(V\dashrightarrow W\) induced by \(\id \colon W \to W\) will not extend to \(V\). To avoid this, assume \(W \) is \hyperref[def-abelian-complete-var]{complete} (so \(W = V\)).%
\item\hypertarget{li-19}{}\(C \colon y^2 = x^3\), then \(\alpha\colon \aff^1 \to C\), \(a\mapsto (a^2,a^3)\) is a regular map, restricting to an isomorphism  \(\aff^1 \smallsetminus \{0 \} \to C \smallsetminus \{0\}\). The inverse of \(\alpha|_{\aff^1\smallsetminus \{0\}}\) represents \(\beta \colon C \dashrightarrow \aff^1\) which does not extend to \(C\). This corresponds on function fields to%
\begin{equation*}
K(t) \to K(x,y)
\end{equation*}
%
\begin{equation*}
t\mapsto y/x
\end{equation*}
which does not send \(K[y]_{(t)}\) to \(K[x,y]_{(x,y)}\).%
\item\hypertarget{li-20}{}Given a nonsingular surface \(V,\, P\in V\) then \(\exists \alpha\colon W \to V\) regular that induces an isomorphism \(\alpha\colon W\smallsetminus \alpha^{-1} (P) \to V\smallsetminus P\), but \(\alpha^{-1}(P)\) is a projective line. The \hyperref[def-rational-map]{rational map} represented by \(\alpha^{-1}\) is not regular on \(V\) (where to send \(P\)?).%
\end{enumerate}
%
\end{example}
\begin{theorem}{Milne 3.1.}{}{thm-milne-3-1}%
\hypertarget{p-87}{}%
A \hyperref[def-rational-map]{rational map} \(\phi\colon V\dashrightarrow W\) from a nonsingular variety \(V\) to a \hyperref[def-abelian-complete-var]{complete} variety \(W\) is defined on an open subset  \(U \subseteq V\) whose complement has codimension \(\ge 2\).%
\end{theorem}
\begin{proof}\hypertarget{proof-12}{}
\hypertarget{p-88}{}%
(\(V\) a curve) \(V\) nonsingular curve, \(\emptyset\ne U\subseteq V\) open, \(\phi\colon U \to W\) a regular map.%
\begin{equation*}
\xymatrix{
& V\\
U\ar[ur]\ar[dr] \ar[r] & U' \subseteq Z \subseteq V\times W \ni (v,w)\ar[d]_q \ar[u]_p \\
& W \ni w
}
\end{equation*}
\(U'\) is the image of \(U\), \(Z = \overline{U'}\). \(W \) is \hyperref[def-abelian-complete-var]{complete}, \(Z\) closed implies \(p(Z) \subseteq V\) is closed. Also, \(U \subseteq p(Z) \implies p(Z)= V\).%
\begin{equation*}
U\xrightarrow{\sim} U' \to U
\end{equation*}
so%
\begin{equation*}
U' \xrightarrow{\sim} U
\end{equation*}
%
\begin{equation*}
Z \twoheadrightarrow V
\end{equation*}
this implies \(Z \xrightarrow\sim V\). Then \(q|_Z \colon Z \to W\) is the extension of \(\phi \) to \(V\).%
\end{proof}
\begin{theorem}{Milne 3.2.}{}{thm-milne-3-2}%
\hypertarget{p-89}{}%
A \hyperref[def-rational-map]{rational map} \(\phi\colon V\dashrightarrow A\) from a nonsingular variety \(V\) to an \hyperref[def-buntes-abvar]{abelian variety} \(W\), extends to all of \(V\).%
\end{theorem}
\begin{proof}\hypertarget{proof-13}{}
\hypertarget{p-90}{}%
\hyperref[thm-milne-3-1]{Theorem~\ref{thm-milne-3-1}} \hyperref[lem-milne-3-3]{Lemma~\ref{lem-milne-3-3}}%
\end{proof}
\begin{lemma}{}{}{lem-milne-3-3}%
\hypertarget{p-91}{}%
Let \(\phi\colon V \dashrightarrow G\) be a map from a nonsingular variety to a group variety. Then either \(\phi\) is defined on all of \(V\) or the set where \(\phi\) is not defined is closed of pure codimension 1.%
\end{lemma}
\begin{proof}\hypertarget{proof-14}{}
\hypertarget{p-92}{}%
Fix \((U, \phi_U) \in \phi\) and consider%
\begin{equation*}
\Phi\colon V\times V \dashrightarrow G
\end{equation*}
represented by%
\begin{equation*}
U\times U\xrightarrow{\phi_U\times\phi_U} G\times G \xrightarrow{\id\times\operatorname{inv}} G\times G \xrightarrow{m} \to G
\end{equation*}
%
\begin{equation*}
(x,y) \mapsto \phi_U(x) \phi_U(y)^{-1}
\end{equation*}
Check \(\phi\) is defined at \(x\) iff \(\Phi\) is defined at \((x,x)\) (and in this case \(\Phi(x,x) = e\)). This is equivalent to the map \(\Phi^*\colon \sheaf O_{G,e} \to K(V\times V)\) induced by  \(\Phi\) satisfying   \(\im(\sheaf O_{G,e}) \subseteq \sheaf O_{V\times V, (x,x)}\) For a nonzero function \(f\) on \(V\times V\), write \(\divisor(f) = \divisor(f)_0 - \divisor(f)_\infty\) which are effective divisors. Then%
\begin{equation*}
\sheaf O_{V\times V, (x,x)} = \{0\} \cup \{f\in K(V\times V) : \divisor(f)_\infty \text{ does not contain }(x,x)\}\text{.}
\end{equation*}
Suppose \(\phi\) is not defined at \(x\), then there exists \(f\in \im(\sheaf O_{G,e})\) s.t. \((x,x) \in \divisor(f)_\infty\). Then \(\Phi\) is not defined at any \((y,y) \in \Delta \cap  \divisor(f)_\infty = \divisor(f^{-1})_0\), which is a pure codimension 1 subset of \(\Delta\) by Milne's AG thm 9.2. The corresponding subset in \(V\) is of pure codimension 1, and \(\phi\) is not defined there.%
\end{proof}
\begin{theorem}{Milne 3.4.}{}{thm-milne-3-4}%
\hypertarget{p-93}{}%
Let \(\alpha \colon V \times W \to A\) be a morphism from a product of nonsingular varieties into an \hyperref[def-buntes-abvar]{abelian variety}. If \(\alpha (V\times\{w_0\}) = \{a_0 \} =  \alpha(\{v_0 \}\times W)\) for some \(a_0 \in A\), \(v_0\in W\), \(w_0 \in W\), then \(\alpha(V\times W) = \{a_0\}\).%
\end{theorem}
\begin{corollary}{Milne 3.7.}{}{cor-milne-3-7}%
\hypertarget{p-94}{}%
Every \hyperref[def-rational-map]{rational map} \(\alpha \colon G\dashrightarrow A\) from a group variety into an \hyperref[def-buntes-abvar]{abelian variety} is the composition of a homomorphism and a translation in \(A\).%
\end{corollary}
\begin{proof}\hypertarget{proof-15}{}
\hypertarget{p-95}{}%
Since group varieties are nonsingular, \(\alpha\colon G \to A\) is a regular map by \hyperref[thm-milne-3-2]{Theorem~\ref{thm-milne-3-2}}. The rest is as proof of Corollary 1.2.%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.4.2 Dominating and birational maps}
\typeout{************************************************}
%
\begin{subsectionptx}{Dominating and birational maps}{}{Dominating and birational maps}{}{}\label{subsection-9}
\begin{definition}{Dominating maps.}{def-dominating-maps}%
\hypertarget{p-96}{}%
\(\phi\colon V \dashrightarrow W\) is \terminology{dominating} if \(\im (\phi_U)\) is dense in \(W\) for a representative \((U,\phi_U)\in \phi\).%
\end{definition}
\hypertarget{p-97}{}%
Exercise: A \hyperref[def-dominating-maps]{dominating} \(\phi\colon V\dashrightarrow W\) defines a homomorphism \(K(W) \to K(V)\) and any such homomorphism arises from a unique \hyperref[def-dominating-maps]{dominating} \hyperref[def-rational-map]{rational map}.%
\begin{definition}{}{def-birational}%
\hypertarget{p-98}{}%
\(\phi\colon V \dashrightarrow W\) is \terminology{birational} if the corresponding \(K(W)\to K(V)\) is an isomorphism or, equivalently if there exists \(\psi\colon W\dashrightarrow V \) s.t. \(\phi\circ \psi\) and \(\psi\circ\phi\) are the identity wherever they are defined. In this case we say \(V\) and \(W\) are \terminology{birationally equivalent}.%
\end{definition}
\begin{note}{}{note-2}%
\hypertarget{p-99}{}%
In general \hyperref[def-birational]{birational} equivalence does not imply isomorphic. E.g. \(V\) a variety \(\emptyset \ne W\subsetneq V\) an open subset, or \(V= \aff^1, W \colon y^2 =x^3\).%
\end{note}
\begin{theorem}{Milne 3.8.}{}{prop-milne-3-8}%
\hypertarget{p-100}{}%
If two \hyperref[def-buntes-abvar]{abelian varieties} are \hyperref[def-birational]{birationally equivalent} then they are isomorphic as \hyperref[def-buntes-abvar]{abelian varieties}.%
\end{theorem}
\begin{proof}\hypertarget{proof-16}{}
\hypertarget{p-101}{}%
\(A,B\) \hyperref[def-buntes-abvar]{abelian varieties} with \(\phi \colon A\dashrightarrow B\) a \hyperref[def-birational]{birational} map with inverse \(\psi\). Then by \hyperref[thm-milne-3-2]{Theorem~\ref{thm-milne-3-2}} \(\phi ,\psi\) extend to regular maps   \(\phi\colon A \to B \), \(\psi\colon B\to A\) and \(\phi\circ\psi,\psi\circ\phi\) are  the identity everywhere. This implies that \(\phi\) is an isomorphism of  algebraic varieties and after composition with a translation, \(\phi\) is also a group isomorphism.%
\end{proof}
\begin{proposition}{Milne 3.9.}{}{prop-milne-3-9}%
\hypertarget{p-102}{}%
Any \hyperref[def-rational-map]{rational map} \(\aff^1 \dashrightarrow A\) or \(\PP^1 \dashrightarrow A\), for \(A\) an \hyperref[def-buntes-abvar]{abelian variety} is constant.%
\end{proposition}
\begin{proof}\hypertarget{proof-17}{}
\hypertarget{p-103}{}%
\hyperref[thm-milne-3-2]{Theorem~\ref{thm-milne-3-2}} implies \(\alpha \colon \aff^1 \dashrightarrow A\) extends to \(\alpha \colon \aff^1\to A\) and we may assume \(\alpha(0) = e\). \((\aff^1, +)\): \(\alpha(x+y) = \alpha(x) + \alpha(y)\) for all \(x,y\in \aff^1(K) = K\). \((\aff^1\smallsetminus\{0\}, \cdot)\): \(\alpha(xy) = \alpha(x) + \alpha(y) + c\) for all \(x,y\in K^\times\). These can only hold at the same time if \(\alpha\) is constant. \(\PP^1 \dashrightarrow A\) is constant, since its constant on affine patches.%
\end{proof}
\begin{definition}{}{def-unirational}%
\hypertarget{p-104}{}%
\(V/\overline K\) is \terminology{unirational} if there is a \hyperref[def-dominating-maps]{dominating} map \(\aff^n \dashrightarrow V\), where \(n = \dim_{\overline K} V\). \(V/K\) is \hyperref[def-unirational]{unirational} if \(V/K\) is.%
\end{definition}
\begin{proposition}{Milne 3.10.}{}{prop-milne-3-10}%
\hypertarget{p-105}{}%
Every \hyperref[def-rational-map]{rational map} \(V\dashrightarrow A\) from \(V\) \hyperref[def-unirational]{unirational} to \(A\) abelian is constant.%
\end{proposition}
\begin{proof}\hypertarget{proof-18}{}
\hypertarget{p-106}{}%
Wlog \(K = \overline K\). Since \(V\) is \hyperref[def-unirational]{unirational} we get \(\beta \colon \PP^1\times\cdots\times\PP^1 \dashrightarrow V\dashrightarrow A\), which extends to \(\beta \colon \PP^1\times\cdots\times\PP^1 \to A\). Then by Milne corollary 1.5, there exist regular maps \(\beta_i \colon \PP^1 \to A\) s.t. \(\beta(x_1,\ldots, x_n) = \sum \beta_i(x_i)\) and by \hyperref[prop-milne-3-9]{Proposition~\ref{prop-milne-3-9}} each \(\beta_i\) map is constant.%
\end{proof}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.5 Theorem of the Cube (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Theorem of the Cube (Ricky)}{}{Theorem of the Cube (Ricky)}{}{}\label{sec-thm-cube}
%
%
\typeout{************************************************}
\typeout{Subsection 1.5.1 Crash Course in Line Bundles}
\typeout{************************************************}
%
\begin{subsectionptx}{Crash Course in Line Bundles}{}{Crash Course in Line Bundles}{}{}\label{sec-crash-course-line-bundles}
\hypertarget{p-107}{}%
Consider \(\RR^2\), \(f\colon \RR \to \RR\) , \(f(x,y) = x^2 + y^2 -1\), now \(S = \{f=0\}\subseteq \RR^2\) is a closed submanifold (in fact a circle). Question: Do all closed submanifolds arise in this way? Lets switch to \(\CC\) better analogies with AG.%
\begin{example}{}{example-5}%
\hypertarget{p-108}{}%
Let \(X\in \PP^n(\CC)\), the answer here is no! (Because \(f\colon X \to \CC^1\) is constant!) Want to define functions locally that give us level sets, but gluing such will give us a global section. Instead glue in a different way (i.e. into different ``copies'' of \(\CC\)) so that this doesn't happen.%
\end{example}
\begin{example}{}{example-6}%
\hypertarget{p-109}{}%
\(X\in \PP_\CC^1\), \(\sheaf O_X\) the structure sheaf.%
\begin{equation*}
X = U_0 \cup U_1 = (\aff^1,t) \cup(\aff^1,s)
\end{equation*}
on \(U_0\cap U_1\), \(t = s^{-1}\). What is a global section of \(\sheaf O_X\), a section of \(U_0\) and a section of \(U_1\) that glue. \(\sheaf O_X(U_0) =  k[t], \sheaf O_X(U_1) =  k[s]\) so given \(f(t), g(s)\) these glue to a global section iff \(f(t) = g(1/t)\) so \(f,g\) must be constant.%
\end{example}
\begin{definition}{Line bundles.}{def-line-bundle}%
\hypertarget{p-110}{}%
A \terminology{line bundle} on \(X\) is a locally free \(\sheaf O_X\)-module of rank 1, i.e. \(\exists \{U_i\}\) open cover along with isomorphisms \(\phi_i\colon \sheaf L|_{U_i} \xrightarrow\sim \sheaf O_X |_{U_i}\).%
\end{definition}
\begin{inlineexercise}{}{exercise-1}%
\hypertarget{p-111}{}%
Alternative definition: A \hyperref[def-line-bundle]{line bundle} on \(X\) is equivalent to the following data:\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}An open cover of \(X\).%
\item{}Transition maps \(\tau_{ij} \in \GL_1(\sheaf O_X(U_i\cap U_j))\) satisfying \(\tau_{ij}\tau_{jk} =\tau_{ik}\) and \(\tau_{ii} = \id\).%
\end{itemize}
%
\end{inlineexercise}
\begin{example}{}{example-7}%
\hypertarget{p-112}{}%
On \(X = \PP^n_k\), we have \hyperref[def-line-bundle]{line bundles} \(\sheaf O(d)\) for all \(d\in \ZZ\). Just have to give cover and transition functions, use usual open cover \(\{U_i\}\) with \(U_i\cong \aff^n\). Then \(\tau_{ji}\) is given by multiplication by \((x_i/x_j)^d\).%
\end{example}
\begin{inlineexercise}{}{exercise-2}%
\hypertarget{p-113}{}%
%
\begin{equation*}
H^0(X,\sheaf O(d)) ( = \Gamma (X,\sheaf O(d)))
\end{equation*}
\(= k\)vector space spanned by deg. \(d\) homogenous polynomials  in \(k[x_0,\ldots, x_n]\).%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-3}%
\hypertarget{p-114}{}%
All \hyperref[def-line-bundle]{line bundles} on \(\PP^n\) are isomorphic to some \(\sheaf O(d)\).%
\end{inlineexercise}
\hypertarget{p-115}{}%
We say a \hyperref[def-line-bundle]{line bundle} \(\sheaf L\) on \(X\) is trivial if \(\sheaf L \cong \sheaf O_X\). Given \(\sheaf L_1\) and \(\sheaf L_2\) on \(X\) (line bundles) we can create a new \hyperref[def-line-bundle]{line bundle} \(\sheaf L = \sheaf L_1 \otimes \sheaf L_2\). So isomorphism classes of \hyperref[def-line-bundle]{line bundles} on \(X\) with \(\otimes\) form a group, denoted \(\Pic(X)\) with identity \(\sheaf O_X\) and inverses \(\sheaf L^{-1} = \Hom(\sheaf L , \sheaf O_X)\).%
\begin{example}{}{example-8}%
\hypertarget{p-116}{}%
By previous exercise \(\Pic(\PP_k^n) \cong \ZZ\) since \(\sheaf O_X(d_1) \otimes \sheaf O_X(d_2)  \cong \sheaf O_X(d_1+d_2)\).%
\end{example}
\begin{fact}{}{}{fact-1}%
\hypertarget{p-117}{}%
If \(f\colon X \to Y\), then given \(\sheaf L\) on \(Y\) we can pullback to a \hyperref[def-line-bundle]{line bundle} \(f^* \sheaf L\) on \(X\), definition is complicated. We also know that \(f^*\) commutes with \(\otimes\) so in fact (as \(f^*\sheaf O_Y = \sheaf O_X\)) we get a homomorphism \(f^* \colon \Pic(Y) \to \Pic(X)\).%
\end{fact}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.5.2 Relation to (Weil) divisors}
\typeout{************************************************}
%
\begin{subsectionptx}{Relation to (Weil) divisors}{}{Relation to (Weil) divisors}{}{}\label{sec-reln-weil}
\hypertarget{p-118}{}%
Let \(X\) be a normal variety, call \(Z\subseteq X\), a closed subvariety of codimension 1, a \terminology{prime divisor}. Then a divisor on \(X\) is a formal sum%
\begin{equation*}
D = \sum_{Z\subseteq X} n_Z\cdot Z
\end{equation*}
of \hyperref[sec-reln-weil]{prime divisors}.%
\par
\hypertarget{p-119}{}%
Let \(K = K(X)\) be the function field of \(X\). Given \(f\in K^\times\) we can define%
\begin{equation*}
\divisor (f) = \sum v_Z(f) \cdot Z\text{.}
\end{equation*}
%
\par
\hypertarget{p-120}{}%
Given \(D \in \Div(X)\), we can define a \hyperref[def-line-bundle]{line bundle} \(\sheaf L(D)\) on \(X\) via%
\begin{equation*}
\sheaf L(D)(U) = \{f\in K^\times : (D + \divisor (f))|_U\ge 0 \} \cup \{0\}
\end{equation*}
where \(D|_U = \sum_{Z\cap U\ne \emptyset} n_Z\cdot (Z\cap U)\).%
\begin{proposition}{}{}{proposition-12}%
\hypertarget{p-121}{}%
The map%
\begin{equation*}
\Cl(X) = \Div(X)/\Princ(X) \xrightarrow{\sheaf L(\cdot)} \Pic(X)
\end{equation*}
is an isomorphism.%
\end{proposition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.5.3 Onto cubes}
\typeout{************************************************}
%
\begin{subsectionptx}{Onto cubes}{}{Onto cubes}{}{}\label{sec-onto-cubes}
\begin{theorem}{Theorem of the cube.}{}{thm-cube}%
\hypertarget{p-122}{}%
Let \(U,V,W\) be \hyperref[def-abelian-complete-var]{complete} varieties. If \(\sheaf L \) is a \hyperref[def-line-bundle]{line bundle} on \(U\times V\times W\) s.t. \(\sheaf L|_{\{u_0\}\times V\times W},\sheaf L|_{U\times \{v_0\}\times W}, \sheaf L|_{U\times V\times \{w_0\}}\) are all trivial then \(\sheaf L\) is trivial.%
\end{theorem}
\begin{corollary}{Milne 5.2.}{}{cor-5-2}%
\hypertarget{p-123}{}%
Let \(A\) be an \hyperref[def-buntes-abvar]{abelian variety}. Let \(p_i\colon A\times A\times A \to A\) be the projection onto the \(i\)th coordinate. \(p_{ij} = p_i+p_j\), \(p_{123} = p_1+p_2+p_3\). Then for any \(\sheaf L\) on \(A\), the \hyperref[def-line-bundle]{line bundle}%
\begin{equation*}
\sheaf M  = p_{123}^*\sheaf L \otimes p_{12}^*\sheaf L^{-1}\otimes p_{23}^*\sheaf L^{-1}\otimes p_{13}^*\sheaf L^{-1} \otimes p_1^*\sheaf L \otimes p_2^*\sheaf L \otimes p_3^*\sheaf L
\end{equation*}
is trivial.%
\end{corollary}
\begin{proof}\hypertarget{proof-19}{}
\hypertarget{p-124}{}%
Let  \(m \colon A\times A \to A\) be multiplication (addition?) and \(p,q\) the projections \(A\times A \to A\). Then the composites of the maps \(\phi\colon A\times A \to A \times A \times A, \phi(x,y) = (x,y,0)\) with \(p_{123}, p_{12}, p_{23}, p_{13}, p_1, p_2, p_3\) are respectively \(m,m,q, p, p, q, 0\). Hence the restriction of \(\sheaf M\) to \(A \times A \times \{0\}\) is%
\begin{equation*}
m^* \sheaf L \otimes m^* \sheaf L^{-1} \otimes q^* \sheaf L^{-1} \otimes p^*\sheaf L^{-1} \otimes p^*\sheaf L \otimes q^*\sheaf L \otimes \sheaf O_{A\times A}
\end{equation*}
this is trivial by tensor commuting with pullback. Similarly \(\sheaf M\) restricts to a trivial bundle on \(A\times \{0\} \times A\) and \(\{0\}\times A \times A\). So by \hyperref[thm-cube]{theorem of the cube~\ref{thm-cube}} \(\sheaf M\) is trivial.%
\end{proof}
\begin{corollary}{Milne 5.3.}{}{cor-5-3}%
\hypertarget{p-125}{}%
Let \(f,g, h\colon V \to A\) (\(A\) abelian). Then for any \(\sheaf L\) on \(A\) the bundle%
\begin{equation*}
\sheaf M  = (f+g+h)^*\sheaf L \otimes (f+g)^*\sheaf L^{-1}\otimes (f+h)^*\sheaf L^{-1}\otimes (g+h)^*\sheaf L^{-1} \otimes   f^*\sheaf L \otimes   g^*\sheaf L \otimes   h^*\sheaf L
\end{equation*}
is trivial.%
\end{corollary}
\begin{proof}\hypertarget{proof-20}{}
\hypertarget{p-126}{}%
\(\sheaf M\) is the pullback of the \hyperref[def-line-bundle]{line bundle} of \hyperref[cor-5-2]{Corollary~\ref{cor-5-2}} via the map \((f,g,h) \colon V \to A\times A\times A\).%
\end{proof}
\hypertarget{p-127}{}%
On \(A\) we have \(n_A \colon A\to A\) be \(n_A(a) = a+\cdots + a\) (\(n\) times) for \(n\in \ZZ\).%
\begin{corollary}{Milne 5.4.}{}{cor-5-4}%
\hypertarget{p-128}{}%
For \(\sheaf L\) on \(A\) we have%
\begin{equation*}
n^*_A\sheaf L \cong \sheaf L^{(n^2 + n)/2} \otimes (-1)_A^* \sheaf L^{(n^2 - n)/2}
\end{equation*}
In particular if \((-1)^* \sheaf L = \sheaf L\) (symmetric) then \(n_A^* \sheaf L = \sheaf L^{n^2}\). And if \((-1)^* \sheaf L = \sheaf L^{-1}\) (antisymmetric) then \(n_A^* \sheaf L = \sheaf L^{n}\).%
\end{corollary}
\begin{proof}\hypertarget{proof-21}{}
\hypertarget{p-129}{}%
Use \hyperref[cor-5-3]{Corollary~\ref{cor-5-3}} with \(f= n_A, g = 1_A, h = (-1)_A\). So the \hyperref[def-line-bundle]{line bundle}%
\begin{equation*}
(n)^*\sheaf L \otimes (n+1)^*\sheaf L^{-1}\otimes (n-1)^*\sheaf L^{-1}\otimes (1-1)^*\sheaf L^{-1} \otimes   n^*\sheaf L \otimes   1^*\sheaf L \otimes   (-1)^*\sheaf L
\end{equation*}
is trivial i.e.%
\begin{equation*}
(n+1)^*\sheaf L =  (n-1)^*\sheaf L^{-1}\otimes n^*\sheaf L^2 \otimes   \sheaf L \otimes   (-1)^*\sheaf L
\end{equation*}
in statement \(n = 1\) is clear, so use \(n=1\) in the above to get%
\begin{equation*}
2_A^*\sheaf L \cong \sheaf L^2 \otimes \sheaf L \otimes (-1)^*_A \sheaf L\cong \sheaf L^3 \otimes (-1)_A^*\sheaf  L\text{.}
\end{equation*}
Then induct on \(n\) in above.%
\end{proof}
\begin{theorem}{Theorem of the square (Milne 5.5).}{}{thm-square}%
\hypertarget{p-130}{}%
Let \(\sheaf L\) be an invertible sheaf (line bundle) on \(A\). Let \(t_a \colon A\to A\) be translation by \(a\in A(k)\). Then%
\begin{equation*}
t_{a+b}^*\sheaf L \otimes \sheaf L \cong t_a^*\sheaf L \otimes t_b^* \sheaf L\text{.}
\end{equation*}
%
\end{theorem}
\begin{proof}\hypertarget{proof-22}{}
\hypertarget{p-131}{}%
Use \hyperref[cor-5-3]{Corollary~\ref{cor-5-3}} with \(f=  \id\), \(g(x)  = a, h(x) = b\) to get%
\begin{equation*}
t_{a+b}^*\sheaf L \otimes t_{a}^*\sheaf L ^{-1}\otimes t_b^* \sheaf L ^{-1} \otimes \sheaf L
\end{equation*}
is trivial.%
\end{proof}
\begin{remark}{}{remark-1}%
\hypertarget{p-132}{}%
Tensor by \(\sheaf L^{-2}\) in the above equation to get%
\begin{equation*}
t_{a+b}^*\sheaf L \otimes\sheaf L^{-1} \cong ( t_{a}^*\sheaf L \otimes \sheaf L^{-1}) \otimes(t_b^* \sheaf L\otimes \sheaf L^{-1})\text{.}
\end{equation*}
This gives a group homomorphism%
\begin{equation*}
A(k) \to \Pic(A)
\end{equation*}
via%
\begin{equation*}
a\mapsto t_a^*\sheaf L \otimes \sheaf L^{-1}
\end{equation*}
for any \(\sheaf L \in \Pic(A)\).%
\end{remark}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.6 The Adventures of BUNTES (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{The Adventures of BUNTES (Sachi)}{}{The Adventures of BUNTES (Sachi)}{}{}\label{sec-adventures-buntes}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.1 In which we are introduced to an important homomorphism, review some concepts and our story begins}
\typeout{************************************************}
%
\begin{subsectionptx}{In which we are introduced to an important homomorphism, review some concepts and our story begins}{}{In which we are introduced to an important homomorphism, review some concepts and our story begins}{}{}\label{subsection-13}
\hypertarget{p-133}{}%
Abelian variety  \(X\), we know this is a \hyperref[def-abelian-complete-var]{complete} group variety, our goal is to give an embedding \(X\to \PP^N\) for some \(N\). This motivates the study of \hyperref[def-line-bundle]{line bundles}.%
\par
\hypertarget{p-134}{}%
Last time Ricky proved theorem of \hyperref[thm-cube]{cube~\ref{thm-cube}} and \hyperref[thm-square]{square~\ref{thm-square}}. For any \hyperref[def-line-bundle]{line bundle}  \(L\) on \(X\), there is a group homomorphism \(\Phi_L\colon X \to \Pic(X)\) via \(x\mapsto T_x^* L\otimes L^{-1}\). Be careful \(T_x^*\) is \(-x\), convention, who knows why.%
\begin{example}{}{example-9}%
\hypertarget{p-135}{}%
Let \(X =E\) an \hyperref[def-supersing-isog-ec]{elliptic curve}, \(L = L((0))\), \(x\mapsto (x) - (0)\), in this case this is in \(\Pic^0(E) \cong E \cong \widehat E\),%
\end{example}
\begin{proposition}{}{}{proposition-13}%
\hypertarget{p-136}{}%
This is translation invariant.%
\end{proposition}
\begin{proof}\hypertarget{proof-23}{}
\hypertarget{p-137}{}%
Translate by \(q\in E\). \((x+q) - (q)\) take \(p\) to be the third point on the line with \(x,q\), \((x) + (q) + (p) \cong 3(0)\) and \((x+q) + (p) \cong 2 (0)\) subtracting these gives \((x) - (x+q) +(q) \cong (0)\) or \((x) - (0) \cong (x+q) -(q)\).%
\end{proof}
\hypertarget{p-138}{}%
What about the converse of this, what can we say about translation invariant \hyperref[def-line-bundle]{line bundles}%
\begin{equation*}
K(L) = \{x\in X : T_x^* L \cong L\}\text{?}
\end{equation*}
%
\begin{proposition}{}{}{proposition-14}%
\hypertarget{p-139}{}%
\(K(L)\) is Zariski closed in \(X\).%
\end{proposition}
\begin{proof}\hypertarget{proof-24}{}
\hypertarget{p-140}{}%
Consider \(m^* L \otimes p_2^*L^{-1}\) on \(X\times X\), then%
\begin{equation*}
\{x : \text{this is trivial on }\{x\}\times X\}
\end{equation*}
is closed. \hyperref[thm-see-saw]{See-saw~\ref{thm-see-saw}} implies restriction is pullback%
\begin{equation*}
T_x^*L \otimes L^{-1}
\end{equation*}
so this is \(K(L)\).%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.2 In which Pooh discovers our main theorem}
\typeout{************************************************}
%
\begin{subsectionptx}{In which Pooh discovers our main theorem}{}{In which Pooh discovers our main theorem}{}{}\label{subsection-14}
\begin{proposition}{}{}{proposition-15}%
\hypertarget{p-141}{}%
Let \(X\) be an \hyperref[def-buntes-abvar]{abelian variety} and \(L\) a \hyperref[def-line-bundle]{line bundle}, \(L = L(D)\) then TFAE:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-23}{}\(H(D) = \{x\in X: T_x^*D  = D \}\) is finite.%
\item\hypertarget{li-24}{}\(K(L) = \{x\in X: T_x^*L  \cong L \}\) is finite.%
\item\hypertarget{li-25}{}\(|2D|\) is basepoint free and defines a finite morphism \(X\to \PP^N\).%
\item\hypertarget{li-26}{}\(L\) is ample.%
\end{enumerate}
%
\end{proposition}
\begin{proof}\hypertarget{proof-25}{}
\hypertarget{case-1}{}\textit{3. to 4.}. \hypertarget{p-142}{}%
Is algebraic geometry.%
\par\medskip\noindent
\hypertarget{case-2}{}\textit{2. to 1.}. \hypertarget{p-143}{}%
Follows as being equal is stronger than being linearly equivalent.%
\par\medskip\noindent
\hypertarget{case-3}{}\textit{4. to 2.}. \hypertarget{p-144}{}%
\hyperref[sec-ample-L-finite-KL]{Section~\ref{sec-ample-L-finite-KL}}%
\par\medskip\noindent
\hypertarget{case-4}{}\textit{3. to 4.}. \hypertarget{p-145}{}%
\hyperref[sec-finite-HD-finite-PN]{Section~\ref{sec-finite-HD-finite-PN}}%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.3 In which Owl proves the ampleness of \(L\) implies finiteness of \(K(L)\)}
\typeout{************************************************}
%
\begin{subsectionptx}{In which Owl proves the ampleness of \(L\) implies finiteness of \(K(L)\)}{}{In which Owl proves the ampleness of \(L\) implies finiteness of \(K(L)\)}{}{}\label{sec-ample-L-finite-KL}
\hypertarget{p-146}{}%
4. to 2. Assume \(L\) ample and \(K(L)\) is infinite. Let \(Y\) be the connected component at 0 of \(K(L)\), \(\dim Y \gt 0\). Show trivial bundle is ample on \(Y\) implies \(Y\) is affine, But \(Y\) is closed and therefore \hyperref[def-abelian-complete-var]{complete} so this is a contradiction. \(L|_Y\) ample \(\lb-1\rb^* L|_Y\) is ample. \(L|_Y\otimes \lb -1\rb^*L|_Y\) is ample, consider%
\begin{align*}
d\colon \amp Y \to Y\times Y\\
\amp y\mapsto (y,-y)
\end{align*}
\(m\circ d = \) constant, \(d^*m^* (L) = \sheaf O_Y\), LHS is \(L|_Y \otimes [-1]^* L|_Y\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.4 In which Rabbbit sets out on a long journey to prove finiteness of \(H(D)\) implies \(|2D|\) is basepoint free and gives a finite map \(X \to \PP^N\)}
\typeout{************************************************}
%
\begin{subsectionptx}{In which Rabbbit sets out on a long journey to prove finiteness of \(H(D)\) implies \(|2D|\) is basepoint free and gives a finite map \(X \to \PP^N\)}{}{In which Rabbbit sets out on a long journey to prove finiteness of \(H(D)\) implies \(|2D|\) is basepoint free and gives a finite map \(X \to \PP^N\)}{}{}\label{sec-finite-HD-finite-PN}
\begin{note}{}{note-3}%
\hypertarget{p-147}{}%
\(|2D|\) is always basepoint free.%
\end{note}
\hypertarget{p-148}{}%
Apply the \hyperref[thm-square]{theorem of the square~\ref{thm-square}}: \(T_{x+y}^*D + D \cong T_x^* D + T_y^*D\), let \(y = -x\), \(2D \cong T_x^* D + T_{-x}^*D\). (\(D\) effective) For any \(y\in X\), choose some \(x\) s.t. RHS doesn't contain \(y\). \(E = 2D\)%
\begin{equation*}
\psi_E\colon X \to \PP^N
\end{equation*}
can we make this finite? If \(\psi_E\) is not finite then \(\psi(C) = \text{pt}\) for some irreducible curve \(C\) (Zariski's main theorem). For each divisor in \(|E|\) either it contains \(C\) or fails to intersect \(C\) by changing \(E\) if necessary, assume \(E \cap C = \emptyset\).%
\begin{claim}{}{}{claim-1}%
\hypertarget{p-149}{}%
\(T_x^*E\cap C= \emptyset\) or all of \(C\) for all \(x\in X\).%
\end{claim}
\begin{proof}\hypertarget{proof-26}{}
\hypertarget{p-150}{}%
Intersection numbers are constant.%
\end{proof}
\begin{proof}\hypertarget{proof-27}{}
\hypertarget{p-151}{}%
\(\sheaf O(T_x^*E)|_{\widetilde C}\), when \(x=0\) this is trivial so \(\deg =0\). So \(\deg = 0\) for all \hyperref[def-line-bundle]{line bundles}. \(E\) effective implies \(C\cap T_x^* E = \emptyset\) for all \(x\) s.t. \(\cap\) is not in \(C\).%
\end{proof}
\begin{claim}{}{}{claim-2}%
\hypertarget{p-152}{}%
\(E\) is invariant by translation by \(x - y\) for \(x,y \in C\).%
\end{claim}
\begin{proof}\hypertarget{proof-28}{}
\hypertarget{p-153}{}%
If \(e \in E\), \(T_{x-e}^*(E) \cap C \ne \emptyset\). This is as \(x\) is in it, \(x-(x-e) =e\), because it is nonempty it's all of \(C\). So \(y\) is in it. So \(y- (x-e) \in E\). This is also \(e - (x-y) \in E\), so \(E\) is invariant under \(T^*_{x-y}\)%
\end{proof}
\hypertarget{p-154}{}%
Now assume \(H(E) = \{x\in X: T_x^*E  = E \}\) is finite. But if \(\psi_E(C) = \text{pt}\) then \(T_{x-y}^*(E)  = E\) for all \(x,y\in C\). So \(H\) is not finite, a contradiction. So \(\psi_E\) can't collapse a curve so \(\psi_E\) is finite.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.5 In which Piglet discovers a corollary}
\typeout{************************************************}
%
\begin{subsectionptx}{In which Piglet discovers a corollary}{}{In which Piglet discovers a corollary}{}{}\label{subsection-17}
\begin{corollary}{}{}{corollary-8}%
\hypertarget{p-155}{}%
Abelian varieties are projective.%
\end{corollary}
\begin{proof}\hypertarget{proof-29}{}
\hypertarget{p-156}{}%
Let \(X\) be an \hyperref[def-buntes-abvar]{abelian variety}, \(U \subseteq X\) be an open affine set, \(0\in U\), \(X\smallsetminus U = D_1 \cup \cdots \cup D_t\) irreducible divisors. Let \(D = \sum D_i\), then claim: \(H(D) = \{x\in X: T_x^*D  = D \}\) is finite. If \(H\subseteq U\), \(U\) affine, then \(H\) closed subvariety of an \hyperref[def-buntes-abvar]{abelian variety}, hence \hyperref[def-abelian-complete-var]{complete}, so its finite. If \(x\in H\) then \(-x \in H\). Now claim that if \(x\in H\) then \(T_x^*\) preserves \(U\), if not let \(u\in U\). Suppose \(u-x = d\) for some \(d\in D\) then \(u = d+x\) which is \(d\) translated by \(-x\) so \(d+x \in D\) so \(u\in D\). But contradiction, oh no! So \(T_x^*\) preserves \(U\), for all \(x\in H\), as \(0 \in U\), for all \(x\in H\) we have \(0-x \in U\) and  \(0+x\in U\) so \(H\subseteq U\).%
\end{proof}
\begin{corollary}{}{}{corollary-9}%
\hypertarget{p-157}{}%
Abelian varieties are divisible. \(X[n]\) is finite for \(n\ge 1\).%
\end{corollary}
\begin{proof}\hypertarget{proof-30}{}
\hypertarget{p-158}{}%
\([n]\colon X \to X\) and \(X[n]\) is the kernel of this. Note that for \(x\in X[n]\)%
\begin{equation*}
[n]\circ T_x = [n]
\end{equation*}
\(y\in X\), then \(n(y-x) = ny - nx = ny\) so for all \(L \in \Pic X\)%
\begin{equation*}
T_x^*([n]^* L ) \cong ([n]^* L)
\end{equation*}
which implies%
\begin{equation*}
K([n]^* L ) \supseteq X[n]
\end{equation*}
and we just need to find \(L\) s.t. this is finite. \(X\) projective implies there exists an ample \(L\). The \hyperref[thm-cube]{theorem of the cube~\ref{thm-cube}} implies%
\begin{equation*}
[n]^*L \cong L^{\frac{n^2 + n}{2}} \otimes L^{\frac{n^2 - n}{2}}
\end{equation*}
where both terms on the right are ample, hence the left is also.%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.6 Epilogue: In which we might discuss isogenies}
\typeout{************************************************}
%
\begin{subsectionptx}{Epilogue: In which we might discuss isogenies}{}{Epilogue: In which we might discuss isogenies}{}{}\label{subsection-18}
\begin{definition}{}{definition-21}%
\hypertarget{p-159}{}%
\(f\colon X \to Y\) a morphism of varieties, get a field extension \(k(X)/f^*k(Y)\), if \(\dim X = \dim Y\) and \(f\) is surjective. Then this is a finite field extension and \(\deg f\) is \(d = \lb k(X) : f^*k(Y)\rb\) and \(d = \#f^{-1}(y)\) for almost all \(y\).%
\end{definition}
\begin{definition}{}{def-isogenies-avs}%
\hypertarget{p-160}{}%
A homomorphism of \hyperref[def-buntes-abvar]{abelian varieties} \(f\colon X \to Y\) is an \terminology{isogeny} if \(f\) is surjective with finite kernel.%
\end{definition}
\begin{corollary}{}{}{corollary-10}%
\hypertarget{p-161}{}%
Degree of \(\lb n\rb\) is \(n^{2g}\), if \(n\) is prime to the characteristic of \(k\), \(k = \overline k\), \(g = \dim X\).%
\end{corollary}
\begin{proof}\hypertarget{proof-31}{}
\hypertarget{p-162}{}%
Let \(D\) be an ample \hyperref[def-princ-pol]{symmetric} divisor, e.g.%
\begin{equation*}
D = D' + [-1]^* D'
\end{equation*}
know \(\lb n \rb^* D \sim n^2 D\)%
\begin{equation*}
\deg([n]^*(D\cdot\ldots\cdot D)) = ([n]^*D\cdot \ldots\cdot [n]^*D) = (n^2 D\cdot\ldots\cdot n^2 D)= n^{2g} (D\cdot \ldots\cdot D)\text{.}\qedhere
\end{equation*}
%
\end{proof}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.7 Line Bundles and the Dual Abelian Variety (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Line Bundles and the Dual Abelian Variety (Angus)}{}{Line Bundles and the Dual Abelian Variety (Angus)}{}{}\label{sec-dual-ab}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.1 Introduction}
\typeout{************************************************}
%
\begin{subsectionptx}{Introduction}{}{Introduction}{}{}\label{subsection-19}
\begin{paragraphs}{Meta-goal.}{paragraphs-1}%
\hypertarget{p-163}{}%
Understand \hyperref[def-line-bundle]{line bundles} on \hyperref[def-buntes-abvar]{abelian varieties}.%
\end{paragraphs}%
\begin{paragraphs}{Setup.}{paragraphs-2}%
\hypertarget{p-164}{}%
\(A\) an \hyperref[def-buntes-abvar]{abelian variety} \(/k\).%
\end{paragraphs}%
\begin{paragraphs}{Last time.}{paragraphs-3}%
\hypertarget{p-165}{}%
For \(L\) a \hyperref[def-line-bundle]{line bundle} on \(A\) we get a map%
\begin{align*}
\phi_L\colon A(K) \amp\to \Pic(A)\\
a\amp\mapsto t_a^* L\otimes L^{-1}
\end{align*}
where%
\begin{equation*}
\Pic(A) = \{\text{line bundles on } A\}/\sim\text{.}
\end{equation*}
This a is a group homomorphism (by the \hyperref[thm-square]{theorem of the square~\ref{thm-square}}). We define%
\begin{equation*}
K(L)(k) = \ker(\phi_L) = \{a\in A(k) : t_a^* L \simeq L\}\text{.}
\end{equation*}
%
\end{paragraphs}%
\begin{paragraphs}{Today.}{paragraphs-4}%
\hypertarget{p-166}{}%
We are going to package these into a big map%
\begin{align*}
\phi\colon \Pic(A)\amp\to \Hom(A(k), \Pic(A))\\
L \amp\mapsto \phi_L\text{.}
\end{align*}
%
\begin{proposition}{}{}{proposition-16}%
\hypertarget{p-167}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-27}{}\(\phi\) is a group homomorphism%
\item\hypertarget{li-28}{}%
\begin{equation*}
\phi_{t_a^* L}  = \phi_L
\end{equation*}
%
\end{enumerate}
%
\end{proposition}
\begin{proof}\hypertarget{proof-32}{}
\hypertarget{case-5}{}\textit{1}. \hypertarget{p-168}{}%
%
\begin{align*}
\phi_{L\otimes M}(a) \amp = t_a^*(L\otimes M) \otimes(L\otimes M)^{-1}\\
\amp = t_a^*L\otimes L^{-1} t_a^*M\otimes M^{-1}\\
\amp = \phi_L\otimes \phi_M
\end{align*}
%
\par\medskip\noindent
\hypertarget{case-6}{}\textit{2}. \hypertarget{p-169}{}%
%
\begin{align*}
\phi_{t_b^*L}(a) \amp = t_a^*(t_b^*L) \otimes(t_b^*L)^{-1}\\
\amp = t_{a+b}^*L \otimes(t_b^*L)^{-1}\\
\amp = t_{a}^*L \otimes t_b^*L \otimes L^{-1} \otimes (t_b^*L)^{-1}\\
\amp = \phi_L(a)
\end{align*}
by  the \hyperref[thm-square]{theorem of the square~\ref{thm-square}}%
\end{proof}
\begin{definition}{}{definition-23}%
\hypertarget{p-170}{}%
%
\begin{align*}
\Pic^0(A) \amp = \ker(\phi)\\
\amp = \{ L \in \Pic(A) : \phi_L = 0\}\\
\amp = \{ L \in \Pic(A) : t_a^* L\simeq L \ \forall a\in A(k)\}\\
\amp = \{\text{translation invariant line bundles}\}/\sim
\end{align*}
%
\end{definition}
\end{paragraphs}%
\begin{paragraphs}{Goals.}{paragraphs-5}%
\hypertarget{p-171}{}%
Study \(\Pic^0(A)\), give it an \hyperref[def-buntes-abvar]{abelian variety} structure, solve a moduli problem, demonstrate some duality.%
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.2 Aside: alternate description of \(\Pic^0(A)\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Aside: alternate description of \(\Pic^0(A)\)}{}{Aside: alternate description of \(\Pic^0(A)\)}{}{}\label{subsection-20}
\begin{definition}{Algebraic Equivalence.}{def-alg-equivalence}%
\hypertarget{p-172}{}%
Two \hyperref[def-line-bundle]{line bundles} \(L_1,L_2\)  on an \hyperref[def-buntes-abvar]{abelian variety} are \terminology{algebraically equivalent} if there exists a variety \(Y\) with \hyperref[def-line-bundle]{line bundle} \(L\) on \(A\times Y\) and points \(y_1y_2 \in Y\) s.t. \(L|_{A\times\{y_1\}} \simeq L_1, L|_{A\times\{y_2\}} \simeq L_2\).%
\end{definition}
\begin{remark}{}{remark-2}%
\hypertarget{p-173}{}%
This looks like homotopy.%
\end{remark}
\begin{proposition}{}{}{proposition-17}%
\hypertarget{p-174}{}%
%
\begin{equation*}
\Pic^0(A) = \{\text{line bundles which are alg. equiv to } \sheaf O_A\}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-33}{}
\hypertarget{p-175}{}%
\hyperlink{bib-polishchuck}{[52]}.%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.3 See-Saws}
\typeout{************************************************}
%
\begin{subsectionptx}{See-Saws}{}{See-Saws}{}{}\label{subsection-21}
\begin{theorem}{See-saw theorem.}{}{thm-see-saw}%
\hypertarget{p-176}{}%
Let \(X,T\) be varieties      \(X\) \hyperref[def-abelian-complete-var]{complete}, let \(L\) be a \hyperref[def-line-bundle]{line bundle}  on \(X\times T\), let \(T_1 = \{t\in T : L|_{X\times\{t\}} \text{ is trivial}\}\) then \(T_1\) is closed in \(T\). Further let \(p_2\colon X\times T_1 \to T_1\), then \(L|_{X\times T_1} \cong p^*_2 M\) for some \hyperref[def-line-bundle]{line bundle} \(M\) on \(T_1\).%
\end{theorem}
\begin{remark}{}{remark-3}%
\hypertarget{p-177}{}%
In fact \(M = p_{2*}L\).%
\end{remark}
\begin{corollary}{that no one states/only Milne.}{}{corollary-11}%
\hypertarget{p-178}{}%
Let X, T be as above and let \(L, M\) be \hyperref[def-line-bundle]{line bundles} on \(X\times T\) s.t.%
\begin{equation*}
L|_{X\times \{t\}} \cong M|_{X\times \{t\}} \forall t\in T
\end{equation*}
%
\begin{equation*}
L|_{\{t\}\times X} \cong M|_{\{t\}\times X} \text{ for some } x\in X
\end{equation*}
then \(L\cong M\).%
\end{corollary}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.4 Properties of \(\Pic^0 A\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Properties of \(\Pic^0 A\)}{}{Properties of \(\Pic^0 A\)}{}{}\label{subsection-22}
\begin{lemma}{}{}{lemma-2}%
\hypertarget{p-179}{}%
\(L\in \Pic^0(A)\) and \(m,p_1,p_2\colon A\times A \to A\)\leavevmode%
\begin{enumerate}
\item\hypertarget{li-29}{}%
\begin{equation*}
m^* L \cong p_1^* L\otimes p_2^* L
\end{equation*}
%
\item\hypertarget{li-30}{}Given \(f,g \colon X \to A\)%
\begin{equation*}
(f+g)^* L \cong f^* L \otimes g^* L
\end{equation*}
%
\item\hypertarget{li-31}{}%
\begin{equation*}
[n]^* L \cong L^{\otimes n}
\end{equation*}
%
\item\hypertarget{li-32}{}%
\begin{equation*}
\phi_L(A(k)) \subseteq \Pic^0(A)
\end{equation*}
for \(L \in \Pic (A)\).%
\end{enumerate}
%
\end{lemma}
\begin{proof}\hypertarget{proof-34}{}
\hypertarget{case-7}{}\textit{1}. \hypertarget{p-180}{}%
%
\begin{equation*}
(m^*L\otimes (p_1^*l)^{-1} \otimes (p_2^*l)^{-1})|_{A\times\{a\}} = t_a^*L \otimes L^{-1} = \sheaf O_A
\end{equation*}
%
\begin{equation*}
(m^*L\otimes (p_1^*l)^{-1} \otimes (p_2^*l)^{-1})|_{\{a\}\times A} = t_a^*L \otimes L^{-1} = \sheaf O_A
\end{equation*}
by \hyperref[thm-see-saw]{see-saw~\ref{thm-see-saw}} whole thing is trivial on \(A\times A\).%
\par\medskip\noindent
\hypertarget{case-8}{}\textit{2}. \hypertarget{p-181}{}%
%
\begin{equation*}
(f+g)^*L\cong (f\times g)^* m^*L \cong (f\times g)^*(p_1^*L \otimes p_2^*L) \cong f^*L \otimes g^*L
\end{equation*}
%
\par\medskip\noindent
\hypertarget{case-9}{}\textit{3}. \hypertarget{p-182}{}%
Induction of 3.%
\par\medskip\noindent
\hypertarget{case-10}{}\textit{4}. \hypertarget{p-183}{}%
%
\begin{equation*}
\phi_{\phi_L(a)} = \phi_{t^*_a L}\otimes L^{-1} = \phi _{t_a^*L}\otimes L^{-1} = \phi_L \otimes \phi_{L^{-1}} = 0\qedhere
\end{equation*}
%
\end{proof}
\begin{proposition}{}{}{proposition-18}%
\hypertarget{p-184}{}%
If \(L\) is nontrivial in \(\Pic^0(A)\) then \(H^i(A,L) = 0\) \(\forall i\).%
\end{proposition}
\begin{proof}\hypertarget{proof-35}{}
\hypertarget{p-185}{}%
If \(H^0(A,L) \ne 0\), we would have  a nontrivial section \(s\) of \(L\) then \(\lb -1\rb ^* s\) is   a nontrivial section of \(\lb-1\rb^* L = L^{-1}\). But if both \(L\) and \(L^{-1}\) have  a nontrivial section then \(L \cong \sheaf O_A\). So since \(L\) is nontrivial \(H^0(A,L) = 0\). Now assume \(H^i(A,L) = 0\) for all \(i\lt j\). Consider%
\begin{gather*}
A\xrightarrow{\id \times 0} A\times A \xrightarrow m A\\
a\mapsto (a,0)\mapsto a
\end{gather*}
this gives%
\begin{equation*}
H^j(A, L) \to H^j(A\times A, m^*L) \to H^j(A,L)
\end{equation*}
which composes to the identity.%
\begin{equation*}
H^j(A\times A, m^*L) =  H^j(A\times A, p_1^*L \otimes p_2^*L) = \bigoplus_{i=0}^j H^i(A,L) \otimes H^{j-i}(A,L)
\end{equation*}
by Künneth. The RHS is 0 by the inductive hypothesis. So the identity on \(H^j(A,L)\) factors through 0, hence the group is 0.%
\end{proof}
\hypertarget{p-186}{}%
We now think of \(\phi_L\) as a map \(\phi_L \colon A(k) \to \Pic^0(A)\) with kernel \(K(L) (k)\).%
\begin{theorem}{}{}{theorem-14}%
\hypertarget{p-187}{}%
If \(K(L)(k)\) is finite then \(\phi_L\) is surjective.%
\end{theorem}
\begin{proof}\hypertarget{proof-36}{}
\hypertarget{p-188}{}%
Idea is to study%
\begin{equation*}
\Lambda (L) =  m^* L \otimes (p_1^* L)^{-1} \otimes (p_2^* L)^{-1}\text{.}\qedhere
\end{equation*}
%
\end{proof}
\hypertarget{p-189}{}%
Given an ample \hyperref[def-line-bundle]{line bundle} \(L\) on \(A\) we now have an isomophism of groups%
\begin{equation*}
A(k)/K(L)(k) \cong \Pic^0(A)
\end{equation*}
the LHS allows us to put an \hyperref[def-buntes-abvar]{abelian variety} structure on \(\Pic^0(A)\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.5 The Dual Abelian Variety}
\typeout{************************************************}
%
\begin{subsectionptx}{The Dual Abelian Variety}{}{The Dual Abelian Variety}{}{}\label{subsection-23}
\begin{theorem}{}{}{theorem-15}%
\hypertarget{p-190}{}%
Let \(A\) be an \hyperref[def-buntes-abvar]{abelian variety} and \(L\) an ample \hyperref[def-line-bundle]{line bundle} on \(A\), then the quotient scheme \(A/K(L)\) exists and is an \hyperref[def-buntes-abvar]{abelian variety} of the same dimension as \(A\).%
\end{theorem}
\begin{proof}\hypertarget{proof-37}{}
\hypertarget{p-191}{}%
(Sketch) (characteristic 0) Cover \(A\) by affine opens \(U_i = \Spec R_i\) such that for all \(a \in A\) the orbit \(K(L)a \subseteq U_i\) for some \(i\). We can do this because \hyperref[def-buntes-abvar]{abelian varieties} are projective. Then we say \(U_i / K(L) = \Spec(R^{K(L)}_i)\) then glue. (details in Mumford, II sec, 6  appendix). Since we are in characteristic 0, the quotient scheme is in fact a variety.%
\end{proof}
\begin{definition}{Dual abelian varieties.}{def-dual-abvar}%
\hypertarget{p-192}{}%
The \terminology{dual \hyperref[def-buntes-abvar]{abelian variety}} is%
\begin{equation*}
\hat A = A/K(L)\text{.}
\end{equation*}
%
\end{definition}
\begin{remark}{}{remark-4}%
\hypertarget{p-193}{}%
\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}%
\begin{equation*}
\hat A(K) = \Pic^0(A)
\end{equation*}
%
\item{}We have an \hyperref[def-supersing-isog-isog]{isogeny}%
\begin{equation*}
\phi_L\colon A \to \hat A\text{.}
\end{equation*}
%
\end{itemize}
%
\end{remark}
\begin{theorem}{}{}{thm-poincare-bundle}%
\hypertarget{p-194}{}%
There is a unique \hyperref[def-line-bundle]{line bundle} \(\sheaf P\) on \(A\times \hat A\) called the \terminology{Poincaré bundle} such that\leavevmode%
\begin{enumerate}
\item\hypertarget{li-35}{}%
\begin{equation*}
\sheaf P|_{A\times \{x\}} \in \Pic^0(A) \text{ for all }x\in \hat A
\end{equation*}
%
\item\hypertarget{li-36}{}%
\begin{equation*}
\sheaf P|_{0\times \hat A} = 0
\end{equation*}
%
\item\hypertarget{li-37}{}If \(Z\) is a  scheme with a \hyperref[def-line-bundle]{line bundle} \(R\) on \(A\times Z\) satisfying 1., 2., there exists a unique%
\begin{equation*}
f\colon Z\to \hat A
\end{equation*}
s.t.%
\begin{equation*}
(\id\times f)^* \sheaf P = R\text{.}
\end{equation*}
%
\end{enumerate}
That is \((\hat A, \sheaf P)\)  represents the functor%
\begin{equation*}
Z \mapsto \left\{ L\in \Pic (A\times Z) : \substack{ L|_{A\times \{z\}} \in \Pic^0(A) \forall z\in Z \\L|_{ 0 \times Z } = 0}\right\}/\sim\text{.}
\end{equation*}
%
\end{theorem}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.7.6 Dual morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Dual morphisms}{}{Dual morphisms}{}{}\label{subsection-24}
\hypertarget{p-195}{}%
Let \(f\colon A\to B\) be a homomorphism of \hyperref[def-buntes-abvar]{abelian varieties}. Let \(\sheaf P_A,\sheaf P_B\) be the \hyperref[thm-poincare-bundle]{Poincaré bundles} on  \(A\) and \(B\). Consider \(M=    (F\times \id_{\hat B})^* \sheaf P_B\) on \(A\times \hat B\), then\leavevmode%
\begin{enumerate}
\item\hypertarget{li-38}{}%
\begin{equation*}
M|_{A\times \{x\}} \in \Pic^0(A)
\end{equation*}
%
\item\hypertarget{li-39}{}%
\begin{equation*}
M|_{\{0\} \times \hat B} = 0
\end{equation*}
%
\end{enumerate}
thus by the universal property we get a unique morphism%
\begin{equation*}
\hat f\colon \hat B \to \hat A
\end{equation*}
satisfying%
\begin{equation*}
(\id_A\times \hat f)^* \sheaf P_A = (f\times \id_{\hat B})^*\sheaf P_B\text{.}
\end{equation*}
%
\begin{definition}{Dual morphisms.}{def-dual-morp-abvar}%
\hypertarget{p-196}{}%
\(\hat f\) as above is called the \terminology{dual morphism}.%
\end{definition}
\begin{remark}{}{remark-5}%
\hypertarget{p-197}{}%
\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}%
\begin{equation*}
\hat f\colon \hat B = \Pic^0(B) \to \hat A(k) = \Pic^0(A)
\end{equation*}
%
\begin{equation*}
L\mapsto f^*L
\end{equation*}
%
\item{}%
\begin{equation*}
\hat{\lb n_A\rb} = [n_{\hat A}]
\end{equation*}
%
\end{itemize}
%
\end{remark}
\hypertarget{p-198}{}%
Consider the \hyperref[thm-poincare-bundle]{Poincaré bundle} \(\sheaf P_{\hat A}\) on \(\hat A \times \hat{\hat{A}}\), now think of \(\sheaf P_A\) as living on \(\hat A \times A\). By the universal property of \(\sheaf P_{\hat A}\) get a unique morphism%
\begin{equation*}
\operatorname{can}_A\colon A\to\hat{\hat A}\text{.}
\end{equation*}
%
\begin{theorem}{}{}{theorem-17}%
\hypertarget{p-199}{}%
\(\operatorname{can}_A\) is an isomorphism.%
\end{theorem}
\begin{lemma}{}{}{lemma-3}%
\hypertarget{p-200}{}%
%
\begin{equation*}
\phi_{f^*L} = \hat f\circ \phi_L\circ f\text{.}
\end{equation*}
%
\end{lemma}
\begin{proposition}{}{}{proposition-19}%
\hypertarget{p-201}{}%
If \(f\colon A \to B\) is an \hyperref[def-supersing-isog-isog]{isogeny}, then \(\hat f\colon \hat B \to \hat A\) is an \hyperref[def-supersing-isog-isog]{isogeny}. Further if \(N  = \ker f\), then \(\hat N = \ker \hat f\) is the Cartier  dual of \(N\).%
\end{proposition}
\begin{definition}{Symmetric morphisms, (principal) polarizations.}{def-princ-pol}%
\hypertarget{p-202}{}%
A morphism \(f\colon A \to \hat A\) is \terminology{symmetric} if \(f = \hat f\circ \operatorname{can}_A\)%
\par
\hypertarget{p-203}{}%
A \terminology{polarization} is a \hyperref[def-princ-pol]{symmetric} \hyperref[def-supersing-isog-isog]{isogeny} \(f\colon A \to \hat A\) s.t. \(f=  \phi_L\) for some ample \hyperref[def-line-bundle]{line bundle} \(L\) on \(A\).%
\par
\hypertarget{p-204}{}%
A \terminology{principal \hyperref[def-polarization]{polarization}} is a \hyperref[def-polarization]{polarization} of degree 1, i.e. an isomorphism.%
\end{definition}
\begin{remark}{}{remark-6}%
\hypertarget{p-205}{}%
Elliptic curves always admit \hyperref[def-polarization]{principal polarization}.%
\par
\hypertarget{p-206}{}%
If one wishes to mimic the theory of \hyperref[def-supersing-isog-ec]{elliptic curves}, one should study principally polarized \hyperref[def-buntes-abvar]{abelian varieties}.%
\end{remark}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.8 Endomorphisms and the Tate module (Berke)}
\typeout{************************************************}
%
\begin{sectionptx}{Endomorphisms and the Tate module (Berke)}{}{Endomorphisms and the Tate module (Berke)}{}{}\label{sec-endomorphisms}
\begin{introduction}{Motivation.}%
\hypertarget{p-207}{}%
%
\begin{align*}
f \colon \PP^n\subseteq V_1 \amp\to V_2 \subseteq \PP^m,\,V_i = V(I_i)\\
P\amp \mapsto \cdots
\end{align*}
%
\begin{equation*}
f = \lb f_1 : \cdots : f_m\rb ,\,f_i\in \overline K (V_1)
\end{equation*}
this feels quite restrictive, an \hyperref[def-supersing-isog-isog]{isogeny} is even more so, rational, regular, homomorphism, surjective, finite kernel. It feels like there won't be too many but we have multiplication by \(n\) etc. so we should ask how many are there that will surprise us? I.e. what is%
\begin{equation*}
\rank_\ZZ \Hom(A,B) = ?
\end{equation*}
%
\par
\hypertarget{p-208}{}%
Notation: \(A,B,C , A_i,  B_i\) are all \hyperref[def-buntes-abvar]{abelian varieties}. \(l \ne \characteristic k\), \(\sim\) is \hyperref[def-supersing-isog-isog]{isogeny}.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.8.1 Poincaré's complete reducibility theorem}
\typeout{************************************************}
%
\begin{subsectionptx}{Poincaré's complete reducibility theorem}{}{Poincaré's complete reducibility theorem}{}{}\label{subsection-25}
\begin{theorem}{Poincaré's complete reducibility theorem.}{}{thm-poincare-reducibility}%
\hypertarget{p-209}{}%
Let \(B\subseteq A\) then there is \(C\subseteq A\) s.t. \(B \cap C\) is finite and \(B+C = A\). I.e. \(B\times C \to A,\,(b,c) \mapsto b+c\) is an \hyperref[def-supersing-isog-isog]{isogeny}.%
\end{theorem}
\begin{proof}\hypertarget{proof-38}{}
\hypertarget{p-210}{}%
Choose \(\sheaf L\) ample on \(A\)%
\begin{equation*}
\xymatrix{
B\ar[r]^i \ar[d]_{\phi_{i*\sheaf L}} & A \ar[d]_\sim^{\phi_{\sheaf L}} \\
\hat B & \hat A \ar[l]_{\hat i}
}
\end{equation*}
\(C\) is defined to be the connected component of \(\phi^{-1}_{\sheaf L}(\ker \hat i)\) in \(A\)%
\begin{equation*}
\dim C = \dim \ker \hat i \ge \dim \hat A - \dim \hat B = \dim A - \dim B\text{.}
\end{equation*}
%
\par
\hypertarget{p-211}{}%
\(B \cap C\) finite, \(z\in B\), \(z\in B\cap \phi_{\sheaf L^{-1}} (\ker \hat i) = T_z^* \sheaf L \otimes \sheaf L^{-1} |_B\) is trivial if and only if \(z\in K(\sheaf L|_B)\). So \(\sheaf L|_B\) ample implies \(K(\sheaf L|_B)\) finite and so \(B\cap C\) is finite. So \(B\times C \to A\) has finite kernel and%
\begin{equation*}
\dim (B\times C) = \dim B + \dim C \ge \dim A
\end{equation*}
and surjective implies its an \hyperref[def-supersing-isog-isog]{isogeny}.%
\end{proof}
\begin{definition}{Simple abelian varieties.}{def-simple-av}%
\hypertarget{p-212}{}%
\(A\) is called \terminology{simple} if there does not exists \(B\subseteq A\) other than \(B = 0,A\).%
\end{definition}
\begin{corollary}{}{}{cor-ab-var-product-simple}%
\hypertarget{p-213}{}%
%
\begin{equation*}
A \sim A_1^{n_1} \times \cdots \times A_k^{n_k}
\end{equation*}
\(A_i \not\sim A_j\) for \(i\ne j\) and \(A_i\) \hyperref[def-simple-av]{simple}.%
\end{corollary}
\begin{corollary}{}{}{corollary-13}%
\hypertarget{p-214}{}%
\(\alpha \in \Hom(A,B)\) for \(A,B\) \hyperref[def-simple-av]{simple} then \(\alpha\) is an \hyperref[def-supersing-isog-isog]{isogeny} or \(0\).%
\end{corollary}
\begin{proof}\hypertarget{proof-39}{}
\hypertarget{p-215}{}%
\(\alpha(A) \subseteq B\) which implies \(\alpha(A)  = B\) or \(0\). The connected component of 0 of \(\ker \alpha\) will be an abelian subvariety of \(A\), denote it \(C\) If \(C = 0\) then \(\ker \alpha\) is finite, if \(C = A\) then \(\alpha = 0\). So \(\alpha\) is an \hyperref[def-supersing-isog-isog]{isogeny} or \(0\).%
\end{proof}
\begin{corollary}{}{}{corollary-14}%
\hypertarget{p-216}{}%
If \(A,B\) are \hyperref[def-simple-av]{simple} and  \(A\not\sim B\) then \(\Hom(A,B) = 0\).%
\end{corollary}
\begin{definition}{}{definition-29}%
\hypertarget{p-217}{}%
%
\begin{equation*}
\End^0(A) = \End(A) \otimes \QQ\text{.}
\end{equation*}
%
\end{definition}
\begin{lemma}{}{}{lemma-4}%
\hypertarget{p-218}{}%
If \(\alpha \colon A\to B\) is an \hyperref[def-supersing-isog-isog]{isogeny}, then there exists \(\beta \colon B\to A\) s.t. \(\beta \circ \alpha = n_A\) for some \(n \ge 1\).%
\end{lemma}
\begin{proof}\hypertarget{proof-40}{}
\hypertarget{p-219}{}%
\(\alpha\) an \hyperref[def-supersing-isog-isog]{isogeny} implies \(\ker \alpha\) is finite. So there exists \(n\) with \(n \ker \alpha = 0\). \(\ker\alpha \subseteq \ker n_A\)%
\begin{equation*}
\xymatrix{
& A \ar[dl]_\alpha \ar[d]\ar[r]^{n_A} & A \\
B\ar[r]_\sim \ar@/_3.0pc/[urr]_{\exists | \beta} & A/\ker\alpha \ar[d]\ar[ur]_{\circ} &\\
& A/n_A &
}
\end{equation*}
so \(\beta\circ \alpha = n_A\), also \(\alpha \circ \beta = n_B\).%
\end{proof}
\begin{corollary}{}{}{corollary-15}%
\hypertarget{p-220}{}%
\(A\) is \hyperref[def-simple-av]{simple} then \(\End^0(A)\) is a division ring, \(\alpha^{-1} = \beta \otimes \frac 1n\).%
\end{corollary}
\begin{corollary}{to Poincaré reducibility theorem.}{}{corollary-16}%
\hypertarget{p-221}{}%
If%
\begin{equation*}
A\sim A_1^{n_1} \times \cdots \times A_k^{n_k}
\end{equation*}
then%
\begin{equation*}
\End^0(A) \simeq \prod \End^0(A_i)^{n_i^2}\text{.}
\end{equation*}
%
\end{corollary}
\begin{proof}\hypertarget{proof-41}{}
\hypertarget{p-222}{}%
%
\begin{align*}
\End(A) \otimes \QQ \amp \simeq \prod_{i,j} \Hom(A_i^{n_i}, A_j^{n_j}) \otimes \QQ\\
\amp \simeq \prod_{i} \End(A_i)^{n_i^2} \otimes \QQ\\
\amp \simeq \prod_{i} \End^0(A_i)^{n_i^2}\qedhere
\end{align*}
%
\end{proof}
\begin{theorem}{7.2.}{}{theorem-19}%
\hypertarget{p-223}{}%
If \(\dim A = g\) then \(\deg n_A  =n^{2g}\).%
\end{theorem}
\begin{corollary}{}{}{corollary-17}%
\hypertarget{p-224}{}%
\(\characteristic k \nmid n\) implies \(\ker(n_A) \simeq (\ZZ/n\ZZ)^{2g}\).%
\end{corollary}
\begin{proof}\hypertarget{proof-42}{}
\hypertarget{p-225}{}%
If  \(m | n\) then \(|\ker (m_A)| = m^{2g}\), then use structure theorem.%
\end{proof}
\hypertarget{p-226}{}%
In particular if we let \(A\lb l^n\rb = A(k^\sep) \lb l^n\rb\), then \(A\lb l^n\rb \simeq (\ZZ/l^n)^{2g}\) Define%
\begin{equation*}
T_l(A) = \varprojlim_n A[l^n],\, A[l^{n+1}] \xrightarrow{l} A[l]
\end{equation*}
%
\begin{proposition}{}{}{proposition-20}%
\hypertarget{p-227}{}%
%
\begin{equation*}
T_l \simeq (\ZZ_l)^{2g}
\end{equation*}
%
\end{proposition}
\hypertarget{p-228}{}%
\(\alpha \colon A \to B\) induces%
\begin{equation*}
T_l\alpha\colon T_l(A) \to T_l(B)
\end{equation*}
%
\begin{equation*}
(a_1,a_2, \ldots) \mapsto(\alpha(a_1),\alpha(a_2), \ldots)
\end{equation*}
%
\begin{lemma}{}{}{lemma-5}%
\hypertarget{p-229}{}%
%
\begin{equation*}
\Hom(A,B) \hookrightarrow \Hom(T_l(A), T_l(B))
\end{equation*}
%
\end{lemma}
\begin{proof}\hypertarget{proof-43}{}
\hypertarget{p-230}{}%
Let \(\alpha \in \Hom(A,B)\) and assume \(T_l \alpha = 0\) then%
\begin{equation*}
\ker (\alpha|_{A_i}) \supseteq A_i[l^n] \forall n
\end{equation*}
for any \hyperref[def-simple-av]{simple} component \(A_i\) of \(A\) so \(\alpha =0\) on each \(A_i\) and hence \(\alpha = 0\) on \(A\).%
\end{proof}
\begin{corollary}{}{}{corollary-18}%
\hypertarget{p-231}{}%
\(\Hom(A,B)\) is torsion free.%
\end{corollary}
\hypertarget{p-232}{}%
Recall we are interested in knowing about \(\rank_\ZZ\Hom(A,B) = ?\), can we bound this? If we could show that%
\begin{equation*}
\Hom(A,B) \otimes \ZZ_l \hookrightarrow \Hom(T_l(A),T_l(B))
\end{equation*}
we could conclude, so:%
\par
\hypertarget{p-233}{}%
%
\begin{equation*}
\xymatrix{
\Hom(A,B)\otimes \ZZ_l \ar[d]_{\sim} \ar@{^(->}[r]     & \Hom(T_lA,T_lB)\ar[d]_{\sim} \\
\prod_{i,j} (\Hom(A_i, B_j) \otimes \ZZ_l) \ar@{^(->}[r] & \prod_{i,j}\Hom(T_lA_i, T_l B_j)
% TODO right arrows hooks, fix
}
\end{equation*}
\(A_i + B_j = 0\), \(A_i\sim B_j\) \(\Hom(A_i, B_j) \hookrightarrow \End(A_i)\). Assume \(A= B\) and \(A\) \hyperref[def-simple-av]{simple}, then \(\End(A) \otimes \ZZ_l \hookrightarrow \End(T_l(A))\).%
\begin{definition}{}{definition-30}%
\hypertarget{p-234}{}%
\(V/k\) then \(f\colon V \to k\) is called a (homogenous) polynomial function of degree \(d\) if \(\forall \{v_1,\cdots, v_m\}\subseteq V\) linearly independent.%
\begin{equation*}
f(\lambda_1 v_1 + \lambda_2 v_2 +\cdots + \lambda_m v_m)
\end{equation*}
is given by a homogenous polynomial of degree \(d\) in \(\lambda_i\) i.e.%
\begin{equation*}
f(\lambda_1 v_1 + \lambda_2 v_2 +\cdots + \lambda_m v_m) = P(\lambda_1,\ldots, \lambda_m)
\end{equation*}
for some \(P\in k\lb X_m\rb\) homogenous of degree \(d\).%
\end{definition}
\hypertarget{p-235}{}%
%
\begin{equation*}
\deg\colon \End(A) \to \ZZ
\end{equation*}
\(\alpha\) an \hyperref[def-supersing-isog-isog]{isogeny} iff \(\deg \alpha\), \(\alpha\) not an \hyperref[def-supersing-isog-isog]{isogeny} iff \(0\).%
\begin{theorem}{}{}{theorem-20}%
\hypertarget{p-236}{}%
\(\deg\) uniquely extends to a polynomial function of degree \(2g\) on \(\End^0(A) \to \QQ\).%
\end{theorem}
\begin{proof}\hypertarget{proof-44}{}
\hypertarget{p-237}{}%
(of above continued)%
\par
\hypertarget{p-238}{}%
%
\begin{equation*}
\End(A) \otimes \ZZ_l \hookrightarrow\End(T_l(A))
\end{equation*}
for \(A\) \hyperref[def-simple-av]{simple} iff for any finitely generated \(M \subseteq \End(A)\)%
\begin{equation*}
M \otimes \ZZ_l \hookrightarrow \End(T_l(A))
\end{equation*}
%
\par
\hypertarget{p-239}{}%
Claim:%
\begin{equation*}
M^{\text{div}} = \{f\in \End(A) : nf\in M \text{ for some }n\ge 1\}
\end{equation*}
is finitely generated.%
\par
\hypertarget{p-240}{}%
Proof: \(M^\text{div} = (M\otimes \QQ) \cap \End(A)\) \(\deg \colon M \otimes \QQ \to \QQ\) is a polynomial so it is continuous.%
\begin{equation*}
U = \{\phi\in M \otimes \QQ : \deg \phi \lt 1\}
\end{equation*}
is open in \(M \otimes \QQ\) but \(U \cap M^\text{div} = 0\) so \(M^\text{div} \) is a discrete subgroup of the finite dimensional \(\QQ\)-vector space \(M \otimes \QQ\) so \(M^\text{div}\) is finitely generated. \(M \hookrightarrow M^\text{div}\) so \(M \otimes \ZZ_l \hookrightarrow M^\text{div} \otimes \ZZ_l\) so  we may assume \(M = M^\text{div}\).%
\par
\hypertarget{p-241}{}%
Let \(f_1,\ldots, f_r\) be a \(\ZZ\)-basis for \(M\) and suppose that \(\sum a_iT_l(f_i)=0\) for some \(a_i \in \ZZ_l\) not all 0. We can assume not all \(a_i\) are divisible by \(l\). Choose \(a_i' \in \ZZ\) s.t. \(a_i'=a_i \pmod{l}\)%
\begin{equation*}
f = \sum a_i' f_i \in \End(A)
\end{equation*}
we then have%
\begin{equation*}
f = \sum a_i' T_lf_i
\end{equation*}
is 0 on the first coordinate of \(T_l\). So \(A\lb l \rb \subseteq \ker f\) so there exists \(g\) with \(f= lg\) \(f\in M\) implies \(g\in M^\text{div} = M\) so \(g = \sum b_i f_i\) and \(f = \sum lb_i f = \sum a_i f_i\) hence \(l\mid a_i\) for all \(i\) a contradiction. So \(\End(A)\otimes \ZZ_l \hookrightarrow \End(T_l(A))\).%
\par
\hypertarget{p-242}{}%
Therefore%
\begin{equation*}
\Hom(A,B) \otimes \ZZ_l \hookrightarrow \Hom(T_l(A), T_l(B))
\end{equation*}
%
\begin{equation*}
\rank_\ZZ \Hom(A,B) \le 4 \dim A\dim B\text{.}\qedhere
\end{equation*}
%
\end{proof}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.9 Polarizations and Étale cohomology (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Polarizations and Étale cohomology (Alex)}{}{Polarizations and Étale cohomology (Alex)}{}{}\label{sec-polarizations-etale}
\begin{introduction}{}%
\hypertarget{p-243}{}%
Plan: \hyperref[def-polarization]{polarizations}, a little cohomological warmup and a cool finiteness result. \hyperref[def-etale]{Étale} cohomology.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.9.1 Polarizations}
\typeout{************************************************}
%
\begin{subsectionptx}{Polarizations}{}{Polarizations}{}{}\label{subsection-26}
\begin{definition}{Polarizations.}{def-polarization}%
\hypertarget{p-244}{}%
A \terminology{polarization} of an \hyperref[def-buntes-abvar]{abelian variety} \(A/k\) is an \hyperref[def-supersing-isog-isog]{isogeny}%
\begin{equation*}
\lambda \colon A \to \hat A
\end{equation*}
such that%
\begin{equation*}
\lambda \simeq_{\overline k} \lambda_{\sheaf{L}} : a\mapsto t_a^*\sheaf L \otimes \sheaf L^{-1}
\end{equation*}
for an ample invertible sheaf \(\sheaf L\) on \(A_{\overline k}\).%
\par
\hypertarget{p-245}{}%
We then have a notion of degree, \hyperref[def-polarization]{polarizations} of degree 1 (i.e. isomorphisms \(A\to \hat A\)) are called \terminology{principal \hyperref[def-polarization]{polarizations}}.%
\end{definition}
\begin{remark}{}{remark-7}%
\hypertarget{p-246}{}%
This is in fact equivalent to the \hyperref[def-princ-pol]{previous definition~\ref{def-princ-pol}}, see \hyperlink{bib-vandergeer-moonen}{[66,~cor. 11.5]}.%
\end{remark}
\hypertarget{p-247}{}%
Natural questions: what does the \hyperref[def-line-bundle]{line bundle} \(\sheaf L\) tell us about the \hyperref[def-polarization]{polarization}? Can we tell principality?%
\par
\hypertarget{p-248}{}%
To answer this we must (rapidly) recall (Zariski) sheaf cohomology. But this will help us in the next section too.%
\par
\hypertarget{p-249}{}%
A \hyperref[def-line-bundle]{line bundle} (or indeed any sheaf) defines for us for any open subset \(U \hookrightarrow X\) an abelian group of sections \(\sheaf L(U)\).%
\par
\hypertarget{p-250}{}%
However taking (global) sections doesn't play well with exact sequences!%
\begin{example}{Classic example.}{example-10}%
\hypertarget{p-251}{}%
Let \(X = \CC^*\) and consider%
\begin{equation*}
0 \to \ZZ \hookrightarrow \sheaf O_X \xrightarrow{e^{2\pi i -}} \sheaf O_X^* \to 0
\end{equation*}
but%
\begin{equation*}
0 \to \ZZ \to \sheaf O_X(X) \to \sheaf O_X^*(X)
\end{equation*}
is not surjective on the right, for example \(f(z) = z\) is a nowhere vanishing \hyperref[def-morph-riem-surf]{meromorphic function} on \(X\) but its not \(\exp\) of anything. Upshot: maps of sheaves can be surjective (by being so locally) but not globally.%
\end{example}
\hypertarget{p-252}{}%
To understand/control this phenomenon we introduce \(H^1(X, \sheaf F)\) fitting into the above and so on.%
\par
\hypertarget{p-253}{}%
Explicitly: for a sheaf \(\sheaf F\) we fix an injective resolution%
\begin{equation*}
0\to \sheaf F \to \sheaf I_0 \to \sheaf I_1 \to \cdots
\end{equation*}
which we then take global sections of to get a chain complex%
\begin{equation*}
0\to \Gamma(X,\sheaf F) \to \Gamma(X,\sheaf I_0) \to \Gamma(X,\sheaf I_1) \to \cdots
\end{equation*}
and we truncate and take cohomology of this to measure ``failure of exactness''%
\begin{equation*}
H^0(X, \sheaf F) , H^1(X, \sheaf F) , H^2(X, \sheaf F) , \ldots\text{.}
\end{equation*}
%
\begin{definition}{Euler-Poincaré characteristic.}{def-euler-poincare-char}%
\hypertarget{p-254}{}%
Define the \terminology{Euler-Poincaré characteristic} of a \hyperref[def-line-bundle]{line bundle} \(\sheaf L\) to be%
\begin{equation*}
\chi(\sheaf L) = \sum (-1)^i \dim_k H^i(A,\sheaf L)\text{.}
\end{equation*}
%
\end{definition}
\begin{theorem}{Riemann-Roch.}{}{theorem-21}%
\hypertarget{p-255}{}%
Let \(A\) be an \hyperref[def-buntes-abvar]{abelian variety} of dimension \(g\) then\leavevmode%
\begin{enumerate}
\item\hypertarget{li-42}{}The degree of \(\lambda_{\sheaf L}\) is \(\chi(\sheaf L)^2\).%
\item\hypertarget{li-43}{}If \(\sheaf L = \sheaf L(D)\) then \(\chi(\sheaf L) = (D^g)/g!\), this is the \(g\)-fold self intersection number of \(D\).%
\end{enumerate}
%
\end{theorem}
\begin{theorem}{Vanishing.}{}{theorem-22}%
\hypertarget{p-256}{}%
If \(\#K( \sheaf L)\lt \infty\) then there is a unique integer \(0\le i(\sheaf L) \le g\) with \(H^i(A, \sheaf L) \ne  0\) and \(H^p(A, \sheaf L) = 0\) for all \(p \ne i\). Moreover \(i(\sheaf L^{-1}) = g - i(\sheaf L)\).%
\end{theorem}
\hypertarget{p-257}{}%
Recall \hyperref[sec-ample-L-finite-KL]{Subsection~\ref{sec-ample-L-finite-KL}}: So for ample \(\sheaf L\) we have \(K(\sheaf L)\) finite, so the vanishing theorem applies. Additionally for very ample \(\sheaf L\) we know \(H^0(A,\sheaf L) \ne 0\) so in this case we get vanishing of higher cohomology.%
\begin{theorem}{Finiteness.}{}{theorem-23}%
\hypertarget{p-258}{}%
Let \(k\) be a finite field, and   \(g,d\ge 1\) integers. Up to isomorphism there are only finitely many \hyperref[def-buntes-abvar]{abelian varieties} \(A/k\) of dimension \(g\) and with a \hyperref[def-polarization]{polarization} of degree \(d^2\).%
\end{theorem}
\begin{proof}\hypertarget{proof-45}{}
\hypertarget{p-259}{}%
(Super sketch)%
\par
\hypertarget{p-260}{}%
Over a finite field implies there is an ample \(\sheaf L\) with \(\lambda_{\sheaf L}\) a \hyperref[def-polarization]{polarization} of degree \(d^2\), then using above \(\chi(\sheaf L^3) = 3^g d\) and \(\sheaf L^3\) is very ample hence \(\dim H^0(A, \sheaf L^3) = 3^g d\) so we get an embedding into \(\PP^{3^g d - 1}\).%
\par
\hypertarget{p-261}{}%
The degree of \(A\) in \(\PP^{3^g d - 1}\) is \(((3D)^g) = 3^g d(g!)\) . It is determined by its Chow form, which by these formulae has some (large) bounded degree, as we are over a finite field however there are only finitely many such.%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.9.2 Étale Cohomology of Abelian Varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Étale Cohomology of Abelian Varieties}{}{Étale Cohomology of Abelian Varieties}{}{}\label{subsection-27}
\hypertarget{p-262}{}%
See \hyperlink{bib-milne-etale}{[48]} or \hyperlink{bib-tamme}{[63]}.%
\par
\hypertarget{p-263}{}%
Recall for \hyperref[def-buntes-abvar]{abelian varieties} over \(A/\CC\) we considered singular cohomology of the complex points \(A(\CC)\). Indeed this theory was strongly connected to the \hyperref[def-buntes-lattice]{lattice} \(\Lambda\) defining \(A(\CC)\).%
\par
\hypertarget{p-264}{}%
We saw that in fact \(\pi_1(A,0) = \pi^{-1} (0) = \Lambda \subseteq V\) which was the universal covering space of \(A(\CC)\). We want to emulate this over a general field.%
\par
\hypertarget{p-265}{}%
We want to allow multiplication by \(n\) to define finite covers for our \hyperref[def-buntes-abvar]{abelian varieties} as they did before.%
\par
\hypertarget{p-266}{}%
Problem: Zariski topology is too coarse: we can't find an open \(U\) set around \(0 \in A\) such that \(\lb 2\rb \colon U \to A\) is an isomorphism onto its image. Isogenies are not local isomorphisms for the Zariski topology.%
\par
\hypertarget{p-267}{}%
How on earth do we ``allow'' maps which are clearly not local isomorphisms to become such? First what do we mean by local isomorphism?%
\begin{equation*}
\xymatrix{
f^{-1}(U)\ar[d] \ar[r]^{\sim} & U\ar@{^(->}[d]^i\\
X \ar[r]_f & Y
}\text{.}
\end{equation*}
There exists an open subset \(U\) such that the base change \(X \times_Y U\) is isomorphic with \(\coprod U\) of several copies of \(U\) in a \hyperref[def-buntes-compat]{compatible} way with the map to \(U\).%
\par
\hypertarget{p-268}{}%
So let's cheat, the best isomorphism is the identity map%
\begin{equation*}
\xymatrix{
X\ar[d] \ar[r]^{\sim} & X\ar[d]^f\\
X \ar[r]_f & Y
}
\end{equation*}
if we define an ``open set'' \(U\) to be a morphism \(X \to Y\) with the properties we want, then all such become local isomorphisms.%
\par
\hypertarget{p-269}{}%
By taking our \emph{topology} to be given by some maps we decide are decent covering maps we can circumvent these difficulties.%
\par
\hypertarget{p-270}{}%
What is the correct class of morphisms to take here, we feel like our \(\lb n\rb\) maps should count. Taking inspiration from differential geometry perhaps, we are led to the notion of a local diffeomorphism, an \hyperref[def-etale]{étale} map.%
\begin{definition}{}{definition-33}%
\hypertarget{p-271}{}%
Let \(X,Y\) be nonsingular varieties over \(k = \overline k\). Then \(f\colon X\to Y\) is \hyperref[def-etale]{étale} at a point \(P\in X\) if%
\begin{equation*}
\diff f\colon\Tgt_{P}(X) \to \Tgt_{f(P)} (Y)
\end{equation*}
is an isomorphism.%
\end{definition}
\begin{proposition}{}{}{proposition-21}%
\hypertarget{p-272}{}%
Let \(f \colon \aff^m\to \aff^m\) then \(f\) is \hyperref[def-etale]{étale} at \((a_1, \cdots, a_m)\) iff%
\begin{equation*}
\left(\frac{\partial(X_i \circ f)}{\partial Y_j}|_{(a_k)} \right)
\end{equation*}
is nonsingular.%
\end{proposition}
\begin{example}{A non-étale map.}{example-11}%
\hypertarget{p-273}{}%
Consider the map%
\begin{align*}
\aff^2 \amp\to \aff^2\\
(x,y) \amp\mapsto (x^3, x^2 + y)
\end{align*}
we can see that the image of \(y= 0\) is the nodal cubic (\(Y^3 = X^2\)), which is messed up (singular) at \((0,0)\). The jacobian is%
\begin{equation*}
\begin{pmatrix} 3x^2 \amp 0 \\ 2x \amp 1\end{pmatrix}
\end{equation*}
so this matrix is singular exactly when \(x= 0\) (unless characteristic 3). So the map is not \hyperref[def-etale]{étale} at these points.%
\end{example}
\begin{proposition}{}{}{proposition-22}%
\hypertarget{p-274}{}%
The maps \(\lb n\rb\) are \hyperref[def-etale]{étale} on an \hyperref[def-buntes-abvar]{abelian variety} \(A/k\) for all  \(\characteristic{k} \nmid n\)%
\end{proposition}
\begin{proof}\hypertarget{proof-46}{}
\hypertarget{p-275}{}%
Key point \(\diff (\alpha+ \beta)_0 = (\diff \alpha )_0 + (\diff \beta)_0\). So the map on tangent spaces is simply multiplication by \(n\).%
\end{proof}
\begin{definition}{Étale morphisms.}{def-etale}%
\hypertarget{p-276}{}%
A morphism \(f\colon X\to Y\) of schemes is \terminology{étale} if it is flat and unramified.%
\par
\hypertarget{p-277}{}%
Flatness for finite morphisms of varieties is equivalent to each fibre \(f^{-1}(t)\) being of equal cardinality, counting \hyperref[def-riem-order-vanish]{multiplicities}.%
\end{definition}
\hypertarget{p-278}{}%
All \hyperref[def-supersing-isog-isog]{isogenies} are finite and flat.%
\begin{definition}{}{definition-35}%
\hypertarget{p-279}{}%
Let \(\mathrm{FEt}/X\) be the category of finite \hyperref[def-etale]{étale} maps \(\pi\colon Y \to X\) (i.e. finite \hyperref[def-etale]{étale} coverings of \(X\)).%
\par
\hypertarget{p-280}{}%
Then after picking a basepoint \(x\in X\) we can map%
\begin{equation*}
F\colon \mathrm{FEt}/X\to \mathrm{Set}
\end{equation*}
%
\begin{equation*}
\pi\mapsto \Hom_X(x,Y) \approx\pi^{-1}(x)\text{.}
\end{equation*}
%
\par
\hypertarget{p-281}{}%
This is in fact pro-representable, i.e. there exists a system%
\begin{equation*}
\tilde X = (X_i)_{i\in I}
\end{equation*}
with%
\begin{equation*}
F(Y) = \Hom(\tilde X ,Y) = \varinjlim_i \Hom(X_i, Y)\text{.}
\end{equation*}
%
\par
\hypertarget{p-282}{}%
We then define%
\begin{equation*}
\pi_1(X,x) = \Aut_X(\tilde X) = \varprojlim_i \Aut_X(X_i)\text{.}
\end{equation*}
%
\end{definition}
\hypertarget{p-283}{}%
So we need to understand \hyperref[def-etale]{étale} covers of \hyperref[def-buntes-abvar]{abelian varieties}. Following \hyperlink{bib-vandergeer-moonen}{[66]}:%
\begin{proposition}{surprising proposition.}{}{proposition-23}%
\hypertarget{p-284}{}%
Let \(X\)  be a \hyperref[def-abelian-complete-var]{complete} variety over a field \(k\) with \(e\in X(k)\) and \(m \colon X\times X\to X\) s.t. \(m(e,x) = m(x,e) = x\) for all \(x \in X\). Then \((X, m,e)\) is an \hyperref[def-buntes-abvar]{abelian variety}.%
\end{proposition}
\begin{proof}\hypertarget{proof-47}{}
\hypertarget{p-285}{}%
(Sketch)%
\par
\hypertarget{p-286}{}%
Let%
\begin{equation*}
\tau\colon X\times X \to X\times X
\end{equation*}
%
\begin{equation*}
\tau(x,y) = (xy,y)
\end{equation*}
so \(\tau^{-1} (e,e) = (e,e)\). Some exercise in Hartshorne implies \(\im \tau\) has dimension \(2\dim X\).%
\par
\hypertarget{p-287}{}%
Reduce to algebraically closed case.%
\par
\hypertarget{p-288}{}%
Let%
\begin{equation*}
\tau^{-1}(\{e\} \times X) =  \{(x,y) : xy = e\} = \Gamma \subseteq X\times X
\end{equation*}
as \(\tau \) is surjective we get \(p_2 \colon \Gamma \to X\) is also so pick an irreducible \(\Gamma_1 \subseteq \Gamma\) with \(p_2(\Gamma_1) = X\). This also implies \(p_1(\Gamma_1) = X\).%
\par
\hypertarget{p-289}{}%
Let%
\begin{equation*}
f\colon \Gamma_1 \times X\times X \to X
\end{equation*}
%
\begin{equation*}
f((x,y),z,w) = x((yz)w)
\end{equation*}
then%
\begin{equation*}
f(\Gamma_1 \times\{e\}\times\{e\}) = \{eee\} = \{e\}
\end{equation*}
so a version of \hyperref[thm-rigidity]{rigidity~\ref{thm-rigidity}} gives%
\begin{equation*}
x((yz)w) = zw\ \forall (x,y) \in \Gamma_1,\,z,w\in X
\end{equation*}
So letting \(w = e\) we get%
\begin{equation*}
x(yz) = z\text{.}
\end{equation*}
Fix \(y \in X(k)\), and then by surjectivity we can find \(x,z \in X(k)\) with \((x,y)\in \Gamma_1 \ni (y,z)\). So we get%
\begin{equation*}
x = x(yz) = ze = z
\end{equation*}
and so \(y\) has both a left and right inverse. We then multiply above by \(y\) to get%
\begin{equation*}
y(zw) = y(x((yz)w)) = (yz)w
\end{equation*}
so \(X(k)\) is associative.%
\end{proof}
\begin{theorem}{Lang-Serre.}{}{theorem-24}%
\hypertarget{p-290}{}%
Let \(X/k\) be an \hyperref[def-buntes-abvar]{abelian variety} and \(Y/k\) a variety with \(e_Y\in Y(k)\) s.t. \(f\colon Y \to X\) is an \hyperref[def-etale]{étale} covering where \(f(e_Y) = e_X\). Then \(Y\) can be given the structure of an \hyperref[def-buntes-abvar]{abelian variety} so that \(f\) is a separable \hyperref[def-supersing-isog-isog]{isogeny}.%
\end{theorem}
\begin{proof}\hypertarget{proof-48}{}
\hypertarget{p-291}{}%
Must construct a group law on \(Y\):%
\par
\hypertarget{p-292}{}%
Take the graph of \(m\colon X\times X \to X\)%
\begin{equation*}
\Gamma_X \subseteq X\times X\times X
\end{equation*}
and pullback along \(f\times f\times f\) to%
\begin{equation*}
\Gamma'_Y \subseteq Y\times Y\times Y
\end{equation*}
fix the connected component \(\Gamma_Y\) containing \((e_Y,e_Y,e_Y)\).%
\par
\hypertarget{p-293}{}%
Call the projections from \(\Gamma_Y\) \(q_I\). Now we must show that \(q_{12}\colon \Gamma_Y \to Y\times Y\) is an isomorphism, then \(m_Y\colon Y\times Y \to Y\) can be defined as \(q_3 \circ q_{12}^{-1}\). \(q_{12}\) has sections \(s_1,s_2\) over \(\{e_Y\}\times Y\), \(Y\times \{e_Y\}\) respectively given by \(s_1(e_Y,y) = (e_Y,y,y)\) and \(s_2(y,e_y,y) = (y,e_y,y)\). So \(m_Y\) satisfies the conditions of the surprising proposition.%
\begin{equation*}
\xymatrix{
\Gamma_Y \ar[r]\ar[d]_{q_{12}} & \Gamma_X\ar[d]^{p_{12}} \\
Y\times Y \ar[r]_{f\times f} & X\times X
}
\end{equation*}
the horizontal maps are \hyperref[def-etale]{étale} coverings and the rightmost an isomorphism so \(q_{12}\) is an \hyperref[def-etale]{étale} covering. The projection \(p_2 \circ q_{12} = q_2 \colon \Gamma_Y\to Y\) is smooth proper. Fact: all fibres of \(q_2\) are irreducible. So \(Z = q_2^{-1} (e_Y) = q_{12}^{-1}(Y\times \{e_Y\})\) is irreducible. Moreover \(q_{12}\) restricts to an \hyperref[def-etale]{étale} covering \(Z \to Y = Y\times\{e_Y\}\) of  the same degree, but \(s_2\) is a section of this covering, hence it is an isomorphism. Hence \(q_{12}\) has degree 1 and is therefore an isomorphism as required.%
\end{proof}
\hypertarget{p-294}{}%
So we have some control over the finite \hyperref[def-etale]{étale} maps, what does the covering space look like? Last week we saw that for an \hyperref[def-supersing-isog-isog]{isogeny} \(\alpha\colon B \to A\) we could find \(\beta \colon A \to B\) with \(\beta\circ\alpha = \lb n\rb\colon A \to A\). This means we can take our universal covering space to be%
\begin{equation*}
(A)_{i\in I}
\end{equation*}
with multiplication by \(n\) maps.%
\par
\hypertarget{p-295}{}%
So we find%
\begin{equation*}
\pi_1^\et(A,0) =\varprojlim_n \Aut_A(A\xrightarrow{[n]} A)=  \varprojlim_n A[n]\text{.}
\end{equation*}
%
\begin{theorem}{}{}{theorem-25}%
\hypertarget{p-296}{}%
%
\begin{equation*}
H^1_\et(A , \ZZ_l) = \Hom(\pi_1(A,0), \ZZ_l) = \Hom(T_l,\ZZ_l)
\end{equation*}
%
\end{theorem}
\begin{theorem}{}{}{theorem-26}%
\hypertarget{p-297}{}%
%
\begin{equation*}
H^r(A_\et, \ZZ_l) = \bigwedge^r H^1(A_\et, \ZZ_l)
\end{equation*}
%
\end{theorem}
\hypertarget{p-298}{}%
Note that Milne gives a combined proof of the above two statements, this relies on some theorems on Hopf algebras such as \hyperlink{bib-borel-hopf}{[17,~Theoreme 6.1]}.%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.10 Weil pairings (Maria)}
\typeout{************************************************}
%
\begin{sectionptx}{Weil pairings (Maria)}{}{Weil pairings (Maria)}{}{}\label{sec-weil-pairings}
%
%
\typeout{************************************************}
\typeout{Subsection 1.10.1 Weil pairings on elliptic curves}
\typeout{************************************************}
%
\begin{subsectionptx}{Weil pairings on elliptic curves}{}{Weil pairings on elliptic curves}{}{}\label{subsection-28}
\hypertarget{p-299}{}%
Start with \hyperref[def-supersing-isog-ec]{elliptic curves}, later repeat for \hyperref[def-buntes-abvar]{abelian varieties}. \(E/k\) an \hyperref[def-supersing-isog-ec]{elliptic curve}, \(m\ge 2\), if \(\characteristic(k) = p \gt 0\) \((m,p) = 1\). The Weil \(e_m\)-pairing \(e_m \colon E\lb m\rb \times E\lb m \rb \to \mu_m\) is defined as follows: Fix \(T\in E\lb m \rb\) then \(f\in \overline  k (E)\) s.t. \(\divisor(f) = m(T) - m(0)\). Fix \(T' \in E\) with \(mT' = T\) and \(g\in \overline k(E)\) s.t. \(\divisor(g) = \lb m \rb^*(T) = \lb m \rb^*(0)= \sum_{R\in E\lb m \rb} (T+R) - (R)\). Check \(\divisor (f\circ \lb m \rb) = \divisor(g^m)\), hence%
\begin{equation*}
f\circ [m] = c g^m
\end{equation*}
so can assume \(f\circ \lb m \rb = g^m\). For \(s \in E\lb m \rb\), \(x\in E\):%
\begin{equation*}
g(x + s) = f([m]x + [m]s) = f([m]x) = g(x)^m
\end{equation*}
%
\begin{equation*}
\frac{g(\cdot + s)^m}{g(\cdot)} \colon E \to \PP^1
\end{equation*}
is then a constant function, since not surjective. So we define%
\begin{align*}
e_m\colon E[m]\times E[m] \amp\to \mu_m\\
(s,t)\amp \mapsto \frac{g_t(x+s)}{g_t(x)}
\end{align*}
will state many properties later, but for now. \(e_m\) is \hyperref[def-buntes-compat]{compatible}:%
\begin{equation*}
e_{mm'} (a,a')^{m'} = e_m(m'a, m'a') \ \forall a,a' \in E[mm']
\end{equation*}
so for any \(l\ne \characteristic(k)\) prime we can combine \(e_{l^n}\)-pairings into an \(l\)-adic \hyperref[prop-weil-pair]{Weil pairing} on \(T_l E\)%
\begin{equation*}
e \colon T_l E\times T_lE \to T_l \mu = \ZZ_l(1)
\end{equation*}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.10.2 Weil pairings on abelian varieties}
\typeout{************************************************}
%
\begin{subsectionptx}{Weil pairings on abelian varieties}{}{Weil pairings on abelian varieties}{}{}\label{subsection-29}
\hypertarget{p-300}{}%
Story will be broadly similar to before but we must use the dual, which doesn't appear in the presentation for \hyperref[def-supersing-isog-ec]{elliptic curves}.%
\par
\hypertarget{p-301}{}%
Let \(A/k\) be an \hyperref[def-buntes-abvar]{abelian variety} \(k = \overline k\). We construct a Weil \(e_m\)-pairing%
\begin{align*}
e_m \colon A[m]\times A^\vee [m] \amp\to \mu_m\\
(a,a') \amp\mapsto \frac{g\circ t_a(x)}{g(x)} = \frac{g(x+a)}{g(x)}
\end{align*}
Fix \(a\in A\lb m\rb,\,a'\in A^\vee\lb m\rb\) say \(a'\) corresponds to \(\sheaf L\) and a divisor \(D\) then \(\sheaf L^m \) and \(m_A^* \sheaf L\) are trivial so \(\exists f,g \in k(A)\) s.t.%
\begin{equation*}
\divisor (f) = m D
\end{equation*}
%
\begin{equation*}
\divisor (g) = m_A^* D
\end{equation*}
again we have%
\begin{equation*}
\divisor( f\circ m_A) = \divisor (g^m)
\end{equation*}
%
\begin{equation*}
g(x+a)^m = g(x)^m
\end{equation*}
%
\begin{proposition}{}{}{proposition-24}%
\hypertarget{p-302}{}%
The Weil \(e_m\)-pairing has the following properties\leavevmode%
\begin{enumerate}
\item\hypertarget{li-44}{}\(e_m\) is bilinear%
\begin{equation*}
e_m(a_1+a_2,a') = e_m(a_1,a')e_m(a_2, a')
\end{equation*}
%
\begin{equation*}
e_m(a,a'_1+a'_2) = e_m(a,a'_1)e_m(a,a'_2)
\end{equation*}
%
\item\hypertarget{li-45}{}\(e_m\) is non-degenerate: if \(e_m(a,a') = 1 \forall a\in A\lb m\rb\) then \(a' = 0\) (and likewise for the reverse).%
\item\hypertarget{li-46}{}\(e_m\) is Galois-invariant... but we assume \(\overline k =k\) so we ignore this.%
\item\hypertarget{li-47}{}\(e_m\) is \hyperref[def-buntes-compat]{compatible}%
\begin{equation*}
e_{mm'} (a,a')^{m'} = e_m(m'a, m'a') \ \forall a \in A[mm'], a'\in A^\vee [mm']
\end{equation*}
\((mm',\characteristic k) = 1\)%
\end{enumerate}
%
\end{proposition}
\begin{corollary}{}{}{corollary-19}%
\hypertarget{p-303}{}%
There exists a bilinear non-degenerate (Galois invariant) pairing%
\begin{equation*}
e_l = e \colon T_lA \times T_lA^\vee \to T_l\mu
\end{equation*}
%
\begin{equation*}
((a_n), (a'_n)) \mapsto (e_{l^n}(a_,a'_n))
\end{equation*}
%
\end{corollary}
\hypertarget{p-304}{}%
For a homomorphism \(\lambda \colon A \to A^\vee\) we define%
\begin{equation*}
e_m^\lambda \colon A[m]\times A [m] \to \mu_m
\end{equation*}
%
\begin{equation*}
(a,a') \mapsto e_m(a, \lambda(a'))
\end{equation*}
%
\begin{equation*}
e_m \colon T_lA\times T_l A \to T_l \mu
\end{equation*}
%
\begin{equation*}
(a,a') \mapsto e_m(a, \lambda(a'))\text{.}
\end{equation*}
%
\begin{paragraphs}{Notation.}{paragraphs-6}%
\hypertarget{p-305}{}%
If \(\lambda = \lambda_{\sheaf L} e^{\sheaf L} = e^{\lambda_{\sheaf L}}\).%
\end{paragraphs}%
\begin{proposition}{}{}{proposition-25}%
\hypertarget{p-306}{}%
For a homomorphism \(\alpha \colon A \to B\)\leavevmode%
\begin{enumerate}
\item\hypertarget{li-48}{}%
\begin{equation*}
e(a,\alpha^\vee(b)) = e(\alpha (a), b) \forall a \in T_lA,\,b\in T_l B
\end{equation*}
%
\item\hypertarget{li-49}{}%
\begin{equation*}
e^{\alpha^\vee \lambda \alpha}(a,a') = e ^\lambda (\alpha(a), \alpha(a'))
\end{equation*}
for \(a,a' \in T_l(A)\), \(\lambda \in \Hom(B,B^\vee)\).%
\item\hypertarget{li-50}{}%
\begin{equation*}
e^{\alpha^* \sheaf L} (a,a') = e^{\sheaf L}(\alpha (a),\alpha(a'))
\end{equation*}
\(a,a'\in T_lA\) \(\sheaf L\in \Pic(B)\).%
\item\hypertarget{li-51}{}%
\begin{equation*}
\Pic A  \to \Hom( \bigwedge^2 T_lA , T_l\mu)
\end{equation*}
%
\begin{equation*}
\sheaf L \mapsto e^{\sheaf L}
\end{equation*}
is a homomorphism (in particular \(e^{\sheaf L}\) is  skew-\hyperref[def-princ-pol]{symmetric}).%
\end{enumerate}
%
\end{proposition}
\begin{proof}\hypertarget{proof-49}{}
\hypertarget{p-307}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-52}{}\(a = (a_n) \in T_lA\) \(b\in (b_n) \in T_l B^\vee\) fix a divisor \(D \) on \(B\) representing \(b_n\) and \(g\in k(B)\) s.t. \(\divisor (h) = (l^n_B)^* D\). Then \(\alpha^* D\) represents \(\alpha^\vee(b_n)\) so:%
\begin{equation*}
\divisor(g\circ \alpha) = \alpha^*\divisor (g) = \alpha^*(l^n_B)^* D = (l_A^n)^* \alpha^* D\text{.}
\end{equation*}
So%
\item\hypertarget{li-53}{}%
\begin{equation*}
e^{\alpha^{\vee}\lambda \alpha} (a,a') = e(a, \alpha^\vee\lambda \alpha(a')) = e(\alpha(a),\lambda (\alpha(a'))) = e^\lambda (\alpha(a), \alpha(a'))\text{.}
\end{equation*}
%
\item\hypertarget{li-54}{}%
\begin{equation*}
\lambda_{\alpha^* \sheaf L} = \alpha^\vee \lambda_{\sheaf L} \alpha
\end{equation*}
%
\item\hypertarget{li-55}{}Follows from \(\lambda_{\sheaf L\otimes \sheaf L'} = \lambda_{\sheaf L} + \lambda_{\sheaf L'}\).%
\end{enumerate}
%
\end{proof}
\begin{example}{Computation over \(\CC\).}{example-12}%
\hypertarget{p-308}{}%
\(A/\CC\) be an \hyperref[def-buntes-abvar]{abelian variety}%
\begin{equation*}
0\to \ZZ \to \sheaf O_A \xrightarrow{e^{2\pi i (\cdot)}} \sheaf O^\times \to 0
\end{equation*}
induces%
\begin{equation*}
H^1(A(\CC), \ZZ) \to H^1(A(\CC), \sheaf O) \to H^1(A(\CC), \sheaf O^\times) \simeq \Pic A \to H^2(A(\CC), \ZZ)
\end{equation*}
and%
\begin{equation*}
H^1(A(\CC), \sheaf O)/ H^1(A(\CC), \ZZ) \simeq A^\vee(\CC) = \Pic^0(A)
\end{equation*}
so we get an exact sequence%
\begin{equation*}
0 \to \NS(A) \to H^2 (A(\CC),\ZZ) \to H^2(A(\CC),\sheaf O_A)
\end{equation*}
%
\begin{equation*}
\lambda \mapsto E_\lambda
\end{equation*}
then we can regard \(E_\lambda\) as a skew-\hyperref[def-princ-pol]{symmetric} 2-form on \(H_1(A(\CC), \ZZ)\). Mumford pg. 237 proves%
\begin{equation*}
\xymatrix{
H_1(A(\CC), \ZZ) \times H_1(A(\CC), \ZZ) \ar[r] \ar[d] & \ZZ\ni m \ar[d] \\
T_l \times T_l \ar[r] & T_l \mu \ni \zeta^m
}
\end{equation*}
commutes with - sign so \(e^\lambda (a,a') = \zeta^{-E(a,a')}\)%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.10.3 Results about polarizations}
\typeout{************************************************}
%
\begin{subsectionptx}{Results about polarizations}{}{Results about polarizations}{}{}\label{subsection-30}
\hypertarget{p-309}{}%
\(k = \overline k\) \(p = \characteristic (k) \ge 0\).%
\begin{theorem}{13.4.}{}{theorem-27}%
\hypertarget{p-310}{}%
Let \(\alpha\colon A\to B\) be an \hyperref[def-supersing-isog-isog]{isogeny} of degree prime to \(\characteristic k\) and \(\lambda \in \NS(A)\) then \(\lambda = \alpha^* \lambda '\) for \(\lambda ' \in \NS(B) \iff \forall l |\deg(\alpha)\) \(l\) prime there exists a skew-\hyperref[def-princ-pol]{symmetric} form \(f\colon T_lB\times T_lB \to T_l\mu\) s.t. \(e^\lambda(a,a') = f(\alpha(a), \alpha(a'))\) for all \(a,a' \in T_l(A)\).%
\end{theorem}
\begin{proof}\hypertarget{proof-50}{}
\hypertarget{p-311}{}%
Milne 1986 16.4%
\end{proof}
\begin{corollary}{13.5.}{}{corollary-20}%
\hypertarget{p-312}{}%
\(l \ne \characteristic (k)\) \(\lambda \in \NS(A) \) is divisible by \(l^n \iff e^\lambda\) is divisible by \(l^n\) in \(\Hom (\bigwedge^2 T_lA, T_l \mu)\).%
\end{corollary}
\begin{proof}\hypertarget{proof-51}{}
\hypertarget{p-313}{}%
Apply theorem 13.4 with \(\alpha = l^n\).%
\end{proof}
\begin{lemma}{13.7.}{}{lemma-6}%
\hypertarget{p-314}{}%
Let \(\sheaf P\) be the Poincaré sheaf on \(A\times A^\vee\) then%
\begin{equation*}
e^{\sheaf P} ((a,b),(a',b')) = \frac{e(a,b')}{e(a',b)}
\end{equation*}
for all \(a,a' \in T_l A\), \(b,b' \in T_l A^\vee\).%
\end{lemma}
\begin{proof}\hypertarget{proof-52}{}
\hypertarget{p-315}{}%
Milne 1986 16.7. Use:%
\begin{equation*}
(1+ \lambda_{\sheaf L})^* \sheaf P \cong m^* \sheaf L \otimes p^* \sheaf L^{-1} \otimes q^* \sheaf L^{-1}\qedhere
\end{equation*}
%
\end{proof}
\begin{proposition}{13.6.}{}{prop-milne-av-13-6}%
\hypertarget{p-316}{}%
Assume \(\characteristic k \ne l,2\) then a homomorphism \(\lambda\colon A\to A^\vee\) is \(\lambda = \lambda_{\sheaf L}\) for some \(\sheaf L \in \Pic A\) iff \(e^\lambda\) is skew-\hyperref[def-princ-pol]{symmetric}.%
\end{proposition}
\begin{proof}\hypertarget{proof-53}{}
\hypertarget{case-11}{}\hypertarget{p-317}{}%
Clear.%
\par\medskip\noindent
\hypertarget{case-12}{}\hypertarget{p-318}{}%
\(e^\lambda\) is skew-\hyperref[def-princ-pol]{symmetric}, define \(\sheaf L = (1 \times \lambda)^* \sheaf P\) then  \(\forall a,a' \in T_l A\)%
\begin{equation*}
e(a,\lambda_{\sheaf L} (a') ) = e^{\sheaf L}(a,a') = e^{(1\times \lambda)^* \sheaf P} (a,a') = e^{\sheaf P}((a,\lambda (a)), (a',\lambda(a'))) = \frac{e(a,\lambda (a'))}{ e(a',\lambda(a))}
\end{equation*}
%
\begin{equation*}
= \frac{e^\lambda(a,a')}{ e^\lambda(a',a)} = (e^\lambda(a,a'))^2 = e(a,2\lambda (a'))
\end{equation*}
so \(2\lambda = \lambda_{\sheaf L}\). So by corollary 13.5 \(\lambda_{\sheaf L} = 2\lambda_{\sheaf L'}\) for some \(\sheaf L' \in \Pic A\) so \(\lambda = \lambda_{\sheaf L'}\).%
\end{proof}
\begin{definition}{}{definition-36}%
\hypertarget{p-319}{}%
For a  \hyperref[def-polarization]{polarization} \(\lambda \colon A\to A^\vee\) define%
\begin{equation*}
e^{\lambda} \colon \ker(\lambda)\times \ker(\lambda) \to \mu_m
\end{equation*}
%
\begin{equation*}
(a,a')\mapsto e_m(a,\lambda(b))
\end{equation*}
where \(m \) kills \(\ker(\lambda)\) and \(b \in A\) s.t.\(mb = a'\).%
\end{definition}
\hypertarget{p-320}{}%
Check: this is well defined.%
\begin{note}{}{note-4}%
\hypertarget{p-321}{}%
\(e^\lambda\) is skew-\hyperref[def-princ-pol]{symmetric}.%
\end{note}
\begin{proposition}{13.8.}{}{proposition-27}%
\hypertarget{p-322}{}%
\(\alpha\colon A \to B\) is an \hyperref[def-supersing-isog-isog]{isogeny} of degree prime to \(p\), \(\lambda\colon A\to A^\vee\) \hyperref[def-polarization]{polarization} then \(\lambda = \alpha^* \lambda', \,\lambda' \colon B\to B^\vee\) \hyperref[def-polarization]{polarization} iff%
\begin{equation*}
\ker(\alpha) \subset \ker \lambda
\end{equation*}
%
\begin{equation*}
e^{\lambda} \text{ is trivial on } \ker (\alpha)\times \ker(\alpha)
\end{equation*}
%
\end{proposition}
\begin{note}{}{note-5}%
\hypertarget{p-323}{}%
If \(\lambda = \alpha^* \lambda'\) then%
\begin{equation*}
\deg(\lambda) = \deg (\lambda') \deg(\alpha)^2\text{.}
\end{equation*}
%
\end{note}
\begin{corollary}{13.10.}{}{corollary-21}%
\hypertarget{p-324}{}%
\(A\) an \hyperref[def-buntes-abvar]{abelian variety}, \(\lambda \colon A \to A^\vee\) is a \hyperref[def-polarization]{polarization} with \((\deg (\lambda), p) = 1\) then \(A\) is  isogenous to a principally polarized \hyperref[def-buntes-abvar]{abelian variety}.%
\end{corollary}
\begin{proof}\hypertarget{proof-54}{}
\hypertarget{p-325}{}%
Fix \(l |\deg(\lambda)\) prime. Choose a subgroup \(N\subseteq \ker \lambda\) of \hyperref[def-order-quaternion]{order} \(l\) let \(\alpha \colon A\to A/N = B\) \(N\) is cyclic and \(e^\lambda\) is skew-\hyperref[def-princ-pol]{symmetric} so \(e^{\lambda}\) is trivial on \(N\times N\) so \(B\) has a \hyperref[def-polarization]{polarization} of degree \(\deg(\lambda) / l^2\) by 13.8.%
\end{proof}
\begin{corollary}{13.11.}{}{corollary-22}%
\hypertarget{p-326}{}%
Let \(\lambda\) be a \hyperref[def-polarization]{polarization} of \(A\) s.t. \(\ker (\lambda) \subseteq A\lb m \rb\) for some \((m,p)=1\). If \(\exists \alpha \colon A \to A\) s.t. \(\alpha(\ker (\lambda)) \subseteq \ker(\lambda)\) and \(\alpha^\vee \lambda \alpha = - \lambda\) on \(A\lb m^2\rb\) then \(A\times A^\vee\) is principally polarized.%
\end{corollary}
\begin{theorem}{13.12 (Zarhin's trick).}{}{theorem-28}%
\hypertarget{p-327}{}%
For any \hyperref[def-buntes-abvar]{abelian variety} \(A\) \((A\times A^\vee)^4\) is principally polarized.%
\end{theorem}
\begin{proof}\hypertarget{proof-55}{}
\hypertarget{p-328}{}%
Fix \(\lambda \colon A\to A^\vee\) \hyperref[def-polarization]{polarization}, assume \(\ker (\lambda) \subseteq A\lb m \rb\) \((m, p) = 1\) there exists \(a,b,c,d \in \ZZ\) s.t. \(a^2 + b^2 + c^2 + d^2 = m^2  - 1 = -1 \pmod {m^2}\) then%
\begin{equation*}
\begin{pmatrix} a\amp -b \amp-c\amp -d \\ b\amp a \amp d \amp -c \\ c\amp -d \amp a \amp b \\ d \amp c \amp -b \amp a\end{pmatrix}
\end{equation*}
works.%
\end{proof}
\begin{corollary}{13.13.}{}{corollary-23}%
\hypertarget{p-329}{}%
Let \(k\) be a finite field, then for each \(g \in \ZZ\) there exist only finitely many isomorphism classes of \hyperref[def-buntes-abvar]{abelian varieties} of dimension \(g\) over \(k\).%
\end{corollary}
\begin{proof}\hypertarget{proof-56}{}
\hypertarget{p-330}{}%
\(A/k\) an \hyperref[def-buntes-abvar]{abelian variety} of dimension \(g\), so \((A\times A^\vee)^4\) is an \hyperref[def-buntes-abvar]{abelian variety} of dimension \(8g\) with a \hyperref[def-polarization]{principal polarization} so using theorem 11.2 there are finitely many (up to \(\simeq\)) of those. Also \((A\times A^\vee)^4\) has finitely many direct factors (theorem 15.3).%
\end{proof}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.11 The Rosati involution (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{The Rosati involution (Alex)}{}{The Rosati involution (Alex)}{}{}\label{sec-rosati}
\hypertarget{p-331}{}%
Let \(A/k\) be an \hyperref[def-buntes-abvar]{abelian variety} and \(f \in \End(A)\). Via pullback we get \(\hat f \in \End(\hat A)\), in the case where \(A\) is polarized i.e. we have an \hyperref[def-supersing-isog-isog]{isogeny} \(\phi \colon A\to \hat A\) we might wonder what the relation is between \(\hat f\) and \(f\). E.g. \(\hat \id = \id\) but here we have \(\hat \phi \id \phi = \lb \deg \phi\rb\), this is a little ugly, depends on the degree of our \hyperref[def-polarization]{polarization}. If we work with \(\Hom^0(A,B) = \Hom(A,B) \otimes \QQ\) rather than \(\Hom(A,B)\) we have a bona fide inverse \(\phi\inv\) of an \hyperref[def-supersing-isog-isog]{isogeny} \(\phi\). So now we can ask precisely, what is the relationship of the \hyperref[def-supersing-isog-endo]{endomorphism} \(f^\dagger = \phi^{-1}\circ \hat f \circ \phi\in \End^0(A)\) with \(f\)?%
\par
\hypertarget{p-332}{}%
What sort of properties does this map \(f \mapsto f^\dagger\) have?%
\begin{definition}{The Rosati involution.}{definition-37}%
\hypertarget{p-333}{}%
The map \(\phi^{-1} \hat{-} \phi =  {-}^\dagger \colon \End^0(A) \to \End^0(A)\) is called the \terminology{Rosati involution}.%
\end{definition}
\begin{proposition}{}{}{proposition-28}%
\hypertarget{p-334}{}%
\(-^\dagger\) is \(\QQ\)-linear%
\end{proposition}
\begin{proposition}{}{}{proposition-29}%
\hypertarget{p-335}{}%
\(-^\dagger\) is an anti-homomorphism i.e.%
\begin{equation*}
(fg)^\dagger = g^\dagger f^\dagger
\end{equation*}
%
\end{proposition}
\begin{proposition}{}{}{proposition-30}%
\hypertarget{p-336}{}%
Recall the \(l\)-adic \hyperref[prop-weil-pair]{Weil pairing} for \(l \ne \characteristic(k)\), fix \(a,a'\in V_lA = T_lA\otimes \QQ\), then%
\begin{equation*}
e_l^\phi(f a ,a') = e_l^\phi(a, f^\dagger a')\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-57}{}
\hypertarget{p-337}{}%
%
\begin{equation*}
e_l^\phi(f a ,a')  = e_l(fa, \phi a')= e_l(a, \hat f \phi a') = e_l(a, \phi\phi\inv \hat f \phi a') =  e_l^\phi(a, f^\dagger a')\qedhere
\end{equation*}
%
\end{proof}
\begin{proposition}{}{}{proposition-31}%
\hypertarget{p-338}{}%
\(-^\dagger\) is an involution, i.e.%
\begin{equation*}
{\alpha^\dagger}^{\dagger} = \alpha\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-58}{}
\hypertarget{p-339}{}%
We apply the previous proposition and skew-symmetry of a \hyperref[def-polarization]{polarization} (over some extension)%
\begin{equation*}
e_l^\lambda(\alpha a,a') = e_l^\lambda(a, \alpha^\dagger a') = e_l^\lambda({\alpha^\dagger}^{\dagger} a, a')
\end{equation*}
for all \(a,a'\in V_l A\).%
\end{proof}
\hypertarget{p-340}{}%
So we have a weird algebra with a weird operation, what can we do? Perhaps inspired by the killing form of a lie algebra:%
\par
\hypertarget{p-341}{}%
We can form a bilinear form using the trace%
\begin{equation*}
\End^0(A) \times \End^0(A) \to \QQ
\end{equation*}
%
\begin{equation*}
(f,g) \mapsto \tr(fg^\dagger)\text{.}
\end{equation*}
%
\begin{proposition}{}{}{proposition-32}%
\hypertarget{p-342}{}%
This is positive definite. In fact%
\begin{equation*}
\tr(ff^\dagger) = 2g\frac{(D^{g-1}\cdot f^*(D))}{(D^g)}
\end{equation*}
for \(\phi = \phi_{\sheaf L(D)}\).%
\end{proposition}
\hypertarget{p-343}{}%
So given a \hyperref[def-simple-av]{simple} \hyperref[def-buntes-abvar]{abelian variety} we have a division algebra  \(/ \QQ\) equipped with  a positive definite involution.%
\begin{definition}{Albert algebras?}{def-albert-alg}%
\hypertarget{p-344}{}%
A division algebra \(D\) finite over \(\QQ\) with an involution \('\) such that \(\tr_{D/\QQ}(xx') > 0\ \forall x\in D^\times\) is called an \terminology{Albert algebra}.%
\end{definition}
\hypertarget{p-345}{}%
Such algebras were studied by Albert who proved an important classification theorem.%
\begin{theorem}{Albert (1934/5).}{}{theorem-29}%
\hypertarget{p-346}{}%
Let \((D, ')\) be an \hyperref[def-albert-alg]{Albert algebra}, let \(K\) be the center of \(D\) and \(K_0\) the subfield fixed by \('\). Then we have the following classification\leavevmode%
\begin{enumerate}
\item\hypertarget{li-56}{}Type I: \(D = K = K_0\) a totally real number field and \('\) is the identity.%
\item\hypertarget{li-57}{}Type II: \(D\) is a quaternion algebra over \(K = K_0\) a totally real field, that is split at all infinite places and \('\) is defined by letting starting with the standard quaternion algebra \hyperref[def-quat-alg-conj-trace-norm]{conjugation} for which \(x + x^* = \tr(x)\) and then letting \(x' = ax^* a^{-1}\) for some \(a \in D\) for which \(a^2 \in K\) and is totally negative.%
\item\hypertarget{li-58}{}Type III: \(D\) is a quaternion algebra over \(K = K_0\) a totally real field, that is \hyperref[def-dess-ramified]{ramified} at all infinite places and \('\) is the standard quaternion algebra \hyperref[def-quat-alg-conj-trace-norm]{conjugation} as above.%
\item\hypertarget{li-59}{}Type IV: \(D\) is a division algebra over a CM field \(K\) and \(K_0\) is the maximal totally real subfield. Additionally if \(v\) is a finite place with \(v = \bar v\) we have \(\operatorname{Inv}_v(D) = 0\) and \(\operatorname{Inv}_v(D) + \operatorname{Inv}_{\bar v}(D) = 0\) for all places \(v\).%
\end{enumerate}
%
\end{theorem}
\hypertarget{p-347}{}%
There is a fascinating table in Mumford, page 200 or something.%
\par
\hypertarget{p-348}{}%
As one might hope, changing the \hyperref[def-polarization]{polarization} does not change the type of the algebra + involution pair.%
\par
\hypertarget{p-349}{}%
One might wonder which \hyperref[def-supersing-isog-endo]{endomorphisms} are invariant under this process? I.e. what is%
\begin{equation*}
\{f \in \End^0(A) : f^\dagger = f\}\text{.}
\end{equation*}
Equivalently, for which \(f\) is the dual given by conjugating by our \hyperref[def-polarization]{polarization}.%
\par
\hypertarget{p-350}{}%
We can map%
\begin{equation*}
\QQ \otimes_\ZZ \NS(X) = \QQ \otimes_\ZZ \Pic X/\Pic^0 X \to \Hom(A, \hat A)
\end{equation*}
%
\begin{equation*}
\sheaf M \mapsto \phi_{\sheaf M}\text{,}
\end{equation*}
however we also have an isomorphism%
\begin{equation*}
\Hom^0(A, \hat A) \xrightarrow{\sim} \End^0(A)
\end{equation*}
%
\begin{equation*}
\phi \mapsto \lambda\inv \phi
\end{equation*}
for some fixed \hyperref[def-polarization]{polarization} \(\lambda\), hence we can view \(\NS(A)\otimes \QQ\) inside \(\End^0(A)\).%
\begin{proposition}{}{}{proposition-33}%
\hypertarget{p-351}{}%
Assume \(k\) algebraically closed. The image of%
\begin{equation*}
\QQ \otimes_\ZZ \NS(X) \to \End^0(A)
\end{equation*}
is the fixed subspace%
\begin{equation*}
\{f \in \End^0(A) : f^\dagger = f\}\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-59}{}
\hypertarget{p-352}{}%
Fix \(\alpha \in \End^0(A)\) and \(l\ne \characteristic(k)\) odd. Applying \hyperref[prop-milne-av-13-6]{Proposition~\ref{prop-milne-av-13-6}} we see that \(\lambda \alpha = \phi_{\sheaf L}\) for some \(\sheaf L\) iff \(e^{\lambda\alpha}_l\) is skew-\hyperref[def-princ-pol]{symmetric}, but we also have%
\begin{equation*}
e_l^{\lambda\alpha}(a,a')=  e_l^{\lambda}(a,\alpha a') = -e_l^\lambda(\alpha a',a) = -e_l(a', \hat\alpha \lambda a)
\end{equation*}
for all \(a,a' \in V_lA\) this is the same as requiring \(\lambda\alpha = \hat \alpha \lambda\) i.e. \(\alpha = \alpha^\dagger\). .%
\end{proof}
\hypertarget{p-353}{}%
Another cool result we can now prove (in fact this was the reason Weil introduced the notion of a \hyperref[def-polarization]{polarization}).%
\begin{theorem}{}{}{theorem-30}%
\hypertarget{p-354}{}%
The automorphism group of a polarized \hyperref[def-buntes-abvar]{abelian variety} is finite.%
\end{theorem}
\begin{proof}\hypertarget{proof-60}{}
\hypertarget{p-355}{}%
Let \(\alpha\) be an automorphism of \((A, \lambda)\) i.e. \(\lambda =\hat \alpha  \lambda \alpha\), then \(\alpha^\dagger \alpha= 1\) and so%
\begin{equation*}
\alpha \in \End(A)\cap \{\beta \in \End(A) \otimes \RR: \trace(\alpha^\dagger \alpha) = 2g\}
\end{equation*}
but \(\End(A)\) is discrete inside the compact RHS.%
\end{proof}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.12 Abelian Varieties over finite fields (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Abelian Varieties over finite fields (Ricky)}{}{Abelian Varieties over finite fields (Ricky)}{}{}\label{sec-avs-over-ffs}
\hypertarget{p-356}{}%
Set \(q = p^m\), \(p\) prime. Given \(X/\FF_q\) have  geometric Frobenius \(\pi_X\colon X \to X\) which acts as \(\id\) on \(|X|\) and sends \(f\to f^q\) for \(f\in \sheaf O_X(U)\).%
\begin{example}{}{example-13}%
\hypertarget{p-357}{}%
\(X \hookrightarrow \PP^n\) then \(\pi_X(a_0:\cdots :a_n) = (a_0^q : \cdots :a_n^q)\).%
\end{example}
\hypertarget{p-358}{}%
We also have absolute Frobenius%
\begin{equation*}
F\colon X\to X^{(p)}\text{.}
\end{equation*}
%
\begin{example}{}{example-14}%
\hypertarget{p-359}{}%
%
\begin{equation*}
X \colon y^2 = x^3 + i / \FF_q
\end{equation*}
%
\begin{equation*}
X^{(p)} \colon y^2 = x^3 + i^3 = x^3 - i / \FF_q
\end{equation*}
%
\end{example}
\hypertarget{p-360}{}%
We see that \(X^{(p^m)} = X\) and \(F^m = \pi_X\).%
\begin{equation*}
\xymatrix{
X \ar[drr] \ar[dr]\ar[ddr] & &\\
& X^{(p)} \ar[d]\ar[r] & X\ar[d]\\
& \FF_q \ar[r]_p &\FF_q
}
\end{equation*}
%
\par
\hypertarget{p-361}{}%
If \(f\colon X \to Y\) of \(\FF_q\)-schemes then \(\pi_Y \circ f = f\circ \pi_X\). Now let \(X\) be an \hyperref[def-buntes-abvar]{abelian variety} over \(\FF_q\). From above, we have \(\pi_X\) commutes with all elements of \(\End^0(X) = \End^0(X)\otimes \QQ\). Let \(f_X\) be the characteristic polynomial of \(T_l(\pi_X) \colon V_l(X) \to V_l(X)\) for \(l \ne p\).%
\par
\hypertarget{p-362}{}%
An alternative definition is to take \(f_X\in \ZZ\lb X\rb\) monic of degree \(2g \), \(g = \dim X\) s.t.%
\begin{equation*}
f_X(n) = \deg([n] -\pi_X)\text{,}
\end{equation*}
see 12.8.%
\begin{proposition}{16.3.}{}{proposition-34}%
\hypertarget{p-363}{}%
Assume \(X\) is elementary, (i.e. its isogenous to \(A^n\) for some \(A\) \hyperref[def-simple-av]{simple}). Then  \(\QQ\lb \pi_X\rb\subseteq \End^0(X)\) is a field and \(f_X\) is a power of the minimal polynomial of \(\pi_X\) over \(\QQ\).%
\end{proposition}
\begin{proof}\hypertarget{proof-61}{}
\hypertarget{p-364}{}%
Since \(X\) is elementary \(Z(\End^0(X))\) is  a field containing \(\QQ\lb \pi_X\rb\). Let \(g\) be the minimal polynomial of \(\pi_X\) over \(\QQ\). Let \(\alpha\) be a root of \(f\). Then \(g(\alpha)\) is an eigenvalue of \(g(V_l(\pi_X)) = V_l(g(\pi_X)) = V_l(0) = 0\). Hence \(g(\alpha) = 0\).%
\end{proof}
\begin{theorem}{16.4.}{}{thm-milne-16-4}%
\hypertarget{p-365}{}%
Let \(g= \dim (X)\).\leavevmode%
\begin{enumerate}
\item\hypertarget{li-60}{}Every root of \(f_X\) \(\alpha \in \CC\) satisfies \(|\alpha| = q^{1/2}\).%
\item\hypertarget{li-61}{}If \(\alpha\) is  a root of \(f_X\), then \(\bar \alpha\) with the same \hyperref[def-riem-order-vanish]{multiplicity}. In particular if \(\alpha = \pm \sqrt q\) then it occurs with even \hyperref[def-riem-order-vanish]{multiplicity}.%
\end{enumerate}
%
\end{theorem}
\hypertarget{p-366}{}%
We need some facts before proving this: Ref 5.20, 5.21\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}There exists%
\begin{equation*}
V\colon X^{(p)} \to X
\end{equation*}
such that%
\begin{equation*}
V\circ F = [p]_X
\end{equation*}
and%
\begin{equation*}
F \circ V = [p]_{X^{(p)}}\text{.}
\end{equation*}
Using \(\deg F = p^g \)  get \(\deg V = p^g\)%
\item{}By induction \(\lb p^m\rb = V^m \circ F^m\).%
\end{itemize}
%
\par
\hypertarget{p-367}{}%
We also need some facts about \(F\) and \(V\) relative to \(X^\vee\).%
\begin{equation*}
F_X^\vee = V_{X^\vee} \colon (X^\vee)^{(p)} \to X^\vee
\end{equation*}
identifying \((X^\vee)^{(p)} = (X^{(p)})^\vee\), Ref 7.33, 7.34.%
\begin{proof}\hypertarget{proof-62}{}
\hypertarget{p-368}{}%
Reduce to the case where \(X\) is \hyperref[def-simple-av]{simple}, we have%
\begin{equation*}
h\colon X\to X_1 \times X_2 \times \cdots \times X_s
\end{equation*}
an \hyperref[def-supersing-isog-isog]{isogeny} with \(X_i\) \hyperref[def-simple-av]{simple}, then \(h\) induces an isomorphism%
\begin{equation*}
h\colon V_l(X)\xrightarrow{\sim} \bigoplus_i V_l(X_i)
\end{equation*}
so \(f_X = f_{X_1} \cdots f_{X_s}\). Hence we can assume \(X\) is \hyperref[def-simple-av]{simple}.%
\par
\hypertarget{p-369}{}%
Let \(\lambda \colon X \to X^\vee\) be a \hyperref[def-polarization]{polarization} of \(X\) and \(\dagger\) be the corresponding \hyperref[sec-rosati]{Rosati involution} on \(\End^0(X)\) we will show that \(\pi_X\pi_X^\dagger = q\).%
\begin{equation*}
\pi_X \pi_X^\dagger = \pi_X \lambda^{-1} \pi_X^\vee \lambda = \lambda^{-1} \pi_{X^\vee} \pi_X^\vee \lambda = \lambda^{-1} \lb q \rb \lambda = \lb q \rb
\end{equation*}
To see \(\pi_{X^\vee} = \pi_X^\vee = q\) we use \(\pi_X = F^m\) and \(\pi_X^\vee = V^m \). So \(\pi_{X^\vee} \pi_X^\vee = F^MV^M = p^m = q\). As \(X\) is \hyperref[def-simple-av]{simple} \(\QQ\lb \pi_X\rb\) is a field. Thus \(f_X\) is a power of \(g\), the minimal polynomial of \(\pi_X/\QQ\). So the complex roots of \(f_X\) are \(\iota(\pi_X)\)  for every embedding \(\QQ\lb \pi_X\rb\hookrightarrow \CC\). since \(\pi_X^\dagger = q/ \pi_X\), we see that%
\begin{equation*}
\QQ[\pi_X] \subseteq \End^0(X)
\end{equation*}
is stable under \(\dagger\). We have two cases for such a \(K = \QQ\lb \pi_X \rb \)\leavevmode%
\begin{enumerate}
\item\hypertarget{li-64}{}\(K\) is  totally real and \(\dagger = \id\).%
\item\hypertarget{li-65}{}\(K\) is a CM field and \(\dagger = \overline{\cdot}\).%
\end{enumerate}
hence we get%
\begin{equation*}
\iota(\pi_X\pi_X^\dagger) = \iota(\pi_X) \overline{\iota(\pi_X)} = q
\end{equation*}
for any \(\iota\colon K \to \CC\).%
\par
\hypertarget{p-370}{}%
If \(\pm \sqrt q\) is  a root  of  \(f_X\) then we are in the case of \(K\) totally real. If \(\sqrt q\) has \hyperref[def-riem-order-vanish]{multiplicity} \(n\). Then \(-\sqrt q\) has \hyperref[def-riem-order-vanish]{multiplicity} \(2g-n\). Thus \(f_X(0) = (-1)^n   q^g\). But also \(f_X(0 ) = \deg(0 - \pi_X) = q^g\). Hence \(n \) is even.%
\end{proof}
\begin{paragraphs}{Honda-Tate.}{paragraphs-7}%
\hypertarget{p-371}{}%
The correspondence between \hyperref[def-supersing-isog-isog]{isogeny} classes of \(X/\FF_q\) and conjugacy classes of \(q\)-\hyperref[sec-honda-tate]{Weil numbers} is a bijection. (i.e. algebraic integers \(\alpha\) s.t. \(|\iota \alpha| = \sqrt q\) for all \(\iota \colon \QQ(\alpha) \hookrightarrow \CC\)).%
\end{paragraphs}%
\par
\hypertarget{p-372}{}%
Using relations between a curve \(C/\FF_q\) and its Jacobian \(J(C) \), one can show:%
\begin{theorem}{Hasse-Weil-Serre bound.}{}{theorem-32}%
\hypertarget{p-373}{}%
%
\begin{equation*}
q + 1 - g\lfloor 2\sqrt q\rfloor \le \#C(\FF_{q}) \le q + 1 + g\lfloor 2\sqrt q\rfloor
\end{equation*}
where \(g=  g(C)\).%
\end{theorem}
\begin{proof}\hypertarget{proof-63}{}
\hypertarget{p-374}{}%
Hint: Use Lefschetz trace and \(H^1(C, \QQ_l) \simeq H^1(J(C) , \QQ_l)\).%
\end{proof}
\hypertarget{p-375}{}%
Application: Let \(J = J_0(103) = J(X_0(103))\). \(J\sim J_+ \times J_-\).%
\begin{equation*}
J_{\pm} = \im(w \pm \id)
\end{equation*}
\(w\) Atkin-Lehner. \(\dim J = 8\) and \(\dim(J_-) = 6\). In fact \(\exists f\in  S_2( \Gamma_0(103))\) an eigenform s.t. if%
\begin{equation*}
f=\sum_{n\ge 1} a_n q^n
\end{equation*}
then \(\lb \QQ(a_n)_{n \ge 1}: \QQ\rb =6\) and \(\tr( F_{J_-,p};  T_l(J_-)) = \tr_{K/\QQ}(a_p)\)  for \(l \ne p, p\ne 103\) We can compute \(\tr_{K/\QQ} ( a_2) = 4\). This implies that \(J_- \times \FF_2\) is not the Jacobian of a curve \(/\FF_2\), if it were, then  if \(J_- \times \FF_2 = J(C)\) then via Lefschetz trace formula%
\begin{equation*}
\#C(\FF_2) = 2+1 - 4 = -1
\end{equation*}
similar thing at 17.%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.13 Tate's Isogeny Theorem (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{Tate's Isogeny Theorem (Sachi)}{}{Tate's Isogeny Theorem (Sachi)}{}{}\label{sec-tate-thm}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.1 The Theorem}
\typeout{************************************************}
%
\begin{subsectionptx}{The Theorem}{}{The Theorem}{}{}\label{subsection-31}
\begin{theorem}{Tate.}{}{thm-tate-isog}%
\hypertarget{p-376}{}%
Let \(A,B/\FF_q = k\), \(q = p^n\), \(l\ne p\) be \hyperref[def-buntes-abvar]{abelian varieties} and \(G = \Gal{k^s}{k}\), then%
\begin{equation*}
\Hom_{k}(A,B)\otimes \ZZ_l \to \Hom_G(T_l A, T_lB) = \Hom_{\ZZ_l}(T_lA,T_lB)^G
\end{equation*}
(where the \(G\) action on \(\Hom_{\ZZ_l}(T_l A, T_lB)\) is \((gf)(x) = gf(g^{-1}x)\)) is an isomorphism.%
\end{theorem}
\begin{remark}{}{remark-8}%
\hypertarget{p-377}{}%
Tate's theorem is also true for function fields over finite fields (Zarhin) and fields that are finitely generated over their prime field (Faltings), e.g. number fields. Not true over algebraically closed fields though.%
\end{remark}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.2 Motivation}
\typeout{************************************************}
%
\begin{subsectionptx}{Motivation}{}{Motivation}{}{}\label{subsection-32}
\hypertarget{p-378}{}%
Let \(\pi_A\) and \(\pi_B\) be the (relative) Frobenii on \(V_l(A), V_l(B)\)%
\begin{equation*}
\Hom_{k}(A,B)\otimes \QQ_l \to \Hom_G(V_l A, V_lB)
\end{equation*}
\(P_A,P_B\) characteristic polynomials of \(\pi_A,\pi_B\).%
\par
\hypertarget{p-379}{}%
Toy Weil conjectures: \(P_A, P_B\) have \(\ZZ\)-coefficients, don't depend on the choice of \(l\). Provided that induced action of Frobenii are semisimple, we can find a number \(r(P_A,P_B)\) then Tate implies%
\begin{equation*}
r(P_A,P_B) = \dim_{\QQ_l} \Hom_G (V_l(A), V_l(B)) = \rank \Hom_k(A,B)
\end{equation*}
%
\begin{corollary}{}{}{corollary-24}%
\hypertarget{p-380}{}%
Let \(A, B\) be \hyperref[def-buntes-abvar]{abelian varieties} over \(\FF_q\) and \(P_A, P_B\) as above\leavevmode%
\begin{enumerate}
\item\hypertarget{li-66}{}%
\begin{equation*}
\rank \Hom_k(A,B) = r(P_A,P_B)
\end{equation*}
%
\item\hypertarget{li-67}{}\hypertarget{p-381}{}%
TFAE%
\begin{enumerate}
\item\hypertarget{li-68}{}\(B\) is \(k\)-isogenous to an abelian subvariety of \(A\)%
\item\hypertarget{li-69}{}\(V_lB\) is \(G\)-isomorphic to a \(G\)-subrepresentation of \(V_lA\) for \(l \ne \characteristic k\)%
\item\hypertarget{li-70}{}%
\begin{equation*}
P_B | P_A
\end{equation*}
%
\end{enumerate}
%
\end{enumerate}
we also have similar statements for equivalence, but get a nice statement about counting points over all extensions determining an \hyperref[def-buntes-abvar]{abelian variety}.%
\end{corollary}
\begin{proof}\hypertarget{proof-64}{}
\hypertarget{p-382}{}%
%
\begin{equation*}
\alpha \colon V_l(B)\hookrightarrow V_l(A)
\end{equation*}
the surjectivity in Tate's theorem means we can choose \(u \in \Hom_k(B,A) \otimes \QQ_l\). \(V_l(u) = \alpha\). Choose \(u \in \Hom_k(B,A) \otimes \QQ\) arbitrarily close to \(\alpha\). Lower semicontinuity implies if \(V_l(u)\) is close enough to \(\alpha\), can ensure \(V_l(u)\) is injective (\(\ker (V_l (u)) = 0\)) take multiple to get \(u \in \Hom_k(B,A)\). Since \(T_l (u)\) is injective \(u \) is an \hyperref[def-supersing-isog-isog]{isogeny} to an abelian subvariety.%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.3 Isogeny category}
\typeout{************************************************}
%
\begin{subsectionptx}{Isogeny category}{}{Isogeny category}{}{}\label{subsection-33}
\hypertarget{p-383}{}%
Recall: The \hyperref[def-supersing-isog-isog]{isogeny} category, \hyperref[thm-poincare-reducibility]{Theorem~\ref{thm-poincare-reducibility}}, \hyperref[cor-ab-var-product-simple]{Corollary~\ref{cor-ab-var-product-simple}}. So we have  a category \(\cat{Isog}\) of \hyperref[def-buntes-abvar]{abelian varieties} with%
\begin{equation*}
\Hom_{\cat{Isog}}(A,B) = \Hom_\cat{AV}(A,B)\otimes \QQ\text{.}
\end{equation*}
Now if \(f \colon A \to B\) there exists \(g\colon B \to A\) an \hyperref[def-supersing-isog-isog]{isogeny} and \(n\in \ZZ_{\ge 1}\) s.t. \(gf = \lb n \rb\). So \(\frac 1n g\) is an inverse for \(f \in \cat{Isog}\) so \hyperref[def-supersing-isog-isog]{isogenies} are isomorphisms in \(\cat{Isog}\).%
\par
\hypertarget{p-384}{}%
\(\cat{Isog}\) is a semisimple abelian category. The \hyperref[def-simple-av]{simples} are \hyperref[def-simple-av]{simple} \hyperref[def-buntes-abvar]{abelian varieties}.\leavevmode%
\begin{enumerate}
\item\hypertarget{li-71}{}Decomposition up to \hyperref[def-supersing-isog-isog]{isogeny} into a product of \hyperref[def-simple-av]{simple} \hyperref[def-buntes-abvar]{abelian varieties} is unique.%
\item\hypertarget{li-72}{}If \(A\) is \hyperref[def-simple-av]{simple} \(\End A \otimes \QQ\) is a division algebra over \(\QQ\). Reason: If \(A\) is \hyperref[def-simple-av]{simple} in an abelian category, if \(\End A \supseteq k\) a field implies it's a division algebra.%
\end{enumerate}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.4 Reductions}
\typeout{************************************************}
%
\begin{subsectionptx}{Reductions}{}{Reductions}{}{}\label{subsection-34}
\begin{lemma}{}{}{lemma-7}%
\hypertarget{p-385}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-73}{}%
\begin{equation*}
\ZZ_l \otimes \Hom_\cat{AV} (A,B) \to \Hom_H(T_l, T_lB)
\end{equation*}
is an isomorphism if and only if%
\begin{equation*}
\QQ_l \otimes \Hom_\cat{AV} (A,B) \to \Hom_G(V_l A, V_l B)
\end{equation*}
is an iso%
\item\hypertarget{li-74}{}If for every \(C\),%
\begin{equation*}
\QQ_l \otimes \End_\cat{AV} (C) \to \End_G(V_l C)
\end{equation*}
is an isomorphism then the above is an isomorphism for every pair \(A,B\).%
\end{enumerate}
%
\end{lemma}
\begin{proof}\hypertarget{proof-65}{}
\hypertarget{p-386}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-75}{}The first map is always injective, the cokernel is torsion free, hence free. It's an isomorphism if and only if \(\QQ_l \otimes \coker = 0\) As \(\QQ_l\) is flat over \(\ZZ_l\) the second map injective and its cokernel is \(\QQ_l \otimes\) the cokernel of the first map.%
\item\hypertarget{li-76}{}%
\begin{equation*}
C = A\times B
\end{equation*}
then%
\begin{equation*}
\End^0(C) = \End^0(A)\oplus \Hom^0(A,B) \oplus \Hom^0(B,A) \oplus \End^0(B)
\end{equation*}
and%
\begin{equation*}
\End_G(V_lC) = \End_G(V_lA)\oplus \Hom_G(V_lA,V_lB) \oplus \Hom_G(V_lB,V_lA) \oplus \End_G(V_lB)
\end{equation*}
which the injection above preserves, in  particular if the last map is an isomorphism, so are the rest.%
\end{enumerate}
%
\end{proof}
\hypertarget{p-387}{}%
One more reduction!%
\begin{equation*}
E_l = \End_k(A) \otimes \QQ_l\subseteq \End_{\QQ_l} (V_lA)
\end{equation*}
%
\begin{equation*}
F_l = \QQ_l[G] \subseteq \End_{\QQ_l} (V_lA)
\end{equation*}
automorphisms of \(V_l(A) \) coming from \(G\).%
\begin{note}{}{note-6}%
\hypertarget{p-388}{}%
\(E_l\) coming from \(k\)-rational \hyperref[def-supersing-isog-endo]{endomorphisms} commute with the Galois action%
\begin{equation*}
F_l\subseteq C_{\End_{\QQ_l}(V_l(A))}(E_l)
\end{equation*}
want equality.%
\end{note}
\begin{lemma}{}{}{lemma-8}%
\hypertarget{p-389}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-77}{}The last map of the reduction lemma is an isomorphism if and only if%
\begin{equation*}
C(C(E_l)) = \End_G(V_l(A))
\end{equation*}
%
\item\hypertarget{li-78}{}If \(F_l\) is semisimple the map is an isomorphism if and only if%
\begin{equation*}
C(E_l) = F_l
\end{equation*}
%
\end{enumerate}
%
\end{lemma}
\begin{proof}\hypertarget{proof-66}{}
\hypertarget{p-390}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-79}{}Double centralizer theorem, if \(E_l\) is semisimple then \(C(C(E_l))= E_l\). Poincaré reducibility implies%
\begin{equation*}
A\sim \prod A_i^{m_i}
\end{equation*}
%
\begin{equation*}
\End^0(A) = \End^0(\prod A_i^{m_i}) = \prod \Mat_{m_i}(\End^0(A_i))
\end{equation*}
a finite dimensional division algebra \(/\QQ\). A matrix algebra over a finite dimensional division algebra is semisimple.%
\item\hypertarget{li-80}{}If \(F_l\) is semisimple%
\begin{equation*}
C(E_l) = F_l \iff E_l = C(C(E_l))
\end{equation*}
so%
\begin{equation*}
E_l = C(F_l) = \End_G(V_l(A))\text{.}\qedhere
\end{equation*}
%
\end{enumerate}
%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.13.5 Proof of Tate using finiteness}
\typeout{************************************************}
%
\begin{subsectionptx}{Proof of Tate using finiteness}{}{Proof of Tate using finiteness}{}{}\label{subsection-35}
\hypertarget{p-391}{}%
We introduce a hypothesis: \(\operatorname{Hyp}(k,A,l)\) there exist only finitely many (up to \(k\)-isomorphism) \hyperref[def-buntes-abvar]{abelian varieties} \(B\) s.t. there is a \(k\)-\hyperref[def-supersing-isog-isog]{isogeny} of \(l\)-power degree from \(B\to A\).%
\par
\hypertarget{p-392}{}%
\(D =C(E_l)\) want that \(C(D) = \End_G(V_l(A))\) know \(C(D) \subseteq E_l \subseteq \End_G(V_l(A))\) want \(C(D) \supseteq \End_G(V_l(A))\). Let \(\alpha \in \End_G(V_l(A))\) show that it commutes with everything in \(D\). Equivalently let \(W\) be the graph of \(\alpha\)%
\begin{equation*}
W = \{(x,\alpha x) \in V_l(A)\times V_l(A)\} \subseteq V_l(A)\times V_l(A)
\end{equation*}
note \(g\in G\) then \(g\acts (x,\alpha x) = (gx,g\alpha x ) = (gx, \alpha(gx))\).%
\begin{equation*}
\alpha\in C(D) \iff \forall x\in V_l(A), d\in D
\end{equation*}
%
\begin{equation*}
\alpha d x = d\alpha x \iff (d\oplus d)W \subseteq W \forall d\in D
\end{equation*}
%
\begin{equation*}
W\ni (dx, d\alpha x) = (dx, \alpha d x)
\end{equation*}
%
\begin{lemma}{Technical lemma.}{}{lemma-9}%
\hypertarget{p-393}{}%
If \(W\subseteq V_l(A)\) is \(G\)-stable subspace then there exists \(u\in E_l\) s.t. \(u V_l(A) = W\).%
\end{lemma}
\begin{proof}\hypertarget{proof-67}{}
\hypertarget{p-394}{}%
For \(n \in \ZZ_{\ge 0}\) let \(U_n = (W\cap T_l(A)) + l^n T_A\) which is a \(G\)-stable \hyperref[def-buntes-lattice]{lattice} in \(V_l A\),%
\begin{equation*}
l^nT_lA \subseteq U_n \subseteq T_l A
\end{equation*}
let \(\mathcal K_n \subseteq A\lb l^n \rb (k^s) = T_l A/ l^n T_l A\) be the image of \(U_n\). \(\mathcal K_n\) is stable under \(G\)-action on \(A\lb l^n \rb (k^s)\) which implies \(\mathcal K_n = K_n (k^s)\). Let \(\pi_n \colon A \to B_n = A/ K_n\), \(\iota_n \colon B_n \to A\) unique \hyperref[def-supersing-isog-isog]{isogeny} s.t.%
\begin{equation*}
\iota_n \circ \pi_n  =  \lb [l^n]_A
\end{equation*}
then \(T_lB \cong U_n\) as \(\ZZ_l\)-modules with \(G\)-action. As \(T_l(\iota_n) \colon U_n =T_l B  \to T_l A\) is the inclusion map. Assuming \(\operatorname{Hyp}(k,A,l)\) we can find \(n = n_1 \lt n_2 \lt \cdots\) s.t. we have%
\begin{equation*}
\alpha_i \colon B_n \xrightarrow{\sim} B_{n_i}
\end{equation*}
%
\begin{equation*}
\xymatrix{
B_n \ar[r]^{\alpha_i} & B_{n_i} \ar[d]_{\iota_{n_i}}\\
A\ar[u]_{\pi_n} \ar@{-->}_{u_i}[r] & A
}
\end{equation*}
\(u_i = \iota_{n_i} \circ \alpha_i \circ \pi_n\) is an \hyperref[def-supersing-isog-endo]{endomorphism} of \(A\) on Tate modules \(T_l(u_i)\) is induced map%
\begin{equation*}
T_l A \xrightarrow{[l^n]} U_n \xrightarrow{T_l\alpha_i} U_{n_i} \hookrightarrow T_l A
\end{equation*}
because \(\ZZ_l \otimes \End A\) is a free \(\ZZ_l\)-module of finite rank compact in \(l\)-adic topology subsequence of \(u_i \to u\) in \(\ZZ_l \otimes \End A\)%
\begin{equation*}
U_{n_1} \supseteq U_{n_2} \supseteq \cdots
\end{equation*}
the \hyperref[def-supersing-isog-endo]{endomorphism} of \(T_l u\) maps \(T_l A\) to \(\bigcap_{i=1}^\infty U_{n_i} = W\cap T_l A\) passing to \(\QQ_l\)-coefficients, note \(\QQ_l(W\cap T_l A) = \QQ_l(l^n(W\cap T_l A)) = W\) so \(\image(V_l(u)) =W\).%
\end{proof}
\hypertarget{p-395}{}%
Why does the hypothesis hold.%
\begin{fact}{}{}{fact-2}%
\hypertarget{p-396}{}%
There exists a moduli space of \(d\)-polarised \hyperref[def-buntes-abvar]{abelian varieties} of \(\dim = g\) \(A_{g,d}\) which is a stack of finite type \(/k\).%
\end{fact}
\hypertarget{p-397}{}%
%
\begin{equation*}
A_{g,d}( k) = \{(A,\lambda) : A , \lambda \colon A \to A^\vee,\ \deg d \}
\end{equation*}
Zahrin's trick: \(A\) \hyperref[def-buntes-abvar]{abelian variety} \((A\times A^\vee)^4\) is principally polarized. Finiteness of direct factors \(B\subseteq A\) \(A\simeq B\times C\).%
\begin{corollary}{}{}{corollary-25}%
\hypertarget{p-398}{}%
If \(k = \FF_q\) exists only finitely many \hyperref[def-supersing-isog-isog]{isogeny} classes of \hyperref[def-buntes-abvar]{abelian varieties} of \(\dim g\).%
\end{corollary}
\begin{proof}\hypertarget{proof-68}{}
\hypertarget{p-399}{}%
\(A\) is a direct factor \((A\times A^\vee)^4 \in A_{8g,1}\).%
\end{proof}
\begin{proof}\hypertarget{proof-69}{}
\hypertarget{p-400}{}%
of Tate.%
\par
\hypertarget{p-401}{}%
Apply technical lemma to \(V_l(A\times A)\) and \(W\) so%
\begin{equation*}
(d\oplus d) W = (d \oplus d) uV_l(A\times A) = u(d\oplus d) V_l(A\times A) \subseteq uV_l(A\times A) = W
\end{equation*}
%
\begin{equation*}
\implies C(D) \supseteq \End_G(V_l(A))\text{.}\qedhere
\end{equation*}
%
\end{proof}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.14 The Honda Tate Theorem (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{The Honda Tate Theorem (Angus)}{}{The Honda Tate Theorem (Angus)}{}{}\label{sec-honda-tate}
\begin{introduction}{}%
\hypertarget{p-402}{}%
\(q = p^n\), \(A\) a \hyperref[def-simple-av]{simple} \hyperref[def-buntes-abvar]{abelian variety} over \(\FF_q\), \(\pi_A\) the frobenius on \(A\), \(\End^0(A) = \QQ\otimes \End(A)\), \(f_A\) is the charpoly of \(A\) (i.e. of \(\pi_A\)).%
\begin{fact}{}{}{fact-3}%
\hypertarget{p-403}{}%
\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}\(\End^0(A)\) is a division ring.%
\item{}\(\QQ\lb \pi\rb\) is a field.%
\item{}\(Z(\End^0(A)) = \QQ\lb \pi_A\rb\)%
\end{itemize}
%
\end{fact}
\begin{lemma}{The Weil Conjectures.}{}{lemma-10}%
\hypertarget{p-404}{}%
The roots of \(f_A\) all have absolute value \(\sqrt q\). Alternatively, under all embeddings%
\begin{equation*}
\iota \colon \QQ\lb \pi_A\rb \hookrightarrow \CC,\,|\iota(\pi_A)| = \sqrt q\text{.}
\end{equation*}
%
\end{lemma}
\begin{definition}{\(q\)-Weil numbers.}{definition-39}%
\hypertarget{p-405}{}%
A \(q\)-\terminology{Weil number} is an algebraic integer \(\pi\) s.t.%
\begin{equation*}
\forall \iota \colon \QQ\lb \pi\rb \hookrightarrow \CC,\,|\iota(\pi)| = \sqrt q
\end{equation*}
we say that two \(q\)-\hyperref[sec-honda-tate]{Weil numbers} are conjugate if they have the same minimal polynomial over \(\QQ\), and write \(\pi \sim \pi'\).%
\end{definition}
\hypertarget{p-406}{}%
From the facts so far we have a map%
\begin{equation*}
\{\text{simple AVs}/\FF_q\}\to \{q\text{-Weil numbers}\}
\end{equation*}
%
\begin{equation*}
A \mapsto \pi_A
\end{equation*}
%
\begin{theorem}{}{}{theorem-34}%
\hypertarget{p-407}{}%
We have a bijection%
\begin{equation*}
\{\text{isogeny classes of simple AVs}/\FF_q\}\xrightarrow{\sim} \{\text{conjugacy classes of }q\text{-Weil numbers}\}
\end{equation*}
%
\begin{equation*}
A \mapsto \pi_A\text{.}
\end{equation*}
%
\end{theorem}
\hypertarget{p-408}{}%
We need to show this is well-defined, injectivity and surjectivity.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.14.1 Honda-Tate map}
\typeout{************************************************}
%
\begin{subsectionptx}{Honda-Tate map}{}{Honda-Tate map}{}{}\label{subsection-36}
\hypertarget{p-409}{}%
Recall:%
\begin{corollary}{}{}{corollary-26}%
\hypertarget{p-410}{}%
Let \(A,B\) be \hyperref[def-buntes-abvar]{abelian varieties} over \(\FF_q\) with rational Tate modules \(V_l A, V_lB\) then%
\begin{equation*}
A\sim_{\text{isog}} B \iff V_l A \simeq V_l B \forall l \ne p\text{.}
\end{equation*}
%
\end{corollary}
\begin{corollary}{}{}{corollary-27}%
\hypertarget{p-411}{}%
%
\begin{equation*}
A\sim_{\text{isog}} B \iff f_A = f_B
\end{equation*}
%
\end{corollary}
\begin{proof}\hypertarget{proof-70}{}
\hypertarget{p-412}{}%
By above \(V_l A \simeq V_lB\) for all \(l \ne p\) but \(f_A\) (resp. \(f_B\)) is the charpoly of \(\pi_a\) (\(\pi_B\)) on \(V_l A\) (\(V_l(B)\)).%
\par
\hypertarget{p-413}{}%
The Galois modules \(V_lA\) and \(V_l B\) are semisimple. The Brauer-Nesbitt theorem says \(f_A = f_B \implies V_lA \simeq V_lB \) for \(l\ne p\).%
\end{proof}
\hypertarget{p-414}{}%
Recalling that \(f_A\) is a power of the minimal polynomial of \(\pi_A\),%
\begin{equation*}
A \sim_{\text{isog}} B\implies  f_A =f_B \implies \pi_A \sim \pi_B\text{.}
\end{equation*}
So the Honda-Tate map is well defined.%
\par
\hypertarget{p-415}{}%
This doesn't quite give injectivity because a priori \(f_A\) and \(f_B\) could be powers of the minpolys of \(\pi_A, \pi_B\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.14.2 Injectivity and Brauer groups}
\typeout{************************************************}
%
\begin{subsectionptx}{Injectivity and Brauer groups}{}{Injectivity and Brauer groups}{}{}\label{subsection-37}
\hypertarget{p-416}{}%
From last time:%
\begin{proposition}{}{}{proposition-35}%
\hypertarget{p-417}{}%
There exists a certain quantity \(r(f_A, f_B)\) such that%
\begin{equation*}
r(f_A, f_B) = \rank \Hom(A,B)\text{.}
\end{equation*}
%
\end{proposition}
\begin{corollary}{}{}{corollary-28}%
\hypertarget{p-418}{}%
Let \(d = \lb \End^0(A) : \QQ(\pi_A) \rb^{1/2}\), let \(h_A = \operatorname{minpoly}_\QQ(\pi_A)\) then \(f_A = h_A^d\).%
\end{corollary}
\begin{proof}\hypertarget{proof-71}{}
\hypertarget{p-419}{}%
Study the formula for \(r(f_A, f_A)\) Edixhoven-van der Geer-Moonen 16.22.%
\end{proof}
\hypertarget{p-420}{}%
So the next step is to try and recover \(\End^0(A)\) from \(\pi\).%
\begin{definition}{Central simple algebras.}{def-abvar-csa}%
\hypertarget{p-421}{}%
A \terminology{central \hyperref[def-simple-av]{simple} algebra} \(B/k\) is a \(k\)-algebra \(B\) with no two-sided ideals and \(Z(B) = k\).%
\end{definition}
\begin{theorem}{Artin-Wedderburn.}{}{theorem-35}%
\hypertarget{p-422}{}%
Any such algebra is isomorphic to \(M_n(D)\) for \(D\) a division ring over \(k\).%
\end{theorem}
\begin{definition}{Brauer groups.}{def-brauer-gp}%
\hypertarget{p-423}{}%
The \terminology{Brauer group} of \(k\) \(\operatorname{Br}(k)\) is the set of \hyperref[def-abvar-csa]{central \hyperref[def-simple-av]{simple} algebras} under \(\otimes\) modulo the algebras \(M_n(k)\).%
\end{definition}
\begin{fact}{}{}{fact-4}%
\hypertarget{p-424}{}%
\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}If \(k = \overline k\), \(\operatorname{Br}(k) = 0\).%
\item{}\(k\) \hyperref[def-abelian-complete-var]{complete} nonarchimidean \(\operatorname{Br}(k) = \QQ/\ZZ\)%
\item{}\(\operatorname{Br}(\RR) = \ZZ/2\ZZ\)%
\end{itemize}
Given a place \(v\) of \(k\) we get a map%
\begin{equation*}
\operatorname{Br}(k) \to \operatorname{Br}(k_v)
\end{equation*}
%
\begin{equation*}
D \mapsto D\otimes k_v
\end{equation*}
in fact we get an injection%
\begin{equation*}
\operatorname{Br}(k) \hookrightarrow \prod_v \operatorname{Br}(k_v) \simeq \prod_{v\text{ nonarch}} \QQ/\ZZ \times \prod_{v\text{ real}} \ZZ/2\ZZ
\end{equation*}
%
\begin{equation*}
D\mapsto (\operatorname{inv}_v(D))_v
\end{equation*}
these \(\operatorname{inv}_v(D)\) are called the \terminology{local invariants}.%
\end{fact}
\begin{proposition}{}{}{prop-elem-av-local-invs}%
\hypertarget{p-425}{}%
Let \(A/\FF_q\) be an elementary \hyperref[def-buntes-abvar]{abelian variety}. Let \(K = \QQ(\pi_A)\) then%
\begin{equation*}
\operatorname{inv}_v(\End^0(A)) = \begin{cases} \frac{v(\pi_A)}{v(q)} [k_v: \QQ_p], \amp v|p\\ \frac 12,\amp v\text{ real}\\ 0, \amp \text{else}\end{cases}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-72}{}
\hypertarget{p-426}{}%
Edixhoven-van der Geer-Moonen 16.30.%
\end{proof}
\begin{proposition}{}{}{proposition-37}%
\hypertarget{p-427}{}%
Let \(d= \lb \End^0(A) : \QQ(\pi_A) \rb^{1/2}\) then \(d\) is the least common denominator of all the \(\operatorname{inv}_v(\End^0(A))\).%
\end{proposition}
\begin{corollary}{}{}{corollary-29}%
\hypertarget{p-428}{}%
%
\begin{equation*}
\pi_A\sim \pi_B \iff f_A = f_B\text{.}
\end{equation*}
%
\end{corollary}
\begin{proof}\hypertarget{proof-73}{}
\hypertarget{p-429}{}%
\(\Leftarrow\) done.%
\par
\hypertarget{p-430}{}%
\(\Rightarrow\) Let \(D_{\pi_A} , D_{\pi_B}\) be the division rings with invariants specified as in \hyperref[prop-elem-av-local-invs]{Proposition~\ref{prop-elem-av-local-invs}}. \(\pi_A\sim \pi_B \implies D_{\pi_A} \simeq D_{\pi_B} \implies f_A = \operatorname{minpoly}(\pi_A) ^d = f_B\).%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.14.3 Surjectivity and CM theory}
\typeout{************************************************}
%
\begin{subsectionptx}{Surjectivity and CM theory}{}{Surjectivity and CM theory}{}{}\label{subsection-38}
\hypertarget{p-431}{}%
We need to show that for \(\pi\) a \(q\)-\hyperref[sec-honda-tate]{Weil number} there exists an \hyperref[def-buntes-abvar]{abelian variety} \(A/\FF_q\) such that \(\pi_A \sim \pi\).%
\begin{definition}{}{definition-42}%
\hypertarget{p-432}{}%
Such a \(q\)-\hyperref[sec-honda-tate]{Weil number} \(\pi\) is called effective.%
\end{definition}
\begin{proposition}{}{}{proposition-38}%
\hypertarget{p-433}{}%
A \(q\)-\hyperref[sec-honda-tate]{Weil number} \(\pi\) is effective if and only if \(\pi^N\) is effective for some \(N\in \ZZ_{\ge 1}\).%
\end{proposition}
\begin{proof}\hypertarget{proof-74}{}
\hypertarget{p-434}{}%
\(\Rightarrow\) clear.%
\par
\hypertarget{p-435}{}%
\(\Leftarrow\) By assumption we have \(A'/k\) a \hyperref[def-simple-av]{simple} \hyperref[def-buntes-abvar]{abelian variety} s.t. \(\pi_{A'} \sim  \pi^N\) for \(k\) a degree \(N\) extension of \(\FF_q\). Let%
\begin{equation*}
A = \Res_{k/\FF_q}(A')
\end{equation*}
on the rational Tate modules we have%
\begin{equation*}
V_l A = \Ind_{G_k}^{G_{\FF_q}} (V_lA')
\end{equation*}
where%
\begin{equation*}
G_k = \Gal{\overline{\FF_q}}{k}
\end{equation*}
%
\begin{equation*}
G_{\FF_q} = \Gal{\overline{\FF_q}}{\FF_q}
\end{equation*}
since \(G_k\), \(G_{\FF_q}\) are abelian, by studying the induced action, one can see%
\begin{equation*}
\Ind_{G_k}^{G_{\FF_q}} (\pi_{A'}) = \pi_A^N
\end{equation*}
in particular \(f_A(T) = f_{A'}(T^N)\). Choosing a \hyperref[def-simple-av]{simple} factor \(A_i\) one gets \(\pi_{A_i} \sim \pi\).%
\end{proof}
\hypertarget{p-436}{}%
So it is sufficient to show \(\pi^N\) is effective.%
\par
\hypertarget{p-437}{}%
Strategy for proving surjectivity\leavevmode%
\begin{enumerate}
\item\hypertarget{li-87}{}Construct a division algebra \(D_\pi\).%
\item\hypertarget{li-88}{}Choose a CM field \(L\) splitting \(D_\pi\).%
\item\hypertarget{li-89}{}Find an \hyperref[def-buntes-abvar]{abelian variety} \(A/\CC\) of type \((L, \Phi)\).%
\item\hypertarget{li-90}{}In fact \(A\) is defined over  a number field \(K\) and has good reduction at \(v|p\).%
\item\hypertarget{li-91}{}Apply the Shimura-Taniyama formula to relate \(\pi_A\) to \(\Phi\).%
\item\hypertarget{li-92}{}Choose \(\Phi\) wisely (in retrospect in 3) to relate \(\pi\) to \(\pi_A\).%
\item\hypertarget{li-93}{}Show \(\pi_A^N = \pi^{N'}\).%
\end{enumerate}
%
\par
\hypertarget{p-438}{}%
\(D_\pi\) is given by the invariants described by \(\pi\) (and \(K = \QQ(\pi)\)).%
\begin{proposition}{}{}{proposition-39}%
\hypertarget{p-439}{}%
There exists a CM field \(L/\QQ(\pi)\) such that \(L\) splits \(D_\pi\) and further%
\begin{equation*}
[L:\QQ(\pi) ] = [ D_\pi: \QQ(\pi)]^{1/2}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-75}{}
\hypertarget{p-440}{}%
Two cases:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-94}{}\(\QQ(\pi)\) is totally real, in which case \(\QQ(\pi) = \QQ\) or \(\QQ(\sqrt{p})\).%
\item\hypertarget{li-95}{}\(\QQ(\pi)\) is a CM field with totally real subfield \(\QQ(\pi + q/\pi)\).%
\end{enumerate}
In the case\leavevmode%
\begin{enumerate}
\item\hypertarget{li-96}{}Choose \(L = \QQ(\pi)(\sqrt{-p})\).%
\item\hypertarget{li-97}{}Let \(d= \lb D_\pi: \QQ(\pi)\rb^{1/2}\). This \(L\) splits \(D_\pi\).%
\end{enumerate}
%
\end{proof}
\begin{definition}{CM types.}{def-cm-type}%
\hypertarget{p-441}{}%
For a CM field \(L\) all the embeddings%
\begin{equation*}
\iota\colon L \hookrightarrow \CC
\end{equation*}
come in complex conjugate pairs, choosing an embedding for each pair defines a subset \(\Phi\subseteq \Hom(L, \CC)\) such that%
\begin{equation*}
\Phi \cup \overline \Phi = \Hom(L,\CC)
\end{equation*}
%
\begin{equation*}
\Phi \cap \overline \Phi = \emptyset
\end{equation*}
such a choice of \(\Phi \) is called a \terminology{CM type}.%
\end{definition}
\hypertarget{p-442}{}%
Let \(A/\CC\) be an \hyperref[def-buntes-abvar]{abelian variety} with CM by \(L\) i.e.%
\begin{equation*}
L\hookrightarrow \End^0(A)
\end{equation*}
then%
\begin{equation*}
\CC\otimes L = \prod_\iota \CC
\end{equation*}
acts on the tangent space at the origin \(\Lie(A)\).%
\begin{proposition}{}{}{proposition-40}%
\hypertarget{p-443}{}%
The action of \(\CC\otimes L\) factors through the quotient \(\prod_{\iota\in \Phi} \CC\) for some \hyperref[def-cm-type]{CM type} \(\Phi\). We then say \(A/\CC\) is of type \((L,\Phi)\).%
\end{proposition}
\begin{theorem}{}{}{theorem-36}%
\hypertarget{p-444}{}%
For any \hyperref[def-cm-type]{CM type} \((L,\Phi)\) there exists an \hyperref[def-buntes-abvar]{abelian variety} \(A/\CC\) of type \((L, \Phi)\).%
\end{theorem}
\begin{proof}\hypertarget{proof-76}{}
\hypertarget{p-445}{}%
Found in Shimura-Taniyama.%
\end{proof}
\hypertarget{p-446}{}%
The fact that \(A\) is in fact defined over  a number field \(K\) is also in Shimura-Taniyama.%
\begin{theorem}{}{}{theorem-37}%
\hypertarget{p-447}{}%
Let \(A/K\) be an \hyperref[def-buntes-abvar]{abelian variety} which admits CM. Then \(A/K\) admits potentially good reduction at all places \(v\) of \(K\).%
\end{theorem}
\begin{proof}\hypertarget{proof-77}{}
\hypertarget{p-448}{}%
Highly nontrivial, Neron models, Chevalley decomposition, Neron-Ogg-Shafarevich criterion, result of Grothendieck on potentially stable reduction.%
\end{proof}
\hypertarget{p-449}{}%
After passing to a finite extension we will assume \(A/K\) has good reduction at places \(v|p\). So we have a reduction \(A_{\FF_{q'}}/\FF_{q'}\). For a place \(w|p\) of \(L\) let%
\begin{equation*}
\Sigma_w = \Hom(L_w, \CC_p)
\end{equation*}
%
\begin{equation*}
\Phi_w = \Phi \cap \Sigma_w\text{.}
\end{equation*}
%
\begin{theorem}{Shimura-Taniyama formula.}{}{theorem-38}%
\hypertarget{p-450}{}%
For all places \(w|p\) of \(L\),%
\begin{equation*}
\frac{w(\pi_{A_{\FF_{q'}}})}{w(q')} = \frac{\#\Phi_w}{\#\Sigma_w}
\end{equation*}
%
\end{theorem}
\begin{proof}\hypertarget{proof-78}{}
\hypertarget{p-451}{}%
Tate has a proof using CM theory of \(p\)-divisible groups.%
\end{proof}
\hypertarget{p-452}{}%
Recall we fixed \(\pi\) and from this we deterministically formed \(\QQ(\pi), D_{\pi}, L\) however we have no restriction on our choice of \(\Phi\).%
\begin{lemma}{}{}{lemma-11}%
\hypertarget{p-453}{}%
We can choose \(\Phi\) such that for all places \(w|p\) of \(L\),%
\begin{equation*}
\frac{w(\pi)}{w(q)} = \frac{\#\Phi_w}{\#\Sigma_w}
\end{equation*}
%
\end{lemma}
\begin{proof}\hypertarget{proof-79}{}
\hypertarget{p-454}{}%
Let \(v = w|_{\QQ(\pi)}\) be the place of \(\QQ(\pi)\) below \(w\). Let%
\begin{equation*}
n_w = \frac{w(\pi)}{w(q)}\#\Sigma_w = \frac{w(\pi)}{w(q)}[L_w :\QQ_p]
\end{equation*}
%
\begin{equation*}
= \frac{w(\pi)}{w(q)}[L_w :\QQ(\pi)_v ][ \QQ(\pi)_v:\QQ_p]
\end{equation*}
by recalling the formula for the \hyperref[def-brauer-gp]{local invariants} of \(D_\pi\) we get%
\begin{equation*}
n_w = \operatorname{inv}_w(D_\pi\otimes_{\QQ(\pi)} L)\text{.}
\end{equation*}
But \(L\) splits \(D_\pi\) so \(n_w \in \ZZ\), further%
\begin{equation*}
n_w + n_{\overline w} = \left( \frac{w(\pi)}{w(q)}  + \frac{\overline w(\pi)}{\overline w(q)} \right) \#\Sigma_w
\end{equation*}
%
\begin{equation*}
= \left( \frac{w(\pi\overline \pi)}{w(q)} \right) \#\Sigma_w = \#\Sigma_w
\end{equation*}
check the \hyperref[def-cm-type]{CM type} \(\Phi = \bigcup_w \Phi_w\) where for each \(w\) \(\# \Phi_w = n_w\). Then the formula follows.%
\end{proof}
\hypertarget{p-455}{}%
Combining the previous result with the Shimura-Taniyama formula we get that for all places \(w|p\)%
\begin{equation*}
\frac{w(\pi_{A_{\FF_{q'}}})}{w(q')} = \frac{w(\pi)}{w(q)}\text{.}
\end{equation*}
Taking the correct power,%
\begin{equation*}
w\left( \frac {\pi^m_{A_{\FF_{q'}}}}{\pi^{m'}}\right) = 0 \forall w|p
\end{equation*}
%
\begin{equation*}
\pi,\pi_{A_{\FF_{q'}}}|q^{m'}
\end{equation*}
%
\begin{equation*}
\implies w(\cdots) = 0 \forall w \nmid p
\end{equation*}
since \(|\pi^{m'}|_w = |\pi_{A_{\FF_{q'}}}^m|_w = (q^{m'})^{1/2} \forall \text{ infinite places}\)%
\begin{equation*}
\pi_{A_{\FF_{q'}}}/ \pi_A^{m'}
\end{equation*}
is a root of unity \(\pi^N_{A_{\FF_{q'}}} = \pi^{N'}\).%
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 2 Dessins d'Enfants}
\typeout{************************************************}
%
\begin{chapterptx}{Dessins d'Enfants}{}{Dessins d'Enfants}{}{}\label{chapter-dessins}
\begin{introduction}{}%
\hypertarget{p-456}{}%
These are notes for BUNTES Spring 2018, the topic is \hyperref[def-dessin-denfant]{Dessins} d'Enfants, they were last updated October 21, 2018. For more details see \href{http://math.bu.edu/people/angusmca/buntes/spring2018.html}{the webpage}. These notes are by Alex, feel free to email me at \href{mailto:alex.j.best@gmail.com}{\nolinkurl{alex.j.best@gmail.com}} to report typos/suggest improvements, I'll be forever grateful.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 2.1 Overview (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Overview (Angus)}{}{Overview (Angus)}{}{}\label{sec-dessins-overview}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.1 Belyi morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Belyi morphisms}{}{Belyi morphisms}{}{}\label{subsection-39}
\hypertarget{p-457}{}%
Let \(X\) be an algebraic curve over \(\CC\) (i.e. a compact \hyperref[def-top-riem-surface]{Riemann surface}) when is \(X\) defined over \(\overline \QQ\)?%
\begin{theorem}{Belyi.}{}{theorem-39}%
\hypertarget{p-458}{}%
An algebraic curve \(X/\CC\) is defined over \(\overline \QQ \iff\) there exists a morphism \(\beta \colon X \to \PP^1 \CC\) \hyperref[def-dess-ramified]{ramified} only over \(\{0,1,\infty\}\).%
\end{theorem}
\begin{definition}{Ramified.}{def-dess-ramified}%
\hypertarget{p-459}{}%
(AG) A morphism \(f \colon X \to Y\) is \terminology{ramified} at \(x \in X\) if on local rings the induced map \(f^\# \colon \sheaf O_{Y,f(x)} \to \sheaf O_{X,x}\) descended to%
\begin{equation*}
\sheaf O_{Y,f(x)}/\ideal m \to \sheaf O_{X,x}/ f^\#(\ideal m)
\end{equation*}
is not a finite inseparable field extension.%
\par
\hypertarget{p-460}{}%
(RS) A morphism \(f \colon X \to Y\) is \hyperref[def-dess-ramified]{ramified} at \(x \in X\) if there are charts around \(x\) and \(f(x)\) such that \(f(x) = x^n\). This \(n\) is the \terminology{ramification index}.%
\end{definition}
\begin{definition}{Belyi morphisms.}{def-belyi-morphism}%
\hypertarget{p-461}{}%
A \terminology{Belyi morphism} is one \hyperref[def-dess-ramified]{ramified} only over \(\{0,1,\infty\}\)%
\par
\hypertarget{p-462}{}%
A \terminology{clean \hyperref[def-belyi-morphism]{Belyi morphism}} or \terminology{pure \hyperref[def-belyi-morphism]{Belyi morphism}} is a \hyperref[def-belyi-morphism]{Belyi morphism} where the \hyperref[def-dess-ramified]{ramification indices} over 1 are all exactly 2.%
\end{definition}
\begin{lemma}{}{}{lemma-12}%
\hypertarget{p-463}{}%
A curve \(X\) admits a \hyperref[def-belyi-morphism]{Belyi morphism} iff it admits a \hyperref[def-belyi-morphism]{clean Belyi morphism}.%
\end{lemma}
\begin{proof}\hypertarget{proof-80}{}
\hypertarget{p-464}{}%
If \(\alpha \colon X\to \PP^1 \CC\) is Belyi, then \(\beta = 4\alpha(1-\alpha)\) is a \hyperref[def-belyi-morphism]{clean Belyi morphism}.%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.2 Dessin d'Enfants}
\typeout{************************************************}
%
\begin{subsectionptx}{Dessin d'Enfants}{}{Dessin d'Enfants}{}{}\label{subsection-40}
\begin{definition}{}{def-dessin-denfant}%
\hypertarget{p-465}{}%
A \terminology{dessin d'Enfant} (or Grothendieck \hyperref[def-dessin-denfant]{Dessin} or just \terminology{Dessin}) is a triple \((X_0,X_1,X_2)\) where \(X_2\) is a compact \hyperref[def-top-riem-surface]{Riemann surface}, \(X_1\) is a graph, \(X_0 \subset X_1\) is a finite set of points, where \(X_2 \smallsetminus X_1\) is a collection of open cells. \(X_1 \smallsetminus X_0\) is a disjoint union of line segments%
\end{definition}
\begin{lemma}{}{}{lemma-13}%
\hypertarget{p-466}{}%
The data of a \hyperref[def-dessin-denfant]{dessin} is equivalent to a graph with an ordering on the edges coming out of each vertex.%
\end{lemma}
\begin{definition}{Clean dessins.}{def-clean-dessin}%
\hypertarget{p-467}{}%
A \terminology{clean \hyperref[def-dessin-denfant]{dessin}} is a \hyperref[def-dessin-denfant]{dessin} with a colouring (white and black) on the vertices such that adjacent vertices do not share a colour.%
\end{definition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.3 The Grothendieck correspondence}
\typeout{************************************************}
%
\begin{subsectionptx}{The Grothendieck correspondence}{}{The Grothendieck correspondence}{}{}\label{subsection-41}
\hypertarget{p-468}{}%
Given a \hyperref[def-belyi-morphism]{Belyi morphism} \(\beta\colon X \to \PP^1 \CC\) the graph \(\beta^{-1}(\lb 0,1\rb)\) defines a \hyperref[def-dessin-denfant]{dessin}.%
\begin{theorem}{}{}{theorem-40}%
\hypertarget{p-469}{}%
The map%
\begin{equation*}
\{\text{(Clean) Belyi morphisms}\} \to \{\text{(clean) dessins}\}
\end{equation*}
%
\begin{equation*}
\beta \mapsto \beta\inv([0,1])
\end{equation*}
is a bijection up to isomorphisms.%
\end{theorem}
\begin{example}{}{example-15}%
\hypertarget{p-470}{}%
%
\begin{equation*}
\PP^1 \CC\to \PP^1\CC
\end{equation*}
%
\begin{equation*}
x\mapsto x^3
\end{equation*}
%
\par
\hypertarget{p-471}{}%
%
\begin{equation*}
\PP^1 \CC\to \PP^1\CC
\end{equation*}
%
\begin{equation*}
x\mapsto x^3 + 1
\end{equation*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.4 Covering spaces and Galois groups}
\typeout{************************************************}
%
\begin{subsectionptx}{Covering spaces and Galois groups}{}{Covering spaces and Galois groups}{}{}\label{subsection-42}
\hypertarget{p-472}{}%
A \hyperref[def-belyi-morphism]{Belyi morphism} defines a covering map.%
\begin{equation*}
\tilde \beta\colon \tilde X \to \PP^1 \CC\smallsetminus \{0,1,\infty\}
\end{equation*}
the coverings are controlled by the profinite completion of%
\begin{equation*}
\pi_1 (\PP^1 \CC\smallsetminus \{0,1,\infty\}) = \ZZ * \ZZ = F_2\text{.}
\end{equation*}
%
\begin{theorem}{}{}{theorem-41}%
\hypertarget{p-473}{}%
There is a faithful action%
\begin{equation*}
\absgal\QQ \acts \hat\pi_1 (\PP^1 \CC\smallsetminus \{0,1,\infty\})
\end{equation*}
%
\end{theorem}
\begin{proof}\hypertarget{proof-81}{}
\hypertarget{p-474}{}%
By Belyi's theorem every \hyperref[def-supersing-isog-ec]{elliptic curve} \(E/\overline \QQ\) admits a \hyperref[def-belyi-morphism]{Belyi morphism}. For each \(j \in \overline\QQ\) there exists an \hyperref[def-supersing-isog-ec]{elliptic curve} \(E_j/\overline \QQ\) with \(j\)-invariant \(j\).%
\par
\hypertarget{p-475}{}%
Given \(\sigma \in \absgal{\QQ}\),%
\begin{equation*}
\sigma(E_j) = E(\sigma(j))
\end{equation*}
assume \(\sigma \mapsto 1\),%
\begin{equation*}
E_j \cong E_{\sigma(j)}\ \forall j
\end{equation*}
%
\begin{equation*}
j = \sigma(j) \ \forall j
\end{equation*}
a contradiction.%
\end{proof}
\begin{corollary}{}{}{corollary-30}%
\hypertarget{p-476}{}%
We have a faithful action of \(\absgal{\QQ}\) on \hyperref[def-dessin-denfant]{dessins}.%
\end{corollary}
\begin{theorem}{}{}{theorem-42}%
\hypertarget{p-477}{}%
We have a faithful action of \(\absgal{\QQ}\) on the set of \hyperref[def-dessin-denfant]{dessins} of any fixed \hyperref[def-class-set]{genus}.%
\end{theorem}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.5 Exercises}
\typeout{************************************************}
%
\begin{subsectionptx}{Exercises}{}{Exercises}{}{}\label{subsection-43}
\begin{inlineexercise}{}{exercise-4}%
\hypertarget{p-478}{}%
Compute the \hyperref[def-dessin-denfant]{Dessins} for the following \hyperref[def-belyi-morphism]{Belyi morphisms}\leavevmode%
\begin{enumerate}
\item\hypertarget{li-98}{}%
\begin{equation*}
\PP^1\CC\to \PP^1\CC,\,x\mapsto x^4
\end{equation*}
%
\item\hypertarget{li-99}{}%
\begin{equation*}
\PP^1\CC\to \PP^1\CC,\,x\mapsto x^2(3-2x)
\end{equation*}
%
\item\hypertarget{li-100}{}%
\begin{equation*}
\PP^1\CC\to \PP^1\CC,\,x\mapsto \frac{1}{x(2-x)}
\end{equation*}
%
\end{enumerate}
%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-5}%
\hypertarget{p-479}{}%
Give an alternate proof of the fact that \(X\) admits a \hyperref[def-belyi-morphism]{Belyi morphism} if and only if it admits a \hyperref[def-belyi-morphism]{clean Belyi morphism} using \hyperref[def-dessin-denfant]{dessins} and the Grothendieck correspondence.%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-6}%
\hypertarget{p-480}{}%
Prove that a \hyperref[def-belyi-morphism]{Belyi morphism} corresponding to a tree, that sends \(\infty\) to \(\infty\) is a polynomial.%
\end{inlineexercise}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.2 Riemann Surfaces I (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Riemann Surfaces I (Ricky)}{}{Riemann Surfaces I (Ricky)}{}{}\label{sec-dessins-riemann-surfaces}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.1 Definitions}
\typeout{************************************************}
%
\begin{subsectionptx}{Definitions}{}{Definitions}{}{}\label{subsection-44}
\begin{definition}{}{def-top-riem-surface}%
\hypertarget{p-481}{}%
A \terminology{topological surface} is a Hausdorff space \(X\) wich has a collection of charts%
\begin{equation*}
\{\phi_i \colon U_i \xrightarrow\sim \phi_i(U_i) \subseteq \CC,\,\text{open}\}_{i\in I}
\end{equation*}
such that%
\begin{equation*}
X= \bigcup_{i\in I} U_i\text{.}
\end{equation*}
We call \(X\) a \terminology{Riemann surface} if the transition functions \(\phi_i\circ \phi_j^{-1}\) are holomorphic.%
\end{definition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.2 Examples}
\typeout{************************************************}
%
\begin{subsectionptx}{Examples}{}{Examples}{}{}\label{subsection-45}
\begin{example}{}{example-16}%
\hypertarget{p-482}{}%
Open subsets of \(\CC\), e.g.%
\begin{equation*}
\CC
\end{equation*}
%
\begin{equation*}
\mathbf D = \{z\in \CC : |z| \lt 1 \}
\end{equation*}
%
\begin{equation*}
\HH = \{z\in \CC : \im z \gt 0 \}\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{example-17}%
\hypertarget{p-483}{}%
\(\hat \CC = \) Riemann sphere \(= \CC\cup \{\infty\}\). A basis of neighborhoods of \(\infty\) is given by%
\begin{equation*}
\{z\in \CC : |z| \gt R \} \cup \{\infty\}\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{example-18}%
\hypertarget{p-484}{}%
%
\begin{equation*}
\PP^1(\CC )= \{ [z_0 :z_1 ] : (z_0,z_1) \ne (0,0)\}
\end{equation*}
%
\begin{equation*}
U_0 =\{[z_0,z_1] : z_0 \ne 0\}\to \CC
\end{equation*}
%
\begin{equation*}
[z_0:z_1] \mapsto \frac{z_1}{z_0}
\end{equation*}
%
\begin{equation*}
U_1 =\{[z_0,z_1] : z_1 \ne 0\}\to \CC
\end{equation*}
%
\begin{equation*}
[z_0:z_1] \mapsto \frac{z_0}{z_1}\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{example-19}%
\hypertarget{p-485}{}%
Let \(\Lambda = \ZZ \oplus \ZZ i \subseteq \CC\) then \(X = \CC/\Lambda\) is a \hyperref[def-top-riem-surface]{Riemann surface}.%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.3 Morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Morphisms}{}{Morphisms}{}{}\label{subsection-46}
\begin{definition}{(Holo/Mero)-morphisms of Riemann surfaces.}{def-morph-riem-surf}%
\hypertarget{p-486}{}%
A \terminology{morphism of \hyperref[def-top-riem-surface]{Riemann surfaces}} is a continuous map%
\begin{equation*}
f\colon S\to S'
\end{equation*}
such that for all charts \(\phi, \psi\) on  \(S, S'\) respectively we have \(\psi \circ f \circ \phi\inv\) is holomorphic.%
\par
\hypertarget{p-487}{}%
We call a morphism \(f\colon S\to \CC\) a \terminology{holomorphic function} on \(S\).%
\par
\hypertarget{p-488}{}%
We say \(f \colon S \to \CC\) is a \terminology{meromorphic function} is \(f\circ \phi\inv\) is meromorphic.%
\end{definition}
\begin{inlineexercise}{}{exercise-7}%
\hypertarget{p-489}{}%
The set of \hyperref[def-morph-riem-surf]{meromorphic functions} on a \hyperref[def-top-riem-surface]{Riemann surface} form a field.%
\end{inlineexercise}
\hypertarget{p-490}{}%
We denote the field of \hyperref[def-morph-riem-surf]{meromorphic functions} by \(\mathcal M (S)\).%
\begin{proposition}{1.26.}{}{proposition-41}%
\hypertarget{p-491}{}%
%
\begin{equation*}
\mathcal M(\hat \CC) = \CC(z)\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-82}{}
\hypertarget{p-492}{}%
Let \(f\colon \hat\CC \to \CC\) be meromorphic. Then the number of poles of \(f\) is finite say at \(a_1, \ldots, a_n\). So, locally at  \(a_i\) we can write%
\begin{equation*}
f(z) = \sum_{j=1}^{j_i} \frac{\lambda_{j,i}}{(z-a_i)^j} + h_i(z)
\end{equation*}
with \(h_i\) holomorphic. Then%
\begin{equation*}
f(z) - \sum_{i=1}^n \sum_{j=1}^{j_i} \frac{\lambda_{j,i}}{(z-a_i)^j}
\end{equation*}
is holomorphic everywhere. By Liouville's theorem this is constant.%
\end{proof}
\hypertarget{p-493}{}%
We say \(S,S'\) are isomorphic if \(\exists f\colon S\to S'\), \(g\colon S'\to S\) morphisms such that \(f\circ g = \id_{S'}\), \(g\circ f = \id_{S}\).%
\begin{inlineexercise}{}{exercise-8}%
\hypertarget{p-494}{}%
Show that%
\begin{equation*}
\hat \CC \simeq \PP^1(\CC)\text{.}
\end{equation*}
%
\end{inlineexercise}
\begin{remark}{}{remark-9}%
\hypertarget{p-495}{}%
\(\CC \not\simeq \mathbf D\) by Liouville.%
\par
\hypertarget{p-496}{}%
If \(S, S'\) are connected compact \hyperref[def-top-riem-surface]{Riemann surfaces}, then any nonconstant morphism \(f\colon S \to S'\) is surjective. (Nonconstant holomorphic maps are open)%
\end{remark}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.4 Ramification}
\typeout{************************************************}
%
\begin{subsectionptx}{Ramification}{}{Ramification}{}{}\label{subsection-47}
\begin{definition}{Orders of vanishing.}{def-riem-order-vanish}%
\hypertarget{p-497}{}%
The \terminology{order of vanishing} at \(P\in S\) of a \hyperref[def-morph-riem-surf]{holomorphic function} on \(S\) is defined as follows: For \(\phi\) a  chart centered at \(P\) write%
\begin{equation*}
f\circ \phi\inv (z) = a_n z^n + a_{n+1}z^{n+1} + \cdots,\,a_n\ne 0
\end{equation*}
then \(\ord_P(f) = n\).%
\par
\hypertarget{p-498}{}%
More generally, for \(f\colon S \to S'\) we can define \(m_P(f)\) (\terminology{multiplicity} of \(f\) at \(P\)) by using a chart \(\psi\) on \(S'\) and setting%
\begin{equation*}
m_P(f) = \ord_P(\psi\circ f)\text{.}
\end{equation*}
%
\par
\hypertarget{p-499}{}%
If \(m_P(f)\ge 2\) then we call \(P\) a \terminology{branch point} of \(f\) and call \(f\) \hyperref[def-dess-ramified]{ramified} at \(P\).%
\end{definition}
\begin{example}{}{example-20}%
\hypertarget{p-500}{}%
%
\begin{equation*}
f\colon \CC \to \CC,\,f(z) = z^2\text{.}
\end{equation*}
The chart \(\phi_a(z) = z-a\) is centered at \(a \in \CC\). Then to compute \(m_a(f)\) we compute%
\begin{equation*}
f\circ \phi\inv_a(z) = a^2 + 2az + z^2
\end{equation*}
hence%
\begin{equation*}
\ord_a(f) =\begin{cases} 0,\amp \text{ if } a\ne 0\\ 2,\amp\text{ if } a= 0\end{cases}\text{.}
\end{equation*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.2.5 Genus}
\typeout{************************************************}
%
\begin{subsectionptx}{Genus}{}{Genus}{}{}\label{subsection-48}
\begin{theorem}{Rado.}{}{theorem-43}%
\hypertarget{p-501}{}%
Any orientable compact surface can be triangulated.%
\end{theorem}
\begin{fact}{}{}{fact-5}%
\hypertarget{p-502}{}%
Riemann surfaces are orientable.%
\end{fact}
\hypertarget{p-503}{}%
Given such an oriented polygon coming from a \hyperref[def-top-riem-surface]{Riemann surface}, we can associate a word \(w\) to it from travelling around the perimeter.%
\begin{example}{}{example-21}%
\hypertarget{p-504}{}%
For the sphere \(w = a\inv ab\inv bc\inv c\).%
\end{example}
\begin{fact}{}{}{fact-existance-genus}%
\hypertarget{p-505}{}%
Every such word can be normalised without changing the corresponding \hyperref[def-top-riem-surface]{Riemann surface}.%
\begin{equation*}
w = \begin{cases} w_0 = aa\inv,\\ w_g = a_1b_1 a_1\inv b_1\inv \cdots a_gb_g a_g\inv b_g\inv\end{cases}
\end{equation*}
The (uniquely determined) \(g\) is the \terminology{genus} of the surface.%
\end{fact}
\begin{example}{}{example-22}%
\hypertarget{p-506}{}%
\(w_1 = a_1b_1 a_1\inv b_1 \inv\).%
\par
\hypertarget{p-507}{}%
\(w_2 = a_1b_1 a_1\inv b_1a_2b_2 a_2\inv b_2 \inv\).%
\end{example}
\begin{theorem}{}{}{theorem-44}%
\hypertarget{p-508}{}%
%
\begin{equation*}
\chi (S) = v- e + f = 2-2g(S)\text{.}
\end{equation*}
%
\end{theorem}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.3 Riemann Hurwitz Formula (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{Riemann Hurwitz Formula (Sachi)}{}{Riemann Hurwitz Formula (Sachi)}{}{}\label{sec-riemann-hurwitz}
\begin{inlineexercise}{Unimportant.}{exercise-9}%
\hypertarget{p-509}{}%
The \hyperref[def-class-set]{genus} is invariant under changing triangulation.%
\end{inlineexercise}
\hypertarget{p-510}{}%
In particular there are at least two distinct ways of thinking about \hyperref[def-class-set]{genus} for \hyperref[def-top-riem-surface]{Riemann surfaces} \(R\)\leavevmode%
\begin{enumerate}
\item\hypertarget{li-101}{}%
\begin{equation*}
\chi(R) = V -E + F = 2-2g
\end{equation*}
%
\item\hypertarget{li-102}{}The dimension of the space of holomorphic differentials on \(R\).%
\end{enumerate}
%
\par
\hypertarget{p-511}{}%
Goal: given \(R\) calculate \hyperref[def-class-set]{genus}%
\begin{equation*}
y^2 = (x+1)(x-1)(x+2)(x-2)
\end{equation*}
so in an ad hoc way%
\begin{equation*}
y = \sqrt{(x+1)(x-1)(x+2)(x-2)}
\end{equation*}
when \(x\) is not a root of the above we have two distinct values for \(y\), we can imagine two copies of \(\CC\) sitting above each other and then square root will land in both copies. We have to make branch cuts between the roots and glue along these to account for the fact that going around a small loop surrounding a root will change the sign of our square root. We end up with something looking like a torus here.%
\par
\hypertarget{p-512}{}%
Here we examined the value where there were not enough preimages when we plugged in a value for \(x\). The idea is to project to \(x\), and understand the number of preimages.%
\begin{equation*}
P(x,y) = y^n + p_{n-1}(x) y^{n-1} + \cdots + p_0(x)
\end{equation*}
an  irreducible polynomial.%
\begin{equation*}
R= \{(x,y) : P(x,y) = 0\}\text{.}
\end{equation*}
If we fix \(x_0 \in \PP^1 \CC\) we can analyse how many \(y\) values lie over this \(x\). If we have fixed our coefficients we expect \(n\) solutions in \(y\) over \(\CC\), i.e. points \((x_0,y)\in R\).%
\par
\hypertarget{p-513}{}%
For some values of \(x_0\) this will not be true, there will be fewer \(y\)-values, this occurs when we have a multiple root. This happens precisely when the discriminant of this polynomial vanishes, the discriminant is a polynomial and so has finitely many roots.%
\begin{definition}{Branch points.}{def-branch-point}%
\hypertarget{p-514}{}%
Let \(\pi\colon R \to \PP^1 \CC\). We say \(x_0\) is a \terminology{branch point} if there are fewer than \(n\) distinct \(y\)-values above \(x\). Then define the \terminology{total branching index}%
\begin{equation*}
b = \sum_{x\in \PP^1 \CC} (\deg(\pi) - \# \pi\inv (x))\text{.}
\end{equation*}
%
\end{definition}
\begin{claim}{}{}{claim-euler-degree-total-branching}%
\hypertarget{p-515}{}%
%
\begin{equation*}
\chi(R) = \deg \pi \cdot \chi(\PP^1\CC)  - b\text{.}
\end{equation*}
%
\end{claim}
\begin{lemma}{}{}{lemma-14}%
\hypertarget{p-516}{}%
Locally given some choice of coordinates a non-constant \hyperref[def-morph-riem-surf]{morphism of Riemann surfaces}%
\begin{equation*}
f\colon R \to S
\end{equation*}
is given by \(w\mapsto w^n\). More precisely given \(r \in R\), \(f(r) = s\) and \(V_s \ni s\) a small neighbourhood choose an identification of%
\begin{equation*}
V_s \xrightarrow \Psi D
\end{equation*}
which sends \(s \mapsto 0\) and we can find an analytic identification%
\begin{equation*}
r\in R_r \xrightarrow \phi D
\end{equation*}
such that%
\begin{equation*}
f(U_r) \subseteq V_s\text{.}
\end{equation*}
%
\begin{equation*}
\xymatrix{U_r \ar[r]^f \ar[d]_\phi & V_s \ar[d]^\Psi \\ D \ar[r]_{w\mapsto w^m} & D}
\end{equation*}
%
\end{lemma}
\begin{proof}\hypertarget{proof-83}{}
\hypertarget{p-517}{}%
In Sachi's notes.%
\end{proof}
\begin{proof}\hypertarget{proof-84}{}
\hypertarget{p-518}{}%
Of \hyperref[claim-euler-degree-total-branching]{Claim~\ref{claim-euler-degree-total-branching}}.%
\par
\hypertarget{p-519}{}%
Triangulate \(R\) so that every face lies in some small coordinate neighborhood s.t.%
\begin{equation*}
\pi \colon R\to \PP^1 \CC
\end{equation*}
is given by \(w \mapsto w^m\), s.t. every edge, all \hyperref[def-branch-point]{branch points} are vertices. This ensures that each face edge and vertex has \(n  = \deg (\pi)\) preimages (except \hyperref[def-branch-point]{branch points}). Then accounting for \hyperref[def-branch-point]{branch points} we have \(\deg(\pi) -  \# \pi\inv (x_0)\) preimages.%
\end{proof}
\begin{example}{}{example-23}%
\hypertarget{p-520}{}%
\(P(x,y)\) plane curve, classically have%
\begin{equation*}
g = \frac{(d-1)(d-2)}{2}
\end{equation*}
\(\PP^2 = \{ \lb x:y:z \rb\}\) and \((\PP^2)^* = \lb a:b:c \rb\), lines in \(\PP^2\)%
\begin{equation*}
ax + by + cz = 0
\end{equation*}
and we have lines \(\leftrightarrow\) points. We have \(C^*\) the dual curve in \(\PP^2\) cut out by the tangent lines \(t_Q\) for \(Q \in C\). Claim \(\deg C^* = (d-1)d\).%
\par
\hypertarget{p-521}{}%
Want%
\begin{equation*}
R:\{P(x,y) = 0\} \xrightarrow\pi \PP^1\CC
\end{equation*}
compute \(b\). In other words, if we fix an arbitrary point \(Q\in C\) then there are \(d(d-1)\) lines through \(Q\) which are tangent to \(C\). Projecting to the \(x\)-coordinate \(\iff\) family of lines through a point at \(\infty\) \(\iff\) \(\ast\) line in \((\PP^2)^*\). We have a new question: How many points does this line intersect (up to \hyperref[def-riem-order-vanish]{multiplicity}). By bezout \(\iff  \deg C^*\).%
\par
\hypertarget{p-522}{}%
Proof (Matt emerton) Consider a point on \(C\) in \(\PP^2\) such that no tangent line to the curve at   \(\infty\) passes through it. Move this point to the origin. If we write%
\begin{equation*}
P(x,y) = f_d + f_{d-1} + \cdots + f_0
\end{equation*}
then%
\begin{equation*}
(f_d, f_{d-1}) = 1
\end{equation*}
suppose they share a linear factor:%
\begin{equation*}
0 = (f_d)_x x + (f_d)_y y + f_{d-1}\text{,}
\end{equation*}
then this defines a line through the origin. (Because this gives an equation of an asymptote, this is a contradiction).%
\begin{equation*}
f_d + f_{d-1} + \cdots + f_0 = 0
\end{equation*}
%
\begin{equation*}
d f_d + (d-1) f_{d-1} + \cdots + f_1 = 0
\end{equation*}
%
\begin{equation*}
\implies
\end{equation*}
%
\begin{equation*}
\begin{cases}  f_d + f_{d-1} + \cdots + f_0 = 0 \\ f_{d-1} + 2f_{d-2} + \cdots + (d-1) f_1 = 0\end{cases}\text{.}
\end{equation*}
Now these have \(d(d-1)\) common solutions. \(C^*\) has degree \(d(d-1)\) so \(b = d(d-1)\). Riemann-Hurwitz implies%
\begin{equation*}
\chi(R) = 2\deg \pi - d(d-1)
\end{equation*}
%
\begin{equation*}
\chi(R) = 2d - d(d-1)
\end{equation*}
so%
\begin{equation*}
g=  \frac{(d-1)(d-2)}{2}\text{.}
\end{equation*}
%
\end{example}
\begin{paragraphs}{A 3-fold equivalence of categories.}{paragraphs-8}%
\hypertarget{p-523}{}%
Amazing synthesis.\leavevmode%
\begin{enumerate}
\item\hypertarget{li-103}{}Analysis: Compact connected \hyperref[def-top-riem-surface]{riemann surfaces}.%
\item\hypertarget{li-104}{}Algebra: Field extensions \(K/\CC\) where \(K\) is finitely generated of transcendence degree 1 over \(\CC\).%
\item\hypertarget{li-105}{}Geometry: \hyperref[def-abelian-complete-var]{Complete} nonsingular irreducible algebraic curves in \(\PP^n\).%
\end{enumerate}
%
\par
\hypertarget{p-524}{}%
3) curve \(\to\) 2) field extension. Over \(C\) all rational functions \(\frac{P(x)}{Q(x)}\) \(\deg P= \deg Q\), \(P,Q \colon C\to \CC \cup \{\infty\}\).%
\par
\hypertarget{p-525}{}%
3) \(\to\) 1) take complex structure induced by \(\PP^n\).%
\par
\hypertarget{p-526}{}%
1) \(\to\) 2) associated field of \hyperref[def-morph-riem-surf]{meromorphic functions} on \(X\).%
\par
\hypertarget{p-527}{}%
1) \(\to\) 3) Any curve which is holomorphic has an embedding into \(\PP^n\) (Riemann-Roch).%
\par
\hypertarget{p-528}{}%
2) \(\to\) 1) \(K/\CC\) consider valuation rings \(R\) such that \(K\supseteq R\supseteq \CC\).%
\begin{example}{}{example-24}%
\hypertarget{p-529}{}%
\(g =0\), \(\PP^1 \CC\) \(\CC(t)\), \(\CC\cup \{\infty\}\).%
\end{example}
\begin{example}{}{example-25}%
\hypertarget{p-530}{}%
\(g =1\), \hyperref[def-supersing-isog-ec]{elliptic curves}, \(f(x,y,z)\) smooth plane cubic, \(f= 0\), \(\CC(\sqrt{f(x)}, x)\).%
\begin{equation*}
\CC/\Lambda \to \PP^2
\end{equation*}
%
\begin{equation*}
z\mapsto (z,\wp(z), \wp'(z))
\end{equation*}
%
\begin{equation*}
z\not\in \Lambda
\end{equation*}
backwards%
\begin{equation*}
(x,y) \mapsto \int_{(x_0, y_0)}^{(x,y)} \frac{\diff x}{y}
\end{equation*}
%
\end{example}
\end{paragraphs}%
\begin{paragraphs}{Riemann-Hurwitz (generally).}{paragraphs-9}%
\hypertarget{p-531}{}%
There's nothing that doesn't generalise about the previous proof.%
\begin{claim}{}{}{claim-riemann-hurwitz}%
\hypertarget{p-532}{}%
For \(\pi\colon R\to S\) a non-constant morphism of compact \hyperref[def-top-riem-surface]{Riemann surfaces}%
\begin{equation*}
\chi(R) = \deg \pi \cdot \chi(S)  - \sum_{x\in S} (\deg(\pi) - \#\pi\inv(x))\text{.}
\end{equation*}
%
\end{claim}
\begin{corollary}{}{}{corollary-31}%
\hypertarget{p-533}{}%
There are no non-constant morphisms from a sphere to a surface of \hyperref[def-class-set]{genus} \(\gt 0\).%
\end{corollary}
\begin{proof}\hypertarget{proof-85}{}
\hypertarget{p-534}{}%
%
\begin{equation*}
f\colon \PP^1 \CC \to S
\end{equation*}
%
\begin{equation*}
\chi(\PP^1 \CC) = \deg f \chi(S) - b
\end{equation*}
%
\begin{equation*}
2 = (+)\cdot (-) - b\text{.}\qedhere
\end{equation*}
%
\end{proof}
\begin{inlineexercise}{}{exercise-10}%
\hypertarget{p-535}{}%
%
\begin{equation*}
x^n  +y^ n + z^n = 0
\end{equation*}
is not solvable in non-constant polynomials for \(n \gt 2\).%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-11}%
\hypertarget{p-536}{}%
%
\begin{equation*}
E = \CC/ \ZZ + \ZZ i
\end{equation*}
multiplication by \(i\) rotates \(x \mapsto xi\) let \(x \sim xi\). If we mod out by \(\sim\) to get \(E/\sim\) this is still a \hyperref[def-top-riem-surface]{Riemann surface} and the quotient map%
\begin{equation*}
f \colon E \to E / \sim
\end{equation*}
is nice, compute the \hyperref[def-branch-point]{branch points}  of \hyperref[def-order-quaternion]{order} 4 and \hyperref[def-order-quaternion]{order} 2.%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-12}%
\hypertarget{p-537}{}%
\(X\) compact \hyperref[def-top-riem-surface]{Riemann surface} of \(g\ge 2\) then there are at most \(84(g-1)\) automorphisms of \(X\).%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-13}%
\hypertarget{p-538}{}%
Klein quartic%
\begin{equation*}
x^3 y + y^3 z + z^3 x = 0
\end{equation*}
has 168 automorphisms and is \hyperref[def-class-set]{genus} 3.%
\end{inlineexercise}
\end{paragraphs}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.4 Riemann Surfaces and Discrete Groups (Rod)}
\typeout{************************************************}
%
\begin{sectionptx}{Riemann Surfaces and Discrete Groups (Rod)}{}{Riemann Surfaces and Discrete Groups (Rod)}{}{}\label{sec-rs-discrete-groups}
\begin{introduction}{}%
\hypertarget{p-539}{}%
Welcome to BUGLES (Boston university geometry learning expository seminar), the reason it is called bugles is because bugles are hyperbolic, and today we will see a lot of hyperbolic objects.%
\par
\hypertarget{p-540}{}%
Plan\leavevmode%
\begin{enumerate}
\item\hypertarget{li-106}{}Uniformization%
\item\hypertarget{li-107}{}Fuchsian groups%
\item\hypertarget{li-108}{}Automorphisms of \hyperref[def-top-riem-surface]{Riemann surfaces}%
\end{enumerate}
%
\begin{proposition}{}{}{proposition-42}%
\hypertarget{p-541}{}%
%
\begin{equation*}
\Aut(\hat \CC) =  \{ z\mapsto \frac{az+b }{cz+d}\}
\end{equation*}
%
\begin{equation*}
\Aut(\CC) = \left\{z \mapsto za+b\right\}
\end{equation*}
%
\begin{equation*}
\Aut(\HH) = \{ z\mapsto \frac{az+b }{cz+d},a,b,c,d\in \RR \} = \PSL_2(\RR)
\end{equation*}
%
\end{proposition}
\begin{theorem}{}{}{theorem-45}%
\hypertarget{p-542}{}%
\(\Sigma\) has a universal cover \(\widetilde \Sigma\) with \(\pi_1 ( \Sigma) = 1\). \(\widetilde \Sigma \to \Sigma\) holomorphic. \(\Sigma  = \widetilde \Sigma /G\) for \(G = \pi_1(\Sigma)\). \(G\) acts freely and properly discontinuously.%
\end{theorem}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.4.1 Uniformization}
\typeout{************************************************}
%
\begin{subsectionptx}{Uniformization}{}{Uniformization}{}{}\label{subsection-49}
\begin{theorem}{}{}{theorem-46}%
\hypertarget{p-543}{}%
The only simply connected \hyperref[def-top-riem-surface]{Riemann surfaces} are \(\hat \CC\), \(\CC\), \(\HH\).%
\end{theorem}
\begin{theorem}{}{}{theorem-47}%
\hypertarget{p-544}{}%
\(\Sigma\) is a \hyperref[def-top-riem-surface]{Riemann surface} then%
\begin{align*}
g= 0 : \Sigma \amp\cong \hat \CC\\
g= 1 : \Sigma \amp\cong \CC/ \Lambda\\
g\ge2: \Sigma \amp\cong \HH/ K\text{.}
\end{align*}
%
\end{theorem}
\begin{proof}\hypertarget{proof-86}{}
\hypertarget{p-545}{}%
\(g = 0\) Uniformization.%
\par
\hypertarget{p-546}{}%
\(g \ge 1\) \(\hat \CC\) can't be a cover by Riemann-Hurwitz. \(g = 1\) \(\pi_1 (\Sigma) = \ZZ \oplus \ZZ\) abelian.%
\par
\hypertarget{p-547}{}%
Claim: no subgroup of \(\Aut (\HH) \) is isomorphic to \(\ZZ \oplus \ZZ\) acting freely and properly discontinuously. So \(\widetilde\Sigma = \hat \CC\) \(z\mapsto az+b\) free id \(a=1\) so \(z\mapsto z+\lambda_1\) \(z\mapsto z+\lambda_2\).%
\par
\hypertarget{p-548}{}%
\(g= 2\) \(\pi_1(\Sigma)\) is not abelian but \(z\mapsto z + \lambda_1\) is abelian!%
\begin{equation*}
\Sigma = \HH/K,\, K \subseteq \PSL_2(\RR)\text{.}\qedhere
\end{equation*}
%
\end{proof}
\begin{paragraphs}{Goal.}{paragraphs-10}%
\hypertarget{p-549}{}%
Understand \(\Sigma \) through \(\widetilde \Sigma\) and \(G\).%
\end{paragraphs}%
\begin{paragraphs}{Fuchsian groups.}{paragraphs-11}%
\hypertarget{p-550}{}%
\(g \ge 2\).%
\begin{equation*}
\Aut (\HH) = \PSL_2(\RR) = \operatorname{Isom}^+ ( \HH, \frac{|\diff z|^2}{\Im Z})
\end{equation*}
hyperbolic \(\HH, \mathbf D\) and \(\PSL_2(\RR)\) acts transitively on geodesics.%
\begin{definition}{Fuchsian groups.}{def-fuchsian-group}%
\hypertarget{p-551}{}%
A \terminology{Fuchsian group} is a discrete subgroup of \(\PSL_2(\RR)\).%
\end{definition}
\begin{remark}{}{remark-10}%
\hypertarget{p-552}{}%
(proof in book) Even if \(\Gamma\) doesn't act freely the quotient%
\begin{equation*}
\HH \to \HH/\Gamma
\end{equation*}
is still a covering map and \(\HH/\Gamma\) is a \hyperref[def-top-riem-surface]{Riemann surface}.%
\end{remark}
\end{paragraphs}%
\begin{paragraphs}{Reflections on \(\HH\).}{paragraphs-12}%
\hypertarget{p-553}{}%
Say \(\mu\) is a geodesic in \(\HH\), i.e. a horocycle.There is \(M \in \PSL_2(\RR)\) with \(M\mu\) the imaginary axis. Then \(R = -\bar z\) is the reflection  over the imaginary axis. Now \(R_\mu = M\inv\circ R \circ M\) is a reflection over \(\mu\).%
\begin{equation*}
R_\mu = \frac{a\bar z  + b}{ c\bar z + d}\not\in \PSL_2(\RR)
\end{equation*}
this is a a problem for us.%
\end{paragraphs}%
\begin{paragraphs}{Triangle groups.}{paragraphs-13}%
\hypertarget{p-554}{}%
Given \(n, m, l\in \ZZ \cup \{\infty\}\) then there is a hyperbolic triangle with angles \(\pi/n,\pi/m, \pi/l\) if%
\begin{equation*}
\frac 1n + \frac 1m + \frac 1l \lt 1\text{.}
\end{equation*}
With area \(\pi(1 -  \frac 1n - \frac 1m - \frac 1l)\).%
\par
\hypertarget{p-555}{}%
In the disk model we can start with a wedge of the disk and by adding a choice third geodesic with endpoints on the edge we can adjust the other angles to be what we like.So we can construct hyperbolic triangles with whatever angles we like. Then let \(R_1\) be the reflection over 1 edge, \(R_2\) , \(R_3\) similarly. By reflecting our original triangle \(T\) with these reflections we can tessellate the disk, colouring alternately the triangles obtained using an odd or even number of reflections.%
\par
\hypertarget{p-556}{}%
The only remaining problem is that \(R_i\)'s are not in \(\PSL_2(\RR)\). The solution is to define \(x_1 = R_3 \circ R_1\), \(x_2 = R_1 \circ R_2\), \(x_3 = R_2 \circ R_3\) which are all in \(\PSL_2(\RR)\) now. Now we need to take the union of two adjacent triangles before as a fundamental domain, some quadrilateral that still tessellates. So we have formed a \hyperref[def-fuchsian-group]{Fuchsian group} from our triangles.%
\par
\hypertarget{p-557}{}%
A presentation for this group is%
\begin{equation*}
\langle x_1, x_2, x_3 | x_1 ^n = x_2 ^ m = x_3 ^l = x_1x_2x_3 = 1\rangle
\end{equation*}
note \(n,m,l\) can still be \(\infty\).%
\begin{definition}{Triangle groups.}{def-triangle-groups}%
\hypertarget{p-558}{}%
Let \(\Gamma_{n,m,l}\) be the \terminology{triangle group} with signature \((1/n, 1/m, 1/l)\).%
\end{definition}
\begin{remark}{}{remark-11}%
\hypertarget{p-559}{}%
%
\begin{equation*}
\frac 1n + \frac 1m + \frac 1l = 1
\end{equation*}
%
\begin{equation*}
\frac 1n + \frac 1m + \frac 1l \gt 1
\end{equation*}
still work on \(\CC\) and \(\hat \CC\) respectively.%
\end{remark}
\begin{example}{\(\PSL_2(\ZZ)\).}{example-26}%
\hypertarget{p-560}{}%
Consider \(\Gamma_{2,3,\infty}\) angles \(\pi/2, \pi/3, 0\). We can draw such a triangle in the upper half plane with vertices \(i, e^{\pi i/3}, \infty\). So a fundamental domain will be the region obtained by reflecting through the imaginary axis, given by \(-\frac 12 \le \Re z \le \frac 12\), \(|z| \ge 1\). We have \(R_1 = \frac{1}{\bar z}, R_2 = -\bar z +1,R_3 = -\bar z\) so \(x_1 = \frac{-1}{z}, x_2 = \frac{1}{-z+1}, x_3 = z+1\). Then \(\Gamma_{2,3,\infty} \cong \PSL_2(\ZZ)\). Sometimes denoted \(\Gamma(1)\).%
\end{example}
\begin{observation}{}{observation-1}%
\hypertarget{p-561}{}%
If \(\Gamma_1 \lt \Gamma_2\) and \(T\) is a fundamental domain of \(\Gamma_2\) then if \(\gamma_1, \gamma_2, \ldots, \gamma_n \in \Gamma_2\) are representatives of \(\Gamma_1\backslash \Gamma_2\) then%
\begin{equation*}
\bigcup \gamma_i (T)
\end{equation*}
is a fundamental domain for \(\Gamma_1\).%
\end{observation}
\begin{example}{\(\Gamma(1)\).}{example-27}%
\hypertarget{p-562}{}%
%
\begin{equation*}
\Gamma(2) = \{\begin{pmatrix} a\amp b \\ c\amp d\end{pmatrix} = \id \pmod 2 \}
\end{equation*}
then%
\begin{equation*}
[\Gamma(1) : \Gamma(2)] = 6
\end{equation*}
representatives of \(\Gamma(2) \backslash \Gamma(1)\) are%
\begin{equation*}
x_1 = \id,\,x_2 = \frac{-1}{z-1}, x_3 = \frac{z-1}{z},\, x_4 = \frac{z-1}{z},\,x_5 = \frac{-z}{x-1},\,x_6 = \frac{-1}{z}\text{.}
\end{equation*}
Lets see what these do, for example if \(z= e^{i\theta}\)%
\begin{equation*}
\Re(x_2(z) = \frac{-1}{e^{i\theta} - 1} = \frac{-e^{i\theta} + 1}{2- 2\cos \theta}) = \frac{1-\cos \theta}{ 2- 2\cos \theta} \frac 12
\end{equation*}
if we plot this we see we get two copies of a 0,0,0 triangle so this corresponds to \(\Gamma_{\infty,\infty,\infty}\).%
\begin{equation*}
\langle x_1, x_2, x_3 | x_1x_2x_3 = 1\rangle = \langle x_1,x_2\rangle = \pi_1(\PP^1\smallsetminus\{0,1,\infty\})\text{.}
\end{equation*}
%
\end{example}
\begin{proposition}{}{}{proposition-43}%
\hypertarget{p-563}{}%
\(S_1 = \HH/ \Gamma_1\), \(S_2 = \HH/\Gamma_2\) then%
\begin{equation*}
S_1 \cong S_2 \iff \Gamma_1 = T\circ \Gamma_2 \circ T\inv,\,T\in \PSL_2(\RR)\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-87}{}
\hypertarget{p-564}{}%
\(\Leftarrow\) Define an \(\phi\colon S_1 \to S_2\) via \(\phi(\lb z\rb_1) = \lb T(z)\rb_2\).%
\par
\hypertarget{p-565}{}%
\(\Rightarrow\) Take a lift%
\begin{equation*}
\xymatrix{
\HH\ar[r]^{\tilde\phi}\ar[d] & \HH\ar[d] \\
\HH/\Gamma_1\ar[r]_\phi & \HH/\Gamma_2
}
\end{equation*}
then \(T= \tilde \phi\).%
\end{proof}
\begin{proposition}{}{}{proposition-44}%
\hypertarget{p-566}{}%
\(\Gamma\) a \hyperref[def-fuchsian-group]{Fuchsian group} acts freely%
\begin{equation*}
\Aut(\HH/\Gamma) = N(\Gamma)/\Gamma\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-88}{}
\hypertarget{p-567}{}%
Previous proposition, set \(\Gamma_1 = \Gamma_2\)%
\begin{equation*}
N(\Gamma) \to \Aut(\HH/\Gamma)
\end{equation*}
kernel is \(\Gamma\).%
\end{proof}
\begin{corollary}{}{}{corollary-32}%
\hypertarget{p-568}{}%
Let \(\Sigma\) be a \hyperref[def-top-riem-surface]{Riemann surface} with \(g \ge 2\) then%
\begin{equation*}
|\Aut(\Sigma)| \lt \infty\text{.}
\end{equation*}
%
\end{corollary}
\begin{proof}\hypertarget{proof-89}{}
\hypertarget{p-569}{}%
%
\begin{equation*}
\xymatrix{
\HH \ar[dr]^{\phi_1} \ar[d]_{\phi_2}\\
S =\HH/\Gamma \ar[r]_f & \HH/N(\Gamma) = S/\Aut(S)
}
\end{equation*}
since \(\phi_1,\phi_2\) are holomorphic then so is \(f\). So \(\deg f=  | N(\Gamma) /\Gamma|\) and \(\deg f  \lt \infty\).%
\end{proof}
\hypertarget{p-570}{}%
Say \(\Sigma\), \(g\ge 2\), \(G\subseteq \Aut(\Sigma)\). Let \(\bar g\) be the \hyperref[def-class-set]{genus} of \(\Sigma /G\)%
\begin{equation*}
2g - 2 = |G| (2\bar g - 2) + \sum_p (I(p) - 1) = |G|(2\bar g - 2 + \sum_{i=1}^n (1 - \frac{1}{|I(p_i)|}))
\end{equation*}
where \(I(p)\) is the stabiliser of \(p\) in \(G\) and \(\{p_i\}\) area maximal set of fixed points of \(G\) inequivalent under the action of \(G\).%
\begin{inlineexercise}{}{exercise-14}%
\hypertarget{p-571}{}%
\(\Sigma,\,g\ge 2\) then \(|\Aut(\Sigma)| \le 84(g-1)\). Hint: cases.%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-15}%
\hypertarget{p-572}{}%
Consider%
\begin{equation*}
1 \to \Gamma(n) \to \Gamma(1) \to \PSL_2(\ZZ/n\ZZ) \to 1
\end{equation*}
compute \hyperref[def-class-set]{genus} of \(\HH/\Gamma(n)\).%
\end{inlineexercise}
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.5 Riemann Surfaces and Discrete Groups II (Jim)}
\typeout{************************************************}
%
\begin{sectionptx}{Riemann Surfaces and Discrete Groups II (Jim)}{}{Riemann Surfaces and Discrete Groups II (Jim)}{}{}\label{sec-rs-discrete-groups-ii}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.1 Moduli space of compact Riemann surfaces with genus \(g\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Moduli space of compact Riemann surfaces with genus \(g\)}{}{Moduli space of compact Riemann surfaces with genus \(g\)}{}{}\label{subsection-50}
\hypertarget{p-573}{}%
\(g =0\). Uniformization tells us that up to isomorphisms all \hyperref[def-top-riem-surface]{Riemann surfaces} of \hyperref[def-class-set]{genus} \(0\) are \(\PP^1\) hence the moduli space \(\mathcal M _0  = \{\text{pt}\}\).%
\par
\hypertarget{p-574}{}%
\(g = 1\). Uniformization tells us that each \hyperref[def-top-riem-surface]{Riemann surface} of \hyperref[def-class-set]{genus} \(1\) is a torus and can be written as \(\CC/ \omega_1\ZZ+ \omega_2\ZZ \to \CC/(\ZZ \oplus \tau \ZZ)\), with \(\tau = \pm \omega_1/\omega_2\).%
\begin{proposition}{2.54.}{}{proposition-45}%
\hypertarget{p-575}{}%
%
\begin{equation*}
\mathcal M_1 \simeq \HH/ \PSL_2(\ZZ) \simeq \CC\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-90}{}
\hypertarget{p-576}{}%
Idea: Existence of%
\begin{equation*}
\CC/ \Lambda_{\tau_1} \xrightarrow{\sim} \CC/\Lambda_{\tau_2}
\end{equation*}
with \(\bar T (\lb 0 \rb) = \lb 0 \rb\) is equivalent to the existence of \(T \in \Aut(\CC)\) (choose \(T(z) = wz\)) such that \(w(\ZZ\oplus \tau_1 \ZZ) = \ZZ\oplus \tau_2\ZZ\). This in turn is equivalent to the existence of%
\begin{equation*}
A,A' \in \GL_2(\ZZ)
\end{equation*}
s.t. \(\det (A) = \det(A') = \pm 1\) so that%
\begin{equation*}
\begin{pmatrix} w\\ w\tau_1 \end{pmatrix} A \begin{pmatrix}1\\ \tau_2\end{pmatrix} = A' \begin{pmatrix} w \\ w\tau_1 \end{pmatrix}
\end{equation*}
%
\begin{equation*}
\implies \tau_q = A \psi_2 = \frac{a\tau_2 + b}{c\tau_2 + d}
\end{equation*}
and \(A \in \PSL_2(\RR)\). Implies \(A\in \PSL_2(\ZZ)\) as both \(\tau_1,\tau_2 \in \HH\). Conversely if%
\begin{equation*}
\tau_1 = \frac{a\tau_2 + b}{c\tau_2 + b}
\end{equation*}
isomorphism is induced by \(T(z) = (c\tau_2 + d) z\).%
\end{proof}
\hypertarget{p-577}{}%
\(g \gt 1\) \(\mathcal M_g\) is a complex variety of dimension \(3g-3\). Uniformization tells us that describing a \hyperref[def-top-riem-surface]{Riemann surface} amounts to specifying \(2g\) real \(2\times 2\) matrices \(\{\gamma_i\}_{i=1}^{2g}\) such that\leavevmode%
\begin{enumerate}
\item\hypertarget{li-109}{}\(\det(\gamma_i) = 1\) which implies that \(\gamma_i\) depends on 3 real parameters so we have a total of \(6g\).%
\item\hypertarget{li-110}{}\(\prod_{i=1}^g \lb \gamma_i, \gamma_{g+i}\rb = \begin{pmatrix} 1\amp 0 \\ 0\amp 1\end{pmatrix}\) 3 relations, so \(6g- 3\). Since for any \(\gamma \in \PSL_2(\RR)\) \(\Gamma = \langle \gamma_i \rangle\) and \(\gamma\Gamma \gamma\inv\) uniformize isomorphic \hyperref[def-top-riem-surface]{Riemann surfaces} implies \(6g-6\) real parameters, so \(3g-3\) complex parameters.%
\end{enumerate}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.2 Monodromy}
\typeout{************************************************}
%
\begin{subsectionptx}{Monodromy}{}{Monodromy}{}{}\label{subsection-51}
\hypertarget{p-578}{}%
Let \(f\colon S_1 \to S\) be a morphism of degree \(d\) \hyperref[def-dess-ramified]{ramified} over \(y_1,\ldots, y_n \in S\). For \(y\in S\smallsetminus \{y_1,\ldots, y_n\}\) we have a group homomorphism%
\begin{equation*}
M_f\colon \pi_1(S \smallsetminus \{y_1, \ldots, y_n\} )\to \operatorname{Bij} (f\inv (y))
\end{equation*}
%
\begin{equation*}
\gamma \mapsto M_f(\gamma) = \sigma_\gamma\inv\text{.}
\end{equation*}
\(\sigma_\gamma\) is defined as follows:%
\begin{equation*}
\gamma \in \pi_1(S\smallsetminus \{ y_1,\ldots, y_n\})
\end{equation*}
lifts to a path \(\widetilde \gamma\) from \(x\in f\inv(y)\) to another \(x' \in f\inv(y)\) set \(\sigma_\gamma(x) =x'\). If we number the points in \(f\inv (y)\) we may think of \(M_f(\pi_1)\subseteq \Sigma_d\), via some \(\phi\colon \{1,\ldots, d\}\to f\inv (y)\). \(\operatorname{Mon}(f)\) is the image of \(M_f(\pi_1)\) in \(\Sigma_d\).%
\begin{paragraphs}{Monodromy and Fuchsian groups.}{paragraphs-14}%
\hypertarget{p-579}{}%
Let%
\begin{equation*}
\pi \colon \HH/\Gamma_1 \to \HH/ \Gamma
\end{equation*}
be the \hyperref[def-fuchsian-group]{Fuchsian group} representation of the map%
\begin{equation*}
f\colon S_1 \to S\ni y\text{.}
\end{equation*}
Identifications \(y = \lb z_0 \rb_\Gamma\) for some \(z_0 \in \HH\).%
\begin{equation*}
\pi_1 (S\smallsetminus \{y_1,\ldots, y_n\}) \simeq \Gamma
\end{equation*}
%
\begin{equation*}
f\inv(y ) = \{ [\beta z_0]_{\Gamma_1}\}
\end{equation*}
where \(\beta\) runs along a set of representatives of \(\Gamma_1\backslash \Gamma\).%
\par
\hypertarget{p-580}{}%
%
\begin{equation*}
M_f \colon \Gamma \to \operatorname{Bij} (\Gamma_1\backslash \Gamma)
\end{equation*}
%
\begin{equation*}
\gamma \mapsto M_f(\gamma)
\end{equation*}
%
\begin{equation*}
\implies \gamma \sim \pi_1([z_0,\gamma(z_0)])
\end{equation*}
where \(\lb z_0, \gamma(z_0) \rb\) is a path in \(\HH\). Lift this loop to \(\HH/\Gamma_1\) is the path \(\pi_{\Gamma_1}(\beta \lb z_0, \gamma_0(z_0)\rb)\). which corresponds to \(\Gamma_1 \beta \gamma\), this implies \(\sigma_\gamma(\Gamma_1\beta)  = \Gamma_1 \beta\gamma\).%
\begin{corollary}{2.59.}{}{corollary-33}%
\hypertarget{p-581}{}%
%
\begin{equation*}
M_\pi \colon \Gamma \to \operatorname{Bij} (\Gamma_1 \backslash \Gamma)
\end{equation*}
induces an isomorphism%
\begin{equation*}
\frac{\Gamma}{\bigcap_{\beta\in \Gamma_1} \beta\inv \Gamma_1 \beta} \simeq \operatorname{Mon}(\pi)
\end{equation*}
%
\end{corollary}
\hypertarget{p-582}{}%
characterize morphisms by monodromy. Let \(f_i\) have degree 2, non conjugate.%
\begin{proposition}{2.63.}{}{proposition-46}%
\hypertarget{p-583}{}%
For \(S\) a compact \hyperref[def-top-riem-surface]{Riemann surface} and \(\beta = \{ a_1, \ldots, a_n\} \subset S\) for some \(d \ge 1\) there are only finitely many pairs \((\tilde S, f)\) where \(\tilde S\) is a compact \hyperref[def-top-riem-surface]{Riemann surface} and%
\begin{equation*}
f\colon \tilde S \to S
\end{equation*}
is a degree \(d\) morphism with branching  value set \(\beta\).%
\end{proposition}
\begin{proof}\hypertarget{proof-91}{}
\hypertarget{p-584}{}%
Special case: Assume \(S = \PP^1\) and \(n=3\).%
\begin{equation*}
\Gamma = \Gamma(2) = \{ A \in \PSL_2(\ZZ) : A = \id \pmod 2\}
\end{equation*}
%
\begin{equation*}
= \pi_1 (S' \smallsetminus \{0,1,\infty\})
\end{equation*}
is generated by \(\gamma_1, \gamma_2\) so any map \(M_f \colon \Gamma(2) \to \Sigma_d\) is determined by  images of \(\gamma_1, \gamma_2\).%
\end{proof}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.3 Galois coverings}
\typeout{************************************************}
%
\begin{subsectionptx}{Galois coverings}{}{Galois coverings}{}{}\label{subsection-52}
\begin{definition}{}{definition-54}%
\hypertarget{p-585}{}%
A covering \(f\colon S_1,\to S_2\) is Galois (or regular, or normal) if the covering group%
\begin{equation*}
\Aut(S,f) =  \{ h\in \Aut(S_1) : f\circ h= f\} = G
\end{equation*}
acts transitively on each fibre. With this notion we can think of \(S_1 \to S_1/G\).%
\end{definition}
\begin{proposition}{2.65.}{}{proposition-47}%
\hypertarget{p-586}{}%
%
\begin{equation*}
f\colon S_1 \to S_2
\end{equation*}
is Galois if and only if%
\begin{equation*}
f^* \colon M(S_2 ) \to M(S_1)
\end{equation*}
is a Galois extension. In this case \(\Aut(S_1, f)  \simeq \Gal{M(S_1)}{M(S_2)}\).%
\end{proposition}
\begin{example}{}{example-28}%
\hypertarget{p-587}{}%
Hyperelliptic covers of \(\PP^1\) given by%
\begin{equation*}
S = \{ y^2 = \prod_{i=1}^N (x- a_i)\} \to \PP^1
\end{equation*}
%
\begin{equation*}
(x,y) \to x
\end{equation*}
covering group \(G\) is \hyperref[def-order-quaternion]{order} 2 generated by the involution  \(J(x,y) = (x,-y)\).%
\end{example}
\begin{proposition}{2.66.}{}{proposition-48}%
\hypertarget{p-588}{}%
A covering%
\begin{equation*}
f\colon S_1 \to S_2
\end{equation*}
is normal/Galois  iff%
\begin{equation*}
\deg(f)  = |\operatorname{Mon}(f)|\text{.}
\end{equation*}
%
\end{proposition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.4 Normalization of coverings of \(\PP^1\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Normalization of coverings of \(\PP^1\)}{}{Normalization of coverings of \(\PP^1\)}{}{}\label{subsection-53}
\hypertarget{p-589}{}%
Let \(f\colon S \to \PP^1\) be a cover of \(\deg d \gt 0\) with \(\operatorname{Mon}(f) \le \Sigma_d\).%
\par
\hypertarget{p-590}{}%
The normalisation%
\begin{equation*}
\tilde f \colon \tilde S \to \PP^1
\end{equation*}
associated to \(f\) has \(\operatorname{Mon} (f) \cong \Aut( \tilde S, \tilde g\) and \(\tilde f ^* \colon M(\PP^1 ) \to M(\PP^1) \) is the normalisation of the extension%
\begin{equation*}
f^* \colon M(\PP^1 ) \hookrightarrow M(S)
\end{equation*}
%
\par
\hypertarget{p-591}{}%
Normalization of extensions \(K \hookrightarrow L\) is a Galois extension of \(K \) of lowest possible degree containing \(L\).%
\begin{definition}{}{definition-55}%
\hypertarget{p-592}{}%
Normalization of \(f\colon S\to \PP^1\) \(\deg d \gt 0 \) is a Galois covering \(\tilde f \colon \tilde S \to \PP^1 \) of  lowest possible degree s.t. \(\exists \pi \colon \tilde S \to S\) with  the diagram commuting.%
\end{definition}
\begin{corollary}{2.73.}{}{corollary-34}%
\hypertarget{p-593}{}%
%
\begin{equation*}
\operatorname{Mon}(f)  \simeq \Aut(\tilde S, \tilde f)
\end{equation*}
%
\end{corollary}
\hypertarget{p-594}{}%
Interpretation in terms of \hyperref[def-fuchsian-group]{Fuchsian groups}:%
\begin{proposition}{}{}{proposition-49}%
\hypertarget{p-595}{}%
Let \(f\colon S_1 \to S\) be a covering of \hyperref[def-top-riem-surface]{Riemann surfaces} \(S_1\smallsetminus f\inv \{ y_1, \ldots, y_n \} \to S \smallsetminus\{ y_1, \ldots, y_n \}\). The unramified cover and \(\pi \colon \HH/ \Gamma_1 \to \HH/ \Gamma\) the \hyperref[def-fuchsian-group]{Fuchsian group} representatives. The normalisation of \(f\) can be represented as the compactification of%
\begin{equation*}
\HH/ \bigcap_{\gamma \in \Gamma} \gamma \inv \Gamma_1 \gamma \to \HH/\Gamma_1 \to \HH/\Gamma
\end{equation*}
so the covering group is isomorphic to \(\Gamma/ \bigcap \gamma \inv \Gamma_1 \gamma \simeq \operatorname{Mon}(f)\).%
\end{proposition}
\begin{example}{}{example-29}%
\hypertarget{p-596}{}%
Let \(F(x,y) = y^2x - (y-1)^3\) consider%
\begin{equation*}
S_F \to \PP^1
\end{equation*}
%
\begin{equation*}
(x,y) \to x
\end{equation*}
\(S_F\) has \hyperref[def-class-set]{genus} 0. \(S_F \to \PP^1\) is of degree 3 and \hyperref[def-dess-ramified]{ramified} at most over \(0, \frac{-27}{4}, \infty\). \(\operatorname{Mon}(x)  \simeq \Sigma_3\) so not a normal covering. Normalization of \((S_F, x)\) is \(S_{\tilde F} , \tilde x)\) where%
\begin{equation*}
\tilde F (x,y) = y^2 ( 1-y)^2 x +  (1-y + y^2)
\end{equation*}
%
\end{example}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.6 Belyi's theorem (Maria)}
\typeout{************************************************}
%
\begin{sectionptx}{Belyi's theorem (Maria)}{}{Belyi's theorem (Maria)}{}{}\label{sec-belyi-thm}
\begin{introduction}{}%
\begin{theorem}{}{}{theorem-48}%
\hypertarget{p-597}{}%
Let \(S \) be a compact \hyperref[def-top-riem-surface]{riemann surface}, then the following are equivalent.\leavevmode%
\begin{enumerate}
\item\hypertarget{li-111}{}\(S\) is defined over \(\overline\QQ\) (iff over  a number field)%
\item\hypertarget{li-112}{}\(S\) admits a morphism \(f \colon S \to \PP^1\) with at most 3 branching values.%
\end{enumerate}
%
\end{theorem}
\begin{definition}{Belyi functions.}{def-belyi-function}%
\hypertarget{p-598}{}%
A \hyperref[def-morph-riem-surf]{meromorphic function} with less than 4 branching values is a \terminology{Belyi function}.%
\end{definition}
\begin{remark}{}{remark-12}%
\hypertarget{p-599}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-113}{}Branching values can be taken to be in \(\{0,1,\infty\}\).%
\item\hypertarget{li-114}{}If \(S \ne \PP^1\), then \(f \colon S \to \PP^1\) has at least 3 branching values%
\end{enumerate}
%
\end{remark}
\begin{definition}{Belyi polynomials.}{def-belyi-poly}%
\hypertarget{p-600}{}%
Let \(m,n \in \NN\), \(\lambda = m/(m+n)\), define%
\begin{equation*}
P_\lambda(x) = P_{m,n}(x) = \frac{(m+1)^{m+n}}{m^mn^n} x^m(1-x)^n
\end{equation*}
\terminology{Belyi polynomials}.%
\end{definition}
\begin{proposition}{}{}{proposition-50}%
\hypertarget{p-601}{}%
\(P_\lambda\) satisfies\leavevmode%
\begin{enumerate}
\item\hypertarget{li-115}{}\(P_\lambda\) ramifies at exactly \(0,1,\lambda, \infty\).%
\item\hypertarget{li-116}{}\(P_\lambda(0) = P_\lambda(1) = 0, P_\lambda(\lambda) = 1, P_\lambda(\infty) = \infty\).%
\end{enumerate}
%
\end{proposition}
\begin{example}{}{example-30}%
\hypertarget{p-602}{}%
%
\begin{equation*}
S_\lambda : y^2 = x(x-1)(x-\lambda)
\end{equation*}
with \(\lambda = m/(m+n)\). From ex. 1.32%
\begin{equation*}
x\colon S_\lambda \to \PP^1
\end{equation*}
%
\begin{equation*}
(x,y) \mapsto x
\end{equation*}
%
\begin{equation*}
\infty \mapsto \infty
\end{equation*}
ramifies over \(0,1,\lambda,\infty\). Then \(f = P_\lambda \circ x \colon S_\lambda \to \PP^1\) ramifies exactly at \((0,0), (1,0), (\lambda,0), \infty\). With branching values \(0,0,1,\infty\) so that \(f\) is a \hyperref[def-belyi-function]{Belyi function}.%
\end{example}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.1 Proof of a) implies b)}
\typeout{************************************************}
%
\begin{subsectionptx}{Proof of a) implies b)}{}{Proof of a) implies b)}{}{}\label{subsection-54}
\begin{note}{}{note-7}%
\hypertarget{p-603}{}%
Its enough to show \(\exists f\colon S\to \PP^1\) \hyperref[def-dess-ramified]{ramified} over \(\{0,1,\infty, \lambda_1, \ldots, \lambda_n\} \subseteq \QQ \cup \{\infty\}\). Given this we can repeatedly use \hyperref[def-belyi-poly]{Belyi polynomials} to obtain \(g\colon S \to \PP^1\) \hyperref[def-dess-ramified]{ramified} over \(\{0,1, \infty\}\).%
\end{note}
\hypertarget{p-604}{}%
Write \(S = S_F\)%
\begin{equation*}
F(x,y) = p_0(x)y^n + \cdots + p_n(x)
\end{equation*}
defined over \(\overline \QQ\lb x,y\rb\). Let \(B_0 =  \{\mu_1, \ldots, \mu_s\}\) be the branching values of \(x\colon S_F\to \PP^1\).%
\par
\hypertarget{p-605}{}%
Theorem 1.86 says that the each \(\mu_i\) is \(\infty\), a root of \(p_0(x)\) or a common root of \(F, F_y\) which implies by lemma 1.84 that \(B_0 \subseteq \overline \QQ \cup\{\infty\}\) . If \(B_0\subseteq \QQ\cup\{\infty\}\) we are done otherwise let \(m_1(T) \in \QQ\lb T \rb\) be the minimal polynomial of \(\{\mu_1, \ldots, \mu_s\}\). Let \(\{\beta_1, \ldots, \beta_d\}\) be the roots of \(m_1' (T) \) and \(p'(T)\) their min. poly. Note : \(\deg P(t) \lt \deg m'_1(T)\)%
\par
\hypertarget{p-606}{}%
Note: \(\operatorname{Branch}(g\circ f) = \operatorname{Branch}(g) \cup g(\operatorname{Branch}(f))\) branching values.%
\par
\hypertarget{p-607}{}%
So \(B_1 \operatorname{Branch}(m_1 \circ x) = m_1(\{\text{roots of }m_1'\}) \cup\{0,\infty\}\).%
\begin{equation*}
S\xrightarrow x \PP^1 \xrightarrow{m_1} \PP^1
\end{equation*}
If \(B_1 \subseteq \QQ \cup \{\infty\}\) done. Otherwise let \(m_2(T) \) be the minimal polynomial \(/\QQ\) of \(\{m_1(\beta_1) ,\ldots, m_1(\beta_d) \}\), \(B_2 = \operatorname{Branch}(m_2\circ m_2 \circ x)\). Fact: \(\deg(m(t)) \lt \deg(m_1(T))\).%
\par
\hypertarget{p-608}{}%
Repeat inductively until \(B_k \subseteq \QQ \cup \{\infty\}\) which is guaranteed by the decreasing degrees.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.2 Algebraic characterization of morphisms}
\typeout{************************************************}
%
\begin{subsectionptx}{Algebraic characterization of morphisms}{}{Algebraic characterization of morphisms}{}{}\label{subsection-55}
\begin{proposition}{}{}{proposition-51}%
\hypertarget{p-609}{}%
Defining a morphism \(f \colon S_F\to S_G\) is equivalent to giving a pair of rational functions%
\begin{equation*}
f=  (R_1, R_2),\,R_i= \frac{P_i}{Q_i},\,    P_i,Q_i\in \CC[x,y],\,Q_i\not\in (F)
\end{equation*}
such that \(Q_1^{\deg_x(G)}Q_2^{\deg_y(G)} G(R_1, R_2) = HF\) for some \(H \in \CC\lb x, y\rb\). \(f(R_1, R_2)\) is an isomorphism if there exists an inverse morphism \(h\colon S_G\to S_F\).%
\end{proposition}
\begin{remark}{}{remark-13}%
\hypertarget{p-610}{}%
%
\begin{equation*}
\xymatrix{
S_f \ar[r]^f \ar[dr]_m & S_G \ar[d]_h \\
& S_D
}
\end{equation*}
The fact that this diagram commutes can be expressed by polynomial identities.%
\end{remark}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.3 Galois action}
\typeout{************************************************}
%
\begin{subsectionptx}{Galois action}{}{Galois action}{}{}\label{subsection-56}
\hypertarget{p-611}{}%
Let \(\operatorname{Gal}(\CC) = \Gal{\CC}{\QQ}\).%
\begin{definition}{}{definition-58}%
\hypertarget{p-612}{}%
For \(\sigma \in \operatorname{Gal}(\CC)\), \(a\in \CC\) denote \(a^\sigma = \sigma(a)\),\leavevmode%
\begin{enumerate}
\item\hypertarget{li-117}{}If \(P = \sum a_{ij} x^iy^j \in \CC\lb x,y\rb\) set%
\begin{equation*}
P^\sigma = \sum a^\sigma_{ij} x^iy^j \in \CC\lb x,y\rb
\end{equation*}
if \(R = P/Q\) set \(R^\sigma = P^\sigma / Q^\sigma\).%
\item\hypertarget{li-118}{}If \(S \simeq S_F\), \(S^\sigma = S_{F^\sigma}\).%
\item\hypertarget{li-119}{}If \(\Psi = (R_1, R_2)\) \(S_F\to S_G\) is a morphism, set \(\Psi^ \sigma = (R_1^\sigma , R_2 ^\sigma) \colon S_{F^\sigma} \to S_{G^\sigma}\).%
\item\hypertarget{li-120}{}For an equivalence class \((S,f) = (S_F, R(x,y))\) of \hyperref[def-dess-ramified]{ramified} cvers of \(\PP^1\) set \((S,f)^\sigma = (S^\sigma, f^\sigma) = (S_{F^\sigma}, R^\sigma (x,y))\).%
\end{enumerate}
%
\end{definition}
\begin{inlineexercise}{}{exercise-16}%
\hypertarget{p-613}{}%
Verify this Galois action is well-defined (lemma 3.12).%
\end{inlineexercise}
\hypertarget{p-614}{}%
Recall: \(S_F\) is    constructed from a noncompact \hyperref[def-top-riem-surface]{Riemann surface} \(S_F^\times \subseteq \CC^2\) by adding finitely many points, (theorem 1.86). If \(P=  (a,b) \in S_F^\times\) then \(P^\sigma = (a^\sigma, b^\sigma)\). What about the other points?%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.4 Points and valuations}
\typeout{************************************************}
%
\begin{subsectionptx}{Points and valuations}{}{Points and valuations}{}{}\label{subsection-57}
\begin{definition}{}{definition-59}%
\hypertarget{p-615}{}%
Let \(\mathcal M\) be a function field. A (discrete) valuation of \(\mathcal M\) is \(v \colon \mathcal M^* \to \ZZ\) s.t.\leavevmode%
\begin{enumerate}
\item\hypertarget{li-121}{}\(v(\phi\psi) = v(\phi)  + v(\psi)\)%
\item\hypertarget{li-122}{}\(v(\phi\pm\psi) \ge \min\{ v(\phi)  , v(\psi)\}\)%
\item\hypertarget{li-123}{}\(v(\phi) = 0 \) if \(\phi \in \CC^*\)%
\item\hypertarget{li-124}{}\(v\) is nontrivial \(\exists \phi : v(\phi)\ne 0\)%
\end{enumerate}
set \(v(0) = \infty\).%
\end{definition}
\hypertarget{p-616}{}%
Facts:%
\begin{equation*}
A_v = \{\phi \in \mathcal M : v(\phi) \ge 0 \} \subseteq \mathcal M
\end{equation*}
is a subring that is a local ring with a maximal ideal%
\begin{equation*}
M_v = \{ \phi\in \mathcal M : v(\phi) \gt 0\} = (\phi)
\end{equation*}
for some \(\phi\) a uniformizer.%
\par
\hypertarget{p-617}{}%
If \(v(\phi) = 1\) \(v\) is normalised.%
\begin{proposition}{3.15.}{}{proposition-52}%
\hypertarget{p-618}{}%
Every point \(P \in S\) a compact \hyperref[def-top-riem-surface]{Riemann surface} defines a valuation on \(\mathcal M(S)\) by \(v_P(\phi) = \ord_P(\phi)\).%
\end{proposition}
\begin{proof}\hypertarget{proof-92}{}
\hypertarget{p-619}{}%
Easy exercise.%
\end{proof}
\begin{theorem}{3.23.}{}{theorem-49}%
\hypertarget{p-620}{}%
For any compact \hyperref[def-top-riem-surface]{Riemann surface} \(S\)%
\begin{equation*}
P\in S \mapsto v_P = \ord_P
\end{equation*}
gives a 1-1 correspondence between points of \(S\) and normalised valuations on \(\mathcal M(S)\).%
\end{theorem}
\begin{proof}\hypertarget{proof-93}{}
\hypertarget{p-621}{}%
Sketch: First prove it for \(S = \PP^1\).%
\par
\hypertarget{p-622}{}%
Inductively \hyperref[def-morph-riem-surf]{meromorphic functions} separate points.%
\par
\hypertarget{p-623}{}%
Surjectivity study behaviour of valuations in finite extensions of fields and use a nonconstant morphism \(f\colon S \to \PP^1\) to reduce to the case of \(\PP^1\).%
\end{proof}
\begin{paragraphs}{Galois action on points.}{paragraphs-15}%
\begin{definition}{}{definition-60}%
\hypertarget{p-624}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-125}{}Given a valuation \(v\) on \(\mathcal M(S)\) define a valuation \(v^\sigma\) on \(\mathcal M(S^\sigma)\) by \(v^\sigma = v\circ \sigma^{-1}\) i.e. \(v^\sigma(\psi^\sigma) = v(\psi)\) for all \(\psi \in \mathcal M(S)\).%
\item\hypertarget{li-126}{}For \(P \in S\) define \(P^\sigma \in S^\sigma\) as the unique point in \(S^\sigma\) s.t. \(v_{P^\sigma} = (v_P)^\sigma\).%
\end{enumerate}
%
\end{definition}
\begin{proposition}{3.25.}{}{proposition-53}%
\hypertarget{p-625}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-127}{}For \(\sigma\in \operatorname{Gal}(\CC)\), \(P\mapsto P^\sigma\) is a bijection \(S\to S^\sigma\).%
\item\hypertarget{li-128}{}On \(P \in S_F^\times\) this agrees with the previous definition of \(P^\sigma\).%
\item\hypertarget{li-129}{}\(a^\sigma = a\) for all \(a\in \QQ \cup \{\infty\}\) for all \(\sigma \in \operatorname{Gal}(\CC)\).%
\end{enumerate}
%
\end{proposition}
\begin{proof}\hypertarget{proof-94}{}
\hypertarget{p-626}{}%
Sketch\leavevmode%
\begin{enumerate}
\item\hypertarget{li-130}{}\(a \mapsto a^{\sigma^{-1}}\).%
\item\hypertarget{li-131}{}Follows as in proof of 3.22%
\item\hypertarget{li-132}{}Obvious for \(a \in \QQ\), for \(\infty\):%
\begin{equation*}
(v_\infty)^\sigma (x-1) = v_\infty(x- a^{\sigma^{-1}}) = 1 = v_\infty(x-1)
\end{equation*}
for all \(a\in \CC\) implies \((v_\infty)^{\sigma^{-1}} = v_\infty\) implies \(\infty^\sigma  = \infty\).%
\end{enumerate}
%
\end{proof}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.5 Elementary invariants of the action of \(\operatorname{Gal}(\CC)\).}
\typeout{************************************************}
%
\begin{subsectionptx}{Elementary invariants of the action of \(\operatorname{Gal}(\CC)\).}{}{Elementary invariants of the action of \(\operatorname{Gal}(\CC)\).}{}{}\label{subsection-58}
\begin{remark}{}{remark-14}%
\hypertarget{p-627}{}%
The bijection \(S \leftrightarrow S^\sigma\) is not holomorphic. In general \(S\) and \(S^\sigma\) are not isomorphic.%
\end{remark}
\begin{theorem}{}{}{theorem-50}%
\hypertarget{p-628}{}%
The action of \(\operatorname{Gal}(\CC)\) on pairs \((S,f)\) satisfies\leavevmode%
\begin{enumerate}
\item\hypertarget{li-133}{}%
\begin{equation*}
\deg(f^\sigma) = \deg(f)
\end{equation*}
%
\item\hypertarget{li-134}{}%
\begin{equation*}
(f(P))^\sigma = f^\sigma(P^\sigma)
\end{equation*}
%
\item\hypertarget{li-135}{}%
\begin{equation*}
\ord_{P^\sigma}(f^\sigma) = \ord_P(f)
\end{equation*}
%
\item\hypertarget{li-136}{}\(a\in \hat \CC\) is a branching value of \(f\) iff \(a^\sigma\) is a branching value of \(f^\sigma\).%
\item\hypertarget{li-137}{}\(\operatorname{genus}(S) = \operatorname{genus}(S^\sigma)\) i.e. they are homeomorphic.%
\item\hypertarget{li-138}{}\(\operatorname{Aut}(S,f) \to \operatorname{Aut}(S^\sigma, f^\sigma)\) via \(h \mapsto h^\sigma\) is a group homomorphism.%
\item\hypertarget{li-139}{}The monodromy group \(\operatorname{Mon}(f)\) of \((S,f)\) is isomorphic to \(\operatorname{Mon}(f^\sigma)\) of \((S^\sigma , f^\sigma)\).%
\end{enumerate}
%
\end{theorem}
\hypertarget{p-629}{}%
We will use properties 1 and 4 at least.%
\begin{proposition}{Criterion 3.29.}{}{proposition-54}%
\hypertarget{p-630}{}%
For a compact \hyperref[def-top-riem-surface]{Riemann surface} \(S\) the following are equivalent\leavevmode%
\begin{enumerate}
\item\hypertarget{li-140}{}\(S\) is defined over \(\overline \QQ\).%
\item\hypertarget{li-141}{}\(\{S^\sigma\}_{\sigma \in \operatorname{Gal}(\CC)}\) contains only finitely many isomorphism classes of \hyperref[def-top-riem-surface]{Riemann surfaces}.%
\end{enumerate}
%
\end{proposition}
\begin{proof}\hypertarget{proof-95}{}
\hypertarget{p-631}{}%
1 implies 2: \(S =S_F\), \(F = K\lb x,y\rb\) for \(K\) a number field then%
\begin{equation*}
| \{F^\sigma \}_{\sigma \in \operatorname{Gal}(\CC)} | \le [K : \QQ]
\end{equation*}
%
\par
\hypertarget{p-632}{}%
2 implies 1 is section 3.7.%
\end{proof}
\begin{paragraphs}{Proof of b implies a in Belyi's theorem (3.61).}{paragraphs-16}%
\hypertarget{p-633}{}%
Suppose \(f \colon S\to \PP^1\) is a morphism of degree \(d\) with branching values \(\{0,1,\infty\}\). By theorem 3.28 \(\forall \sigma \in \operatorname{Gal}(\CC)\)%
\begin{equation*}
f^\sigma \colon  S^\sigma \to \PP^1
\end{equation*}
is a morphism of degree \(d\) and branching values are%
\begin{equation*}
\{\sigma(0), \sigma(1), \sigma(\infty)\} = \{0,1,\infty\}\text{.}
\end{equation*}
So \(\{f^\sigma\}_{\sigma \in\operatorname{Gal}(\CC)}\) gives rise to only finitely many monodromy homomorphisms.%
\begin{equation*}
F_{f^\sigma}\colon \pi_1(\PP^1 \smallsetminus \{0,1,\infty\}) \to \Sigma_d
\end{equation*}
the fundamental group is free on two generators so there are only finitely many such maps. Theorem 2.61 implies \(\{S^\sigma\}_{\sigma \in \operatorname{Gal}(\CC)}\) contains only finitely many equivalence classes so by the criterion  \(S\) is defined over \(\overline\QQ\).%
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.6.6 The field of definition of Belyi functions (3.8)}
\typeout{************************************************}
%
\begin{subsectionptx}{The field of definition of Belyi functions (3.8)}{}{The field of definition of Belyi functions (3.8)}{}{}\label{subsection-59}
\begin{proposition}{}{}{proposition-55}%
\hypertarget{p-634}{}%
Belyi functions are defined over \(\overline \QQ\).%
\end{proposition}
\begin{proof}\hypertarget{proof-96}{}
\hypertarget{p-635}{}%
Use the same methods as in 3.7.%
\end{proof}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.7 Dessins (Berke)}
\typeout{************************************************}
%
\begin{sectionptx}{Dessins (Berke)}{}{Dessins (Berke)}{}{}\label{sec-dessins}
\begin{introduction}{}%
\hypertarget{p-636}{}%
%
\begin{equation*}
G_\QQ \acts (X,D) \leftrightarrow (S,f) \acts G_\QQ
\end{equation*}
where \((X,D)\) is a \hyperref[def-dessin-denfant]{dessin}, \((S,f)\) is a Belyi pair.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.7.1 Dessins}
\typeout{************************************************}
%
\begin{subsectionptx}{Dessins}{}{Dessins}{}{}\label{subsection-60}
\begin{definition}{}{definition-61}%
\hypertarget{p-637}{}%
A \hyperref[def-dessin-denfant]{dessin} is  a pair \((X,D)\) where \(X\) is an oriented compact \hyperref[def-top-riem-surface]{topological surface} and \(D\subset X\) is a finite graph:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-142}{}D is connected%
\item\hypertarget{li-143}{}D is bicoloured%
\item\hypertarget{li-144}{}\(X \smallsetminus D\) is a disjoint union of topological disks.%
\end{enumerate}
%
\end{definition}
\hypertarget{p-638}{}%
Not all of these are so important (for example 3 implies 1 (but the converse does not hold)). We can also obtain a bicoloured graph from an uncoloured graph by subdividing all edges and colouring the new vertices black and the others white.%
\par
\hypertarget{p-639}{}%
A single edge in a sphere is, a single edge in a torus is not.%
\begin{paragraphs}{Permutation representation of a Dessin.}{paragraphs-17}%
\hypertarget{p-640}{}%
Label the edges of  a \hyperref[def-dessin-denfant]{dessin} \(\{1, \ldots, N\}\) then%
\begin{equation*}
\sigma_0(i) = \text{subsequent edge in the cycle around the white vertex of }i
\end{equation*}
as we have a positive orientation on the edges%
\begin{equation*}
\sigma_1(i) = \text{subsequent edge in the cycle around the black vertex of }i\text{.}
\end{equation*}
Then we define%
\begin{definition}{}{definition-62}%
\hypertarget{p-641}{}%
\((\sigma_0, \sigma_1)\) is the permutation representation pair of \((X,D)\).%
\end{definition}
\hypertarget{p-642}{}%
Say%
\begin{equation*}
\sigma_0 = (1 , \ldots, N_1) (N_1 + 1 , \ldots, N_2)\cdots
\end{equation*}
a product of disjoint cycles. Then each of these cycles corresponds to a  white vertex, where the length of the cycle is the degree of the corresponding vertex. Same for \(\sigma_1\) and black vertices.%
\par
\hypertarget{p-643}{}%
%
\begin{equation*}
\{\text{cycles appearing in the decomposition of }\sigma_0\sigma_1\}
\end{equation*}
%
\begin{equation*}
\updownarrow
\end{equation*}
%
\begin{equation*}
\{\text{faces of }D\}
\end{equation*}
%
\begin{inlineexercise}{}{exercise-17}%
\hypertarget{p-644}{}%
Prove this.%
\end{inlineexercise}
\begin{remark}{}{remark-15}%
\hypertarget{p-645}{}%
\(D\) connected implies that \(\langle \sigma_0, \sigma_1 \rangle\) is transitive on \(\Sigma_N\). As \(D\) is bicoloured the cycles on \(D\) contain an even number of edges.%
\end{remark}
\hypertarget{p-646}{}%
A \hyperref[def-dessin-denfant]{dessin} is not a triangulation of \(X\) but%
\begin{equation*}
\chi (X) = \#V -  \#E  + \#F
\end{equation*}
proof later.%
\begin{proposition}{}{}{proposition-56}%
\hypertarget{p-647}{}%
%
\begin{equation*}
\chi(X) = (\#\text{cycles of }\sigma_0+\#\text{cycles of }\sigma_1) - N + \#\{\text{cycles of }\sigma_0\sigma_1\}\text{.}
\end{equation*}
%
\end{proposition}
\hypertarget{p-648}{}%
%
\begin{equation*}
(\sigma_0, \sigma_1) \leadsto (X',D)
\end{equation*}
%
\begin{equation*}
\langle \sigma_0, \sigma_1 \rangle \subseteq \Sigma_N
\end{equation*}
is transitive.%
\begin{proposition}{}{}{proposition-57}%
\hypertarget{p-649}{}%
There exists \((X,D)\) with permutation representation \((\sigma_0, \sigma_1)\).%
\end{proposition}
\begin{proof}\hypertarget{proof-97}{}
\hypertarget{p-650}{}%
Write \(\sigma_0\sigma_1 = \tau_1 \cdots \tau_k\), \(\tau_i\) disjoint cycles each of length \(n_i\) with \(\sum n_i = N\). Create \(k\) faces bounded by \(2n_1, \ldots, 2n_k\) vertices, and assign the vertices white and black colours so that the graph is bicoloured. As \(\sigma_0\sigma_1\) should jump two each time we get an identification of all edges which we then  glue using \(\sigma_0\).%
\end{proof}
\begin{definition}{}{definition-63}%
\hypertarget{p-651}{}%
We say that%
\begin{equation*}
(X_1, D_1) \sim (X_2, D_2)
\end{equation*}
if there exists an orientation preserving homeomorphism \(\phi \colon X_1 \to X_2\), \(\phi|_{D_1} \colon D_1 \xrightarrow\sim D_2\).%
\end{definition}
\begin{theorem}{}{}{theorem-51}%
\hypertarget{p-652}{}%
%
\begin{equation*}
\{\text{Dessins}\}/\sim \leftrightarrow \{( \sigma_0, \sigma_1),\,\langle \sigma_0, \sigma_1 \rangle \subseteq \Sigma_N \text{ transitive}\}/\sim
\end{equation*}
%
\end{theorem}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.7.2 Dessins 2 Belyi pairs}
\typeout{************************************************}
%
\begin{subsectionptx}{Dessins 2 Belyi pairs}{}{Dessins 2 Belyi pairs}{}{}\label{subsection-61}
\hypertarget{p-653}{}%
Triangle decomposition of \((X,D) \leadsto T(D)\) a set of triangles that cover \(D\) and intersect along edges or at vertices.%
\begin{example}{}{example-31}%
\hypertarget{p-654}{}%
Edge in the sphere, add an extra vertex \(\times\) not on the edge and get a decomposition into two triangles.%
\end{example}
\hypertarget{p-655}{}%
We will label triangles by \(T_j^\pm\) as there are two for each edge, by orientation some are the same.%
\par
\hypertarget{p-656}{}%
%
\begin{equation*}
T(D) \leadsto f_D \colon X\to \hat\CC
\end{equation*}
Glue%
\begin{equation*}
f_j^? \colon T_j^? \to \overline\HH^?
\end{equation*}
for \(?\in \{+,-\}\), where \(f_j^+  = f_j^-\) on the intersection. Where \(\partial T_j \xrightarrow\sim \RR \cup\{\infty\}\)%
\begin{equation*}
\text{black} \mapsto0
\end{equation*}
%
\begin{equation*}
\text{white} \mapsto1
\end{equation*}
%
\begin{equation*}
\times \mapsto\infty
\end{equation*}
and we have \(\operatorname{Branch}(f_D) \subseteq \{0,1,\infty\}\). Now \(\deg f_D = \#\text{edges of }D\), \(m_v(f_D) = \deg v\), \(f_D^{-1}(\lb 0 , 1 \rb) = D\). Modify \(X\) a little bit and use some lemma to get \(S_D \simeq_{\text{top}} X\) for some \hyperref[def-top-riem-surface]{Riemann surface} with \(f_D\colon S_D \to \PP^1\).%
\begin{definition}{}{definition-64}%
\hypertarget{p-657}{}%
\((S,f)\) is a Belyi pair with \(S\) compact \hyperref[def-top-riem-surface]{Riemann surface} and  \(f\) a \hyperref[def-belyi-function]{Belyi function} on \(S\).%
\begin{equation*}
(S_1,f_1) \sim (S_2, f_2)
\end{equation*}
if it is an isomorphism of \hyperref[def-dess-ramified]{ramified} coverings.%
\end{definition}
\hypertarget{p-658}{}%
So we can now go in both directions.%
\begin{equation*}
\{\text{Dessins}\}/\sim
\end{equation*}
%
\begin{equation*}
\updownarrow
\end{equation*}
%
\begin{equation*}
\{\text{Belyi pairs}\}/\sim
\end{equation*}
%
\begin{equation*}
(X,D) \mapsto (S_D, f_D)
\end{equation*}
%
\begin{equation*}
(S, D_f) \mapsfrom (S,f)
\end{equation*}
%
\par
\hypertarget{p-659}{}%
Now to define the Galois action%
\begin{equation*}
G_\QQ\acts \{\text{Dessins}\}\leftrightarrow \{\text{Belyi pairs}\}
\end{equation*}
%
\begin{equation*}
\xymatrix{
(X,D)\ar[d] \ar@{-->}[r] & (X,D)^\sigma \\
(S_D,f_D)\ar[r] & (S_D^\sigma,f_D^\sigma)^\sigma \ar[u]
}
\end{equation*}
%
\par
\hypertarget{p-660}{}%
The \(G_\QQ\) action is faithful on \hyperref[def-dessin-denfant]{dessins} of \hyperref[def-class-set]{genus} \(g\).%
\begin{example}{}{example-32}%
\hypertarget{p-661}{}%
Same example \(\PP^1\) with a single edge, \(f_D  = z\), \(\deg f_D = \#\) edges, \(m_v(f)=  \deg v\).%
\end{example}
\begin{inlineexercise}{}{exercise-18}%
\hypertarget{p-662}{}%
String.%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-19}%
\hypertarget{p-663}{}%
\(n\) star.%
\end{inlineexercise}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.8 A Sandwich Table of Dessins d'Enfants}
\typeout{************************************************}
%
\begin{sectionptx}{A Sandwich Table of Dessins d'Enfants}{}{A Sandwich Table of Dessins d'Enfants}{}{}\label{sec-sandwich}
\hypertarget{p-664}{}%
Alex: So I haven't typed this section as it was a lot of pictures and I haven't got nice scans of them, will try at some point.%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.9 Belyi's theorem, effective Mordell and ABC (Angus)}
\typeout{************************************************}
%
\begin{sectionptx}{Belyi's theorem, effective Mordell and ABC (Angus)}{}{Belyi's theorem, effective Mordell and ABC (Angus)}{}{}\label{sec-beyi-abc}
\hypertarget{p-665}{}%
We begin with one of the most famous results in arithmetic geometry.%
\begin{theorem}{Mordell conjecture/Falting's theorem.}{}{theorem-52}%
\hypertarget{p-666}{}%
Let \(C\) be an algebraic curve of \hyperref[def-class-set]{genus} \(\ge 2\) over a number field \(K\). Then \(C(K)\) is finite.%
\end{theorem}
\hypertarget{p-667}{}%
There are many proofs of this, Falting's being the original and most famous.%
\begin{remark}{}{remark-16}%
\hypertarget{p-668}{}%
Falting's proof is not effective. That is, it cannot predict the number of points or give any bounds.%
\end{remark}
\hypertarget{p-669}{}%
Today we'll show how this theorem follows from a (much harder conjecture), but how this nonetheless gives new insight into the question of effectiveness. Specifically we'll show ABC implies Mordell.%
\begin{quote}\hypertarget{blockquote-1}{}
\hypertarget{p-670}{}%
``Mordell is as easy as ABC''- Zagier%
\end{quote}
\begin{conjecture}{ABC.}{}{conjecture-1}%
\hypertarget{p-671}{}%
Let \(A,B,C\in \ZZ\) s.t. \(\gcd(A,B,C)  =1 \) and \(A+B+C=0\), then for all \(\epsilon \gt 0\) there exists a constant \(k_\epsilon\) s.t.%
\begin{equation*}
N(A,B,C) \gt k_\epsilon H(A,B,C)^{1-\epsilon}
\end{equation*}
where%
\begin{equation*}
N(A,B,C) =  \prod_{p|ABC} p
\end{equation*}
%
\begin{equation*}
H(A,B,C) = \max(|A|,|B|,|C|)\text{.}
\end{equation*}
%
\end{conjecture}
\hypertarget{p-672}{}%
This is a remarkably deep statement about the integers. Something surprising about how one compares the additive and multiplicative structures of the integers.%
\par
\hypertarget{p-673}{}%
For our purposes (to connect it to the curves and Mordell) we'd like to remove the dependence on integrality and coprimality, by making it scaling invariant.%
\par
\hypertarget{p-674}{}%
We now define%
\begin{equation*}
H(A,B,C) = \prod_{v}\max(|A|_v,|B|_v,|C|_v)
\end{equation*}
%
\begin{equation*}
N(A,B,C) =  \prod_{p\in I} p
\end{equation*}
for%
\begin{equation*}
I = \{p \text{ prime} : \max(|A|_p,|B|_p,|C|_p) \gt \min(|A|_p,|B|_p,|C|_p)\}\text{.}
\end{equation*}
%
\begin{inlineexercise}{For sanity.}{exercise-20}%
\hypertarget{p-675}{}%
%
\begin{equation*}
H(\lambda A,\lambda B,\lambda C)  = H(A,B,C)
\end{equation*}
%
\begin{equation*}
N(\lambda A,\lambda B,\lambda C)  = N(A,B,C)
\end{equation*}
for \(\lambda, A,B,C \in \QQ\units\). Moreover if \(A,B,C \in \ZZ\) and \(\gcd = 1\) then we recover the original definition.%
\end{inlineexercise}
\hypertarget{p-676}{}%
Since we have \(A+ B+C = 0\) and our functions are scaling invariant, they only depend on \(r=  - A/B\). We'll also reformulate it over an arbitrary number field \(K\).%
\par
\hypertarget{p-677}{}%
Note that to satisfy the hypotheses of the conjecture we require%
\begin{equation*}
r \in \PP^1_K \smallsetminus \{0,1,\infty\}\text{.}
\end{equation*}
%
\par
\hypertarget{p-678}{}%
We now define%
\begin{equation*}
H(r) = \prod_{v}\max(1,|r|_v)
\end{equation*}
%
\begin{equation*}
N(r) =  \prod_{p\in I} p
\end{equation*}
for%
\begin{equation*}
I = \{p \text{ prime} : \max(v_p(r), v_p(1/r), v_p(r-1)) \gt 0                      \}\text{.}
\end{equation*}
%
\begin{remark}{}{remark-17}%
\hypertarget{p-679}{}%
In fact this new height is off from the old one by a constant factor, but since ABC allows for a constant factor this won't trouble us.%
\end{remark}
\begin{paragraphs}{Motivation: ABC implies Fermat bound.}{paragraphs-18}%
\hypertarget{p-680}{}%
One can see this simply by assuming a solution%
\begin{equation*}
x^n + y^n  =z^n ,\, n \ge3
\end{equation*}
and setting%
\begin{equation*}
(A,B,C)=  (x^n,y^n, z^n)
\end{equation*}
then%
\begin{equation*}
N(A,B,C) = \prod_{p|ABC} p  \le |xyz| \lt \max(|x|^3,|y|^3,|z|^3) = H(A,B,C)^{3/n}\text{.}
\end{equation*}
So setting%
\begin{equation*}
\epsilon = 1 - 3/n
\end{equation*}
for \((A,B,C)\) s.t. \(H(A,B,C)\) is sufficiently large we get a contradiction to ABC. Thus ABC gives us a bound on the possible solutions to the Fermat equation, reducing the remainder of the conjecture to a finite computation.%
\par
\hypertarget{p-681}{}%
Let us phrase this in the following alternate way: Let%
\begin{equation*}
F_n \colon x^n + y^n + z^n = 0
\end{equation*}
be the Fermat curve and consider the function%
\begin{equation*}
f\colon F_n \to \PP^1
\end{equation*}
%
\begin{equation*}
(x:y:z) \mapsto -\left(\frac{x}{y}\right)^n
\end{equation*}
ramified over \(0,1, \infty\).%
\begin{note}{}{note-8}%
\hypertarget{p-682}{}%
\(\deg(f) = n^2\)%
\par
\hypertarget{p-683}{}%
Each of \(0,1,\infty\) has \(n \) preimages in \(F_n(\overline \QQ)\).%
\end{note}
\hypertarget{p-684}{}%
The idea now is that \(N(A,B, C)\) is measuring ramification, while \(H(A, B,C)\) is a height function. The note above tells us that each of \(0, 1, \infty\) contributes a factor of \(O(H(A,B,C)^{n/n^2})\) to \(N(A,B,C)\). So in this formulation, what we used was the existence of a rational function \(f\) such that%
\begin{equation*}
\#\{p\in C(\overline \QQ): f(p) \in \{0,1,\infty\}\} \lt \deg (f)\text{.}
\end{equation*}
%
\begin{inlineexercise}{}{exercise-21}%
\hypertarget{p-685}{}%
If \(C\)  has \hyperref[def-class-set]{genus} 0 or 1, no such \(f\) can exist (hint: Riemann-Hurwitz).%
\end{inlineexercise}
\end{paragraphs}%
\begin{paragraphs}{ABC implies a bound on Mordell.}{paragraphs-19}%
\hypertarget{p-686}{}%
We begin with a technical proposition:%
\begin{proposition}{}{}{proposition-58}%
\hypertarget{p-687}{}%
Let \(K\) be a number field an d \(C/K\) a  curve. Let \(f \in K(C)\) be a rational function of degree \(d\). Then for \(p \in C(K) \smallsetminus f\inv(0)\) we have%
\begin{equation*}
\log N_0(f(p)) \lt (1- b_f(0)/d) \log H(f(p)) + O(\sqrt{\log H(f(p))} + 1)
\end{equation*}
with the following notation%
\begin{equation*}
N(r)  =N_0(r) N_1(r) N_\infty(r)
\end{equation*}
%
\begin{equation*}
N_0(r) = \prod_{\ideal p \supseteq (r)} \norm(\ideal p)
\end{equation*}
%
\begin{equation*}
N_1(r) = \prod_{\ideal p \supseteq (1-r)} \norm(\ideal p)
\end{equation*}
%
\begin{equation*}
N_\infty(r) = \prod_{\ideal p \supseteq (1/r)} \norm(\ideal p)
\end{equation*}
%
\begin{equation*}
b_f(0) = \sum_{f(p) = 0} (e_p - 1)\text{.}
\end{equation*}
%
\end{proposition}
\begin{proof}\hypertarget{proof-98}{}
\hypertarget{p-688}{}%
The \hyperref[def-class-set]{genus} 0 case follows from the fact that the \(f\) is a rational function (and in fact the error term is \(O(1)\)) (exercise). For the general case we need the theory of log heights on curves. From this we require the following\leavevmode%
\begin{itemize}[label=\textbullet]
\item{}For \(D\) a divisor on \(C\) we have  a height function%
\begin{equation*}
h_D(\cdot)
\end{equation*}
which is well defined up to  \(O(1)\).%
\item{}If%
\begin{equation*}
D=  \sum m_k D_k
\end{equation*}
is a decomposition into irreducible divisors, then%
\begin{equation*}
h_D(P) = \sum m_k h_{D_k}(P)\text{.}
\end{equation*}
%
\item{}For \(\Delta\) a degree 0 divisor%
\begin{equation*}
h_{\Delta} (P) = O(\sqrt{\log H(f(P))} + 1)\text{.}
\end{equation*}
%
\end{itemize}
%
\par
\hypertarget{p-689}{}%
Let \(D = \divisor_0(f) = \sum m_k D_k\), \(D' = \sum_{f(P) = 0} (P)\) then \(b_f(0) = \deg D'\). Then%
\begin{equation*}
\log H(f(P)) = h_D(P) + O(1) = \sum m_k h_{D_k}(P) + O(1)
\end{equation*}
since \(\log H(f(P))\) is also a height function relative to \(D\). We now turn to \(N_0(f(P))\). Any prime occurring in this must also occur in \(h_{D_k}(P)\) for some \(k\) (except for a finite set \(\{p : p|f \text{ or } p \text{ bad red. for } C\}\)). Then%
\begin{equation*}
N_0(f(P))  \lt \sum h_{D_k}(P) + O(1) = h_{D'}(P) + O(1)\text{.}
\end{equation*}
Letting%
\begin{equation*}
\Delta = (\deg D) D' - (\deg D') D
\end{equation*}
we have%
\begin{equation*}
h_{\Delta} (P) = O(\sqrt{\log H(f(P))} + 1)
\end{equation*}
thus%
\begin{equation*}
\log N_0(f(P)) \lt h_{D'} (P) + O(1)
\end{equation*}
%
\begin{equation*}
= \frac{1}{\deg D} (\deg D') h_{D'} (P) + O(1)
\end{equation*}
%
\begin{equation*}
= \frac{1}{\deg D} (\deg D') h_{D} (P) + O(\sqrt{\log H(f(P))} + 1)
\end{equation*}
%
\begin{equation*}
= \frac{1- b_f(0)}{d} \log  H(f(P)) + O(\sqrt{\log H(f(P))} + 1)\qedhere
\end{equation*}
%
\end{proof}
\begin{remark}{}{remark-18}%
\hypertarget{p-690}{}%
One can show the above for \(N_1, N_\infty\) instead making the appropriate replacements for \(f\).%
\end{remark}
\hypertarget{p-691}{}%
Adding the three terms together we get%
\begin{equation*}
\log N_0(f(P))N_1(f(P)) N_\infty(f(P))
\end{equation*}
%
\begin{equation*}
\lt \left(\left(1- \frac{b_f(0)}{d}\right) +\left(1- \frac{b_f(1)}{d}\right)+\left(1- \frac{b_f(\infty)}{d}\right)\right) \log H(f(P)) + O(\cdots)
\end{equation*}
%
\begin{equation*}
\log N(f(P)) \lt \frac 1d \left(\# f\inv(0)+\# f\inv(1)+\# f\inv(\infty) \right) \log H(f(P)) + O(\cdots)
\end{equation*}
%
\begin{equation*}
\lt \frac md \log H(f(P))+ O(\cdots)
\end{equation*}
where%
\begin{equation*}
m = \#\{P \in C(\overline \QQ) : f(P) \in \{0,1,\infty\}\}
\end{equation*}
exponentiating we get%
\begin{equation*}
N(f(P)) \lt H(f(P))^{m/d} K\text{.}
\end{equation*}
%
\begin{theorem}{ABC implies Mordell.}{}{theorem-53}%
\hypertarget{p-692}{}%
ABC implies Mordell.%
\end{theorem}
\begin{proof}\hypertarget{proof-99}{}
\hypertarget{p-693}{}%
Let \(C\) be a given curve of \hyperref[def-class-set]{genus} \(g \ge 2\) Belyi's theorem gives a function%
\begin{equation*}
f\colon C \to \PP^1
\end{equation*}
ramified over \(\{0,1,\infty\}\). By Riemann-Hurwitz \(m  = d + 2 - 2g\), \(d = \deg (f)\) \(m\) as above. Thus \(m \lt d\), thus we can pick \(0 \lt  \epsilon  \lt 1 - \frac md\) and so for sufficiently large \(H(f(P))\) (i.e. all but finitely many) we have a counterexample to ABC.%
\end{proof}
\begin{remark}{Closing remarks.}{remark-19}%
\hypertarget{p-694}{}%
Belyi's theorem gives an algorithm for determining \(f \colon C \to \PP^1\) i.e. it is effective.%
\par
\hypertarget{p-695}{}%
One can also show ABC implies Siegel's theorem.%
\par
\hypertarget{p-696}{}%
In fact it can be shown that a particular effective form of Mordell (applied to \(y^2 + y = x^5\)) for all number fields implies ABC. This is related to Szpiro's conjecture.%
\end{remark}
\hypertarget{p-697}{}%
References:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-148}{}Elkies - ABC implies Mordell%
\item\hypertarget{li-149}{}Serre - Lectures on Mordell-Weil%
\end{enumerate}
%
\end{paragraphs}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.10 Dessins, integer points on elliptic curves and a proof of the ABC conjecture (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Dessins, integer points on elliptic curves and a proof of the ABC conjecture (Alex)}{}{Dessins, integer points on elliptic curves and a proof of the ABC conjecture (Alex)}{}{}\label{sec-dessins-integer-pts-abc}
%
%
\typeout{************************************************}
\typeout{Subsection 2.10.1 A proof of the ABC theorem (for polynomials)}
\typeout{************************************************}
%
\begin{subsectionptx}{A proof of the ABC theorem (for polynomials)}{}{A proof of the ABC theorem (for polynomials)}{}{}\label{subsection-62}
\hypertarget{p-698}{}%
Last week Angus told us about the incredibly powerful ABC conjecture and its arithmetic consequences (apparently). This week we will prove this conjecture (for polynomials). The proof is very similar to some of the things Angus mentioned, but seeing as I wasn't there its new to me... Following Goldring / Stothers / Parab.%
\par
\hypertarget{p-699}{}%
Let \(K\) be algebraically closed of characteristic 0, with \(f \in K\lb x \rb\), we can define the radical as before%
\begin{equation*}
\operatorname{rad}(f) = \prod_{p | f} p
\end{equation*}
over the primes/irreducibles dividing \(f\), this is the maximal squarefree polynomial dividing \(f\). How do we measure the size of a polynomial? Let \(r(f) = \deg \operatorname{rad}(f)\), and \(h(f_1, \ldots, f_n) = \max\{\deg f_i\}\). This is a complicated way of saying%
\begin{equation*}
\#\{x \in K : f(x) = 0 \}\text{,}
\end{equation*}
but we do so to emphasise the link with ABC.%
\par
\hypertarget{p-700}{}%
The result is then%
\begin{theorem}{Mason-Stothers.}{}{theorem-54}%
\hypertarget{p-701}{}%
Let%
\begin{equation*}
e,f,g\in K[x],\,e + f = g
\end{equation*}
be pairwise coprime and all of height \(\gt 0\). Then%
\begin{equation*}
h(e,f,g) \lt r(efg) = r(e) + r(f)  + r(g)\text{.}
\end{equation*}
%
\par
\hypertarget{p-702}{}%
We have sharpness if and only if \(f/g\) is a Belyi map for \(\PP^1 \to \PP^1\) with \((f/g)(\infty) \in \{0,1,\infty\}\). Another way of saying this is that if \(\deg f = \deg g\) then their leading coefficients are equal, and hence \(\deg (e) \lt \deg (f)\).%
\end{theorem}
\begin{proof}\hypertarget{proof-100}{}
\hypertarget{p-703}{}%
First of all we note that the statement is \hyperref[def-princ-pol]{symmetric} in \(e,f,g\), so we may arrange that \(h(g) \le h(e,f)\) which implies that \(h(e) = h(f) = h(e,f,g)\). The second statement is less obviously invariant but note that \(\phi\) is  a \hyperref[def-belyi-function]{Belyi function} is equivalent to \(1-\phi\) and \(1/\phi\) being Belyi also and this preserves \(\phi(\infty) \in \{0,1,\infty\}\), so rearranging does not change the truth of the second statement either. Let \(\phi = f/g\) so \(\deg(\phi) = \max\{\deg (f), \deg(g)\} = h(e,f,g)\), we will denote this by \(h\) now. Apply Riemann-Hurwitz (suprise-suprise)%
\begin{equation*}
-2 = -2h + \sum_{x\in \PP^1} e_\phi(x) - 1\text{.}
\end{equation*}
Let%
\begin{equation*}
R_y = \sum_{x : f(x) = y} e_\phi(x) - 1
\end{equation*}
be the ramification above \(y\), we will consider \(B_0, B_1, B_\infty\). These ramification numbers will simply be \(h - \#(\phi\inv(y))\). Lets begin with \(R_1\), we have \(f(x)/g(x) = 1\) so \(e(x) = 0\) and in fact%
\begin{equation*}
R_1 = h(e) - r(e) = h - r(e)\text{.}
\end{equation*}
For \(R_0\) we have either \(f(x) = 0\) or \(g(x) = \infty\). Having \(g(x) = \infty\) means \(x = \infty\) but this cannot really happen as \(h(f) \ge h(g)\). So this is really just%
\begin{equation*}
\sum_{x : f(x) = 0} e_\phi(x) - 1 = h  - r(f)\text{.}
\end{equation*}
Finally \(\phi(x) = \infty\) only when \(g(x) = 0\) or \(x = \infty\). If \(h(f) = h(g)\) then \(\phi(\infty) \ne \infty\) and we have simply%
\begin{equation*}
R_\infty = h - r(g)\text{.}
\end{equation*}
If \(h(g) \lt h(f)\) then we also have \(\phi(\infty) = \infty\) so we pick up an extra preimage and we get instead%
\begin{equation*}
R_\infty = h - (r(g) + 1)\text{.}
\end{equation*}
%
\par
\hypertarget{p-704}{}%
Back up in Riemann-Hurwitz this comes down (magically?) to%
\begin{equation*}
-2 = \cancelto{0}{-2 h + h + h} + h - r(e) -r(f) - r(g) + R - \delta_{h(f) \gt h(g)}
\end{equation*}
so%
\begin{equation*}
R = h - r(efg) - 2 + \delta_{h(f) \gt h(g)}
\end{equation*}
but of course \(R \ge 0\) so%
\begin{equation*}
h \ge r(efg) + 1
\end{equation*}
with equality exactly when%
\begin{equation*}
h = r(efg) + 1 \implies R = 0,\, h(f) \gt h(g)\text{.}
\end{equation*}
\(R= 0\) is equivalent to being Belyi.%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.10.2 Back to number theory}
\typeout{************************************************}
%
\begin{subsectionptx}{Back to number theory}{}{Back to number theory}{}{}\label{subsection-63}
\hypertarget{p-705}{}%
That was all well and good, but this is a number theory seminar, not a function field analogues of number theory seminar, so let's take it back to why we are all here, solving Diophantine equations.%
\par
\hypertarget{p-706}{}%
Let's try and find nontrivial integral points on Mordell curves!%
\begin{equation*}
E_k\colon y^2 = x^3 + k\text{.}
\end{equation*}
%
\begin{example}{}{example-33}%
\hypertarget{p-707}{}%
%
\begin{equation*}
1001^2 = 5009^3 - (5009^3 - 1001^2)
\end{equation*}
so I found a large point on%
\begin{equation*}
y^2 = x^3 - (5009^3 - 1001^2) = x^3 - 125675213728
\end{equation*}
are you not impressed?%
\end{example}
\hypertarget{p-708}{}%
Although this point would look slightly non-trivial if I started with the curve \(5009^3\) is roughly \(125675213728\) anyway so you should only be impressed if I find points of height somewhat larger than the coefficients. We should probably ask that%
\begin{equation*}
|x|^3 \gt |k|
\end{equation*}
by some margin at least.%
\par
\hypertarget{p-709}{}%
A nice question is then given \(k\) how big can an integer point \((x,y)\) on \(E_k\) be? Bounds are known, e.g.  Via work of Baker we get%
\begin{equation*}
\max(|x|, |y|) \lt e^{10^{10}|k|^{1000}}\text{.}
\end{equation*}
Ouch.%
\par
\hypertarget{p-710}{}%
If we want to study more realistic bounds we can instead reverse the problem. Can we minimise \(x^3 - y^2\) for integer \(x,y\), how close can the square of a large integer and the cube of a large integer be? Euler showed that \(|x^3 - y^2| = 1\) has only 1 (interesting) solution, for example.%
\par
\hypertarget{p-711}{}%
Marshall Hall was interested in this, did some nice computations and conjectured:%
\begin{conjecture}{Mashall Hall's conjecture, 1970.}{}{conjecture-2}%
\hypertarget{p-712}{}%
If%
\begin{equation*}
x^3 - y^2 = k
\end{equation*}
for integers \(x,y\) then%
\begin{equation*}
|k| \gt \frac{\sqrt{|x|}}{5}
\end{equation*}
(or \(k =0\)...).%
\end{conjecture}
\hypertarget{p-713}{}%
This is false!%
\begin{example}{Elkies (who else?).}{example-34}%
\hypertarget{p-714}{}%
If%
\begin{equation*}
x= 5853886516781223,\,y = 447884928428402042307918
\end{equation*}
is a point on%
\begin{equation*}
y^2 = x^3 - 1641843
\end{equation*}
then%
\begin{equation*}
\frac{\sqrt{|x|}}{k} = 46.6004943471754\text{.}
\end{equation*}
%
\end{example}
\hypertarget{p-715}{}%
This is far larger than the previous best known, but still remains the record as far as I can tell. It seems Hall's conjecture is unlikely to be true for any fixed constant, but the following of Stark-Trotter is more believable.%
\begin{conjecture}{Stark-Trotter/Weak Hall.}{}{conjecture-3}%
\hypertarget{p-716}{}%
For any  \(\epsilon \gt 0\) there is some \(C(\epsilon)\) such that for any \(x,y\) integers%
\begin{equation*}
|x^3 - y^2| \gt C(\epsilon) x^{\frac12 - \epsilon}
\end{equation*}
for any \(x \gt C(\epsilon)\).%
\end{conjecture}
\hypertarget{p-717}{}%
If Hall's/Stark-Trotter is true we get a \emph{huge} improvement on Baker%
\begin{equation*}
\frac{\sqrt{|x|}}{|k|} \lt 100 \implies x \lt 10^4k^2
\end{equation*}
and hence%
\begin{equation*}
y^2 = x^3 + k \lt 10^{12}k^6 + k
\end{equation*}
giving polynomial bounds on \(x,y\) in terms of \(k\).%
\par
\hypertarget{p-718}{}%
How might one find such triple \((x,y,k)\) that is extremal? One approach is to try and come up with a parametrisation of nice triples. We can search for polynomials \(X(t),Y(t), K(t)\) and then plug in various integer values for \(t\) and hope for the best. To give ourselves the best chance of succeeding we want \(K(t)\) to be smaller than \(X(t)^3\) and \(Y(t)^2\) for some values of \(t\). This leads us to ask for \(K\) to be of smallest degree possible. So how low can we go?%
\par
\hypertarget{p-719}{}%
This is the point where we come full circle right, we are searching for%
\begin{equation*}
X(t)^3 - Y(t)^2 = K(t)
\end{equation*}
with degree of \(K\) minimised, so we apply Mason-Stothers to see that, if \(M\) is the degree of the left hand terms we have \(\deg(X) = 2m\) and \(\deg (Y) = 3m\), indeed \(h\) in Mason-Stothers is then \(6m\) We also have \(r(X^3) = r(X) \le 2m\) and \(r(X^2) = r(Y) \le 3m\) so together Mason-Stothers gives%
\begin{equation*}
6m \lt 2m + 3m + r(K)
\end{equation*}
or \(m \lt r(K)\). So we have lower-bounded the degree of \(K\) in terms of \(\frac 12 \deg(X)\) for example.%
\par
\hypertarget{p-720}{}%
We just proved:%
\begin{conjecture}{Birch B. J., Chowla S., Hall M., Jr., Schinzel A. On the difference \(x^3 - y^2\), 1965..}{}{conjecture-4}%
\hypertarget{p-721}{}%
Let \(X, Y\) be two coprime polynomials with \(X^3,Y^2\) of equal degree (\(6m\)) and equal leading coefficient, then%
\begin{equation*}
K = X^3 - Y^2
\end{equation*}
is of degree \(\gt m\).%
\par
\hypertarget{p-722}{}%
(Now the speaker has just given a theorem with an inequality, so in \hyperref[def-order-quaternion]{order} to appear smart one of you should ask is this bound sharp.)%
\par
\hypertarget{p-723}{}%
The bound is sharp, this can mean several things in general, originally it was asked that for infinity many \(m\) there is an example where \(\deg K = m + 1\).%
\end{conjecture}
\hypertarget{p-724}{}%
The first part was proved initially by Davenport (in the same year, and journal). The second part had to wait until '81 for Stothers to prove it.%
\par
\hypertarget{p-725}{}%
Someone else should probably also ask, how is any of this related to \hyperref[def-dessin-denfant]{Dessins}?%
\par
\hypertarget{p-726}{}%
To prove sharpness we have to exhibit for each \(m\) triple of polynomials \(X,Y,K\) of degrees \(2m,3m,m+1\). Coming up with polynomial families is hard, drawing stupid pictures is easy, can \hyperref[def-dessin-denfant]{Dessins} aid us here?%
\par
\hypertarget{p-727}{}%
Lets back-track, when we proved Mason-Stothers we also said that sharpness was equivalent to \(f/g\) being Belyi, so \(X(t)^3/K(t) = (K(t) + Y(t)^2) / K(t) = Y(t)^2/K(t) + 1\) should be a Belyi map of degree \(6m\) from \(\PP^1\to \PP^1\). What does its ramification look like? We should have all preimages of \(0\) degree 3, preimages of \(1\) degree 2, and above infinity \(m + 1\) points of degree \(1\) and the remaining of degree \(6m - (m + 1) = 5m - 1\).%
\par
\hypertarget{p-728}{}%
How can we draw a \hyperref[def-dessin-denfant]{Dessin} like this? Begin with a tree with all internal vertices degree 3, with \(2m\) vertices, this will have \(2m - 1\) edges, and as it is trivalent by the handshake lemma%
\begin{equation*}
3 \#\{\text{internal}\} + \#\{\text{leaves}\} =  4m - 2
\end{equation*}
and%
\begin{equation*}
\#\{\text{internal}\} + \#\{\text{leaves}\} =  2m
\end{equation*}
giving%
\begin{equation*}
2\#\{\text{internal}\} =  2m - 2
\end{equation*}
%
\begin{equation*}
\#\{\text{internal}\} =  m - 1
\end{equation*}
%
\begin{equation*}
\#\{\text{leaves}\} =  m + 1
\end{equation*}
Add loops to the leaves, you now have a \hyperref[def-clean-dessin]{clean Dessin} as above. It has \(2m- 1 + m + 1 = 3m\) edges. We have a face for every loop of degree 1, and one on the outside of degree \(m+ 1 +2(2m-1)  = 5m - 1\) as each internal edge is traversed twice if you walk around the outside. So this works!%
\begin{example}{}{example-35}%
\hypertarget{p-729}{}%
For \(m= 1\)%
\begin{equation*}
(x^2 + 2)^3 - (x^3 + 3x)^2 = 3x^2 + 8\text{.}
\end{equation*}
\(m= 2\)%
\begin{equation*}
(x^4 - 4x)^3 - (x^6 -6x^3+6)^2  = 8x^3 - 36\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{example-36}%
\hypertarget{p-730}{}%
For \(m =5\)%
\begin{equation*}
X(t) = \frac 19 (t^{10} + 6t^7 +15 t^4 + 12t)
\end{equation*}
%
\begin{equation*}
Y(t) = \frac{1}{54} (2t^{15} + 18t^{12} +72 t^9 + 144 t^6 + 135 t^3 + 27)
\end{equation*}
%
\begin{equation*}
K(t) = -\frac{1}{108} (3t^{6} + 14t^3 +27)
\end{equation*}
and we can let \(t = -3\) to get \(X(-3) = 5234\), \(Y(-3) = -378661\) and \(K(-3) = -17\), so we have a point%
\begin{equation*}
(5234, 378661) \in E_{17} \colon y^2 = x^3 + 17
\end{equation*}
letting \(t = \pm 9\) we get%
\begin{equation*}
|384242766^3 - 7531969451458^2| = 14668
\end{equation*}
%
\begin{equation*}
|390620082^3 - 7720258643465^2| = 14857
\end{equation*}
both of which have%
\begin{equation*}
\frac{\sqrt{|x|}}{k} \approx 1.33\text{,}
\end{equation*}
these get lower as we increase \(t\) though.%
\end{example}
\hypertarget{p-731}{}%
We should expect this decrease from this method as if \(\deg X = 2m\) and \(\deg K = m + 1\) then \(\sqrt{X(t)}/K(t)\) grows like \(t^{m}/t^{m+1} = t\inv\).%
\par
\hypertarget{p-732}{}%
Can we do the same for abc?%
\par
\hypertarget{p-733}{}%
Take the \hyperref[def-dessin-denfant]{Dessin} with a deg 1 vertex at infinity, degree 3 at 0 with an edge surrounding 1, we get a \hyperref[def-belyi-function]{Belyi function}%
\begin{equation*}
f(x) = \frac{64x^3}{(x+9)^3 (x+1)},\,f(x) - 1 = -\frac{(x^2 - 18x -27)^2}{(x+9)^3(x+1)}
\end{equation*}
plugging in \(x=a/b\) and cross multiplying gives%
\begin{equation*}
64a^3 b + (a^2 - 18ab - 27b^2)^2 = (a+9b)^3(a+b)
\end{equation*}
which could of course be verified independently, but how would you find this identity without \hyperref[def-dessin-denfant]{Dessins}? Now for \(a = -32, b= 23\) we get%
\begin{equation*}
- 2^{21} \cdot 23 +  11^2 =  -1 \cdot 3^2 \cdot 5^6 \cdot 7^3
\end{equation*}
or%
\begin{equation*}
11^2 + 3^2 \cdot 5^6 \cdot 7^3 = 2^{21} \cdot 23
\end{equation*}
This is the second highest quality abc triple known with quality%
\begin{equation*}
\frac{\log c}{\log R} = 1.62599
\end{equation*}
(the current winner has quality \(1.6299\)).%
\begin{paragraphs}{References.}{paragraphs-20}%
\hypertarget{p-734}{}%
A semi-random \hyperref[def-order-quaternion]{order}, maybe starting at the top is nice though. If you have trouble finding something let me know.\leavevmode%
\begin{enumerate}
\item\hypertarget{li-150}{}On Computing Belyi Maps - J. Sijsling, J. Voight%
\item\hypertarget{li-151}{}Belyi Functions: Examples, Properties, and Applications - Zvonkin (really nice survey)%
\item\hypertarget{li-152}{}On Davenport’s bound for the degree of \(f^3 - g^2\) and Riemann's Existence Theorem - Umberto Zannier%
\item\hypertarget{li-153}{}Unifying Themes Suggested by Belyi's Theorem - Wushi Goldring%
\item\hypertarget{li-154}{}Polynomial Identities and Hauptmoduln - W. W. Stothers%
\item\hypertarget{li-155}{}Elliptic Surfaces and Davenport-Stothers Triples -  Tetsuji Shioda%
\item\hypertarget{li-156}{}The abc-theorem, Davenport’s inequality and elliptic surfaces - Tetsuji Shioda%
\item\hypertarget{li-157}{}It's As Easy As abc -  Andrew Granville, Thomas J. Tucker%
\item\hypertarget{li-158}{}Polynomial and Fermat–Pell families that attain the Davenport–Mason bound - Noam D. Elkies, Mark Watkins (on Watkins webpage)%
\item\hypertarget{li-159}{}Halltripels en kindertekeningen - Hans Montanus (in Dutch, but math is universal right?)%
\item\hypertarget{li-160}{}Computational Number Theory and Algebraic Geometry Spring 2012, taught by Noam Elkies, notes by Jason Bland%
\item\hypertarget{li-161}{}Davenport–Zannier polynomials over \(\QQ\) - Fedor Pakovich, Alexander K. Zvonkin (a nice extension perhaps?)%
\item\hypertarget{li-162}{}Minimum Degree of the Difference of Two Polynomials over Q, and Weighted Plane Trees -  Fedor Pakovich,  Alexander K. Zvonkin (as above)%
\item\hypertarget{li-163}{}The ABC-conjecture for polynomials - Abhishek Parab%
\item\hypertarget{li-164}{}On Marshall Hall's Conjecture and Gaps Between Integer Points on Mordell \hyperref[def-supersing-isog-ec]{Elliptic Curves} - Ryan D'Mello%
\item\hypertarget{li-165}{}Neighboring powers - F. Beukers, C. L. Stewart (a more general problem, but nice history and examples)%
\item\hypertarget{li-166}{}Rational Points Near Curves and Small Nonzero \(| x^3 - y^2|\) via \hyperref[def-buntes-lattice]{Lattice} Reduction - Elkies%
\item\hypertarget{li-167}{}ABC implies Mordell - Elkies%
\item\hypertarget{li-168}{}Dessins d'enfant -  Jeroen Sijsling (master thesis)%
\item\hypertarget{li-169}{}Algorithms and differential relations for \hyperref[def-belyi-function]{Belyi functions} - Mark van Hoeij, Raimundas Vidunas.%
\item\hypertarget{li-170}{}Belyi functions for hyperbolic hypergeometric-to-Heun transformations -  Mark van Hoeij, Raimundas Vidunas (has application to ABC over number fields at the end)%
\item\hypertarget{li-171}{}Some remarks on the S-unit equation in function fields  - Umberto Zannier%
\item\hypertarget{li-172}{}A note on integral points on \hyperref[def-supersing-isog-ec]{elliptic curves} - Mark Watkins%
\item\hypertarget{li-173}{}On Hall’s conjecture - Andrej Dujella (more recent progress)%
\item\hypertarget{li-174}{}Hecke Groups, \hyperref[def-dessin-denfant]{Dessins} d'Enfants and the Archimedean Solids -  Yang-Hui He, and James Read%
\item\hypertarget{li-175}{}Belyi functions for Archimedean solids - Nicolas Magot, Alexander Zvonkin (didn't really use this but it's nice!)%
\end{enumerate}
%
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.11 Three Short Stories aboute Belyi's theorem (Ricky)}
\typeout{************************************************}
%
\begin{sectionptx}{Three Short Stories aboute Belyi's theorem (Ricky)}{}{Three Short Stories aboute Belyi's theorem (Ricky)}{}{}\label{sec-three-short-stories-belyi}
\begin{introduction}{}%
\begin{theorem}{}{}{theorem-55}%
\hypertarget{p-735}{}%
\(X /\CC\) a curve. Then \(X\) is defined over \(\overline \QQ\) iff there exists a Belyi map%
\begin{equation*}
\phi \colon X\to \PP^1
\end{equation*}
such that \(B(\phi) \subseteq  \{0,1,\infty\}\).%
\end{theorem}
\hypertarget{p-736}{}%
Main reference: Unifying Themes Suggested by Belyi's Theorem - Wushi Goldring%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.11.1 The case of the Rising Degree}
\typeout{************************************************}
%
\begin{subsectionptx}{The case of the Rising Degree}{}{The case of the Rising Degree}{}{}\label{subsection-64}
\begin{definition}{}{def-belyi-degree}%
\hypertarget{p-737}{}%
The \terminology{Belyi degree} of \(X/\overline \QQ\) (a curve) is the minimal degree of \(\phi\colon X \to \PP^1\) a Belyi map.%
\end{definition}
\hypertarget{p-738}{}%
Question, how does the \hyperref[def-belyi-degree]{Belyi degree} of \(X/\overline \QQ\) relate to the arithmetic of \(X\)?%
\begin{definition}{}{def-field-of-moduli}%
\hypertarget{p-739}{}%
The \terminology{field of moduli} of \(X/\overline\QQ\) is the intersection over all fields \(\subseteq \overline \QQ\) over which \(X\) is defined. Similarly for a morphism \(\phi \colon X \to Y\).%
\end{definition}
\begin{remark}{}{remark-20}%
\hypertarget{p-740}{}%
This is not the same as the field of definition always.%
\end{remark}
\hypertarget{p-741}{}%
Given \(X/\overline \QQ\) with \hyperref[def-field-of-moduli]{field of moduli} \(K\) we say \(X\) has good (resp. semistable) reduction at \(\ideal p \subseteq \ints_K\) if there exists a model for \(X\) over \(\ints_{K_{\ideal p}}\) s.t. the special fibre is smooth (resp. semistable) reduction.%
\par
\hypertarget{p-742}{}%
For \(p\in \ZZ\) we say \(X\) has good/semistable reduction at \(p\) if it dies for all \(\ideal p | p\).%
\begin{theorem}{Zapponi.}{}{thm-zapponi}%
\hypertarget{p-743}{}%
If \(X/\overline \QQ\) then the \hyperref[def-belyi-degree]{Belyi degree} of \(X\) is at least the largest prime \(p \in \ZZ\) such that \(X\) has bad semistable reduction at \(p\).%
\end{theorem}
\begin{remark}{}{remark-21}%
\hypertarget{p-744}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-176}{}The lower bound is not ``sharp'' because  there exist \(E/K\) with good reduction everywhere, but no degree 1 maps \(\phi \colon E \to \PP^1\).%
\item\hypertarget{li-177}{}If%
\begin{equation*}
E\colon y^2 = x^3 + x^2 + p
\end{equation*}
then \(E\) has bad semistable reduction at \(p\) so the \hyperref[def-belyi-degree]{Belyi degree} of \(E\) is \(\ge p\).%
\end{enumerate}
%
\end{remark}
\begin{theorem}{Beckmann.}{}{thm-beckmann}%
\hypertarget{p-745}{}%
Let \(\phi \colon X \to \PP^1\) be a Belyi map with \hyperref[def-field-of-moduli]{field of moduli} \(M\). Let \(G\) be the Galois group of the Galois closure of \(\phi\). Then for all \(p\) such that \(p \nmid |G|\), \(\tilde \phi \colon \tilde X \to \PP^1\) has good reduction at \(p\) and \(p\) is unramified in \(M\).%
\end{theorem}
\begin{proof}\hypertarget{proof-101}{}
\hypertarget{p-746}{}%
Of Zapponi.%
\par
\hypertarget{p-747}{}%
Let \(\phi\colon X \to \PP^1\) be a Belyi map of degree \(n\). Let \(K\) be the \hyperref[def-field-of-moduli]{field of moduli} of \(X\), \(M\) the \hyperref[def-field-of-moduli]{field of moduli} of \(\phi\) then \(M/K\) is a finite extension. Take \(G\) as above and let \(\ideal p \subseteq \ints_K\) be a place of bad semistable reduction for \(X\). Then \(\wp| \ideal p\) for \(\wp \subseteq \ints_M\) is a place of bad semistable reduction for \(\phi\). By \hyperref[thm-beckmann]{Theorem~\ref{thm-beckmann}} \(p \mid |G|\) for \(p\in \ZZ\) below \(\ideal p\) but \(G \hookrightarrow S_n\) which implies \(p|n!\) so \(p\le n\).%
\end{proof}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.11.2 Finitists Dream}
\typeout{************************************************}
%
\begin{subsectionptx}{Finitists Dream}{}{Finitists Dream}{}{}\label{subsection-65}
\hypertarget{p-748}{}%
Recall that if \(k \) is a perfect field of characteristic \(p\) then%
\begin{equation*}
\phi \colon C_1 \to C_2
\end{equation*}
is said to be tamely \hyperref[def-dess-ramified]{ramified} at \(P\in C_1\) if \(p\nmid e_\phi(P)\) (wildly \hyperref[def-dess-ramified]{ramified} if \(p |e_\phi(P)\)).%
\begin{theorem}{Wild \(p\)-Belyi.}{}{theorem-58}%
\hypertarget{p-749}{}%
For \(C\) a curve over \(k\) perfect of characteristic \(p\), there exists a ``wild Belyi map''%
\begin{equation*}
\phi \colon C\to \PP^1
\end{equation*}
such that \(B(\phi) = \{\infty\}\). I.e. every curve \(/k\) is \hyperref[def-birational]{birational} to an \hyperref[def-etale]{étale} cover of \(\aff^1\).%
\end{theorem}
\begin{example}{}{example-37}%
\hypertarget{p-750}{}%
%
\begin{equation*}
\mathbf G_m \to \aff^1
\end{equation*}
%
\begin{equation*}
x \mapsto x^p + \frac 1x
\end{equation*}
but the tame \hyperref[def-etale]{étale} fundamental group of \(\aff^1\) is 0.%
\end{example}
\begin{theorem}{Tame \(p\)-Belyi (Saidi).}{}{theorem-59}%
\hypertarget{p-751}{}%
Let \(p \gt 2\). For \(C/\overline \FF_p\) there exists \(\phi\colon C \to \PP^1\) tamely \hyperref[def-dess-ramified]{ramified} everywhere (i.e. possibly unramified) with%
\begin{equation*}
B(\phi) \subseteq \{0,1,\infty\}\text{.}
\end{equation*}
%
\end{theorem}
\begin{lemma}{Fulton.}{}{lemma-15}%
\hypertarget{p-752}{}%
Let \(p \gt 2\) then for \(C/k\) (\(k\) algebraically closed of characteristic \(p\)) there exists \(\psi \colon C\to \PP^1\) such that%
\begin{equation*}
e_\psi(P) \le 2\text{.}
\end{equation*}
%
\end{lemma}
\begin{proof}\hypertarget{proof-102}{}
\hypertarget{p-753}{}%
Of Tame \(p\)-Belyi%
\par
\hypertarget{p-754}{}%
Take \(\psi \colon C\to \PP^1\) as in the lemma then%
\begin{equation*}
B(\psi) \subseteq \PP^1(\FF_{p^m})
\end{equation*}
for some \(m\). Define%
\begin{equation*}
f\colon \PP^1\to \PP^1
\end{equation*}
by%
\begin{equation*}
x\mapsto x^{p^m -1}\text{.}
\end{equation*}
Take \(\phi = f\circ \psi\). So \(\pi\) is tamely \hyperref[def-dess-ramified]{ramified} everywhere and \(B(\phi) \subseteq \{0,1,\infty\}\).%
\end{proof}
\hypertarget{p-755}{}%
Analogue of Fulton's lemma is that there exists%
\begin{equation*}
\tau \colon C\to \PP^1
\end{equation*}
for \(\characteristic (k) \ne 3\) such that \(e_\tau(P) = 1\) or \(3\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.11.3 In the Stacks}
\typeout{************************************************}
%
\begin{subsectionptx}{In the Stacks}{}{In the Stacks}{}{}\label{subsection-66}
\begin{observation}{}{observation-2}%
\hypertarget{p-756}{}%
\(\PP^1 \smallsetminus \{0,1,\infty\}\) is the moduli space of \hyperref[def-class-set]{genus} 0 curves with four (ordered) marked points.%
\begin{equation*}
(\PP^1, \alpha_1,\alpha_2,\alpha_3,\alpha_4) \mapsto \image(\alpha_4) \text{ when } \alpha_1 \mapsto 0,\alpha_2\mapsto 1, \alpha_3 \mapsto \infty\text{.}
\end{equation*}
%
\end{observation}
\begin{definition}{}{definition-67}%
\hypertarget{p-757}{}%
Let \(\mathcal M_{g,n}\) be the moduli space of \hyperref[def-class-set]{genus} \(g\) curves with \(n\) (ordered) marked points (then \(\mathcal M_{g,\lb n\rb}\) is the same for unordered points). If \(n\) is large enough relative to \(g\) then \(\mathcal M_{g,n}\) will be a scheme (but the unordered version will not).%
\end{definition}
\begin{example}{}{example-38}%
\hypertarget{p-758}{}%
%
\begin{equation*}
\mathcal M_{0,4} \simeq \PP^1 \smallsetminus \{0,1,\infty\}
\end{equation*}
%
\end{example}
\begin{question}{Braungardt.}{question-1}%
\hypertarget{p-759}{}%
Is every \(X/\overline \QQ\) (smooth projective variety) \hyperref[def-birational]{birational} to a finite \hyperref[def-etale]{étale} cover of some \(\mathcal M_{g,\lb n \rb}\)?%
\end{question}
\begin{note}{}{note-9}%
\hypertarget{p-760}{}%
There exists an \hyperref[def-etale]{étale} map%
\begin{equation*}
\mathcal M_{g,n} \to \mathcal M_{g,[n]}
\end{equation*}
by forgetting the ordering of the points.%
\end{note}
\hypertarget{p-761}{}%
So the dimension 1 case of the conjecture is Belyi's theorem, by%
\begin{equation*}
X\smallsetminus \phi\inv (B(\phi)) \to \PP^1 \smallsetminus \{0,1,\infty\} \simeq \mathcal M_{0,4} \to\mathcal M_{0,[4]}\text{.}
\end{equation*}
%
\par
\hypertarget{p-762}{}%
In dimension 2 we have \(\mathcal M_{1,\lb 2 \rb}\) and \(\mathcal M_{0,\lb 5 \rb}\), the only 2-d spaces of interest. We also  have an \hyperref[def-etale]{étale} map%
\begin{equation*}
\mathcal M_{1,[2]} \xrightarrow\alpha \mathcal M_{0,[5]}
\end{equation*}
as follows:%
\begin{equation*}
\eta = (E; \{q_1,q_2\}) \in \mathcal M_{1,[2]}
\end{equation*}
with%
\begin{equation*}
\alpha(\eta) = (\PP^1; \{r_1,r_2,r_3,r_4,r_5\})
\end{equation*}
where the \(r_i\) come from constructing a projection \(\phi\) from \(E\) to \(\PP^1\) situated perpendicularly to the line joining \(q_1,q_2\). This then has 4 ramification points%
\begin{equation*}
B(\phi) = \{r_1,r_2,r_3,r_4\}
\end{equation*}
and \(r_5 = \phi(q_1) = \phi(q_2)\). So Braungardt for surfaces \((X/\overline \QQ)\)? Does there exist \(\phi \colon X \to \mathcal M_{0,\lb 5 \rb}\) which is \hyperref[def-etale]{étale}?%
\begin{theorem}{Braungardt.}{}{theorem-60}%
\hypertarget{p-763}{}%
For \(X/\overline \QQ\) an abelian surface \(X\) is \hyperref[def-birational]{birational} to an \hyperref[def-etale]{étale} cover of \(\mathcal M_{0,\lb 5 \rb}\).%
\end{theorem}
\begin{proof}\hypertarget{proof-103}{}
\hypertarget{p-764}{}%
Sketch.%
\par
\hypertarget{p-765}{}%
For an abelian surface over \(\overline \QQ\) there exists another isogenous to it which is principally polarized. Such surfaces come in two flavours%
\begin{equation*}
E_1 \times E_2
\end{equation*}
or \(J(C)\) for \(C\) of \hyperref[def-class-set]{genus} 2.%
\par
\hypertarget{p-766}{}%
Case 1:%
\par
\hypertarget{p-767}{}%
Let \(\phi_i \colon E_i \to \PP^1\smallsetminus \{0,1,\infty\}\) be Belyi maps. Then we have \(\alpha \colon A \xrightarrow{\phi_1,\phi_2} \PP^1 \times \PP^1\). Then \(\alpha\) restricts to a finite unramified cover%
\begin{equation*}
\alpha\inv (S) \xrightarrow \alpha S
\end{equation*}
where%
\begin{equation*}
S = (\PP^1 \smallsetminus \{0,1,\infty\} \times \PP^1 \smallsetminus \{0,1,\infty\}) \smallsetminus \Delta\text{.}
\end{equation*}
Note that \(S \simeq \mathcal M_{0,5}\) by%
\begin{equation*}
(a,b ) \mapsto (\PP^1; \{0,1,\infty, a,b\})\text{.}
\end{equation*}
So \(A\) is \hyperref[def-birational]{birational} to \(\alpha\inv (S)\) which is an \hyperref[def-etale]{étale} cover of \(\mathcal M_{0,\lb 5 \rb}\).%
\par
\hypertarget{p-768}{}%
Case 2%
\par
\hypertarget{p-769}{}%
If \(A = J(C)\) then use \(\phi \colon C \to \PP^1\) and a relation between \(A\) and \(\Sym^2(C)\).%
\end{proof}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.12 Dessins in Physics (Jim)}
\typeout{************************************************}
%
\begin{sectionptx}{Dessins in Physics (Jim)}{}{Dessins in Physics (Jim)}{}{}\label{sec-dessins-physics}
\begin{paragraphs}{Physics.}{paragraphs-21}%
\hypertarget{p-770}{}%
Let  \(M\)  be a manifold with  a metric \(g\). We call the pair \((M,g)\) a ``spacetime manifold''. Let \(\mathcal E\) be  a ``space of fields'', either \(\cinf (M)\), sections of some \(E\to M\), connections, or similar.%
\begin{equation*}
S(\phi) = \int_M \mathcal    L (\phi)
\end{equation*}
for \(\phi\in \mathcal E\) and \(\mathcal L\) the Lagrangian. ``Physically realisable states'' are then fields \(\phi\) that minimise \(S(\phi)\). \(W\) is a superpotential, this is a term in \(\mathcal L\) that satisfies some special symmetries. E.g. we could also have%
\begin{equation*}
S(\phi_1, \phi_2) = \int_M \mathcal L(\phi_1,\phi_2)
\end{equation*}
the \(W\) might satisfy \(W(\phi_1, \phi_2) = W(\phi_2, \phi_1)\).%
\begin{definition}{Gauge transformations.}{def-gauge-transformations}%
\hypertarget{p-771}{}%
Let \(G \acts E \xrightarrow p M\) be an action s.t. each fibre \(E_x = p \inv(x)\) is a representation of \(G\). A \terminology{gauge} is a section \(s(x)\) of \(E \to M\). A \terminology{gauge transformation} is a map \(g\colon M \to G\) s.t.%
\begin{equation*}
g(x) s(x)
\end{equation*}
is another section, call \(G\) the \terminology{gauge group}. The important \hyperref[def-gauge-transformations]{gauge transformations} are the ones that fix the set of physically realisable states (i.e. fixes the subset of \(\mathcal E\) that minimise \(S\)).%
\end{definition}
\end{paragraphs}%
\begin{paragraphs}{Quivers and dessins.}{paragraphs-22}%
\hypertarget{p-772}{}%
Let's now study the relationship between quivers and \hyperref[def-dessin-denfant]{dessins}.%
\begin{example}{}{example-39}%
\hypertarget{p-773}{}%
\(\mathcal N = 4\) SYM (supersymmetric Yang-Mills) (Gauge symmetries given by some product of \(\specialunitary (N)\)) .%
\end{example}
\hypertarget{p-774}{}%
A quiver is a directed graph, possibly with self-loops. Here we think of the nodes as corresponding to factors of the \hyperref[def-gauge-transformations]{gauge group}. And the arrows as fields, so in a bouquet with 3 petals we have three fields, and only \(G = \specialunitary (N)\).%
\par
\hypertarget{p-775}{}%
There is also the notion of a periodic quiver (a tiling of the plane). We can take the triangular \hyperref[def-buntes-lattice]{lattice} and consider its dual, this is a hexagonal tiling with a bicolouring corresponding to the fact we had upwards pointing and downwards pointing triangles. This is a Dimer model.%
\par
\hypertarget{p-776}{}%
Relating the Dimer model back to physics: We have hexagonal faces in correspondence with factors of the \hyperref[def-gauge-transformations]{Gauge group}, and edges fields, with vertices terms in \(W\).%
\par
\hypertarget{p-777}{}%
So one distinct face gives one factor in the \hyperref[def-gauge-transformations]{gauge group} so \(G = \specialunitary (N)\). 3 distinct edges give 3 fields \(X_1, X_2, X_3\). To recover \(W\) consider the permutation arising from reading the edges around the vertices counterclockwise. A black vertex \((1,2,3)\) gives \(\sigma_B\) corresponding to a positive term in \(W\). A white vertex \((1,2,3)\) gives \(\sigma_W\) corresponding to a negative term in \(W\). Then \(\sigma_\infty = (\sigma_B\sigma_W)\inv = (123)\) \(\sigma_i\) gives a term for each cycle. Each cycle in \(\sigma_B\) gives a product of fields indexed by the cycle, e.g. in this example \(\sigma_B\) gives \(X_1X_2X_3\). Each cycle in \(\sigma_W\inv\) gives a product of fields indexed by the cycle, e.g. in this example \(\sigma_W\) gives \(X_1X_3X_2\). Then%
\begin{equation*}
W = \trace((\text{sim of }\sigma_B\text{ terms}) - (\text{sim of }\sigma_W\text{ terms}))
\end{equation*}
%
\begin{equation*}
= \trace(X_1X_2X_3 - X_1X_3X_2)\text{.}
\end{equation*}
%
\par
\hypertarget{p-778}{}%
%
\begin{equation*}
\Aut( \{\sigma_B,\sigma_W,\sigma_\infty\}) = \{ \gamma\in S_3: \gamma\sigma_i \gamma\inv = \sigma_i)
\end{equation*}
%
\begin{equation*}
= \{1,(123), (132)\}
\end{equation*}
%
\begin{equation*}
= \ZZ/3\ZZ\text{.}
\end{equation*}
%
\par
\hypertarget{p-779}{}%
The fundamental domain of the Dimer gives a \hyperref[def-dessin-denfant]{dessin} on the torus with two vertices of degree 3. This corresponds to the Belyi pair \((\Sigma, \beta)\) where%
\begin{equation*}
\Sigma \colon y^2 = x^3 + 1
\end{equation*}
%
\begin{equation*}
\beta \colon \Sigma  \to \PP^1
\end{equation*}
%
\begin{equation*}
(x,y) \mapsto \frac{y+1}{2}\text{.}
\end{equation*}
%
\begin{equation*}
\Aut(\Sigma, \beta) \simeq \Aut(\{\sigma_B,\sigma_W, \sigma_\infty\})
\end{equation*}
\(\Aut(\Sigma, \beta)\) is generated by%
\begin{equation*}
(x,y) \mapsto (w^3 x,y)
\end{equation*}
where \(w^3 = 1\).%
\begin{example}{}{example-40}%
\hypertarget{p-780}{}%
Take the quiver with two vertices and two edges in each direction connecting them. This has 4 fields and two factors of \(G\) (i.e. \(G = \specialunitary (N) \times \specialunitary (N)\)). The dimer is a square \hyperref[def-buntes-lattice]{lattice} alternately coloured, with \(\sigma_B = \sigma_W = (1234), \sigma_\infty = (13)(24)\).%
\begin{equation*}
W = \trace (X_1X_2X_3X_4 - X_1 X_4 X_3 X_2)\text{.}
\end{equation*}
In this case the Belyi pair is%
\begin{equation*}
\Sigma \colon y^2= x(x-1)(x-\frac12)
\end{equation*}
%
\begin{equation*}
\beta = \frac{x^2}{2x-1}\text{.}
\end{equation*}
%
\begin{equation*}
\Aut(\{\sigma_B,\sigma_W, \sigma_\infty\}) = \langle (1234) \rangle \simeq \ZZ/4\ZZ
\end{equation*}
%
\begin{equation*}
\phi_\pm \colon (x,y) \mapsto \left(\frac{x}{2x -1},\frac{\pm i}{(2x-1)^2} \right)
\end{equation*}
%
\begin{equation*}
\phi_+^2 = \phi_-^2 \colon (x,y) \mapsto (x,-y)
\end{equation*}
%
\begin{equation*}
\phi_+^3 = \phi_+\inv = \phi_-
\end{equation*}
%
\begin{equation*}
\phi_+^4 = 1
\end{equation*}
so%
\begin{equation*}
\Aut(\Sigma, \beta) \simeq \ZZ/4\ZZ
\end{equation*}
%
\begin{equation*}
\beta\inv(0)= \{(0,0)\}
\end{equation*}
%
\begin{equation*}
\beta\inv(1)= \{(1,0)\}
\end{equation*}
%
\begin{equation*}
\beta\inv(\infty)= \{(\frac 12,0), (\infty,\infty)\}
\end{equation*}
on the Dimer we have the square \hyperref[def-buntes-lattice]{lattice} so taking a fundamental domain containing  of the vertices we see the torus as a topology.%
\end{example}
\begin{example}{Final example.}{example-41}%
\hypertarget{p-781}{}%
Let's jump straight to the Dimer the hexagonal \hyperref[def-buntes-lattice]{lattice} with fundamental domain containing 6 vertices. We have 9 fields and three factors in the \hyperref[def-gauge-transformations]{gauge group} \(G = \specialunitary (N)^2\).%
\begin{equation*}
\sigma_B = (147)(258)(369)
\end{equation*}
%
\begin{equation*}
\sigma_W = (123)(456)(789)
\end{equation*}
%
\begin{equation*}
\sigma_\infty = (195)(276)(384)
\end{equation*}
so%
\begin{equation*}
W = \trace \sum_{i,j,k} X_{12}^iX_{23}^j X_{31}^k \epsilon_{ijk}
\end{equation*}
where%
\begin{equation*}
\epsilon_{ijk} = \begin{cases} \sgn(ijk) \amp\text{if }i,j,k \text{ distinct}\\ 0 \amp\text{otw}\end{cases}
\end{equation*}
\(X_{12}^i\) acts on the \(i\)th field by \(N, \bar N, 1\) where \(N\) is the canonical representation, \(\bar N\) the anticanonical and \(1\) is trivial.%
\begin{equation*}
\Aut(\{\sigma_B,\sigma_W, \sigma_\infty\})  \simeq \ZZ/3\ZZ\times \ZZ/3\ZZ
\end{equation*}
now the Belyi pair%
\begin{equation*}
\Sigma = \text{projective closure of } F = \{(x,y) : x^3+ y^3 =1\}
\end{equation*}
%
\begin{equation*}
\beta(x,y) = x^3
\end{equation*}
%
\begin{equation*}
\gamma_1(x,y) = (w_1 x, y)
\end{equation*}
%
\begin{equation*}
\gamma_2(x,y) = (x,w_2  y)
\end{equation*}
%
\begin{equation*}
w_i^3 = 1\text{.}
\end{equation*}
%
\end{example}
\end{paragraphs}%
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 3 Supersingular isogeny graphs and Quaternion Algebras}
\typeout{************************************************}
%
\begin{chapterptx}{Supersingular isogeny graphs and Quaternion Algebras}{}{Supersingular isogeny graphs and Quaternion Algebras}{}{}\label{chapter-supersing-isog}
\begin{introduction}{}%
\hypertarget{p-782}{}%
These are notes for BUNTES Fall 2018, the topic is Supersingular \hyperref[def-supersing-isog-isog]{isogeny} graphs and Quaternion Algebras.%
\par
\hypertarget{p-783}{}%
\url{http://math.bu.edu/people/midff/buntes/fall2018.html}.%
\par
\hypertarget{p-784}{}%
Outline:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-178}{}Background, \hyperref[def-supersing-isog-isog]{isogeny} graphs, applications.%
\item\hypertarget{li-179}{}Supersingular \hyperref[def-supersing-isog-isog]{isogeny} graph cryptography (candidate for post-quantum cryptography).%
\item\hypertarget{li-180}{}Introduction to Quaternion algebras.%
\item\hypertarget{li-181}{}The Deuring correspondence:%
\begin{equation*}
\left\{ \text{maximal orders }\ints \subseteq B_{p,\infty}\right\}/\sim \leftrightarrow \left\{ j \text{ s.s. }\in \FF_{p^2}\right\}/\Gal{\FF_{p^2}}{\FF_p}\text{.}
\end{equation*}
%
\end{enumerate}
%
\par
\hypertarget{p-785}{}%
References: [\hyperlink{bib-sutherland}{62}, \hyperlink{bib-voight-quat}{68}, \hyperlink{bib-velu}{67}]%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 3.1 Isogeny graphs: background and motivation (Maria Ines)}
\typeout{************************************************}
%
\begin{sectionptx}{Isogeny graphs: background and motivation (Maria Ines)}{}{Isogeny graphs: background and motivation (Maria Ines)}{}{}\label{sec-supersing-isog-graphs}
%
%
\typeout{************************************************}
\typeout{Subsection 3.1.1 Background}
\typeout{************************************************}
%
\begin{subsectionptx}{Background}{}{Background}{}{}\label{subsec-supersing-isog-background}
\hypertarget{p-786}{}%
Let \(k = \FF_q\), \(\characteristic (k) = p \ne 2,3\).%
\begin{definition}{Elliptic curves.}{def-supersing-isog-ec}%
\hypertarget{p-787}{}%
An \terminology{elliptic curve} \(E/k\) is a smooth projective curve of \hyperref[def-class-set]{genus} 1 together with a point \(\infty \in E(k)\).%
\end{definition}
\hypertarget{p-788}{}%
We can always write such a curve using a Weierstrass equation%
\begin{equation*}
E\colon y^2=  x^3  + ax  +b,\,a,b    \in k
\end{equation*}
\(E\) is really the projective closure of this affine equation.%
\begin{definition}{\(j\)-invariants.}{def-supersing-isog-j-inv}%
\hypertarget{p-789}{}%
The \(j\)-invariant of an \hyperref[def-supersing-isog-ec]{elliptic curve} \(E\) is%
\begin{equation*}
j(E) = j(a,b) = 1728 \frac{4a^3}{4a^3 + 27b^2}
\end{equation*}
doesn't depend on the choice of Weierstrass equation.%
\end{definition}
\begin{fact}{}{}{fact-7}%
\hypertarget{p-790}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-182}{}\(E,E'\) are isomorphic over \(\overline k \iff j(E)  = j(E')\).%
\item\hypertarget{li-183}{}There is a 1-1 correspondence%
\begin{equation*}
k \leftrightarrow \overline k \text{-isomorphism classes of EC's }/k\text{.}
\end{equation*}
%
\end{enumerate}
%
\end{fact}
\begin{definition}{Isogenies.}{def-supersing-isog-isog}%
\hypertarget{p-791}{}%
Let \(E,E'/k\) be \hyperref[def-supersing-isog-ec]{elliptic curves}. An \terminology{isogeny}, \(\phi \colon E\to E'\) is a non-constant morphism of pointed curves. The degree \(\deg \phi \) is the degree as a morphism. \(E,E'\) are said to be \(n\)-isogenous if there exists \(\phi\colon E\to E'\) of degree \(n\). \(j,j'\in k\) are \(n\)-isogenous if the corresponding \hyperref[def-supersing-isog-ec]{elliptic curves} are.%
\end{definition}
\begin{fact}{}{}{fact-8}%
\hypertarget{p-792}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-184}{}If \(p \nmid n = \deg \phi\) then the kernel of \(\phi\) has size \(n\) (\(\phi\) is separable).%
\item\hypertarget{li-185}{}every finite subgoup of \(E(\overline k )\) is the kernel of a separable \hyperref[def-supersing-isog-isog]{isogeny} from \(E\), unique up to isomorphism.%
\item\hypertarget{li-186}{}Every \(n\)-\hyperref[def-supersing-isog-isog]{isogeny} \(\phi\colon E \to E'\) has  a dual \hyperref[def-supersing-isog-isog]{isogeny} \(\hat \phi \colon E' \to E\) such that%
\begin{equation*}
\phi\circ \hat\phi = \hat\phi \circ \phi = \lb n \rb\text{,}
\end{equation*}
the multiplication-by-\(n \) map.%
\item\hypertarget{li-187}{}The \(n\)-torsion subgroup%
\begin{equation*}
E\lb n \rb = \left\{ P \in E(\overline k) : nP = \infty\right\}
\end{equation*}
is isomorphic to \((\ZZ/n)^2\) if \(p\nmid n\).%
\end{enumerate}
%
\end{fact}
\begin{lemma}{}{}{lemma-16}%
\hypertarget{p-793}{}%
Let \(E/k\) be an \hyperref[def-supersing-isog-ec]{elliptic curve} with \(j(E) \not\in\{0,1728\}\) and let \(l\ne p\) be prime, up to isomorphism the number of \(l\)-\hyperref[def-supersing-isog-isog]{isogenies} from \(E\) defined over \(k\) is 0,1,2 or \(l+1\).%
\end{lemma}
\begin{proof}\hypertarget{proof-104}{}
\hypertarget{p-794}{}%
In Maria's notes.%
\end{proof}
\begin{paragraphs}{The modular equation.}{paragraphs-23}%
\hypertarget{p-795}{}%
Let \(j(\tau)\) be the modular \(j\)-function. For each prime \(l\) the minimal polynomial \(\phi_l\) of \(j(l\tau)\) over \(\CC (j(\tau))\) is the modular polynomial%
\begin{equation*}
\phi_l \in \ZZ[j(\tau)][y] \simeq \ZZ[x,y]\text{.}
\end{equation*}
%
\begin{fact}{}{}{fact-9}%
\hypertarget{p-796}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-188}{}\(\phi_l\) is \hyperref[def-princ-pol]{symmetric} in \(x,y\) and has a degree \(l+1\) in both variables.%
\item\hypertarget{li-189}{}The modular equation%
\begin{equation*}
\phi_l (x,y) = 0
\end{equation*}
is a canonical model for%
\begin{equation*}
Y_0(l) = \Gamma_0(l) \backslash \HH
\end{equation*}
it parameterises pairs of \hyperref[def-supersing-isog-ec]{elliptic curves} related by an \(l\)-\hyperref[def-supersing-isog-isog]{isogeny}. This moduli interpretation is still valid when we use any field \(F\) with \(\characteristic(F) \ne l\).%
\item\hypertarget{li-190}{}Let \(m_l(j,j') = \ord_{t = j'} \phi_l(j,t)\), whenever \(j,j' \ne 0,1728\),%
\begin{equation*}
m_l(j,j') = m_l(j',j)\text{.}
\end{equation*}
%
\end{enumerate}
%
\end{fact}
\end{paragraphs}%
\begin{paragraphs}{The endomorphism ring.}{paragraphs-24}%
\begin{definition}{Endomorphisms of elliptic curves.}{def-supersing-isog-endo}%
\hypertarget{p-797}{}%
An \terminology{endomorphism} of an \hyperref[def-supersing-isog-ec]{elliptic curve} \(E\) is either the zero map or an \hyperref[def-supersing-isog-isog]{isogeny} from \(E\) to itself. They form a ring \(\End(E)\).%
\end{definition}
\hypertarget{p-798}{}%
For \(n \in ZZ\) we ahve \(\lb n \rb \in \End(E)\) so \(\ZZ \subseteq \End(E)\) over a finite field \(k\), \(\End(E)\) is always larger than \(\ZZ\). It is either an \hyperref[def-order-quaternion]{order} in an imaginary quadratic field, in which case we say \(E\) is ordinary. Or an \hyperref[def-order-quaternion]{order} in an quaternion algebra, in which case we say \(E\) is supersingular. We say \(E\) has complex multiplication by \(\ints\).%
\begin{proposition}{}{}{proposition-59}%
\hypertarget{p-799}{}%
Let \(E/k = \FF_{p^n}\) be an \hyperref[def-supersing-isog-ec]{elliptic curve}, TFAE\leavevmode%
\begin{enumerate}
\item\hypertarget{li-191}{}\(E\) is supersingular.%
\item\hypertarget{li-192}{}\(E\lb p\rb\) is trivial.%
\item\hypertarget{li-193}{}The map \(\lb p\rb \colon E\to E\) is purely inseparable and \(j(E) \in \FF_{p^2}\).%
\end{enumerate}
%
\end{proposition}
\begin{note}{}{note-10}%
\hypertarget{p-800}{}%
If \(E,E'\) are isogenous \hyperref[def-supersing-isog-ec]{elliptic curves} then \(\End(E) \otimes_\ZZ \QQ \simeq \End(E')\otimes_\ZZ \QQ\). So supersingularity is preserved by \hyperref[def-supersing-isog-isog]{isogenies}.%
\end{note}
\end{paragraphs}%
\begin{paragraphs}{Isogeny graphs of elliptic curves.}{paragraphs-25}%
\hypertarget{p-801}{}%
Let \(k = \FF_q\) with \(\characteristic(k) = p\) and \(l \ne p \) be prime.%
\begin{definition}{Isogeny graphs.}{def-supersing-isog-graph}%
\hypertarget{p-802}{}%
The \(l\)-\hyperref[def-supersing-isog-isog]{isogeny} graph \(G_l(k)\) is the directed graph with vertex set \(k\) and edges \((j,j')\) present with \hyperref[def-riem-order-vanish]{multiplicity}%
\begin{equation*}
m_j(l,l') = \ord_{t=j} \phi_l(j,t)
\end{equation*}
vertices are \(\overline k\) isomorphism classes of  \hyperref[def-supersing-isog-ec]{elliptic curves} \(/k\), edges are isomorphism classes of \(l\)-\hyperref[def-supersing-isog-isog]{isogenies} defined over \(k\).%
\end{definition}
\hypertarget{p-803}{}%
Since \(m_l(j,j') =  m(j',j)\) whenever \(j,j' \ne  0,1728\) the subgraph of \(G_l(k)\) supported on \(k\smallsetminus \{0,1728\}\) can be thought of as undirected. By the last note \(G_l(k)\) consists of ordinary and supersingular components.%
\end{paragraphs}%
\begin{paragraphs}{Supersingular isogeny graphs.}{paragraphs-26}%
\hypertarget{p-804}{}%
Since every supersingular \(j\)-invariant lives in \(\FF_{p^2}\) if \(E\) is supersingular all roots of \(\phi_l(j(E), y)\) live in \(\FF_{p^2}\). Every vertex in a supersingular component has out-degree \(l+1\).%
\par
\hypertarget{p-805}{}%
Moreover by a result of Kohel \(G_l(\FF_{p^2})\) has only one supersingular component.%
\par
\hypertarget{p-806}{}%
By the above if \(p \equiv 1 \pmod {12}\) then the supersingular component of \(G_l(\FF_{p^2})\) is an undirected \((l+1)\)-regular graph with around \(p/12\) vertices.%
\begin{theorem}{Pizer.}{}{theorem-61}%
\hypertarget{p-807}{}%
The supersingular component of \(G_l(\FF_{p^2})\) is a \hyperref[def-supersing-isog-ramanujan]{Ramanujan graph}.%
\end{theorem}
\begin{definition}{Ramanujan graphs.}{def-supersing-isog-ramanujan}%
\hypertarget{p-808}{}%
A connected \(d\)-regular graph is a \terminology{Ramanujan graph} if \(\lambda_2 \le \sqrt{d-1}\) where \(\lambda_2\) is the second largest eigenvalue of its adjacent matrix. (The largest one is always \(d\), by \(d\)-regularity.)%
\end{definition}
\end{paragraphs}%
\begin{paragraphs}{Ordinary isogeny graphs.}{paragraphs-27}%
\hypertarget{p-809}{}%
Let \(E/\FF_q\) be an ordinary \hyperref[def-supersing-isog-ec]{elliptic curve}, then \(\End(E) \simeq \ints\) is an \hyperref[def-order-quaternion]{order} in an imaginary quadratic field \(K\) with \(\ZZ\lb \pi \rb \subseteq \ints \subseteq \ints_K\) where \(\pi\) is Frobenius and%
\begin{equation*}
K = \QQ(\sqrt{(\trace \pi)^2 - 4q})
\end{equation*}
by Tate, isogenous \hyperref[def-supersing-isog-ec]{elliptic curves} have the same \(\trace \pi\).%
\par
\hypertarget{p-810}{}%
We can separate the vertices in the component \(V\) of \(G_l(k)\) containing \(j(E)\) into levels \(V_0, \ldots, V_d\) so that \(j(E') \in V_i\) if \(i = v_l(\lb \ints_K : \ints'\rb)\). We'll see that \(\bigcup_{i=0}^d V_i\) is connected.%
\par
\hypertarget{p-811}{}%
Let \(\phi\colon E\to E'\) be an \(l\)-\hyperref[def-supersing-isog-isog]{isogeny} between two \hyperref[def-supersing-isog-ec]{elliptic curves} with CM by \(\ints = \ZZ+\tau\ZZ\), \(\ints ' = \ZZ+\tau'\ZZ\). Then \(\hat\phi \tau' \phi \in \End(E) \implies l\tau ' \in \ints\). Similarly \(l\tau \in \ints'\). There are 3 cases\leavevmode%
\begin{enumerate}
\item\hypertarget{li-194}{}\(\ints = \ints'\) (\(\phi\) is horizontal).%
\item\hypertarget{li-195}{}\(\lb\ints : \ints' \rb = l\) (\(\phi\) is descending).%
\item\hypertarget{li-196}{}\(\lb\ints' : \ints \rb = l\) (\(\phi\) is ascending).%
\end{enumerate}
In the last two cases we say \(\phi\) is critical.%
\end{paragraphs}%
\begin{paragraphs}{Horizontal isogenies.}{paragraphs-28}%
\hypertarget{p-812}{}%
\(E/k\) with CM by \(\ints \subseteq K\) imaginary quadratic. Let \(\ideal a\) be an invertible ideal.%
\begin{equation*}
E\lb \ideal a \rb = \{ P \in E(\overline k) : \alpha (P)  = 0\, \forall \alpha \in \ideal a\}
\end{equation*}
this is a finite group so it is the kernel of a separable \hyperref[def-supersing-isog-isog]{isogeny} \(\phi_{\ideal a }\). If \(p \nmid N(\ideal a)\) then \(\deg(\phi_{\ideal a}) = N(\ideal a)\) with \(\ideal a\) invertible implying \(\phi_{\ideal a} \) is horizontal.%
\par
\hypertarget{p-813}{}%
Each horizontal \(l\)-\hyperref[def-supersing-isog-isog]{isogeny} \(\phi\) arises from some invertible ideal \(\ideal a\) of norm \(l\).%
\par
\hypertarget{p-814}{}%
If \(l | \lb \ints_K : \ints \rb \) no such ideals exist, otherwise the number of invertible ideals of norm \(l\) is%
\begin{equation*}
1+ \left(\frac {\disc(K)}{l}\right) = \begin{cases}0\amp\text{ if }l \text{ inert }\\ 1\amp\text{ if }l \text{ ramified }\\ 2\amp\text{ if }l \text{ splits}\end{cases}
\end{equation*}
%
\end{paragraphs}%
\begin{paragraphs}{Vertical isogenies.}{paragraphs-29}%
\hypertarget{p-815}{}%
Let \(\ints\) be an \hyperref[def-order-quaternion]{order} in an imaginary quadratic field \(K \) of discriminant \(D \lt -4\) and let \(\ints' = \ZZ+l\ints\).%
\begin{lemma}{}{}{lemma-17}%
\hypertarget{p-816}{}%
Let \(E' / k\)  be an \hyperref[def-supersing-isog-ec]{elliptic curve} with CM by \(\ints '\) then there is a  unique ascending \(l\)-\hyperref[def-supersing-isog-isog]{isogeny} \(E'\to E\) with \(E/k\) an \hyperref[def-supersing-isog-ec]{elliptic curve} with CM by \(\ints\).%
\end{lemma}
\begin{definition}{}{definition-75}%
\hypertarget{p-817}{}%
An \(l\)-volcano \(V\) is a connected undirected graph whose vertices are partitioned into levels \(V_0, \ldots, V_d\).\leavevmode%
\begin{enumerate}
\item\hypertarget{li-197}{}The subgraph \(V_0\) is regular of degree \(\le 2\).%
\item\hypertarget{li-198}{}For each \(i \gt 0\) each vertex in \(V_i\) has exactly one neighbour in level \(V_{i-1}\), and this accounts for all edges outside of \(V_0\).%
\item\hypertarget{li-199}{}For \(i \lt d\) each vertex has degree \(l+1\).%
\end{enumerate}
The number \(d\) is the depth.%
\end{definition}
\begin{figure}
\centering
{
\begin{tikzpicture}
\definecolor{cv0}{rgb}{0.0,0.0,0.0}
\definecolor{cfv0}{rgb}{1.0,1.0,1.0}
\definecolor{clv0}{rgb}{0.0,0.0,0.0}
\definecolor{cv1}{rgb}{0.0,0.0,0.0}
\definecolor{cfv1}{rgb}{1.0,1.0,1.0}
\definecolor{clv1}{rgb}{0.0,0.0,0.0}
\definecolor{cv2}{rgb}{0.0,0.0,0.0}
\definecolor{cfv2}{rgb}{1.0,1.0,1.0}
\definecolor{clv2}{rgb}{0.0,0.0,0.0}
\definecolor{cv3}{rgb}{0.0,0.0,0.0}
\definecolor{cfv3}{rgb}{1.0,1.0,1.0}
\definecolor{clv3}{rgb}{0.0,0.0,0.0}
\definecolor{cv4}{rgb}{0.0,0.0,0.0}
\definecolor{cfv4}{rgb}{1.0,1.0,1.0}
\definecolor{clv4}{rgb}{0.0,0.0,0.0}
\definecolor{cv5}{rgb}{0.0,0.0,0.0}
\definecolor{cfv5}{rgb}{1.0,1.0,1.0}
\definecolor{clv5}{rgb}{0.0,0.0,0.0}
\definecolor{cv6}{rgb}{0.0,0.0,0.0}
\definecolor{cfv6}{rgb}{1.0,1.0,1.0}
\definecolor{clv6}{rgb}{0.0,0.0,0.0}
\definecolor{cv7}{rgb}{0.0,0.0,0.0}
\definecolor{cfv7}{rgb}{1.0,1.0,1.0}
\definecolor{clv7}{rgb}{0.0,0.0,0.0}
\definecolor{cv8}{rgb}{0.0,0.0,0.0}
\definecolor{cfv8}{rgb}{1.0,1.0,1.0}
\definecolor{clv8}{rgb}{0.0,0.0,0.0}
\definecolor{cv9}{rgb}{0.0,0.0,0.0}
\definecolor{cfv9}{rgb}{1.0,1.0,1.0}
\definecolor{clv9}{rgb}{0.0,0.0,0.0}
\definecolor{cv10}{rgb}{0.0,0.0,0.0}
\definecolor{cfv10}{rgb}{1.0,1.0,1.0}
\definecolor{clv10}{rgb}{0.0,0.0,0.0}
\definecolor{cv11}{rgb}{0.0,0.0,0.0}
\definecolor{cfv11}{rgb}{1.0,1.0,1.0}
\definecolor{clv11}{rgb}{0.0,0.0,0.0}
\definecolor{cv12}{rgb}{0.0,0.0,0.0}
\definecolor{cfv12}{rgb}{1.0,1.0,1.0}
\definecolor{clv12}{rgb}{0.0,0.0,0.0}
\definecolor{cv13}{rgb}{0.0,0.0,0.0}
\definecolor{cfv13}{rgb}{1.0,1.0,1.0}
\definecolor{clv13}{rgb}{0.0,0.0,0.0}
\definecolor{cv14}{rgb}{0.0,0.0,0.0}
\definecolor{cfv14}{rgb}{1.0,1.0,1.0}
\definecolor{clv14}{rgb}{0.0,0.0,0.0}
\definecolor{cv15}{rgb}{0.0,0.0,0.0}
\definecolor{cfv15}{rgb}{1.0,1.0,1.0}
\definecolor{clv15}{rgb}{0.0,0.0,0.0}
\definecolor{cv16}{rgb}{0.0,0.0,0.0}
\definecolor{cfv16}{rgb}{1.0,1.0,1.0}
\definecolor{clv16}{rgb}{0.0,0.0,0.0}
\definecolor{cv17}{rgb}{0.0,0.0,0.0}
\definecolor{cfv17}{rgb}{1.0,1.0,1.0}
\definecolor{clv17}{rgb}{0.0,0.0,0.0}
\definecolor{cv18}{rgb}{0.0,0.0,0.0}
\definecolor{cfv18}{rgb}{1.0,1.0,1.0}
\definecolor{clv18}{rgb}{0.0,0.0,0.0}
\definecolor{cv19}{rgb}{0.0,0.0,0.0}
\definecolor{cfv19}{rgb}{1.0,1.0,1.0}
\definecolor{clv19}{rgb}{0.0,0.0,0.0}
\definecolor{cv20}{rgb}{0.0,0.0,0.0}
\definecolor{cfv20}{rgb}{1.0,1.0,1.0}
\definecolor{clv20}{rgb}{0.0,0.0,0.0}
\definecolor{cv21}{rgb}{0.0,0.0,0.0}
\definecolor{cfv21}{rgb}{1.0,1.0,1.0}
\definecolor{clv21}{rgb}{0.0,0.0,0.0}
\definecolor{cv22}{rgb}{0.0,0.0,0.0}
\definecolor{cfv22}{rgb}{1.0,1.0,1.0}
\definecolor{clv22}{rgb}{0.0,0.0,0.0}
\definecolor{cv23}{rgb}{0.0,0.0,0.0}
\definecolor{cfv23}{rgb}{1.0,1.0,1.0}
\definecolor{clv23}{rgb}{0.0,0.0,0.0}
\definecolor{cv24}{rgb}{0.0,0.0,0.0}
\definecolor{cfv24}{rgb}{1.0,1.0,1.0}
\definecolor{clv24}{rgb}{0.0,0.0,0.0}
\definecolor{cv25}{rgb}{0.0,0.0,0.0}
\definecolor{cfv25}{rgb}{1.0,1.0,1.0}
\definecolor{clv25}{rgb}{0.0,0.0,0.0}
\definecolor{cv26}{rgb}{0.0,0.0,0.0}
\definecolor{cfv26}{rgb}{1.0,1.0,1.0}
\definecolor{clv26}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v1}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v2}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v9}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v18}{rgb}{0.0,0.0,0.0}
\definecolor{cv1v3}{rgb}{0.0,0.0,0.0}
\definecolor{cv1v4}{rgb}{0.0,0.0,0.0}
\definecolor{cv1v5}{rgb}{0.0,0.0,0.0}
\definecolor{cv2v6}{rgb}{0.0,0.0,0.0}
\definecolor{cv2v7}{rgb}{0.0,0.0,0.0}
\definecolor{cv2v8}{rgb}{0.0,0.0,0.0}
\definecolor{cv9v10}{rgb}{0.0,0.0,0.0}
\definecolor{cv9v11}{rgb}{0.0,0.0,0.0}
\definecolor{cv9v18}{rgb}{0.0,0.0,0.0}
\definecolor{cv10v12}{rgb}{0.0,0.0,0.0}
\definecolor{cv10v13}{rgb}{0.0,0.0,0.0}
\definecolor{cv10v14}{rgb}{0.0,0.0,0.0}
\definecolor{cv11v15}{rgb}{0.0,0.0,0.0}
\definecolor{cv11v16}{rgb}{0.0,0.0,0.0}
\definecolor{cv11v17}{rgb}{0.0,0.0,0.0}
\definecolor{cv18v19}{rgb}{0.0,0.0,0.0}
\definecolor{cv18v20}{rgb}{0.0,0.0,0.0}
\definecolor{cv19v21}{rgb}{0.0,0.0,0.0}
\definecolor{cv19v22}{rgb}{0.0,0.0,0.0}
\definecolor{cv19v23}{rgb}{0.0,0.0,0.0}
\definecolor{cv20v24}{rgb}{0.0,0.0,0.0}
\definecolor{cv20v25}{rgb}{0.0,0.0,0.0}
\definecolor{cv20v26}{rgb}{0.0,0.0,0.0}
%
\Vertex[style={minimum size=1.0cm,draw=cv0,fill=cfv0,text=clv0,shape=circle},LabelOut=false,L=\hbox{$0$},x=2.0163cm,y=2.0254cm]{v0}
\Vertex[style={minimum size=1.0cm,draw=cv1,fill=cfv1,text=clv1,shape=circle},LabelOut=false,L=\hbox{$1$},x=1.203cm,y=0.8898cm]{v1}
\Vertex[style={minimum size=1.0cm,draw=cv2,fill=cfv2,text=clv2,shape=circle},LabelOut=false,L=\hbox{$2$},x=0.7768cm,y=2.2131cm]{v2}
\Vertex[style={minimum size=1.0cm,draw=cv3,fill=cfv3,text=clv3,shape=circle},LabelOut=false,L=\hbox{$3$},x=1.0954cm,y=0.0cm]{v3}
\Vertex[style={minimum size=1.0cm,draw=cv4,fill=cfv4,text=clv4,shape=circle},LabelOut=false,L=\hbox{$4$},x=0.8216cm,y=0.3343cm]{v4}
\Vertex[style={minimum size=1.0cm,draw=cv5,fill=cfv5,text=clv5,shape=circle},LabelOut=false,L=\hbox{$5$},x=0.4512cm,y=0.4732cm]{v5}
\Vertex[style={minimum size=1.0cm,draw=cv6,fill=cfv6,text=clv6,shape=circle},LabelOut=false,L=\hbox{$6$},x=0.1621cm,y=1.8553cm]{v6}
\Vertex[style={minimum size=1.0cm,draw=cv7,fill=cfv7,text=clv7,shape=circle},LabelOut=false,L=\hbox{$7$},x=0.3018cm,y=2.7372cm]{v7}
\Vertex[style={minimum size=1.0cm,draw=cv8,fill=cfv8,text=clv8,shape=circle},LabelOut=false,L=\hbox{$8$},x=0.0cm,y=2.3107cm]{v8}
\Vertex[style={minimum size=1.0cm,draw=cv9,fill=cfv9,text=clv9,shape=circle},LabelOut=false,L=\hbox{$9$},x=2.8719cm,y=3.0805cm]{v9}
\Vertex[style={minimum size=1.0cm,draw=cv10,fill=cfv10,text=clv10,shape=circle},LabelOut=false,L=\hbox{$10$},x=2.3761cm,y=4.0591cm]{v10}
\Vertex[style={minimum size=1.0cm,draw=cv11,fill=cfv11,text=clv11,shape=circle},LabelOut=false,L=\hbox{$11$},x=3.7123cm,y=4.2098cm]{v11}
\Vertex[style={minimum size=1.0cm,draw=cv12,fill=cfv12,text=clv12,shape=circle},LabelOut=false,L=\hbox{$12$},x=1.7658cm,y=4.2209cm]{v12}
\Vertex[style={minimum size=1.0cm,draw=cv13,fill=cfv13,text=clv13,shape=circle},LabelOut=false,L=\hbox{$13$},x=2.4794cm,y=4.7695cm]{v13}
\Vertex[style={minimum size=1.0cm,draw=cv14,fill=cfv14,text=clv14,shape=circle},LabelOut=false,L=\hbox{$14$},x=1.987cm,y=4.7202cm]{v14}
\Vertex[style={minimum size=1.0cm,draw=cv15,fill=cfv15,text=clv15,shape=circle},LabelOut=false,L=\hbox{$15$},x=4.4167cm,y=4.5571cm]{v15}
\Vertex[style={minimum size=1.0cm,draw=cv16,fill=cfv16,text=clv16,shape=circle},LabelOut=false,L=\hbox{$16$},x=4.1369cm,y=4.9378cm]{v16}
\Vertex[style={minimum size=1.0cm,draw=cv17,fill=cfv17,text=clv17,shape=circle},LabelOut=false,L=\hbox{$17$},x=3.7145cm,y=5.0cm]{v17}
\Vertex[style={minimum size=1.0cm,draw=cv18,fill=cfv18,text=clv18,shape=circle},LabelOut=false,L=\hbox{$18$},x=3.272cm,y=2.0393cm]{v18}
\Vertex[style={minimum size=1.0cm,draw=cv19,fill=cfv19,text=clv19,shape=circle},LabelOut=false,L=\hbox{$19$},x=4.2945cm,y=2.4624cm]{v19}
\Vertex[style={minimum size=1.0cm,draw=cv20,fill=cfv20,text=clv20,shape=circle},LabelOut=false,L=\hbox{$20$},x=3.9454cm,y=0.8813cm]{v20}
\Vertex[style={minimum size=1.0cm,draw=cv21,fill=cfv21,text=clv21,shape=circle},LabelOut=false,L=\hbox{$21$},x=4.7397cm,y=3.0333cm]{v21}
\Vertex[style={minimum size=1.0cm,draw=cv22,fill=cfv22,text=clv22,shape=circle},LabelOut=false,L=\hbox{$22$},x=5.0cm,y=2.6024cm]{v22}
\Vertex[style={minimum size=1.0cm,draw=cv23,fill=cfv23,text=clv23,shape=circle},LabelOut=false,L=\hbox{$23$},x=4.9265cm,y=2.1023cm]{v23}
\Vertex[style={minimum size=1.0cm,draw=cv24,fill=cfv24,text=clv24,shape=circle},LabelOut=false,L=\hbox{$24$},x=3.8508cm,y=0.1215cm]{v24}
\Vertex[style={minimum size=1.0cm,draw=cv25,fill=cfv25,text=clv25,shape=circle},LabelOut=false,L=\hbox{$25$},x=4.3552cm,y=0.2074cm]{v25}
\Vertex[style={minimum size=1.0cm,draw=cv26,fill=cfv26,text=clv26,shape=circle},LabelOut=false,L=\hbox{$26$},x=4.6084cm,y=0.613cm]{v26}
%
\Edge[lw=0.1cm,style={color=cv0v1,},](v0)(v1)
\Edge[lw=0.1cm,style={color=cv0v2,},](v0)(v2)
\Edge[lw=0.1cm,style={color=cv0v9,},](v0)(v9)
\Edge[lw=0.1cm,style={color=cv0v18,},](v0)(v18)
\Edge[lw=0.1cm,style={color=cv1v3,},](v1)(v3)
\Edge[lw=0.1cm,style={color=cv1v4,},](v1)(v4)
\Edge[lw=0.1cm,style={color=cv1v5,},](v1)(v5)
\Edge[lw=0.1cm,style={color=cv2v6,},](v2)(v6)
\Edge[lw=0.1cm,style={color=cv2v7,},](v2)(v7)
\Edge[lw=0.1cm,style={color=cv2v8,},](v2)(v8)
\Edge[lw=0.1cm,style={color=cv9v10,},](v9)(v10)
\Edge[lw=0.1cm,style={color=cv9v11,},](v9)(v11)
\Edge[lw=0.1cm,style={color=cv9v18,},](v9)(v18)
\Edge[lw=0.1cm,style={color=cv10v12,},](v10)(v12)
\Edge[lw=0.1cm,style={color=cv10v13,},](v10)(v13)
\Edge[lw=0.1cm,style={color=cv10v14,},](v10)(v14)
\Edge[lw=0.1cm,style={color=cv11v15,},](v11)(v15)
\Edge[lw=0.1cm,style={color=cv11v16,},](v11)(v16)
\Edge[lw=0.1cm,style={color=cv11v17,},](v11)(v17)
\Edge[lw=0.1cm,style={color=cv18v19,},](v18)(v19)
\Edge[lw=0.1cm,style={color=cv18v20,},](v18)(v20)
\Edge[lw=0.1cm,style={color=cv19v21,},](v19)(v21)
\Edge[lw=0.1cm,style={color=cv19v22,},](v19)(v22)
\Edge[lw=0.1cm,style={color=cv19v23,},](v19)(v23)
\Edge[lw=0.1cm,style={color=cv20v24,},](v20)(v24)
\Edge[lw=0.1cm,style={color=cv20v25,},](v20)(v25)
\Edge[lw=0.1cm,style={color=cv20v26,},](v20)(v26)
%
\end{tikzpicture}
}
\caption{A \(3\)-volcano\label{figure-1}}
\end{figure}
\hypertarget{p-818}{}%
The Sage code used to make this picture was:%
\begin{sageinput}
N = 3 # number of flows
p = 3
d = 2
G = graphs.BalancedTree(p,d) # a (p+1)-regular tree of depth d
G.delete_edge(G.edges()[0])
F = G.subgraph(G.connected_component_containing_vertex(0)) # A single 'flow'
H = N*F
H.add_cycle([len(F.vertices())*i for i in range(N)])
show(H)
#latex(H) # for the code
\end{sageinput}
\begin{theorem}{Kohel.}{}{theorem-62}%
\hypertarget{p-819}{}%
Let \(V\) be an ordinary component of \(G_l(\FF_q)\) that doesn't contain \(0\) or \(1728\) then \(V\) is an \(l\)-volcano s.t.\leavevmode%
\begin{enumerate}
\item\hypertarget{li-200}{}All vertices in \(V_i\) have the same \hyperref[def-supersing-isog-endo]{endomorphism} ring \(\ints_i\).%
\item\hypertarget{li-201}{}The subgraph on \(V_0\) has degree%
\begin{equation*}
1+ \left(\frac {\disc(K)}{l}\right)
\end{equation*}
where \(K = \Frac(\ints_0)\)%
\item\hypertarget{li-202}{}If%
\begin{equation*}
\left(\frac {\disc(K)}{l}\right) \ge 0
\end{equation*}
then \(\#V_0\) is the \hyperref[def-order-quaternion]{order} \(\lb l \rb\) in \(\Cl (\ints_0)\) else \(\#V_0 = 1\).%
\item\hypertarget{li-203}{}The depth of \(V\) is \(d = v_l (\lb \ints_K : \ZZ\lb\pi \rb\rb)\) where \(\pi\) is the Frobenius morphism on any \(E\) with \(j(E) \in V\).%
\item\hypertarget{li-204}{}\(l \nmid \lb \ints_K : \ints_0 \rb\), \(\lb \ints_i : \ints_{i+1}\rb = l\) for \(0\le i \lt d\).%
\end{enumerate}
%
\end{theorem}
\end{paragraphs}%
\begin{paragraphs}{Application: Identifying supersingular elliptic curves.}{paragraphs-30}%
\begin{algorithm}{Sutherland.}{}{algorithm-1}%
\hypertarget{p-820}{}%
Input: \hyperref[def-supersing-isog-ec]{Elliptic curve} \(E/k\), \(\characteristic k = p\).%
\par
\hypertarget{p-821}{}%
Output: Ordinary or supersingular.%
\par
\hypertarget{p-822}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-205}{}If \(j(E) \not \in \FF_{p^2}\) then ordinary.%
\item\hypertarget{li-206}{}If \(p  =2,3\) return supersingular if \(j(E) = 0\) or ordinary otherwise.%
\item\hypertarget{li-207}{}Find 3 roots of \(\phi_2(j(E), 4)\) over \(\FF_{p^2}\) if not possible return ordinary.%
\item\hypertarget{li-208}{}Walk 3 paths in parallel for up to \(\lceil \log_2 p \rceil + 1 \) steps. If any of these paths get to \(V_d\), return ordinary.%
\item\hypertarget{li-209}{}Otherwise supersingular.%
\end{enumerate}
%
\end{algorithm}
\end{paragraphs}%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 3.2 Supersingular isogeny graph cryptography (Asra)}
\typeout{************************************************}
%
\begin{sectionptx}{Supersingular isogeny graph cryptography (Asra)}{}{Supersingular isogeny graph cryptography (Asra)}{}{}\label{sec-supersing-isog-crypto}
\begin{introduction}{}%
\hypertarget{p-823}{}%
Supersingular \hyperref[def-supersing-isog-isog]{isogeny} graph crypto is a candidate for post-quantum crypto, not based on factoring etc.%
\par
\hypertarget{p-824}{}%
Recall last time we defined \hyperref[def-supersing-isog-ramanujan]{Ramanujan graphs}, graphs with very good connectivity properties, a type of expander.%
\begin{proposition}{}{}{proposition-60}%
\hypertarget{p-825}{}%
If \(G\) is a \hyperref[def-supersing-isog-ramanujan]{Ramanujan graph}, \(x\in V, S\subseteq V\). For a sufficiently large path beginning at \(x\), the probability that the path ends in \(S\) is at least \(|S|/2|V|\).%
\end{proposition}
\hypertarget{p-826}{}%
Upshot: supersingular \hyperref[def-supersing-isog-isog]{isogeny} graphs are \((l +1)\)-regular, undirected, Ramanujan, connected (technically, Ramanujan means connected already, but its worth emphasising).%
\par
\hypertarget{p-827}{}%
Some of our algorithms are only dependent on having a graph with this property, not so much the interpretation in terms of \hyperref[def-supersing-isog-isog]{isogenies}.%
\par
\hypertarget{p-828}{}%
Supersingular \hyperref[def-supersing-isog-isog]{isogeny} graphs first appeared in crypto as potential \hyperref[def-hash-function]{hash functions}.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.1 Hash functions}
\typeout{************************************************}
%
\begin{subsectionptx}{Hash functions}{}{Hash functions}{}{}\label{subsection-68}
\hypertarget{p-829}{}%
(2010) (Charles, Goren, Lauter) proposed a cryptographically secure \hyperref[def-hash-function]{hash function} based on the hardness of computing paths in a supersingular \hyperref[def-supersing-isog-isog]{isogeny} graphs.%
\begin{definition}{Hash functions.}{def-hash-function}%
\hypertarget{p-830}{}%
A \terminology{hash function} is a deterministic function \(h\colon \{0,1\}^* \to \{0,1\}^n\).%
\end{definition}
\begin{definition}{Collision resistance.}{def-collision-resistance}%
\hypertarget{p-831}{}%
A \hyperref[def-hash-function]{hash function} \(h\) is \terminology{collision resistant} if its hard to find \(x_1,x_2\) with \(x_1\ne x_2 \) s.t. \(h(x_1) = h(x_2)\).%
\end{definition}
\begin{definition}{Preimage resistance.}{def-preimage-resistance}%
\hypertarget{p-832}{}%
A \hyperref[def-hash-function]{hash function} \(h\) is \terminology{preimage resistant} if given \(y\in \{0,1\}^n\) its hard to find \(x\) s.t. \(h(x) = y\).%
\end{definition}
\hypertarget{p-833}{}%
Cool example, private set intersection, say two groups, Starbucks and BU want to find a list of common customers (students who bought something at Starbucks) but don't want to reveal anything to each other about the students or customers not in the intersection. Compute hashes of the names of customers and share the hashes, can compute the size of, and the intersection itself.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.2 Supersingular isogeny hash functions}
\typeout{************************************************}
%
\begin{subsectionptx}{Supersingular isogeny hash functions}{}{Supersingular isogeny hash functions}{}{}\label{subsection-69}
\begin{paragraphs}{Parameters.}{paragraphs-31}%
\hypertarget{p-834}{}%
\(G_l(\FF_{p^2})\), \(p \equiv 1 \pmod{12}\), \(l\) to be small, fix an ordering on the edges, fix an initial vertex \(j_0\) and an incoming edge.%
\end{paragraphs}%
\begin{paragraphs}{Protocol.}{paragraphs-32}%
\hypertarget{p-835}{}%
\(m \in \{0,1\}^*\) write this as an \(l\)-bit string, \(m \in \{0,1,\ldots, l-1\}^*\), walk the graph based on \(m\) without backtracking.%
\par
\hypertarget{p-836}{}%
Map the final \(j\) invariant to  \(\{0,1\}^{n\approx \log p}\).%
\end{paragraphs}%
\begin{paragraphs}{Properties.}{paragraphs-33}%
\hypertarget{p-837}{}%
Difficult means exponential in the size of the input normally.%
\begin{proposition}{}{}{proposition-61}%
\hypertarget{p-838}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-210}{}Preimage resistant iff when given \(j\) it is difficult to compute a positive integer \(e\) and an \hyperref[def-supersing-isog-isog]{isogeny} \(\phi\colon E_{j_0} \to E_j\) with degree \(l^e\).%
\item\hypertarget{li-211}{}Collision resistant iff when given \(j\) it is difficult to compute \(e\) and  \(\phi \colon E_{j_0} \to E_{j_0}\) with degree \(l^e\).%
\end{enumerate}
%
\end{proposition}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.3 Diffie-Hellman Key Exchange (1976)}
\typeout{************************************************}
%
\begin{subsectionptx}{Diffie-Hellman Key Exchange (1976)}{}{Diffie-Hellman Key Exchange (1976)}{}{}\label{subsection-70}
\hypertarget{p-839}{}%
Choose \(p,\, \ZZ/p, g\) then Alice computes \(g^a\) send to Bob, he computes \(g^b\) and sends it back, they both compute \(g^{ab}\), which is their shared secret.%
\par
\hypertarget{p-840}{}%
The security is based on the hardness of computing \(g^{ab}\) given \(g^a,g^b\).%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.4 Supersingular isogeny Diffie-Hellman (SIDH)}
\typeout{************************************************}
%
\begin{subsectionptx}{Supersingular isogeny Diffie-Hellman (SIDH)}{}{Supersingular isogeny Diffie-Hellman (SIDH)}{}{}\label{subsection-71}
\begin{paragraphs}{Parameters.}{paragraphs-34}%
\hypertarget{p-841}{}%
Supersingular \hyperref[def-supersing-isog-ec]{elliptic curve} of smooth \hyperref[def-order-quaternion]{order}: fix \(p\) to be big enough \(p = l_A^{e_A} l_B^{e_B} f  \pm 1\). \(l_A,l_B\) small primes, \(f\) is a number chosen such that \(p\) is big. Construct a supersingular \hyperref[def-supersing-isog-ec]{elliptic curve} \(E\) such that \(\# E(\FF_{p^2}) = (l_A^{e_A}l_B^{e_B} f)^2\), using Broker's algorithm.%
\par
\hypertarget{p-842}{}%
Construct bases \((P_A, Q_A)\) for \(E\lb l_A^{e_A}\rb\), \((P_B, Q_B)\) for \(E\lb l_B^{e_B}\rb\).%
\end{paragraphs}%
\begin{paragraphs}{Protocol.}{paragraphs-35}%
\hypertarget{p-843}{}%
Alice takes \(m_A,n_A \in \ZZ/l_A^{e_A}\)%
\par
\hypertarget{p-844}{}%
Bob takes \(m_B,n_B \in \ZZ/l_B^{e_B}\)%
\par
\hypertarget{p-845}{}%
Alice finds \(R_A = m_AP_A + n_AQ_A\)%
\par
\hypertarget{p-846}{}%
Bob finds \(R_B = m_BP_B + n_BQ_B\)%
\par
\hypertarget{p-847}{}%
Alice finds \(\phi_A \colon E \to E/\langle R_A\rangle = E_A\)%
\par
\hypertarget{p-848}{}%
Bob finds \(\phi_B \colon E \to E/\langle R_B\rangle = E_B\)%
\par
\hypertarget{p-849}{}%
They send each other \(E_i, \phi_i(P_i),\phi_i(Q_i)\).%
\par
\hypertarget{p-850}{}%
Both compute \(\phi'_A\colon E_B \to E_B/\langle m_A\phi_B(P_A) + n_A\phi_B(Q_A)\rangle\) or analogous.%
\par
\hypertarget{p-851}{}%
Shared secret is \(j(E_{AB})\).%
\end{paragraphs}%
\begin{paragraphs}{Hardness.}{paragraphs-36}%
\hypertarget{p-852}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-212}{}(Decisional supersingular \hyperref[def-supersing-isog-isog]{isogeny} problem) Given \(E, (P_A,Q_A)\) a basis for \(l_A^{e_A}\) torsion, let \(E_A\) be another curve, is \(E_A\) \(l_A^{e_A}\) isogenous to \(E\)?%
\item\hypertarget{li-213}{}(Computational supersingular \hyperref[def-supersing-isog-isog]{isogeny} problem) Let \(\phi_A \colon E \to E_A\) be an \hyperref[def-supersing-isog-isog]{isogeny} with a kernel of the form \(\langle m_AP_A + n_AQ_A \rangle\). Given \(E_A\) and \(\phi_A(P_B)\) \(\phi_A(Q_B)\), find \(R_A\). \(p^{1/4}\) classical, \(p^{1/6}\) quantum.%
\item\hypertarget{li-214}{}Given \(E_A, E_B, \phi_A(P_B), \phi_A(Q_B), \phi_B(P_A), \phi_B(Q_A)\) find \(j\)-invariant of \(E_{AB}\).%
\end{enumerate}
%
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.5 Supersingular isogeny public key}
\typeout{************************************************}
%
\begin{subsectionptx}{Supersingular isogeny public key}{}{Supersingular isogeny public key}{}{}\label{subsection-72}
\hypertarget{p-853}{}%
Classically DH key-exchange \(\leadsto\) ElGamal encryption.%
\par
\hypertarget{p-854}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-215}{}\hypertarget{p-855}{}%
Key generation.%
\par
\hypertarget{p-856}{}%
Alice: secret \(\phi_A \colon E \to E_A\), public \(E_A\) and \(\phi_A(P_B), \phi_A(Q_B)\).%
\item\hypertarget{li-216}{}\hypertarget{p-857}{}%
Encryption.%
\par
\hypertarget{p-858}{}%
Bob: choose \(\phi_B \colon E \to E_B\), compute \(j(E_{AB})\).%
\par
\hypertarget{p-859}{}%
Send Alice \(c = (E_B, \phi_B(P_A), \phi_B(Q_A), m\oplus j(E_{AB}))\)%
\item\hypertarget{li-217}{}\hypertarget{p-860}{}%
Decryption.%
\par
\hypertarget{p-861}{}%
Alice use \((E_B, \phi_B(P_A), \phi_B(Q_A))\) to compute \(j(E_{AB})\). Computes \((m\oplus j(E_{AB})) \oplus j(E_{AB}) = m\).%
\end{enumerate}
%
\par
\hypertarget{p-862}{}%
\(E(\FF_{p^2})\), \(p = l_A^{e_A} l_B^{e_B} f \pm 1\), for \(128\)-bit security use a \(512\)-bit key.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.2.6 Algorithmic aspects}
\typeout{************************************************}
%
\begin{subsectionptx}{Algorithmic aspects}{}{Algorithmic aspects}{}{}\label{subsection-73}
\hypertarget{p-863}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-218}{}(Choosing \(f\)) Prime number theorem for arithmetic progressions gives you a bound on the density of primes of the form \(l_A^{e_A} l_B^{e_B} f \pm 1\)%
\item\hypertarget{li-219}{}Choosing a s.s. e.c. with the right group \hyperref[def-order-quaternion]{order}, Broker's algorithm.%
\item\hypertarget{li-220}{}\hypertarget{p-864}{}%
Finding a basis for \(E\lb l_A^{e_A}\rb\).%
\begin{enumerate}
\item\hypertarget{li-221}{}Find a random point in \(E(\FF_{p^2})\) say \(P\).%
\item\hypertarget{li-222}{}Check the \hyperref[def-order-quaternion]{order} of \((l_B^{e_B} f)^2 \cdot P\). If its \(l_A^{e_A}\) set \(P_A = P\). Otherwise repeat from 1.%
\item\hypertarget{li-223}{}Do the same with \(Q_A = Q\).%
\item\hypertarget{li-224}{}Check independence by seeing if \(e(P_A,Q_A) \) has the right \hyperref[def-order-quaternion]{order}, so that it is in \(E\lb l_A^{e_A} \rb\) torsion.%
\end{enumerate}
%
\item\hypertarget{li-225}{}Computing the kernels generated by \(R_A = m_A P_A + n_A Q_A\), \(m_A, n_A \in \ZZ/l_A^{e_A} \ZZ\). Analogue of double and add. Set \(R_A = P_A + \lb m_A\inv n_A\rb Q_A\). Use differential addition (when you compute \(A+B\) with side info \(A-B\)) and a Montgomery ladder%
\item\hypertarget{li-226}{}(Computing smooth degree \hyperref[def-supersing-isog-isog]{isogenies}) Decompose the \(l_A^{e_A}\) \hyperref[def-supersing-isog-isog]{isogeny} into \(e_A\) different \(l_A\)-\hyperref[def-supersing-isog-isog]{isogenies}, \(\phi_i\colon E_i \to E_{i+1}\) the kernel of \(\phi_i\) is \(\langle l_A^{e_A - i - 1} R_A\rangle\). Vélu's formula runs in \(O(l)\) for \(l\)-\hyperref[def-supersing-isog-isog]{isogeny}.%
\end{enumerate}
%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 3.3 Quaternion Algebras (Alex)}
\typeout{************************************************}
%
\begin{sectionptx}{Quaternion Algebras (Alex)}{}{Quaternion Algebras (Alex)}{}{}\label{sec-quaternion-algebras}
\begin{introduction}{}%
\hypertarget{p-865}{}%
Q: Why study quaternion algebras?%
\par
\hypertarget{p-866}{}%
A: They arise as the \hyperref[def-supersing-isog-endo]{endomorphism} algebras of \emph{supersingular} \hyperref[def-supersing-isog-ec]{elliptic curves} \(/\FF_{p^2}\).%
\par
\hypertarget{p-867}{}%
I don't want to spoiler next week at all, but I cannot talk about quaternion algebras without a little bit of motivation first!%
\begin{example}{What are we doing again?}{example-42}%
\hypertarget{p-868}{}%
Lets take%
\begin{equation*}
K = \FF_9 = \FF_3[\alpha] = \FF_3[x]/(x^2- x - 1)
\end{equation*}
and%
\begin{equation*}
E/K\colon y^2 = x^3 + \alpha x = f(x)\text{,}
\end{equation*}
\hyperref[def-simple-av]{simple} eh? It's supersingular as the \(j\)-invariant is 0 (and are in characteristic 3). Alternatively, count points or even compute the Hasse invariant, the coefficient of \(p -1 = 2\) in \(f(x)^{(p-1)/2 = 1}\), yep, it's 0.%
\par
\hypertarget{p-869}{}%
We therefore have \(\#E(K) = 9 + 1 = 10\) so we have a \(2\)-torsion point (\(P = (0,0)\)) and any other point we can use to generate (will be \(5\) or \(10\) torsion). Let \(x = 1\) so \(y^2 = 1 + \alpha = \alpha^2\) so \(y = \pm\alpha\), say \(Q = (1,\alpha)\).%
\par
\hypertarget{p-870}{}%
We have one \hyperref[def-supersing-isog-endo]{endomorphism}, \(p\)-power frobenius \(x\mapsto x^3\), \(y\mapsto y^3\). How to find another one?%
\par
\hypertarget{p-871}{}%
Lets compute an isogenous curve and see what happens! We will compute \(\psi\colon  E \to E/\langle P \rangle = E'\). In general the formulae are  a little annoying \hyperlink{bib-velu}{[67]}, when you have a 2-torsion point at \((0,0)\), not as bad:%
\begin{equation*}
\psi = \left(x + \frac{f'(0)}{x}, y - \frac{yf'(0)}{x^2} \right)
\end{equation*}
%
\begin{equation*}
f'(0) = \alpha
\end{equation*}
so%
\begin{equation*}
\psi= \left(\frac{x^2 + \alpha}{x}, y\frac{x^2 - \alpha}{x^2} \right)
\end{equation*}
(aside: if \(g/h = (x^2+\alpha)/x\) then \((g/h)' = (g' h - g h')/h^2 = (2x^2 - (x^2 + \alpha))/x^2 = (x^2 - \alpha)/x^2\), sanity check/fast computation?). The curve is then%
\begin{equation*}
E'\colon y^2 = x^3 + 0x^2 + (\alpha - 5\alpha)x +0 = x^3  - \alpha x\text{.}
\end{equation*}
I think really here we're just recovering those classic formulae for 2-\hyperref[def-supersing-isog-isog]{isogenies} between curves with a rational 2 torsion point at \((0,0)\) (used in 2-descent).%
\begin{align*}
C\amp\colon y^2 = x(x^2+ax+b)\\
D\amp\colon v^2 = u(u^2+a_1u+b_1)\\
\phi\amp\colon C\to D\\
(x,y) \amp\mapsto ((y/x)^2 , y-by/x^2)\\
\hat\phi\amp\colon D\to C\\
(u,v) \amp\mapsto \left(\frac14\left(\frac vu\right)^2 ,\frac18( v-b_1 v/u^2)\right)
\end{align*}
%
\par
\hypertarget{p-872}{}%
So far so good, our curve doesn't look exactly the same, but it's \(j\)-invariant is, so we are still in business. Is%
\begin{equation*}
E \simeq E'\text{?}
\end{equation*}
If we substitute \(x= \alpha^2 x\), \(y = \alpha ^3 y\) into \(E'\) we get%
\begin{equation*}
\alpha^6 y^2 = \alpha^6 x^3 - \alpha^3 x
\end{equation*}
%
\begin{equation*}
y^2 = x^3 - \alpha^{-3} x = x^3 +\alpha x\text{,}
\end{equation*}
call this map \(\iota\). Excellent, so to get \(\psi' \colon E\to E\) we compose \(\iota\circ \psi\).%
\begin{equation*}
\iota \circ\left( \frac{x^2  + \alpha}{x}, \frac{(x^2 - \alpha )y}{x^2}\right)  = \left( \alpha^2\frac{x^2  + \alpha}{x}, \alpha^3\frac{(x^2 - \alpha )y}{x^2}\right)
\end{equation*}
%
\begin{equation*}
= \left( (\alpha+  1)\frac{x^2  + \alpha}{x}, ( -\alpha  + 1)\frac{(x^2 - \alpha )y}{x^2}\right)\text{.}
\end{equation*}
%
\par
\hypertarget{p-873}{}%
What happens to our other point \(Q\)? \(\psi'(Q) = (\alpha^2(1+\alpha), \alpha^4(1-\alpha)) =(-1, \alpha - 1)\)%
\begin{gather*}
(0 : 0 : 1) \mapsto (0 : 1 : 0),\, (0 : 1 : 0) \mapsto (0 : 1 : 0),\, (1 : \alpha : 1) \mapsto (-1 : \alpha -1 : 1),\\
(1 : -\alpha : 1) \mapsto (-1 : -\alpha + 1 : 1),\, (-1 : \alpha -1 : 1) \mapsto (1 : -\alpha : 1),\\
(-1 : -\alpha + 1 : 1) \mapsto (1 : \alpha : 1),\, (\alpha : \alpha + 1 : 1) \mapsto (-1 : -\alpha + 1 : 1),\\
(\alpha : -\alpha -1 : 1) \mapsto (-1 : \alpha -1 : 1),\, (-\alpha : 1 : 1) \mapsto (1 : \alpha : 1),\, (-\alpha : -1 : 1) \mapsto (1 : -\alpha : 1)
\end{gather*}
A word of caution: If you are very awake you may check and be led to believe that this is just the multiplication by \(-2\) \hyperref[def-supersing-isog-isog]{isogeny} on \(E\), its action on \(E(\FF_9)\) points is the same!!!!! It's not the same \hyperref[def-supersing-isog-isog]{isogeny} though so you can relax. Now we have an \hyperref[def-supersing-isog-endo]{endomorphism} ring with two elements, what are the relations between themselves, and each other?%
\par
\hypertarget{p-874}{}%
As we quotiented by a rational \(2\)-torsion point we have computed a factor of \(\pi - 1\), the other factor comes from quotienting by \(5\)-torsion. In fact we find. The frobenius has characteristic polynomial \(t^2 + 9 = (t + 3i)(t-3i)\) \(\pi\) looks like \(3i\). \(\psi\) has characteristic polynomial \(t^2 - 2t + 2 = (t+1)^2 + 1\), so \(\psi + 1\) looks like \(\pm i\). \(?? \cdot \psi = \pi - 1\)  \(?? \cdot (i - 1) = 3i - 1\), so \(?? = 2 - i = 2 - (\psi + 1) = 1 - \psi\).%
\par
\hypertarget{p-875}{}%
So what if we quotient by non-rational 2-torsion? Pass to the quadratic extension \(\FF_{3^4}\), which we get from adjoining the other roots of \(0 = x^3 + \alpha x\) i.e. \(\pm \sqrt{-\alpha}\). Denote this extension \(\FF_3 \lb \beta \rb\),  \((\beta^2 - 1)^2 = -\alpha\). We can use Vélu again, it's degree two still but a bit more ugh, you might need a computer from now on, actually I've been using one all along.%
\begin{equation*}
\phi = \left( \frac{\left(\alpha + 1\right) x^{2} + \left(- \beta^{3}  -  \beta - 1\right) x}{x -   (\beta^{2} - 1)},y \frac{\left(-\alpha + 1\right) x^{2} + \left(\beta^{3}  -  \beta^{2} + \beta - 1\right) x -  1}{(x -  ( \beta^{2} - 1))^2} \right)
\end{equation*}
doing a computation it looks like \(\phi\) satisfies \(\phi^2 -\phi + 2\).%
\par
\hypertarget{p-876}{}%
What are the relations between these? Hopefully they generate the \hyperref[def-supersing-isog-endo]{endomorphism} ring by now but without relations we are screwed! Do they commute? Computing \(\tau = \phi \psi  - \psi \phi\) is relevant, if 0, commutative, otherwise not! Note that if they are algebraically dependant they must commute! In our example we can compute \(\tau^2 + 3 = 0\)%
\end{example}
\begin{inlineexercise}{}{exercise-22}%
\hypertarget{p-877}{}%
Finish this example, compute the \hyperref[def-supersing-isog-endo]{endomorphism} ring as a recognisable quaternion \hyperref[def-order-quaternion]{order}.%
\end{inlineexercise}
\hypertarget{p-878}{}%
Aside: I now believe Asra when she says not to use Vélu's formulae for large degree!%
\par
\hypertarget{p-879}{}%
Aside 2: Frobenius can be weird for supersingular curves, e.g. for%
\begin{equation*}
y^2 = x^{3} + x/\FF_9
\end{equation*}
we have \(\pi = -3\). Or%
\begin{equation*}
y^2 = x^{3} + 1/\FF_{25}
\end{equation*}
we have \(\pi = -5\)%
\begin{inlineexercise}{Good for long walks on the beach.}{exercise-23}%
\hypertarget{p-880}{}%
Show by hand that \(y^2 + y = x^3/\FF_4\) is supersingular and that frobenius is just the multiplication by \(-2\) map.%
\end{inlineexercise}
\begin{inlineexercise}{}{exercise-24}%
\hypertarget{p-881}{}%
PODASIP: this happens for all \(p^2\)?%
\end{inlineexercise}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 3.3.1 Quaternion Algebras}
\typeout{************************************************}
%
\begin{subsectionptx}{Quaternion Algebras}{}{Quaternion Algebras}{}{}\label{subsection-74}
\begin{introduction}{}%
\hypertarget{p-882}{}%
Pretty much all of this material was ripped with the utmost love and affection from \hyperlink{bib-voight-quat}{[68]}, check it out.%
\begin{proposition}{}{}{proposition-62}%
\hypertarget{p-883}{}%
The theory of Quaternion algebras is very rich.%
\end{proposition}
\begin{proof}\hypertarget{proof-105}{}
\hypertarget{p-884}{}%
The above book is 800 pages long.%
\end{proof}
\hypertarget{p-885}{}%
So now we have gone out into nature and observed a beautiful new species of algebra, time to catch it, pin it to a wall, dissect it to study it in detail. It might not look as pretty any more but it's the way the science is done.%
\begin{example}{Hamilton's quaternions.}{example-43}%
\hypertarget{p-886}{}%
Hamilton's quaternions \(\HH\) were the first quaternion algebra to be discovered (citation needed). The structure is like two copies of \(\CC\) tensored together in some non-commuting way over \(\RR\). We have a real algebra with two generators \(i,j\) s.t. \(i^2 = j^2  = (ij)^2 = -1\) we let \(k = ij\) for aesthetic reasons (note that these relations imply noncommutativity!). Like this we get a division algebra.%
\end{example}
\hypertarget{p-887}{}%
Quaternion algebras are a generalisation of this to other fields.%
\begin{definition}{Quaternion algebras.}{def-quaternion-algebra}%
\hypertarget{p-888}{}%
Let \(F\) be a field (not characteristic 2), a quaternion algebra over \(F\) is an algebra \(B\) over \(F\) for which there exist \(a,b\in F^\times\) such that there is a basis%
\begin{equation*}
1,i,j,k \in B
\end{equation*}
such that%
\begin{equation*}
i^2 = a,j^2=b,k=ij=-ji\text{,}
\end{equation*}
it is automatic that \(k^2 = -ab\) from this.%
\par
\hypertarget{p-889}{}%
We denote this particular quaternion algebra by \(\legendre{a,b}{F}\)%
\end{definition}
\begin{example}{}{example-44}%
\hypertarget{p-890}{}%
%
\begin{equation*}
\HH = \legendre{-1,-1}{\RR}\text{.}
\end{equation*}
%
\end{example}
\begin{example}{}{example-45}%
\hypertarget{p-891}{}%
What is%
\begin{equation*}
\legendre{1,1}{F} \left( = \legendre{1,-1}{F}\right)\text{?}
\end{equation*}
We have another way to come up with \(4\)-dimensional non-commutative algebras over fields, matrices! Let%
\begin{equation*}
i=  \begin{pmatrix} 1\amp0\\0\amp -1\end{pmatrix}
\end{equation*}
%
\begin{equation*}
j =\begin{pmatrix} 0\amp1\\1\amp 0\end{pmatrix}
\end{equation*}
so%
\begin{equation*}
k = ij = \begin{pmatrix} 0\amp1\\-1\amp 0\end{pmatrix} = -ji
\end{equation*}
as required.%
\end{example}
\hypertarget{p-892}{}%
Call this example \emph{split}, in analogy with quadratic theory,  If \(x^2 - N\) has a solution mod \(p\) then \(\legendre{N}{p} = 1 = \legendre{1}{p}\).%
\par
\hypertarget{p-893}{}%
Note that if \(a\) or \(b \in (F^\times)^2\) then we can divide the corresponding basis element by \(\sqrt{a}\) or whatever and find that \(\legendre{a,b}{F} = \legendre{1,b}{F}\). This shows:%
\begin{proposition}{}{}{proposition-63}%
\hypertarget{p-894}{}%
After passing to the algebraic closure (or even the quadratic closure!) every quaternion algebra is split.%
\end{proposition}
\hypertarget{p-895}{}%
This is helpful as it allows us to work with non-split quaternion algebras as matrix algebras over a quadratic extension.%
\begin{example}{}{example-46}%
\hypertarget{p-896}{}%
\(\HH/\RR\) can be seen as \(\Mat_{2\times 2}(\RR(i)) = \Mat_{2\times 2}(\CC)\), explicitly%
\begin{equation*}
i=  i\begin{pmatrix} 1\amp0\\0\amp -1\end{pmatrix} = \begin{pmatrix} i\amp0\\0\amp -i\end{pmatrix}
\end{equation*}
%
\begin{equation*}
j = i\begin{pmatrix} 0\amp1\\1\amp 0\end{pmatrix} = \begin{pmatrix} 0\amp i\\i\amp 0\end{pmatrix}
\end{equation*}
please excuse the unfortunate notational clash here, I hope you agree it's somewhat unavoidable.%
\end{example}
\hypertarget{p-897}{}%
Here is a nice lemma I probably used implicitly already somewhere!%
\begin{lemma}{}{}{lemma-18}%
\hypertarget{p-898}{}%
An \(F\)-algebra \(B\) with \(F\)-algebra generators \(i,j\) satisfying \(i^2,j^2\in F^\times\), \(ij = -ji\) is automatically a quaternion algebra (i.e. dimension 4).%
\end{lemma}
\begin{proof}\hypertarget{proof-106}{}
\hypertarget{p-899}{}%
Show linear independence of \(1,i,j,ij\) (exercise).%
\end{proof}
\begin{definition}{Conjugate, trace and norm.}{def-quat-alg-conj-trace-norm}%
\hypertarget{p-900}{}%
Given a quaternion algebra \(B/F\) there is a unique anti-involution \(\overline \cdot \colon B \to B\), called \terminology{conjugation}.%
\par
\hypertarget{p-901}{}%
With basis \(1,i,j,ij\in \legendre{a,b}{F}\) as above it is given as%
\begin{equation*}
\overline {x + yi + zj + w ij} = x - yi - zj - w ij,\,x,y,z,w\in F\text{.}
\end{equation*}
%
\par
\hypertarget{p-902}{}%
As normal (heh) we define the (reduced) norm and trace%
\begin{equation*}
\norm \alpha =  \alpha + \overline \alpha,\,\forall \alpha \in B
\end{equation*}
%
\begin{equation*}
\norm(x + yi + zj + w ij) = x^2 - ay^2 - b z^2 + ab w^2
\end{equation*}
and%
\begin{equation*}
\trace \alpha =  \alpha + \overline \alpha,\,\forall \alpha \in B
\end{equation*}
%
\begin{equation*}
\trace (x + yi + zj + w ij) = 2x\text{.}
\end{equation*}
%
\end{definition}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsubsection 3.3.1.1 Orders}
\typeout{************************************************}
%
\begin{subsubsectionptx}{Orders}{}{Orders}{}{}\label{subsubsection-1}
\hypertarget{p-903}{}%
In our example, while the \hyperref[def-supersing-isog-endo]{endomorphism} algebra \(\End(E)\otimes \QQ\) was of interest, the \hyperref[def-supersing-isog-endo]{endomorphism} ring \(\End(E)\) was the more fundamental object. What is this? A quaternion ring?%
\begin{definition}{Orders in quaternion algebras.}{def-order-quaternion}%
\hypertarget{p-904}{}%
Let \(B/\QQ\) be a quaternion algebra, an \terminology{order} in \(B\) is a full rank sub-\(\ZZ\)-module that is also a subring.%
\end{definition}
\begin{example}{The Lipschitz order.}{ex-lipshitz-order}%
\hypertarget{p-905}{}%
\(B = \legendre{-1,-1}{\QQ}\) (Hamilton quaternions with \(\QQ\)-coefficients) then we have an \hyperref[def-order-quaternion]{order}%
\begin{equation*}
\ZZ + \ZZ i + \ZZ j + \ZZ ij
\end{equation*}
the \terminology{Lipschitz \hyperref[def-order-quaternion]{order}}.%
\end{example}
\begin{definition}{Maximality.}{def-maximal-order}%
\hypertarget{p-906}{}%
Orders are ordered (heh) with respect to inclusion, thus we get notions of maximality of \hyperref[def-order-quaternion]{orders} etc.%
\end{definition}
\hypertarget{p-907}{}%
Is the \hyperref[ex-lipshitz-order]{Lipschitz order} maximal? NO! Whats going on? \(\ZZ\lb i\rb\) is maximal in \(\QQ(i)\) after all. Consider%
\begin{equation*}
i + j + k,\,(i+j + k)^2 = i^2 + j^2 + k^2 + \cancelto{0}{ij + ji} + \cancelto{0}{ik + ki} + \cancelto{0}{jk + kj} = -3
\end{equation*}
so we have a \(\ZZ\lb \sqrt{-3}\rb\) lurking inside \(\legendre{-1,-1}{\QQ}\), quaternion algebras are not everything they appear to be at first sight! \(\ZZ\lb \sqrt{-3}\rb\) is non-maximal and we must add \(\sqrt{-3}/2\) to make it so. Lets add this in the quaternion setting:%
\begin{example}{The Hurwitz order.}{ex-hurwitz-order}%
\hypertarget{p-908}{}%
Let \(B = \legendre{-1,-1}{\QQ}\), then%
\begin{equation*}
\ZZ+  \ZZ i + \ZZ j + \ZZ \left(\frac{i + j + k}{2}\right)
\end{equation*}
is an index two suborder of the \hyperref[ex-lipshitz-order]{Lipschitz order}, called the \terminology{Hurwitz \hyperref[def-order-quaternion]{order}}, this \emph{is} maximal.%
\end{example}
\hypertarget{p-909}{}%
Warning, just because \(\sqrt{-3} \in \legendre{-1,-1}{\QQ}\) we do not have \(\legendre{-1,-3}{\QQ} = \legendre{-1,-1}{\QQ}\)!%
\begin{example}{/Exercise.}{example-49}%
\hypertarget{p-910}{}%
Show that the \hyperref[def-supersing-isog-ec]{elliptic curve} from the exercise earlier%
\begin{equation*}
y^2 + y = x^3/\overline{\FF_2}
\end{equation*}
has \hyperref[def-supersing-isog-endo]{endomorphism} algebra the \hyperref[ex-hurwitz-order]{Hurwitz order}.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-1}{}\quad%
\hypertarget{p-911}{}%
Here is what me and Angus think, we have the 2-power frobenius \(\pi\) a degree 2 \hyperref[def-supersing-isog-isog]{isogeny} whose square is minus 2, we also have the \hyperref[def-supersing-isog-isog]{isogeny} \(\phi \colon x\mapsto \zeta_3 x, y\mapsto y\) which is in fact an automorphism (degree 1) and satisifies \(\phi^2 + \phi + 1 = 0\). The relation between these two \hyperref[def-supersing-isog-isog]{isogenies} is that \(\pi \phi  = \phi^2 \pi \colon x\mapsto \zeta_3^2 x^2, y\mapsto y^2\).%
\par
\hypertarget{p-912}{}%
Inside the Huwitz \hyperref[def-order-quaternion]{order} we have some candidates for an element whose square is \(-2\) there are a few, coming in two types \(a+ b\) for \(a \ne b \in \{i,j,k\}\) and \(a-b\) for \(a\ne b\in \{i,j,k\}\), we choose the second type (why? because it works and the other doesn't), let \(p = i + j\) for concreteness. We also have a cube root of unity in the \hyperref[ex-hurwitz-order]{Hurwitz order}, it is \(f = (-1 + i + j + k)/2\).%
\par
\hypertarget{p-913}{}%
We can calculate now what \(pf\) and \(f^2 p\) are, they both come out to be \(- i + k\), some other square root of minus 2, which makes sense because degree is multiplicative. Anyway this is consistent with the \hyperref[def-supersing-isog-endo]{endomorphism} ring but there is a slight problem, the \hyperref[def-order-quaternion]{order} generated here has discriminant \(6\), so its non-maximal as we know its contained in the \hyperref[ex-hurwitz-order]{Hurwitz order} but the discriminant is higher, Deuring tells us we have to get a maximal \hyperref[def-order-quaternion]{order} so we need something extra.%
\end{example}
\hypertarget{p-914}{}%
Warning, there is no such thing as \emph{the} maximal \hyperref[def-order-quaternion]{order} of a quaternion algebra! Rather there are multiple maximal \hyperref[def-order-quaternion]{orders} due to non-commutativity, e.g. if \(\ints\) is a maximal \hyperref[def-order-quaternion]{order} then so is%
\begin{equation*}
\alpha \ints \alpha\inv \ne \ints\text{.}
\end{equation*}
%
\par
\hypertarget{p-915}{}%
Normally when we have unique maximal things with a certain property, its because we can always take spans/unions and they still have that property.%
\par
\hypertarget{p-916}{}%
This is no longer true here, the sum of two elements with integral trace and norm need not remain so, nor the product.%
\par
\hypertarget{p-917}{}%
We can define discriminants of \hyperref[def-order-quaternion]{orders} which like normal give a hint as to their maximality%
\begin{equation*}
\ints = \ZZ + \ZZ i + \ZZ j + \ZZ ij \subseteq \legendre{a,b}{\QQ}
\end{equation*}
%
\begin{equation*}
\disc \ints  = d(1,i,j,ij) = \left| \det\begin{pmatrix} 2 \amp 0 \amp 0\amp 0 \\ 0 \amp 2a \amp 0 \amp 0 \\ 0 \amp 0 \amp 2b \amp 0 \\ 0 \amp 0 \amp 0 \amp -2ab\end{pmatrix}\right| = (4ab)^2
\end{equation*}
%
\begin{inlineexercise}{}{exercise-25}%
\hypertarget{p-918}{}%
Find the discriminant of the \hyperref[ex-lipshitz-order]{Lipschitz order}.%
\end{inlineexercise}
\end{subsubsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsubsection 3.3.1.2 Local theory}
\typeout{************************************************}
%
\begin{subsubsectionptx}{Local theory}{}{Local theory}{}{}\label{subsubsection-2}
\begin{theorem}{}{}{theorem-63}%
\hypertarget{p-919}{}%
Over a local field \(F \ne \CC\) there is a unique division quaternion algebra \(B/F\) up to \(F\)-isomorphism.%
\par
\hypertarget{p-920}{}%
If \(F = \QQ_p\), \(p\ne 2\) then this is%
\begin{equation*}
\legendre{e,p}{\QQ_p}
\end{equation*}
for \(e\) any quadratic non-residue mod \(p\).%
\par
\hypertarget{p-921}{}%
This is saying that any quadratic extension of \(F\) embeds into \(B\)!%
\end{theorem}
\begin{definition}{Split and ramified quaternion algebras.}{def-split-ram-quaternion-algs}%
\hypertarget{p-922}{}%
Let \(B/\QQ_v\) be a quaternion algebra, we say that \(B\) is%
\begin{equation*}
\begin{cases}
\text{split} \amp \text{if } B\cong M_2(\QQ_v)  = \legendre{1,-1}{\QQ_v}\\
\text{ramified} \amp \text{otherwise}
\end{cases}
\end{equation*}
%
\par
\hypertarget{p-923}{}%
Correspondingly we say that \(B/\QQ\) is split/ramified at a place \(v\) if the corresponding \(B\otimes \QQ_v\) has that property.%
\end{definition}
\hypertarget{p-924}{}%
The terminology definite for quaternion algebras \hyperref[def-dess-ramified]{ramified} at infinity is also used (i.e. for which \(B\otimes \RR = \HH\)).%
\begin{theorem}{Albert-Brauer-Hasse-Noether.}{}{theorem-64}%
\hypertarget{p-925}{}%
Let \(B/F\) be a quaternion algebra  over  a  number field \(F\) (or any \hyperref[def-abvar-csa]{central \hyperref[def-simple-av]{simple} algebra}), if \(B\) splits at every place \(v\) of \(F\) then \(B\) is a matrix algebra \(M_d (F)\).%
\end{theorem}
\hypertarget{p-926}{}%
In fact:%
\begin{theorem}{}{}{theorem-65}%
\hypertarget{p-927}{}%
Two quaternion algebras are isomorphic if and only if they are isomorphic everywhere locally, i.e. if the set of places at which they ramify is the same.%
\end{theorem}
\hypertarget{p-928}{}%
Warning: Quaternion algebras may not be \hyperref[def-dess-ramified]{ramified} where you think they are?%
\par
\hypertarget{p-929}{}%
Knowing the ramification of a quaternion algebra \(\QQ\) is enough to identify it uniquely, in fact we have the following theorem%
\begin{theorem}{Main Theorem [68,~14.1.3].}{}{theorem-66}%
\hypertarget{p-930}{}%
There is a sequence of bijections%
\begin{align*}
\left\{ \text{quaternion algebras }B/\QQ \right\}/\text{isom.}\\
S \mapsto \text{unique }B \text{ ramified at exactly }S\amp\updownarrow D\mapsto \{p : B \text{ is ramifies at } p\}\\
\left\{ S \subseteq \text{places of }\QQ,\,2|\#S \right\}\\
D \mapsto \{p|D\} \cup \{\infty\} \text{ if }2\nmid \omega(D)\amp\updownarrow S \mapsto \prod_{p\in S,p\ne \infty} p\\
\left\{ D\in \ZZ_{\gt 0 }\text{ squarefree}\right\}
\end{align*}
%
\end{theorem}
\hypertarget{p-931}{}%
Sometimes however we want generators and relations not just ramification information: (As we will only care about discriminant \(p\) quaternion algebras) In our setting the relevant theorem is:%
\begin{theorem}{Pizer.}{}{theorem-67}%
\hypertarget{p-932}{}%
Let \(\QQ_{p,\infty}\) be the unique quaternion algebra \hyperref[def-dess-ramified]{ramified} at \(p,\infty\), let \(q \equiv 3 \pmod 4\) be such that \(\legendre pq = -1\), then%
\begin{equation*}
\QQ_{p,\infty} \cong
\begin{cases}
\legendre{-1,-1}{\QQ} \amp \text{ if }p\equiv 2\pmod 4,\\
\legendre{-1,-p}{\QQ} \amp \text{ if }p\equiv 3\pmod 4,\\
\legendre{-2,-p}{\QQ} \amp \text{ if }p\equiv 1\pmod 8,\\
\legendre{-p,-q}{\QQ} \amp \text{ if }p\equiv 5\pmod 8.
\end{cases}
\end{equation*}
%
\end{theorem}
\hypertarget{p-933}{}%
Ibukiyama has given a nice description of a maximal \hyperref[def-order-quaternion]{order} in such.%
\par
\hypertarget{p-934}{}%
Here are some nice references:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-227}{}Computational Problems in Supersingular \hyperref[def-supersing-isog-ec]{Elliptic Curve} \hyperref[def-supersing-isog-isog]{Isogenies} - Steven D. Galbraith and Frederik Vercauteren \url{https://www.esat.kuleuven.be/cosic/publications/article-2842.pdf}%
\item\hypertarget{li-228}{}Computing \hyperref[def-supersing-isog-isog]{Isogenies} Between \hyperref[def-buntes-abvar]{Abelian Varieties} - David Lubicz Damien Robert \url{https://perso.univ-rennes1.fr/david.lubicz/articles/isogenies.pdf}%
\item\hypertarget{li-229}{}Toric forms of \hyperref[def-supersing-isog-ec]{elliptic curves} and their arithmetic - Wouter Castryck and Frederik Vercauteren \url{https://homes.esat.kuleuven.be/\~fvercaut/papers/ec_forms.pdf}%
\item\hypertarget{li-230}{}Isogenies of \hyperref[def-supersing-isog-ec]{Elliptic Curves}: A Computational Approach - Daniel Shumow \url{https://www.sagemath.org/files/thesis/shumow-thesis-2009.pdf}%
\item\hypertarget{li-231}{}Hard and Easy Problems for Supersingular \hyperref[def-supersing-isog-isog]{Isogeny} Graphs - Christophe Petit and Kristin Lauter \url{https://eprint.iacr.org/2017/962.pdf}%
\item\hypertarget{li-232}{}Perspectives on the Albert-Brauer-Hasse-Noether Theorem for Quaternion Algebras -  Thomas R. Shemanske \url{https://www.math.dartmouth.edu/\~trs/expository-papers/tex/ABHN.pdf}%
\item\hypertarget{li-233}{}COMPUTING \hyperref[def-supersing-isog-isog]{ISOGENIES} BETWEEN SUPERSINGULAR \hyperref[def-supersing-isog-ec]{ELLIPTIC CURVES} OVER Fp CHRISTINA DELFS AND STEVEN D. GALBRAITH \url{http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.740.6509\&rep=rep1\&type=pdf}%
\end{enumerate}
%
\end{subsubsectionptx}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 3.4 The Deuring Correspondence (Maria Ines)}
\typeout{************************************************}
%
\begin{sectionptx}{The Deuring Correspondence (Maria Ines)}{}{The Deuring Correspondence (Maria Ines)}{}{}\label{sec-deuring}
\begin{introduction}{}%
\hypertarget{p-935}{}%
References:%
\par
\hypertarget{p-936}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-234}{}Voight ch. 16,17,42%
\item\hypertarget{li-235}{}Hard and Easy Problems for Supersingular \hyperref[def-supersing-isog-isog]{Isogeny} Graphs - Christophe Petit and Kristin Lauter \url{https://eprint.iacr.org/2017/962.pdf}%
\end{enumerate}
%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 3.4.1 Background: Ideals and Ideal classes}
\typeout{************************************************}
%
\begin{subsectionptx}{Background: Ideals and Ideal classes}{}{Background: Ideals and Ideal classes}{}{}\label{subsection-75}
\hypertarget{p-937}{}%
Let \(B/\QQ\) be a quaternion algebra and  \(\ints \subseteq B\) be an \hyperref[def-order-quaternion]{order}. If \(I \subseteq B \) is a  \hyperref[def-buntes-lattice]{lattice}, we can define \(\ints_L (I) = \{ \alpha\in  B :  \alpha I  \subseteq I \}\). This is an \hyperref[def-order-quaternion]{order} , it's the left \hyperref[def-order-quaternion]{order} of  \(I\) similarly can define \(\ints_R (I) \).%
\begin{definition}{}{definition-84}%
\hypertarget{p-938}{}%
A left (resp. right) fractional ideal is a \hyperref[def-buntes-lattice]{lattice} \(I \subseteq B\) s.t. \(\ints \subseteq       \ints_L (I) \) resp \(\ints \subseteq \ints_R (I) \)%
\end{definition}
\begin{definition}{Compatibility.}{def-buntes-compat}%
\hypertarget{p-939}{}%
For \hyperref[def-buntes-lattice]{lattices} \(I,J \subseteq B\) we say \(I\) is \terminology{compatible} with \(J\) if%
\begin{equation*}
\ints_R(I)= \ints_L(J)\text{.}
\end{equation*}
A \hyperref[def-buntes-lattice]{lattice} \(I \) is invertible if there is a \hyperref[def-buntes-lattice]{lattice} \(I' \subseteq B\) s.t.%
\begin{equation*}
II' = \ints_L(I) =  \ints_R(I')
\end{equation*}
%
\begin{equation*}
I'I = \ints_L(I') =  \ints_R(I)
\end{equation*}
with both products \hyperref[def-buntes-compat]{compatible}%
\end{definition}
\begin{proposition}{}{}{proposition-64}%
\hypertarget{p-940}{}%
Let \(\ints \subseteq B\) be a maximal \hyperref[def-order-quaternion]{order} then every left or right fractional \(\ints\)-ideal is invertible.%
\end{proposition}
\begin{definition}{Principal ideals.}{definition-86}%
\hypertarget{p-941}{}%
An ideal of the form%
\begin{equation*}
I =  \ints_L(I) \alpha =  \alpha\ints_R(I)
\end{equation*}
is a principal ideal.%
\end{definition}
\begin{fact}{}{}{fact-10}%
\hypertarget{p-942}{}%
\(I \) is invertible with \(I\inv = \alpha \inv \ints_L(I) =  \ints_R(I) \alpha \inv\).%
\end{fact}
\begin{definition}{Reduced norms.}{def-nrd}%
\hypertarget{p-943}{}%
Let \(I \subseteq B\) be a fractional ideal the \terminology{reduced norm} of \(I \) is the positive generator of the fractional ideal generated by%
\begin{equation*}
\{ \operatorname{nrd} (\alpha) :  \alpha \in I \}
\end{equation*}
in \(\QQ\). We denote it \(\operatorname{nrd}(I)\).%
\end{definition}
\begin{paragraphs}{Ideal classes.}{paragraphs-37}%
\begin{definition}{Ideal classes.}{def-ideal-class}%
\hypertarget{p-944}{}%
Two left fractional ideals \(I,J \subseteq B\) are in the same left class%
\begin{equation*}
I\sim_L J
\end{equation*}
if \(\exists  \alpha \in B^\times\) s.t. \(I\alpha = J\). Equivalently if \(\ints_L(I)  = \ints_L(J)\) and \(I \sim J\) as left modules over this \hyperref[def-order-quaternion]{order}. \(\sim_L\) is an equivalence relation \(\lb I \rb\) is the class of \(I\). If \(I \) is invertible then every \(J \in \lb I \rb_L\) is invertible, and then we say \(\lb I \rb_L \) is invertible.%
\end{definition}
\begin{definition}{Class sets.}{def-class-set}%
\hypertarget{p-945}{}%
Let \(\ints \subseteq B\) be an \hyperref[def-order-quaternion]{order}. The \terminology{left class set} of \(\ints\) is%
\begin{equation*}
\operatorname{Cls}_L \ints   = \{ \lb I \rb_L : I \subseteq B \text{ is invertible  and } \ints_L(I) = \ints\}
\end{equation*}
its a pointed set with distinguished element \(\lb \ints \rb_L\).%
\end{definition}
\begin{theorem}{}{}{theorem-68}%
\hypertarget{p-946}{}%
Let \(\ints \subseteq B\) be an \hyperref[def-order-quaternion]{order}. then \(\operatorname{Cls} _L \ints\) is finite. We call \(\# \operatorname{Cls}_L\ints \) the \terminology{left class number} of \(\ints\).%
\end{theorem}
\end{paragraphs}%
\begin{paragraphs}{Types of orders.}{paragraphs-38}%
\hypertarget{p-947}{}%
Let \(\ints ,\ints'  \subseteq B\) be \hyperref[def-order-quaternion]{orders}.%
\begin{definition}{}{definition-90}%
\hypertarget{p-948}{}%
We say \(\ints,\ints' \) are of the same type if \(\exists \alpha \in B^\times\) s.t. \(\ints ' = \alpha \inv \ints \alpha\). \(\ints,\ints'\) are locally of the same type if \(\ints_p, \ints_p'\) are of the same type for all primes in \(\ZZ\cup\{\infty\}\). \(\ints\) is connected to  \(\ints'\) if there exists an invertible fractional \(\ints,\ints'\)-ideal \(J \subseteq B\) called a connecting ideal.%
\end{definition}
\begin{lemma}{}{}{lemma-19}%
\hypertarget{p-949}{}%
\(\ints,\ints'\) are of the same type iff they are isomorphic as \(\ZZ\)-algebras.%
\par
\hypertarget{p-950}{}%
\(\ints,\ints'\) are connected iff they are locally of the same type.%
\end{lemma}
\begin{definition}{}{definition-91}%
\hypertarget{p-951}{}%
Let \(\ints \subseteq B\) be an \hyperref[def-order-quaternion]{order}.\leavevmode%
\begin{enumerate}
\item\hypertarget{li-236}{}The \terminology{genus} \(\operatorname{Gen}(\ints)\) of \(\ints \) is the set of \hyperref[def-order-quaternion]{orders} in \(B \) connected to \(\ints\).%
\item\hypertarget{li-237}{}The type set \(\operatorname{Typ}(\ints)\) of \(\ints\) is the set of \(\ZZ\)-algebra isomorphism classes of \hyperref[def-order-quaternion]{orders} in \(\operatorname{Gen} (\ints)\).%
\end{enumerate}
%
\end{definition}
\begin{lemma}{}{}{lemma-20}%
\hypertarget{p-952}{}%
The set map \(\operatorname{Cls}_L(\ints) \to \operatorname{Typ}(\ints)\)%
\begin{equation*}
[ I]_L \mapsto \text{class of } \ints_R(I)
\end{equation*}
is surjective.%
\end{lemma}
\begin{remark}{}{remark-22}%
\hypertarget{p-953}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-238}{}Any two maximal \hyperref[def-order-quaternion]{orders} in \(B\) are connected.%
\item\hypertarget{li-239}{}In particular there are only finitely many conjugacy classes of maximal \hyperref[def-order-quaternion]{orders} in \(B\).%
\end{enumerate}
%
\end{remark}
\begin{example}{Voight 17.6.3.}{example-50}%
\hypertarget{p-954}{}%
Let%
\begin{equation*}
B = \legendre{-1,-23}{\QQ}
\end{equation*}
Then \(\ints=  \ZZ +  \ZZ i + \ZZ \frac{i+j}{2} + \ZZ i \frac{i+j}{2}\) is a maximal \hyperref[def-order-quaternion]{order} and%
\begin{equation*}
\operatorname{Typ}(\ints) =  \left\{ \lb \ints \rb , \lb \ints_2 \rb , \lb \ints_3 \rb \right\}\text{.}
\end{equation*}
%
\end{example}
\end{paragraphs}%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.4.2 The Deuring Correspondence}
\typeout{************************************************}
%
\begin{subsectionptx}{The Deuring Correspondence}{}{The Deuring Correspondence}{}{}\label{subsection-76}
\hypertarget{p-955}{}%
Fix a prime \(p\), let \(E\) be an \hyperref[def-supersing-isog-ec]{elliptic curve} over \(\FF_q = \FF_{p^n}\).%
\begin{lemma}{}{}{lemma-21}%
\hypertarget{p-956}{}%
The \hyperref[def-supersing-isog-endo]{endomorphism} algebra  \(\End(E)_\QQ = \End(E) \otimes \QQ\) of \(E\) is either \(\QQ\) an imaginary quadratic field or a definite quaternion algebra \(/\QQ\).%
\end{lemma}
\begin{theorem}{Deuring, this proof by Lenstra.}{}{theorem-69}%
\hypertarget{p-957}{}%
Let \(E/\FF_q\) be a s.s. e.c. (i.e. assume \(\End(E) \otimes \QQ\) is a quaternion algebra). Then \(\operatorname{Ram}(B)  =    \{p, \infty\}\) and \(\ints = \End(E) \) is a maximal \hyperref[def-order-quaternion]{order} in \(B\).%
\end{theorem}
\begin{proof}\hypertarget{proof-107}{}
\hypertarget{p-958}{}%
Let \(n \gt 0\)  be prime to \(p \). Then%
\begin{equation*}
E \lb n \rb  \simeq \ZZ/ n \oplus \ZZ/n
\end{equation*}
as groups so \(\End(E\lb n\rb ) \simeq M_2(\ZZ/n)\).%
\par
\hypertarget{p-959}{}%
Claim: The structure map \(\ints/n\ints  \to \End(E\lb n \rb)\) is an isomorphism.%
\par
\hypertarget{p-960}{}%
Check: suppose \(\phi \in  \ints\) kills \(E\lb n \rb\), then since \(\phi\) is separable then \(\exists\) \(\psi \in \ints\) s.t. \(\phi = n \psi\). Hence \(\phi = 0 \in \ints/n\). This gives injectivity.%
\par
\hypertarget{p-961}{}%
As both rings are finite with the same \hyperref[def-order-quaternion]{order} \(n^4\) we have an isomorphism.%
\par
\hypertarget{p-962}{}%
Since \(\ints\) is a free \(\ZZ\) module%
\begin{equation*}
\ints_l = \ints \otimes \QQ_l = \ints \otimes \varprojlim _n \ZZ/l^n
\end{equation*}
%
\begin{equation*}
\simeq \varprojlim_n \ints/l^n \simeq \varprojlim_n \End(E[l^n])
\end{equation*}
%
\begin{equation*}
\simeq \End_{\ZZ_l}  \simeq M_2( \ZZ_l)
\end{equation*}
for any \(l \ne p\) primes. This is an isomorphism as \(\ZZ\)-algebras.%
\par
\hypertarget{p-963}{}%
In particular \(\ints_l\) is maximal in \(B_l \simeq M_2(\QQ_l)\) and \(B\) is split at \(l\) for all \(l\ne p\). Since \(B\) is definite, it follows from the classification theorem that \(\operatorname{Ram}(B)  = \left\{ p, \infty \right\}\).%
\par
\hypertarget{p-964}{}%
Fact: \(\ints_p\) is maximal in \(B_p\) (thm 42.1.9 of voight).%
\par
\hypertarget{p-965}{}%
\(\ints\) is maximal in \(B\) because it is locally maximal.%
\end{proof}
\begin{theorem}{Deuring correspondence.}{}{theorem-70}%
\hypertarget{p-966}{}%
%
\begin{equation*}
\left\{ \text{maximal orders }\ints \subseteq B_{p,\infty}\right\}/\sim \leftrightarrow \left\{ j \text{ s.s. }\in \FF_{p^2}\right\}/\Gal{\FF_{p^2}}{\FF_p}\text{.}
\end{equation*}
%
\end{theorem}
\begin{proof}\hypertarget{proof-108}{}
\hypertarget{p-967}{}%
Voight 42.4.7.%
\end{proof}
\begin{definition}{}{definition-92}%
\hypertarget{p-968}{}%
Let \(I \subseteq \ints = \End(E)\) be an integral left \(\ints\)-ideal with \((\operatorname{nrd}(I), p) = 1\). Define%
\begin{equation*}
E\lb I \rb = \{ P \in E(\overline \FF_q) :  \alpha(P) = 0 \forall \alpha \in I\}
\end{equation*}
Then there is a separable \hyperref[def-supersing-isog-isog]{isogeny}%
\begin{equation*}
\Phi_I  \colon E \to E / E \lb I \rb
\end{equation*}
with \(\ker \Phi_I = E \lb I \rb\).%
\end{definition}
\begin{fact}{}{}{fact-11}%
\hypertarget{p-969}{}%
%
\begin{equation*}
\deg (\Phi_I)  = \operatorname{nrd}(I)
\end{equation*}
%
\end{fact}
\begin{proposition}{}{}{proposition-65}%
\hypertarget{p-970}{}%
The association \(I \mapsto \phi_I\) is a 1-1 correspondence provided that \((\deg \phi_I, p) = 1\).%
\end{proposition}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 3.4.3 Applications to SIG crypto}
\typeout{************************************************}
%
\begin{subsectionptx}{Applications to SIG crypto}{}{Applications to SIG crypto}{}{}\label{subsection-77}
\begin{problem}{Constructive Deuring correspondence.}{problem-1}%
\hypertarget{p-971}{}%
Given a maximal \hyperref[def-order-quaternion]{order} \(\ints \subseteq B_{p,\infty}\) return a s.s. \(j\)-invariant \(j\) s.t. \(\ints \simeq \End(E_j)\).%
\end{problem}
\begin{problem}{Inverse Deuring correspondence.}{problem-2}%
\hypertarget{p-972}{}%
Given a supersingular \(j\) invariant \(j\), compute a maximal \hyperref[def-order-quaternion]{order} \(\ints \subseteq B_{p,\infty}\)  s.t. \(\ints \simeq \End(E_j)\). \(\ints\) is described by a \(\ZZ\)-basis.%
\end{problem}
\begin{problem}{Endomorphism ring computation problem.}{problem-3}%
\hypertarget{p-973}{}%
Given a supersingular \(j\) invariant \(j\), \(\End(E_j)\). \(\End(E_j)\) should be returned as \(4\) or \(3\) \hyperref[def-rational-map]{rational maps} that form a \(\ZZ\)-basis. Their representation should be efficient in storage and in evaluation time at points.%
\end{problem}
\begin{remark}{}{remark-23}%
\hypertarget{p-974}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-240}{}Problem 1 can be solved in polynomial time, (Prop. 14 in Petit-Lauter).%
\item\hypertarget{li-241}{}P2 and P3 are polynomially equivalent but this isn't obvious (P-L sec.3.1 and 3.2)%
\item\hypertarget{li-242}{}There is no known efficient algorithm to solve P3.%
\end{enumerate}
%
\end{remark}
\hypertarget{p-975}{}%
Recall: the (Charles-Goren-Lauter) CGL \hyperref[def-hash-function]{hash function} is \hyperref[def-preimage-resistance]{preimage resistant} iff given 2 s.s. \(j\)-invariants \(j_1,j_2\) its computationally hard to compute a  positive integer \(e\) and an \hyperref[def-supersing-isog-isog]{isogeny} \(\phi \colon E_{j_1} \to E_{j_2}\) of degree \(l^e\).%
\begin{proposition}{}{}{proposition-66}%
\hypertarget{p-976}{}%
Assume there's an efficient algorithm to solve P3. Then there is an efficient algorithm to solve the preimage problem for the CGL \hyperref[def-hash-function]{hash function}%
\end{proposition}
\begin{proof}\hypertarget{proof-109}{}
\hypertarget{p-977}{}%
Algorithm%
\par
\hypertarget{p-978}{}%
Input: two s.s. \(j\)-invariants \(j_s,j_t \in \FF_{p^2}\).%
\par
\hypertarget{p-979}{}%
Output: sequence of \(j\)-invariants%
\begin{equation*}
j_s,\ldots,j_0,\ldots, j_t\text{.}
\end{equation*}
%
\par
\hypertarget{p-980}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-243}{}Compute \(\End(j_s),\End(j_t)\).%
\item\hypertarget{li-244}{}Compute \(\ints_s \simeq \End(E_{j_s})\), \(\ints_t \simeq \End(E_{j_t})\)%
\item\hypertarget{li-245}{}Compute ideals \(I_s\) and \(I_t\) connecting \(\ints_0 \) to \(\ints_s\), \(\ints_t\)%
\item\hypertarget{li-246}{}Compute ideals \(J_s \in \lb I_s \rb\),\(J_t \in \lb I_t \rb\), with norms \(l^{e_s},l^{e_t}\).%
\item\hypertarget{li-247}{}For \(J \in \{J_s,J_t\}\) and corresponding \(E \in \{E_s,E_t\}\) and \(e\in \{e_s, e_t\}\) compute \(J_i = \ints_0 p^2 + \ints_0 l^i\) for \(i = 0,\ldots, e\). For \(i = 0,\ldots, e\) compute \(K_i \in \lb J_i \rb_L\) with powersmooth norm. Translate \(K_i\) into an \hyperref[def-supersing-isog-isog]{isogeny}%
\begin{equation*}
\phi\colon E_0 \to E_i
\end{equation*}
Deduce a sequence \((j_0, j(E_1),\ldots,j(E) = j_e)\).%
\item\hypertarget{li-248}{}Return \((j(E_s), \ldots,j_0, \ldots,j(E_t))\).%
\end{enumerate}
%
\par
\hypertarget{p-981}{}%
Except for step 1 everything can be done efficiently.%
\end{proof}
\begin{remark}{}{remark-24}%
\hypertarget{p-982}{}%
The converse is also true.%
\end{remark}
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 4 \(p\)-divisible groups}
\typeout{************************************************}
%
\begin{chapterptx}{\(p\)-divisible groups}{}{\(p\)-divisible groups}{}{}\label{chapter-p-div}
\begin{introduction}{}%
\hypertarget{p-983}{}%
These are notes for the short-lived BUNTES Fall 2018 part II, the topic is \(p\)-divisible groups.%
\par
\hypertarget{p-984}{}%
\url{http://math.bu.edu/people/midff/buntes/fall2018.html}.%
\par
\hypertarget{p-985}{}%
References:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-249}{}Tate%
\item\hypertarget{li-250}{}Schatz%
\end{enumerate}
%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 4.1 \(p\)-divisible groups (Sachi)}
\typeout{************************************************}
%
\begin{sectionptx}{\(p\)-divisible groups (Sachi)}{}{\(p\)-divisible groups (Sachi)}{}{}\label{sec-p-div-gps}
\hypertarget{p-986}{}%
Why study  \(p\)-divisible groups (Jacob Stix).\leavevmode%
\begin{enumerate}
\item\hypertarget{li-251}{}Analyse local \(p\)-adic galois action on \(p\)-torsion of \hyperref[def-supersing-isog-ec]{elliptic curves}, Serre's open image theorem.%
\begin{equation*}
\phi_l \colon G_K \to \Aut \lb l \rb
\end{equation*}
Surjective for almost all \(l\).%
\item\hypertarget{li-252}{}Tool for representing \(p\)-adic cohomology, e.g \(p\)-adic hodge theory.%
\item\hypertarget{li-253}{}Describe local properties of moduli spaces of \hyperref[def-buntes-abvar]{abelian varieties} which map to moduli spaces of \(p\)-divisible groups which can be described by semilinear algebra (Serre-Tate).%
\item\hypertarget{li-254}{}Explicit local CFT via Lubin-Tate formal groups describing wildly \hyperref[def-dess-ramified]{ramified} abelian extensions.%
\item\hypertarget{li-255}{}The true fundamental group in characteristic \(p\) must include infinitesimal group schemes, \(p\)-divisible groups enter through their tate modules.%
\end{enumerate}
%
\begin{paragraphs}{Detour, schemes.}{paragraphs-39}%
\hypertarget{p-987}{}%
There is an (anti)-equivalence of categories%
\begin{equation*}
\{\text{ring}\} \leftrightarrow\{\text{affine schemes}\}\text{.}
\end{equation*}
%
\par
\hypertarget{p-988}{}%
Moral whatever  a scheme is the data of a ring is enough to specify it + homs%
\begin{equation*}
\Hom_{Ring} (B,A) \leftrightarrow \Hom_{Aff}(\Spec A, \Spec B)
\end{equation*}
to specify a base field or base ring play a similar game with \(R\)-algebras and \(R\)-schemes.%
\par
\hypertarget{p-989}{}%
Yoneda, schemes are functors: Let \(R\lb T_1,\ldots,T_n\rb \) be a polynomial ring over \(R\), we want solutions to%
\begin{equation*}
f_1=  f_2 = \cdots = f_m = 0
\end{equation*}
with coefficients in \(A\) this is asking for  a map%
\begin{equation*}
R\lb T_1, \ldots ,T_n] /(f_i) \to A
\end{equation*}
same as%
\begin{equation*}
\Hom_{R-alg} (R[T_1,\ldots, T_n] /(f_i), A)
\end{equation*}
functor \(A\) to this is a functor from \(R\)-algs to sets.%
\begin{definition}{}{definition-93}%
\hypertarget{p-990}{}%
For any affine scheme \(A = \Spec B\) we attach a functor \(h_X\) from \(\mathrm{Sch}^\op\) to sets, sending \(\Spec S \mapsto \Hom_{\mathrm{Sch}} (\Spec S, X) = \Hom_{Ring} (B,S) = h_X(\Spec S)\). spec S points of X%
\end{definition}
\begin{example}{}{example-51}%
\hypertarget{p-991}{}%
%
\begin{equation*}
\aff^n = \Spec \ZZ \lb T_1,\ldots, T_n\rb
\end{equation*}
%
\begin{equation*}
\aff^n(T) = \Hom_{\mathrm{Sch}} (T, \aff^n) = \Hom_{Ring}(\ZZ[T_1,\ldots, T_n], S)\cong S^n
\end{equation*}
%
\end{example}
\begin{example}{}{example-52}%
\hypertarget{p-992}{}%
%
\begin{equation*}
E \colon \Spec k[x,y] / (y^2 - (x^3 + ax +b)),\,k = \QQ
\end{equation*}
\(E(\QQ(i)) = \QQ(i)\) points, choosing \(x,y\) satisfying weierstrass equation.%
\end{example}
\hypertarget{p-993}{}%
Suppose \(h_X \colon \mathrm{Sch}^\op \to R\) factors through \(\mathrm{Grp} \to \mathrm{Set}\) then this is a group scheme.%
\begin{example}{}{example-53}%
\hypertarget{p-994}{}%
%
\begin{equation*}
\mathbf G_a = \Spec k[t]
\end{equation*}
%
\begin{equation*}
S\mapsto \Hom(k[t], S) \cong (S,+)
\end{equation*}
%
\end{example}
\begin{example}{}{example-54}%
\hypertarget{p-995}{}%
%
\begin{equation*}
\mathbf G_m = \Spec k[t,t\inv]
\end{equation*}
%
\begin{equation*}
S\mapsto \Hom(k[t,t\inv], S) \cong (S^\times,\cdot)
\end{equation*}
%
\end{example}
\begin{example}{}{example-55}%
\hypertarget{p-996}{}%
%
\begin{equation*}
\mu_n = \Spec k[t]/(t^n -1)
\end{equation*}
%
\end{example}
\begin{example}{}{example-56}%
\hypertarget{p-997}{}%
%
\begin{equation*}
\alpha_{p^n} = \Spec k[t]/(t^{p^n})
\end{equation*}
char \(k = p\)%
\end{example}
\hypertarget{p-998}{}%
Cartier Duality \(G\) is a finite group scheme \(/R\) there is a dual%
\begin{equation*}
G^* (T) = \Hom (G_T, \mathbf G_m)
\end{equation*}
\(R\)-scheme \(T\)%
\begin{equation*}
G \cong (G^*)^*
\end{equation*}
%
\begin{example}{}{example-57}%
\hypertarget{p-999}{}%
%
\begin{equation*}
\mu_{p^n} \leftrightarrow \ZZ/p^n
\end{equation*}
%
\end{example}
\begin{definition}{}{definition-94}%
\hypertarget{p-1000}{}%
Let \(p\) be a prime and \(h\) a non-negative integer. A \(p\)-divisible group of height \(h\) is an inductive system%
\begin{equation*}
(G_v, i_v)
\end{equation*}
where each \(G_v\) is a group scheme \(/R\) of size \(p^{vh}\)%
\begin{equation*}
i_v \colon G_v \to G_{v+1}
\end{equation*}
identifies \(G_v\) with kernel of multiplication by \(p^v\).%
\begin{equation*}
0 \to G_v \xrightarrow{i_v} G_{v+1} \xrightarrow{[p^v]} G_{v+1}
\end{equation*}
%
\end{definition}
\begin{remark}{}{remark-25}%
\hypertarget{p-1001}{}%
We can show that \(G_\mu,G_v\) are two levels then%
\begin{equation*}
0 \to G_\mu \xrightarrow{i_{\mu, v}} G_{\mu +v } \xrightarrow{[p^\mu]} G_{\mu,v}
\end{equation*}
so%
\begin{equation*}
0 \to G_\mu \to G_{\mu + v}  \to G_v \to 0\text{.}
\end{equation*}
%
\end{remark}
\hypertarget{p-1002}{}%
The connected etale sequence%
\par
\hypertarget{p-1003}{}%
A finite flat group scheme \(G\) over a henselian local ring \(R\) admitsa (functorial) decomposition%
\begin{equation*}
0  \to G^\circ \to G \to G^\et \to 0
\end{equation*}
connected and etale%
\par
\hypertarget{p-1004}{}%
There is an equivalence of categories between finite etale gp scheme \(/R\) and its continuous \(\absgal k\) modules when \(R = k\) is a field.%
\begin{definition}{}{definition-95}%
\hypertarget{p-1005}{}%
An \(n\)-dimensional formal lie group \(/R\) is the formal power series ring%
\begin{equation*}
A = R\lb \lb x_1, \ldots, x_n \rb\rb
\end{equation*}
with a suitable co-multiplication structure.%
\begin{equation*}
m^* \colon A \to A\widehat \otimes A
\end{equation*}
%
\begin{equation*}
m^*(X_i) = (f_i(Y,Z))
\end{equation*}
require\leavevmode%
\begin{enumerate}
\item\hypertarget{li-256}{}%
\begin{equation*}
F(X,0) = F(0,X) = X
\end{equation*}
%
\item\hypertarget{li-257}{}%
\begin{equation*}
F(X,F(Y,Z)) = F(F(Y,Z),X) = X
\end{equation*}
%
\item\hypertarget{li-258}{}%
\begin{equation*}
F(Y,Z) = F(Z,Y)
\end{equation*}
%
\end{enumerate}
%
\end{definition}
\hypertarget{p-1006}{}%
Let \(\psi\) denote multiplication by \(p\) in \(A\) then \(A\) is divisible if \(\psi\) is an \hyperref[def-supersing-isog-isog]{isogeny} (surj. with finite kernel). Alternatively \(A\) is a finite free \(\psi (A)\)-module.%
\begin{theorem}{}{}{theorem-71}%
\hypertarget{p-1007}{}%
Let \(R\) be a \hyperref[def-abelian-complete-var]{complete} noetherian local ring with residue characteristic \(p \gt 0\). We have an equiv of cats%
\begin{equation*}
\text{conn. p-div gps} \leftrightarrow \text{div. formal lie groups /R}
\end{equation*}
%
\end{theorem}
\begin{example}{}{example-58}%
\hypertarget{p-1008}{}%
%
\begin{equation*}
\mathbf G_m(p) , \, F(X)= Y+Z+YZ
\end{equation*}
%
\end{example}
\begin{example}{}{example-59}%
\hypertarget{p-1009}{}%
\(E\) ordinary \hyperref[def-supersing-isog-ec]{elliptic curve} \(/\overline{\FF}_p\)%
\par
\hypertarget{p-1010}{}%
%
\begin{equation*}
E[p] (\overline \FF_p)
\end{equation*}
is non-empty%
\begin{equation*}
E[p] = E[p]^\circ \times E[p]^\et\text{.}
\end{equation*}
%
\par
\hypertarget{p-1011}{}%
etale group schemes over alg. closed fields are constant%
\begin{equation*}
E = E[p]^\circ \times A
\end{equation*}
%
\par
\hypertarget{p-1012}{}%
It can't be entirely etale \(\lb p \rb\) would be etale but this induces the 0 map on tangent space so \(E\lb p \rb^\circ \ne 0\).%
\par
\hypertarget{p-1013}{}%
%
\begin{equation*}
|E\lb p \rb | =  p^2
\end{equation*}
so each \hyperref[def-order-quaternion]{order} \(p\).%
\par
\hypertarget{p-1014}{}%
%
\begin{equation*}
A = \ZZ/p
\end{equation*}
%
\par
\hypertarget{p-1015}{}%
\(E\) is cartier self dual%
\begin{equation*}
A^* = \mu_p = E[p]^\circ
\end{equation*}
%
\par
\hypertarget{p-1016}{}%
Induct for \(E\lb p^n\rb \).%
\end{example}
\end{paragraphs}%
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 5 Shimura varieties}
\typeout{************************************************}
%
\begin{chapterptx}{Shimura varieties}{}{Shimura varieties}{}{}\label{chapter-buntes-shimura}
\begin{introduction}{}%
\hypertarget{p-1017}{}%
These are notes for BUNTES Fall 2018 part III, the topic is Shimura varieties%
\par
\hypertarget{p-1018}{}%
\url{http://math.bu.edu/people/midff/buntes/fall2018.html}.%
\par
\hypertarget{p-1019}{}%
Outline:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-259}{}%
\end{enumerate}
%
\par
\hypertarget{p-1020}{}%
References:%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 5.1 Modular curves (Aash)}
\typeout{************************************************}
%
\begin{sectionptx}{Modular curves (Aash)}{}{Modular curves (Aash)}{}{}\label{sec-buntes-modular-curves}
\begin{definition}{Lattices.}{def-buntes-lattice}%
\hypertarget{p-1021}{}%
A \terminology{lattice} is a free abelian group of rank 2%
\begin{equation*}
\Lambda \otimes \RR \to \CC
\end{equation*}
is an isomorphism%
\begin{equation*}
\Lambda = \ZZ\lb \alpha \rb  \oplus \ZZ\lb \beta \rb
\end{equation*}
if%
\begin{equation*}
\Lambda = \gamma \Lambda ',\,\gamma \in \CC
\end{equation*}
then we say the two \hyperref[def-buntes-lattice]{lattices} are \terminology{homothetic}.%
\end{definition}
\hypertarget{p-1022}{}%
Any \hyperref[def-buntes-lattice]{lattice} is \hyperref[def-buntes-lattice]{homothetic} to one of the form%
\begin{equation*}
\Lambda = \langle 1 , \tau \rangle
\end{equation*}
as we can take a positively oriented basis we have that all such are equivalent to%
\begin{equation*}
\tau \in \HH = \{ z\in \CC: \Im(z) \gt 0 \}\text{.}
\end{equation*}
So there is a bijection between \(\HH\) and ordered bases of \hyperref[def-buntes-lattice]{lattices}.%
\par
\hypertarget{p-1023}{}%
\(\SL_2(\ZZ)\) acts on \(\HH\) and the action corresponds to changing bases.%
\par
\hypertarget{p-1024}{}%
The action of \(\PSL_2(\ZZ)\) is faithful. \(i,\rho = e^{\pi i /3}\) have non-trivial stabilisers%
\begin{equation*}
\Stab_i =  \langle S\rangle = \begin{pmatrix} 0\amp1 \\ -1 \amp 0 \end{pmatrix}
\end{equation*}
%
\begin{equation*}
\Stab_\rho =  \langle TS\rangle,\,T = \begin{pmatrix} 1\amp1 \\ 0 \amp 1 \end{pmatrix}
\end{equation*}
%
\par
\hypertarget{p-1025}{}%
We can determine the \hyperref[def-order-quaternion]{order} of elements by looking at the characteristic polynomials.%
\par
\hypertarget{p-1026}{}%
We then have%
\begin{equation*}
Y(1) =\SL_2(\ZZ) \backslash \HH
\end{equation*}
a complex manifold and%
\begin{equation*}
j\colon Y(1) \to \CC
\end{equation*}
is an isomorphism.%
\par
\hypertarget{p-1027}{}%
We have a fundamental domain for this action%
\begin{equation*}
D = \{ z\in \CC : |z|  \ge 1,\, |\Re(z)| \le \frac 12 \}
\end{equation*}
\(Y(1)\) is Hausdorff because the action is properly discontinuous.%
\par
\hypertarget{p-1028}{}%
Care must be taken around the elliptic points (those with larger stabiliser), to define the complex structure.%
\par
\hypertarget{p-1029}{}%
The extended upper half plane%
\begin{equation*}
\HH^* = \HH \cup \PP^1 (\QQ)
\end{equation*}
also has an \(\SL_2(\ZZ)\) action via fractional linear transformations, which is proper.%
\par
\hypertarget{p-1030}{}%
We can define a basis of neighbourhoods around the cusps by transforming them to the cusp \(\infty\) where we can use the basis of neighbourhoods given by%
\begin{equation*}
\HH_N = \{ z\in \HH : | \Im(z)| \gt N\}\text{.}
\end{equation*}
%
\par
\hypertarget{p-1031}{}%
The parameter \(q\) around \(\infty\) is defined as \(e^{2\pi i z/N}\) for some \(N\in \ZZ\), \(q\) is fixed by \(T\).%
\par
\hypertarget{p-1032}{}%
We can quotient by the action of \(\SL_2(\ZZ) \) on \(\HH^*\) to get%
\begin{equation*}
X(1) = \SL_2(\ZZ) \backslash \HH^*
\end{equation*}
which is now compact, \hyperref[def-class-set]{genus} 0, which matches up with \(Y(1)\) having \(\CC\) points \(\CC\) earlier.%
\par
\hypertarget{p-1033}{}%
If \(X\) is a projective curve then \(X(\CC)\) has the structure of a compact \hyperref[def-top-riem-surface]{Riemann surface}. If \(S\) is such a surface then there exists a unique up to isomorphism \(X\) with \(X(\CC) = S\).%
\par
\hypertarget{p-1034}{}%
The \hyperref[def-morph-riem-surf]{meromorphic functions} on \(S\) are the function field of \(X\) and there is a correspondence%
\begin{equation*}
\text{Compact Riemann surfaces} \leftrightarrow \text{Smooth proj. curves}
\end{equation*}
%
\par
\hypertarget{p-1035}{}%
Given a finite index subgroup of \(\SL_2(\ZZ)\) we can do something similar to obtain%
\begin{equation*}
\Gamma\backslash \HH\text{.}
\end{equation*}
One of the most prominent examples of such a subgroup is%
\begin{equation*}
\Gamma(N) = \left\{ \gamma \in \SL_2(\ZZ) : \gamma \equiv \begin{pmatrix} 1\amp0 \\ 0 \amp 1 \end{pmatrix} \pmod N \right\}
\end{equation*}
along with%
\begin{equation*}
\Gamma_1(N) = \left\{ \gamma \in \SL_2(\ZZ) : \gamma \equiv \begin{pmatrix} 1\amp\ast \\ 0 \amp 1 \end{pmatrix} \pmod N \right\}
\end{equation*}
%
\begin{equation*}
\Gamma_0(N) = \left\{ \gamma \in \SL_2(\ZZ) : \gamma \equiv \begin{pmatrix} \ast\amp\ast \\ 0 \amp \ast \end{pmatrix} \pmod N \right\}\text{.}
\end{equation*}
%
\par
\hypertarget{p-1036}{}%
\(\Gamma(N)\) is normal inside \(\SL_2(\ZZ)\) and \(\Gamma_1(N)\) is normal inside \(\Gamma_0(N)\).%
\par
\hypertarget{p-1037}{}%
The aforementioned equivalence of categories gives us a smooth projective curve for each of these examples.%
\par
\hypertarget{p-1038}{}%
In fact one can find a smooth projective curve with \(\QQ\)-coefficients realising each of these \hyperref[def-top-riem-surface]{Riemann surfaces}.%
\par
\hypertarget{p-1039}{}%
For%
\begin{equation*}
\Gamma_0(N) \backslash \HH^*
\end{equation*}
we have the function \(j(z)\) from before, but also \(j(Nz)\) which is still a function on the quotient now as%
\begin{equation*}
j(N \gamma z) = j\left( N\frac{az + b}{cz+d} \right)
\end{equation*}
%
\begin{equation*}
= j\left( N\frac{az + b}{c'Nz+d} \right)
\end{equation*}
%
\begin{equation*}
= j\left( \frac{aNz + bN}{c'Nz+d} \right)
\end{equation*}
%
\begin{equation*}
= j\left( \gamma ' Nz\right)
\end{equation*}
%
\begin{equation*}
= j\left( Nz\right)
\end{equation*}
%
\par
\hypertarget{p-1040}{}%
We can therefore let%
\begin{equation*}
g = \prod_{\gamma} (Y - j(\gamma Nz))
\end{equation*}
the product over the cosets of \(\Gamma_0(N) \subseteq \SL_2(\ZZ)\).%
\par
\hypertarget{p-1041}{}%
The coefficients of \(g\) are \hyperref[def-morph-riem-surf]{meromorphic functions} on \(X(1) = \CC\lb j \rb\). So we have%
\begin{equation*}
g(Y) = F(j(z), Y)
\end{equation*}
and%
\begin{equation*}
g (j(Nz)) = F(j(z), j(Nz)) = 0
\end{equation*}
then \(F(X,Y)\) is irreducible and  has integer coefficients.%
\par
\hypertarget{p-1042}{}%
Then the curve \(X_0(N)\) whose function field is%
\begin{equation*}
\QQ \lb X,Y\rb/ F(X,Y)
\end{equation*}
so \(U \subseteq X_0(N)\) is isomorphic to an affine variety defined by%
\begin{equation*}
F(X,Y) = 0 \smallsetminus \text{singular pts}
\end{equation*}
%
\par
\hypertarget{p-1043}{}%
%
\begin{equation*}
\Gamma_0(N) \backslash \HH \to U(\CC)
\end{equation*}
%
\begin{equation*}
z \mapsto (j(z), j(Nz))
\end{equation*}
\(j(\gamma z) = z\,\forall z\) iff \(\gamma \in \SL_2(\ZZ)\).%
\par
\hypertarget{p-1044}{}%
If for \(z= z_1,z_2\) have \((j(z),j(Nz))\) equal then \(z_1,z_2\) are in the same \(\Gamma_0(N)\) orbit.%
\par
\hypertarget{p-1045}{}%
We can do similar for \(\Gamma_1\) but only over \(\QQ(\zeta_N)\).%
\begin{paragraphs}{Elliptic curves.}{paragraphs-40}%
\hypertarget{p-1046}{}%
Several definitions:\leavevmode%
\begin{enumerate}
\item\hypertarget{li-260}{}Smooth proj. curve \hyperref[def-class-set]{genus} 1 with a rational point.%
\item\hypertarget{li-261}{}smooth curve given by Weierstrass eqn.%
\begin{equation*}
y^2 + a_1xy + a_3 y =  x^3 + a_2x^2 + a_4 x + a_6\text{.}
\end{equation*}
%
\item\hypertarget{li-262}{}Complex torus of  dimension 1.%
\end{enumerate}
%
\par
\hypertarget{p-1047}{}%
Over \(\CC\) at least all are equivalent.%
\par
\hypertarget{p-1048}{}%
To get the weierstrass equation from the curve we use Riemann-Roch to see that%
\begin{equation*}
H(1[0]) = 1,\, H(2[0]) = 2,\,H(3[0]) =3
\end{equation*}
So we call a generator of \(H(2\lb 0 \rb) \smallsetminus H(\lb 0 \rb)\) the function \(x\) same for \(y\) and \(H(3\lb 0 \rb)\), now in \(H(6 \lb 0 \rb)\) we have%
\begin{equation*}
1,x,y,x^2 ,xy,y^2,x^3
\end{equation*}
so there is a linear relation among these, giving the Weierstrass equation.%
\par
\hypertarget{p-1049}{}%
To get the equation for a torus we use the Weierstrass \(\wp\) function.%
\end{paragraphs}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.2 Modular forms (Asra)}
\typeout{************************************************}
%
\begin{sectionptx}{Modular forms (Asra)}{}{Modular forms (Asra)}{}{}\label{sec-buntes-modular-forms}
\hypertarget{p-1050}{}%
Last time we saw the \(j\)-function, which was \(\SL_2(\ZZ)\)-invariant, this is quite a strong condition, and in fact \(j\) is pretty much all we get under this condition. So instead we weaken this somewhat to some other variance property.%
\par
\hypertarget{p-1051}{}%
If \(w = f(z) \diff z\) on \(\HH\) and \(f(z)\) is meromorphic. \(\gamma \in \Gamma\) then%
\begin{equation*}
f(\gamma z) d(\gamma z) = f(\gamma z) d\left( \frac{az+b}{cz+d} \right)
\end{equation*}
%
\begin{equation*}
= f(\gamma z) \left( \frac{\cdots \diff }{(cz+d)^2} \right)
\end{equation*}
so we get a condition%
\begin{equation*}
f(\gamma z) = (cz+d)^2 f(z)
\end{equation*}
this is how we come to:%
\begin{definition}{}{def-buntes-weak-modular}%
\hypertarget{p-1052}{}%
A \hyperref[def-morph-riem-surf]{holomorphic function} \(f\colon \HH \to \CC\) is a \terminology{weakly modular} function for \(\Gamma\) of weight \(k\) if%
\begin{equation*}
f(\gamma z) = (cz+d)^k f(z) \forall \gamma  = \begin{pmatrix} a\amp b \\ c \amp d    \end{pmatrix} \in \Gamma\text{.}
\end{equation*}
%
\end{definition}
\begin{remark}{}{remark-26}%
\hypertarget{p-1053}{}%
If \(-I \in \Gamma\) and \(k\) odd%
\begin{equation*}
f(-z)  = - f(-z)
\end{equation*}
so in this setting we only have interesting behaviour for even \(k\).%
\par
\hypertarget{p-1054}{}%
If \(\Gamma\) is a congruence subgroup of level \(N\) we have%
\begin{equation*}
\begin{pmatrix} 1\amp N \\ 0 \amp 1 \end{pmatrix} \in \Gamma
\end{equation*}
gives you a \(q\)-expansion%
\begin{equation*}
q=  e^{2\pi i z}
\end{equation*}
%
\begin{equation*}
f(z) = \sum_{m\in \ZZ} a_m  q^{m/N}\text{.}
\end{equation*}
%
\par
\hypertarget{p-1055}{}%
\(f\) is holomorphic at \(\infty\) if \(a_m  = 0\) for \(m \lt 0\).%
\par
\hypertarget{p-1056}{}%
\(f\) is holomorphic at all cusps if \(f(\gamma z)(cz+d)^k\) is holomorphic at \(\infty\) for all \(\gamma \in \SL_2(\ZZ)\).%
\end{remark}
\begin{example}{}{example-60}%
\hypertarget{p-1057}{}%
Cusps for \(\Gamma_0(p)\), we know we have \(\infty\), what is the orbit of this?%
\begin{equation*}
\gamma\in \Gamma_0(p),\, \gamma  =  \begin{pmatrix} a\amp b \\ cp \amp d    \end{pmatrix}
\end{equation*}
%
\begin{equation*}
\gamma \infty  = \frac{a}{cp}
\end{equation*}
so anything with  a \(p\) in the denominator is equivalent to \(\infty\), what about the rest?%
\begin{equation*}
\gamma 0  = \frac{b}{d}, \, \gcd(b,d)  =1\text{,}
\end{equation*}
so we have two cusps.%
\end{example}
\begin{definition}{Modular forms.}{def-buntes-mfs}%
\hypertarget{p-1058}{}%
A \terminology{modular form} is  a \hyperref[def-buntes-weak-modular]{weakly modular} function that is holomorphic at all the cusps.%
\end{definition}
\begin{example}{}{example-61}%
\hypertarget{p-1059}{}%
Eisenstein series%
\begin{equation*}
G_k(z) = \sum'_{m,n\in \ZZ} \frac{1}{(mz+n)^k}
\end{equation*}
is a \hyperref[def-buntes-mfs]{modular form} of weight \(k \gt 2\) for \(\SL_2(\ZZ)\).%
\begin{equation*}
\lim_{\im z\to \infty} G_k(z) = \lim_{\im z\to \infty} \sum'_{m,n\in \ZZ} \frac{1}{(mz+n)^k} = \sum'_{n\in \ZZ} \frac{1}{n^k} = 2\zeta(k)\text{.}
\end{equation*}
%
\par
\hypertarget{p-1060}{}%
So here the function does not vanish at 0.%
\end{example}
\begin{definition}{Cusp forms.}{def-buntes-cusp-forms}%
\hypertarget{p-1061}{}%
A \terminology{cusp form} is a \hyperref[def-buntes-mfs]{modular form} that vanishes at all cusps.%
\end{definition}
\hypertarget{p-1062}{}%
Given a cusp it will be stabilised by some%
\begin{equation*}
\begin{pmatrix} 1\amp h \\ 0 \amp 1 \end{pmatrix}
\end{equation*}
call the smallest such \(h\) for a given cusp the \terminology{width} of the cusp.%
\begin{example}{}{example-62}%
\hypertarget{p-1063}{}%
Let's find the \hyperref[def-buntes-cusp-forms]{width} of a cusp in \(\Gamma_0(qp)\) we have%
\begin{equation*}
\begin{pmatrix} 1\amp 1 \\ 0 \amp 1 \end{pmatrix}
\end{equation*}
so the \hyperref[def-buntes-cusp-forms]{width} of \(\infty\) is 1.%
\par
\hypertarget{p-1064}{}%
What about \(\alpha = 1/p\)?\leavevmode%
\begin{enumerate}
\item\hypertarget{li-263}{}Find an element \(\gamma \in \SL_2(\ZZ)\) s.t. \(\gamma(\infty) = \alpha\).%
\item\hypertarget{li-264}{}Compute%
\begin{equation*}
\delta(x) = \gamma \begin{pmatrix} 1\amp x \\ 0 \amp 1 \end{pmatrix} \gamma\inv
\end{equation*}
%
\item\hypertarget{li-265}{}Find the smallest \(x\) such that \(\delta(x) = \Gamma_0(pq)\)%
\end{enumerate}
%
\begin{equation*}
\gamma = \begin{pmatrix} 1\amp 0 \\ p \amp 1 \end{pmatrix},\, \gamma(\infty) = \frac 1p
\end{equation*}
%
\begin{equation*}
\begin{pmatrix} 1\amp 0 \\ p \amp 1 \end{pmatrix} \begin{pmatrix} 1\amp x \\ 0 \amp 1 \end{pmatrix} \begin{pmatrix} 1\amp 0 \\ -p \amp 1 \end{pmatrix}  = \begin{pmatrix} 1 - px \amp x  \\ -p^2 \amp px+ 1 \end{pmatrix}
\end{equation*}
%
\end{example}
\begin{example}{A cusp form.}{example-63}%
\hypertarget{p-1065}{}%
Let \(\Delta(\tau) = g_2(\tau)^3 - 27g_3(\tau)^2,\,g_2(\tau) = 60G_4(\tau),\,g_3(\tau) =140G_6(\tau)\) \(\Delta(\tau)\) has weight 12 for \(\SL_2(\ZZ)\). This vanishes at \(\infty\) because%
\begin{equation*}
\zeta(4) = \frac{\pi^4}{90}
\end{equation*}
%
\begin{equation*}
\zeta(6) = \frac{\pi^6}{945}
\end{equation*}
also%
\begin{equation*}
j(z) = \frac{g_2(\tau)^3}{\Delta(\tau)}
\end{equation*}
so \(\Delta(\tau)\) vanishes at \(\infty\) because \(g_2(\tau)\) doesn't  and \(j(z)\) has a  \hyperref[def-simple-av]{simple} pole at \(\infty\).%
\end{example}
\hypertarget{p-1066}{}%
\(M_k(\Gamma)\) as the space of \hyperref[def-buntes-mfs]{modular forms} of weight \(k\) for \(\Gamma\) is a \(\CC\) -v.s. \(S_k(\Gamma)\) as the space of \hyperref[def-buntes-cusp-forms]{cusp forms} of weight \(k\) for \(\Gamma\) is a \(\CC\) -v.s.%
\begin{theorem}{}{}{theorem-72}%
\hypertarget{p-1067}{}%
\(M_k(\Gamma)\) and \(S_k(\Gamma)\) are finite dimensional%
\begin{equation*}
\dim(M_k(\Gamma)) =
\begin{cases}
0 \amp \text{ if } k \le -1\\
1 \amp \text{ if } k = 0\\
(k-1)(g-1) + v_\infty \frac k2 + \sum_p [\frac k2 (1- \frac{1}{e_p})] \amp \text{ if } k \ge 2
\end{cases}
\end{equation*}
where \(g\) is the \hyperref[def-class-set]{genus} of \(X(\Gamma)\) \(v_\infty\) is the number of inequivalent cusps \(P\) are the elliptic points \(\lb \cdot \rb\) is the integer part%
\begin{equation*}
\dim(S_k(\Gamma)) =
\begin{cases}
0 \amp \text{ if } k \le 0 \\
(k-1)(g-1) + v_\infty (\frac k2 - 1) + \sum_p [\frac k2 (1- \frac{1}{e_p})] \amp \text{ if } k \ge 2
\end{cases}
\end{equation*}
%
\end{theorem}
\hypertarget{p-1068}{}%
%
\begin{equation*}
\dim(S_2(\Gamma)) = g(X(\Gamma))
\end{equation*}
%
\begin{proposition}{}{}{proposition-67}%
\hypertarget{p-1069}{}%
If \(f \in S_2(\Gamma)\) then \(f(z) \diff z\) is a holomorphic differential.%
\end{proposition}
\hypertarget{p-1070}{}%
Given an \hyperref[def-supersing-isog-ec]{elliptic curve}%
\begin{equation*}
E/  \CC = \CC/\Lambda
\end{equation*}
%
\begin{equation*}
E \to E'
\end{equation*}
%
\begin{equation*}
\CC/\Lambda \to \CC/\Lambda'\text{,}
\end{equation*}
studying degree \(n\) \hyperref[def-supersing-isog-isog]{isogenies}, is like studying index  \(n \) sublattices%
\begin{definition}{}{definition-100}%
\hypertarget{p-1071}{}%
\(n \ge 1\) then \(T(n)\) is the  \(n\)th \terminology{Hecke operator} acting on%
\begin{equation*}
\divisors (\mathcal L)
\end{equation*}
by%
\begin{equation*}
T(n) \Lambda = \sum_{\Lambda' \subseteq \Lambda,\,[\Lambda : \Lambda'] = n} (\Lambda')
\end{equation*}
%
\end{definition}
\begin{definition}{}{definition-101}%
\hypertarget{p-1072}{}%
Let \(\lambda \in \CC^\times\) the homothety operator \(R_\lambda\) is \(R_\lambda \Lambda = \lambda\Lambda\).%
\end{definition}
\begin{theorem}{}{}{theorem-73}%
\hypertarget{p-1073}{}%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-266}{}%
\begin{equation*}
R_\lambda R_\mu = R_{\lambda\mu}
\end{equation*}
%
\item\hypertarget{li-267}{}%
\begin{equation*}
R_\lambda T(n) = T(n) R_{\lambda}
\end{equation*}
%
\item\hypertarget{li-268}{}%
\begin{equation*}
T(nm) = T(n) T(m),\,\gcd(n,m) =1
\end{equation*}
%
\item\hypertarget{li-269}{}%
\begin{equation*}
T(p^e)T(p) = T(p^{e+1 }) + p T(p^{e-1}) R_p
\end{equation*}
%
\end{enumerate}
%
\end{theorem}
\begin{proof}\hypertarget{proof-110}{}
\hypertarget{p-1074}{}%
Of 4.%
\par
\hypertarget{p-1075}{}%
\(\Lambda \in \mathcal L\) for \(\Lambda' \subseteq \Lambda \) index \(p^{e+1}\) have%
\begin{equation*}
a(\Lambda')  = \# \{ \Gamma : \Lambda'  \subseteq \Lambda \subseteq_p \Lambda \}
\end{equation*}
%
\begin{equation*}
b(\Lambda')  = 1 \text{ if } \Lambda' \subseteq p\Lambda
\end{equation*}
now%
\begin{equation*}
T(p^e)T(p) \Lambda = T(p^e) \sum_{\Gamma \subseteq_p \Lambda } (\Gamma) = \sum_{\Gamma \subseteq_p \Lambda } \sum_{\Lambda' \subseteq_{p^e} \Gamma} (\Lambda') =\sum_{\Lambda' \subseteq_{p^e} \Gamma}  a(\Lambda') (\Lambda')
\end{equation*}
%
\begin{equation*}
T(p^{e+1} ) \Lambda  =  \sum_{\Lambda'\subseteq_{p^{e+1}} \Lambda} (\Lambda')
\end{equation*}
%
\begin{equation*}
T(p^{e-1} )R_p \Lambda  =  T(p^{e-1}) (p \Lambda) = \sum_{\Lambda'' \subseteq_{p^{e-1}} p\Lambda } (\Lambda'') = \sum_{\Lambda' \subseteq_{p^{e+1}} \Lambda} b(\Lambda') (\Lambda')
\end{equation*}
Split into cases, do some maths..%
\end{proof}
\hypertarget{p-1076}{}%
Hecke operators on \hyperref[def-buntes-lattice]{lattices} Given \(\Lambda' \subseteq_n \Lambda\) there is an integer matrix of determinant  \(n\) taking one basis to the other. Have a correspondence%
\begin{equation*}
\{ \alpha \in M_2(\ZZ) : \det(\alpha) = n \}  \leftrightarrow \{ \Lambda ' : \Lambda ' \subseteq_n \Lambda\}
\end{equation*}
representatives in Hermite normal form%
\begin{equation*}
S_n = \{\begin{pmatrix} a\amp b \\ 0 \amp d\end{pmatrix} : ad= n,\, a,d\gt 0\, 0\le b \lt d\}
\end{equation*}
%
\begin{corollary}{}{}{corollary-35}%
\hypertarget{p-1077}{}%
Let \(\Lambda \in \mathcal L\), \(\Lambda = \ZZ w_1 + \ZZ w_2\) then  \(T(n)\) acts as follows%
\begin{equation*}
T(n) \Lambda =  \sum_{ ad= n,\, a,d\gt 0\, 0\le b \lt d} \ZZ(aw_1 + bw_2) + \ZZ dw_2 = \sum_{\alpha \in S_n} \alpha \Lambda
\end{equation*}
%
\end{corollary}
\begin{corollary}{}{}{corollary-36}%
\hypertarget{p-1078}{}%
For \(p \) prime \(T(p)\):%
\begin{equation*}
T(p) \Lambda = \ZZ pw_1 + \ZZ w_2 +\sum_{0 \le b \lt p} \ZZ(w_1 + bw_2) + \ZZ pw_2\text{.}
\end{equation*}
%
\end{corollary}
\hypertarget{p-1079}{}%
The \hyperref[def-buntes-cusp-forms]{Hecke operators} act on \hyperref[def-buntes-mfs]{modular forms} \(f(\tau)\) by reinterpreting \hyperref[def-buntes-weak-modular]{weakly modular} functions of weight \(k\) as functions on \hyperref[def-buntes-lattice]{lattices} that have  a weight \(k\) action under homothety.%
\par
\hypertarget{p-1080}{}%
This boils down to%
\begin{equation*}
(T_k(n) f)(\tau) = n^{k-1}  \sum_{ ad= n,\, a,d\gt 0\, 0\le b \lt d} d^{-k} f\left( \frac{ a\tau +b}{d}\right)
\end{equation*}
%
\begin{corollary}{}{}{corollary-37}%
\hypertarget{p-1081}{}%
For \(p \) prime%
\begin{equation*}
(T_k(p) f)(\tau) = p^{k-1}f(pz) +\frac 1p \sum_{0 \le b  \lt p} f\left( \frac {z + b}{p} \right)\text{.}
\end{equation*}
%
\end{corollary}
\hypertarget{p-1082}{}%
We have an action on fourier expansions%
\begin{equation*}
f(\psi) = \sum_{m\in \ZZ} a_m q^m
\end{equation*}
%
\begin{equation*}
T_k(p)f(\tau) = p^{k-1} \sum_{m\in \ZZ} a_m q^{pm} + \frac{1}{p} \sum_{b=0}^{p-1}  \left( \sum_{m\in \ZZ} a_m e^{2\pi i m (z+b)/p}\right)
\end{equation*}
%
\begin{equation*}
= p^{k-1} \sum_{m\in \ZZ} a_m q^{pm} + \frac{1}{p}  \sum_{m\in \ZZ} a_me^{2\pi i m z/p} \sum_{b=0}^{p-1} \underbrace{e^{2\pi i m b/p}}_{p\text{ if }p|m,0\text{otw}}
\end{equation*}
%
\begin{equation*}
= p^{k-1} \sum_{m\in \ZZ} a_m q^{pm} +\sum_{m\in \ZZ} a_{pm}q^m
\end{equation*}
%
\begin{corollary}{}{}{corollary-38}%
\hypertarget{p-1083}{}%
%
\begin{equation*}
a_1(T_p(f)) = a_p(f)
\end{equation*}
%
\end{corollary}
\hypertarget{p-1084}{}%
If \(f\in S_k(\Gamma_0(1))\) is an eigenfunction for these operators we can normalise so that \(a_1(f) = 1\).%
\par
\hypertarget{p-1085}{}%
%
\begin{equation*}
T(m)T(n) = T(mn)
\end{equation*}
%
\begin{equation*}
a_ma_n = a_{mn}
\end{equation*}
%
\begin{equation*}
a_{p^r} = a_p a_{p^{r-1}} + p^{k-1} a_{p^{r+1}}
\end{equation*}
%
\begin{definition}{Petersson inner product.}{def-pet}%
\hypertarget{p-1086}{}%
The \terminology{Petersson inner product} of two \hyperref[def-buntes-cusp-forms]{cusp forms} \(f,g\in S_k(\SL_2(\ZZ))\) is defined to be%
\begin{equation*}
\pair{f}{g} = \int_{\mathcal D} f \bar g y^{k-2} \diff x \diff y
\end{equation*}
where \(\mathcal D\) is a fundamental domain for \(\SL_2(\ZZ)\).%
\end{definition}
\begin{proposition}{}{}{proposition-68}%
\hypertarget{p-1087}{}%
Let \(f,g\in S_k(\SL_2(\ZZ))\), \(n\in \NN\) then%
\begin{equation*}
\pair{T(n) f}{g} = \pair{f}{T(n)g}\text{.}
\end{equation*}
%
\end{proposition}
\end{sectionptx}
\end{chapterptx}
%
\backmatter
%
%
%% A lineskip in table of contents as transition to appendices, backmatter
\addtocontents{toc}{\vspace{\normalbaselineskip}}
%
%
%
\typeout{************************************************}
\typeout{References  References}
\typeout{************************************************}
%
\begin{references-chapter-numberless}{References}{}{References}{}{}\hypertarget{references-1}{}
%% If this is a top-level references
%%   you can replace with "thebibliography" environment
\begin{thebibliography}{9}
\bibitem[1]{bib-balakrishnan-bradshaw-kedlaya}\hypertarget{bib-balakrishnan-bradshaw-kedlaya}{}Balakrishnan, Jennifer S., Robert W. Bradshaw, and Kiran S. Kedlaya. \textit{Explicit Coleman Integration for Hyperelliptic Curves}. In ANTS, pp. 16-31. 2010.
\bibitem[2]{bib-balakrishnan-even}\hypertarget{bib-balakrishnan-even}{}Balakrishnan, Jennifer S. \textit{Coleman integration for even-degree models of hyperelliptic curves}. LMS Journal of Computation and Mathematics 18.1 (2015): 258-265.
\bibitem[3]{bib-balakrishnan-iterated}\hypertarget{bib-balakrishnan-iterated}{}Balakrishnan, Jennifer S. \textit{Iterated Coleman integration for hyperelliptic curves}. The Open Book Series 1.1 (2013): 41-61.
\bibitem[4]{bib-balakrishnan-dogra}\hypertarget{bib-balakrishnan-dogra}{}Balakrishnan JS, Dogra N. \textit{Quadratic Chabauty and rational points I: p-adic heights}. arXiv preprint arXiv:1601.00388. 2016 Jan 4.
\bibitem[5]{bib-balakrishnan-dogra-muller-tuitman-vonk}\hypertarget{bib-balakrishnan-dogra-muller-tuitman-vonk}{}Balakrishnan JS, Dogra N, Müller JS, Tuitman J, Vonk J. \textit{Explicit Chabauty-Kim for the Split Cartan Modular Curve of Level 13}. arXiv preprint arXiv:1711.05846. 2017 Nov 15.
\bibitem[6]{bib-balakrishnan-tuitman}\hypertarget{bib-balakrishnan-tuitman}{}Balakrishnan JS, Tuitman J. \textit{Explicit Coleman integration for curves}. arXiv preprint arXiv:1710.01673. 2017 Oct 4.
\bibitem[7]{bib-bala-nonab}\hypertarget{bib-bala-nonab}{}Balakrishnan, J., Dan-Cohen, I., Kim, M., and Wewers, S. (2012). \textit{A non-abelian conjecture of Birch and Swinnerton-Dyer type for hyperbolic curves}. arXiv preprint arXiv:1209.0640.
\bibitem[8]{bib-berkovich}\hypertarget{bib-berkovich}{}Berkovich, Vladimir G.  \textit{Integration of One-forms on P-adic Analytic Spaces}. (AM-162). No. 162. Princeton University Press, 2007.
\bibitem[9]{bib-berth1}\hypertarget{bib-berth1}{}Berthelot, Pierre.\textit{Cohomologie Cristalline des Schémas de Caractéristique \(p\gt 0\)} LNM 407, Springer, 1974.
\bibitem[10]{bib-berth2}\hypertarget{bib-berth2}{}Berthelot, Pierre.  \textit{Finitude et pureté cohomologique en cohomologie rigide} \url{https://perso.univ-rennes1.fr/pierre.berthelot/publis/Finitude.pdf}
\bibitem[11]{bib-besser-coleman-tannakian}\hypertarget{bib-besser-coleman-tannakian}{}Besser, Amnon. \textit{Coleman integration using the Tannakian formalism}. Mathematische Annalen 322, no. 1 (2002): 19-48.
\bibitem[12]{bib-besser-coleman-heidelberg}\hypertarget{bib-besser-coleman-heidelberg}{}Besser, Amnon. \textit{Heidelberg lectures on Coleman integration}. In The Arithmetic of Fundamental Groups, pp. 3-52. Springer, Berlin, Heidelberg, 2012.
\bibitem[13]{bib-besser-syntomic-I}\hypertarget{bib-besser-syntomic-I}{}Besser, Amnon. \textit{Syntomic regulators andp-adic integration I: Rigid syntomic regulators}. Israel Journal of Mathematics 120, no. 2 (2000): 291-334.
\bibitem[14]{bib-besser-syntomic-II}\hypertarget{bib-besser-syntomic-II}{}Besser, Amnon. \textit{Syntomic regulators and \(p\)-adic integration II: K 2 of curves}. Israel Journal of Mathematics 120, no. 2 (2000): 335-359.
\bibitem[15]{bib-bloch}\hypertarget{bib-bloch}{}Bloch, Spencer.  \textit{Higher regulators, algebraic K-theory, and zeta functions of elliptic curves.} Vol. 11. American Mathematical Soc., 2000.
\bibitem[16]{bib-bochner-formal}\hypertarget{bib-bochner-formal}{}Bochner, S. \textit{Formal Lie Groups}. Annals of Mathematics, vol. 47, no. 2, 1946, pp. 192–201. JSTOR, JSTOR, \url{www.jstor.org/stable/1969242}.
\bibitem[17]{bib-borel-hopf}\hypertarget{bib-borel-hopf}{}Borel, Armand. \textit{Sur La Cohomologie Des Espaces Fibres Principaux Et Des Espaces Homogenes De Groupes De Lie Compacts}. Annals of Mathematics, Second Series, 57, no. 1 (1953): 115-207. doi:10.2307/1969728.
\bibitem[18]{bib-bostan-gaudry-schost}\hypertarget{bib-bostan-gaudry-schost}{}Bostan, Alin, Gaudry, Pierrick, and Schost, Éric. \textit{Linear recurrences with polynomial coefficients and application to integer factorization and Cartier-Manin operator}. SIAM Journal on Computing 36, no. 6 (2007): 1777-1806.
\bibitem[19]{bib-chen}\hypertarget{bib-chen}{}Chen, Kuo-Tsai.  \textit{Algebras of iterated path integrals and fundamental groups.} Transactions of the American Mathematical Society 156 (1971): 359-379.
\bibitem[20]{bib-coleman-torsion}\hypertarget{bib-coleman-torsion}{}Coleman, Robert F.  \textit{Torsion points on curves and p-adic abelian integrals.} Annals of Mathematics 121.1 (1985): 111-168.
\bibitem[21]{bib-coleman-chabauty}\hypertarget{bib-coleman-chabauty}{}Coleman, Robert F.  \textit{Effective Chabauty} Duke Math. J 52.3 (1985): 765-770.
\bibitem[22]{bib-coleman-de-shalit}\hypertarget{bib-coleman-de-shalit}{}Coleman, Robert, and Ehud De Shalit. \textit{\(p\)-adic regulators on curves and special values of \(p\)-adic \(L\)-functions}. Inventiones mathematicae 93, no. 2 (1988): 239-266.
\bibitem[23]{bib-coleman-dilogs}\hypertarget{bib-coleman-dilogs}{}Coleman, Robert F. \textit{Dilogarithms, regulators and \(p\)-adic \(L\)-functions}. Inventiones mathematicae 69, no. 2 (1982): 171-208.
\bibitem[24]{bib-coleman-gross}\hypertarget{bib-coleman-gross}{}Coleman, Robert F., and B. Gross. \textit{p-adic Heights on Curves} Math. Sciences Research Inst., Berkeley, Calif. (1987).
\bibitem[25]{bib-fresnel-van-der-put}\hypertarget{bib-fresnel-van-der-put}{}Fresnel, Jean, and Marius Van der Put \textit{Rigid analytic geometry and its applications} Vol. 218. Springer Science \& Business Media, 2012.
\bibitem[26]{bib-gabber-ramero}\hypertarget{bib-gabber-ramero}{}Gabber O, Ramero L. \textit{Almost ring theory}. Springer; 2003 Dec 15.
\bibitem[27]{bib-gaudry-gurel}\hypertarget{bib-gaudry-gurel}{}Gaudry, Pierrick, and Nicolas Gürel. \textit{An extension of Kedlaya's point-counting algorithm to superelliptic curves}. Advances in Cryptology - ASIACRYPT 2001, Springer, Berlin, Heidelberg, 2001.
\bibitem[28]{bib-gerritzen-van-der-put}\hypertarget{bib-gerritzen-van-der-put}{}Gerritzen, L. and Van der Put, M., 2006. \textit{Schottky groups and Mumford curves} (Vol. 817). Springer.
\bibitem[29]{bib-goncalves}\hypertarget{bib-goncalves}{}Gonçalves, Cécile. \textit{A point counting algorithm for cyclic covers of the projective line}. Contemporary mathematics 637 (2015): 145.
\bibitem[30]{bib-goncharov-mixed}\hypertarget{bib-goncharov-mixed}{}Goncharov, Alexander. \textit{Mixed elliptic motives}. London Mathematical Society Lecture Note Series (1998): 147-222.
\bibitem[31]{bib-gl}\hypertarget{bib-gl}{}Goncharov, Alexander B., and Andrey M. Levin. \textit{Zagier's conjecture on L (E, 2)}. Inventiones mathematicae 132, no. 2 (1998): 393-432.
\bibitem[32]{bib-harrison-hyperelliptic}\hypertarget{bib-harrison-hyperelliptic}{}Harrison, Michael C. \textit{An extension of Kedlaya's algorithm for hyperelliptic curves}. Journal of Symbolic Computation 47.1 (2012): 89-101.
\bibitem[33]{bib-hartshorne}\hypertarget{bib-hartshorne}{}Hartshorne, Robin. \textit{Algebraic geometry}. Vol. 52. Springer Science \& Business Media, 2013.
\bibitem[34]{bib-harvey-average}\hypertarget{bib-harvey-average}{}Harvey, David. \textit{Counting points on hyperelliptic curves in average polynomial time}. Annals of Mathematics 179, no. 2 (2014): 783-803.
\bibitem[35]{bib-harvey-sqrtp}\hypertarget{bib-harvey-sqrtp}{}Harvey, David. \textit{Kedlaya's Algorithm in Larger Characteristic}. IMRN: International Mathematics Research Notices 2007 (2007).
\bibitem[36]{bib-harvey-sutherland}\hypertarget{bib-harvey-sutherland}{}Harvey, David, and Andrew V. Sutherland. \textit{Computing Hasse–Witt matrices of hyperelliptic curves in average polynomial time}. LMS Journal of Computation and Mathematics 17, no. A (2014): 257-273.
\bibitem[37]{bib-harvey-sutherland-ii}\hypertarget{bib-harvey-sutherland-ii}{}Harvey, David, and Andrew V. Sutherland. \textit{Computing Hasse-Witt matrices of hyperelliptic curves in average polynomial time II}. Frobenius distributions: Lang–Trotter and Sato–Tate conjectures, Contemporary Mathematics 663 (2016): 127-148.
\bibitem[38]{bib-hida-geometric}\hypertarget{bib-hida-geometric}{}Hida, Haruzo. \textit{Geometric modular forms and elliptic curves}. World Scientific, 2012.
\bibitem[39]{bib-katz-serre-tate}\hypertarget{bib-katz-serre-tate}{}Katz, Nicholas. \textit{Serre-Tate local moduli}. In Surfaces algébriques, pp. 138-202. Springer, Berlin, Heidelberg, 1981.
\bibitem[40]{bib-kedlaya-counting}\hypertarget{bib-kedlaya-counting}{}Kedlaya, Kiran S. \textit{Counting points on hyperelliptic curves using Monsky-Washnitzer cohomology}, J. Ramanujan Math. Soc. 16 (2001), no. 4, 323-338; errata, ibid. 18 (2003), 417--418.
\bibitem[41]{bib-lang-algebra}\hypertarget{bib-lang-algebra}{}Lang, Serge,  \textit{Algebra}, Graduate Texts in Mathematics 1.211 (2002): ALL-ALL.
\bibitem[42]{bib-lee-smooth}\hypertarget{bib-lee-smooth}{}Lee, John M. \textit{Smooth manifolds}. Springer, New York, NY, 2003. 9780387954486.
\bibitem[43]{bib-le-gall}\hypertarget{bib-le-gall}{}Le Gall, François. \textit{Faster algorithms for rectangular matrix multiplication}. In Foundations of Computer Science (FOCS), 2012 IEEE 53rd Annual Symposium on, pp. 514-523. IEEE, 2012.
\bibitem[44]{bib-liu}\hypertarget{bib-liu}{}Qing Liu. \textit{Algebraic geometry and arithmetic curves}. Vol. 6. Oxford University Press, 2002.
\bibitem[45]{bib-matsumura}\hypertarget{bib-matsumura}{}Matsumura, Hideyuki. \textit{Commutative ring theory}. Vol. 8. Cambridge university press, 1989.
\bibitem[46]{bib-matsumura-algebra}\hypertarget{bib-matsumura-algebra}{}Matsumura, Hideyuki. \textit{Commutative algebra}. Vol. 120. New York: WA Benjamin, 1970.
\bibitem[47]{bib-mazur-stein-tate}\hypertarget{bib-mazur-stein-tate}{}Mazur, Barry, William Stein, and John Tate. \textit{Computation of p-adic heights and log convergence.} Doc. Math (2006): 577-614.
\bibitem[48]{bib-milne-etale}\hypertarget{bib-milne-etale}{}Milne, James S. \textit{Etale cohomology} (PMS-33). Vol. 33. Princeton university press, 2016.
\bibitem[49]{bib-minzlaff}\hypertarget{bib-minzlaff}{}Minzlaff, Moritz. \textit{Computing zeta functions of superelliptic curves in larger characteristic}. Mathematics in Computer Science 3.2 (2010): 209-224.
\bibitem[50]{bib-mumford-abvar}\hypertarget{bib-mumford-abvar}{}Mumford, David. \textit{Abelian varieties}. Vol. 5. Oxford University Press, USA, 1974.
\bibitem[51]{bib-narkiewicz}\hypertarget{bib-narkiewicz}{}Narkiewicz, Wladyslaw  \textit{Elementary and Analytic Theory of Algebraic Numbers}. Springer, 2004.
\bibitem[52]{bib-polishchuck}\hypertarget{bib-polishchuck}{}Polishchuk, Alexander. \textit{Abelian varieties, theta functions and the Fourier transform}. Vol. 153. Cambridge University Press, 2003.
\bibitem[53]{bib-rolshausen}\hypertarget{bib-rolshausen}{}Rolshausen, Klaus, and Norbert Schappacher.  \textit{On the second K-group of an elliptic curve.}  Journal für die reine und angewandte Mathematik 495 (1998): 61-77.
\bibitem[54]{bib-sage}\hypertarget{bib-sage}{}\textit{SageMath, the Sage Mathematics Software System (Version 8.1.0)}, The Sage Developers, 2017, \url{http://www.sagemath.org}.
\bibitem[55]{bib-serre-course}\hypertarget{bib-serre-course}{}Serre, Jean-Pierre. \textit{A course in arithmetic}. Vol. 7. Springer Science \& Business Media, 2012.
\bibitem[56]{bib-serre-local-alg}\hypertarget{bib-serre-local-alg}{}Serre, Jean-Pierre. \textit{Local algebra}. Springer Science \& Business Media, 2000.
\bibitem[57]{bib-serre-mordell-weil}\hypertarget{bib-serre-mordell-weil}{}Serre, Jean-Pierre, Martin Brown, and Michel Waldschmidt. \textit{Lectures on the Mordell-Weil theorem}. Vol. 2. Braunschweig: Vieweg, 1990.
\bibitem[58]{bib-shafarevich-remizov}\hypertarget{bib-shafarevich-remizov}{}Shafarevich, Igor R., and Alexey O. Remizov. \textit{Linear algebra and geometry}. Springer Science \& Business Media, 2012.
\bibitem[59]{bib-silverman}\hypertarget{bib-silverman}{}Silverman, Joseph H. \textit{The arithmetic of elliptic curves}. Vol. 106. Springer Science \& Business Media, 2009.
\bibitem[60]{bib-silverman-advanced}\hypertarget{bib-silverman-advanced}{}Silverman, Joseph H. \textit{Advanced topics in the arithmetic of elliptic curves}. Vol. 151. Springer Science \& Business Media, 2013.
\bibitem[61]{bib-stacks}\hypertarget{bib-stacks}{}Stacks Project Authors, \textit{The Stacks Project}, \href{}{https://stacks.math.columbia.edu}.
\bibitem[62]{bib-sutherland}\hypertarget{bib-sutherland}{}Sutherland, Andrew. \textit{Isogeny volcanoes}. The Open Book Series 1, no. 1 (2013): 507-530. \url{https://msp.org/obs/2013/1-1/obs-v1-n1-p25-s.pdf}.
\bibitem[63]{bib-tamme}\hypertarget{bib-tamme}{}Tamme, Günter. \textit{Introduction to étale cohomology}. Springer Science \& Business Media, 2012.
\bibitem[64]{bib-tuitman-map-to-p1-1}\hypertarget{bib-tuitman-map-to-p1-1}{}Tuitman, Jan. \textit{Counting points on curves using a map to \(\PP^1\)}. Mathematics of Computation 85.298 (2016): 961-981.
\bibitem[65]{bib-tuitman-map-to-p1-2}\hypertarget{bib-tuitman-map-to-p1-2}{}Tuitman, Jan. \textit{Counting points on curves using a map to \(\PP^1\), II}. Finite Fields and Their Applications 45 (2017): 301-322.
\bibitem[66]{bib-vandergeer-moonen}\hypertarget{bib-vandergeer-moonen}{}van der Geer, G., Moonen, B. \textit{Abelian Varieties}, from \url{https://www.math.ru.nl/\~bmoonen/research.html\#bookabvar}.
\bibitem[67]{bib-velu}\hypertarget{bib-velu}{}Vélu, Jacques. \textit{Isogénies entre courbes elliptiques}. CR Acad. Sci. Paris, Séries A 273 (1971): 305-347.
\bibitem[68]{bib-voight-quat}\hypertarget{bib-voight-quat}{}Voight, John. \textit{Quaternion Algebras}. \url{http://quatalg.org}
\bibitem[69]{bib-waterhouse}\hypertarget{bib-waterhouse}{}Waterhouse, William C.  \textit{Profinite groups are Galois groups}. Proceedings of the American Mathematical Society 42.2 (1974): 639-640.
\bibitem[70]{bib-weng-nakamura}\hypertarget{bib-weng-nakamura}{}Weng, L., and Nakamura, I. \textit{Arithmetic geometry and number theory}, World Scientific, 2006.
\bibitem[71]{bib-zag-ram}\hypertarget{bib-zag-ram}{}Zagier, Don.  \textit{The Bloch-Wigner-Ramakrishnan polylogarithm function.} Mathematische Annalen 286, no. 1 (1990): 613-624.
\bibitem[72]{bib-pug}\hypertarget{bib-pug}{}\textit{Pug Template Engine} see \href{http://pug-lang.com/}{pug-lang.com}.
\end{thebibliography}
\end{references-chapter-numberless}
\end{document}